{"version":3,"file":"index.es.js","sources":["../src/core/contexts/BreacrumbsContext.tsx","../src/core/contexts/ModeController.tsx","../src/core/util/navigation_utils.ts","../src/core/util/navigation_from_path.ts","../src/core/internal/common.tsx","../src/core/contexts/DataSourceContext.tsx","../src/hooks/data/useDataSource.tsx","../src/core/contexts/NavigationContext.tsx","../src/hooks/useNavigationContext.tsx","../src/core/contexts/AuthControllerContext.tsx","../src/hooks/useAuthController.tsx","../src/core/contexts/SideDialogsControllerContext.tsx","../src/hooks/useSideDialogsController.tsx","../src/core/contexts/SideEntityControllerContext.tsx","../src/hooks/useSideEntityController.tsx","../src/core/contexts/StorageSourceContext.tsx","../src/hooks/useStorageSource.tsx","../src/hooks/useSnackbarController.tsx","../src/core/contexts/UserConfigurationPersistenceContext.tsx","../src/hooks/useUserConfigurationPersistence.tsx","../src/hooks/useFireCMSContext.tsx","../src/hooks/data/useCollectionFetch.tsx","../src/hooks/data/useEntityFetch.tsx","../src/hooks/data/save.ts","../src/hooks/data/delete.ts","../src/form/useClearRestoreValue.tsx","../src/hooks/useResolvedNavigationFrom.tsx","../src/hooks/useModeController.tsx","../src/hooks/useClipboard.tsx","../src/hooks/useBreadcrumbsContext.tsx","../src/hooks/useReferenceDialog.tsx","../src/hooks/useBrowserTitleAndIcon.tsx","../src/core/components/ErrorTooltip.tsx","../src/core/components/ErrorView.tsx","../src/types/entities.ts","../src/preview/components/EmptyValue.tsx","../src/preview/util.ts","../src/preview/components/ImagePreview.tsx","../src/preview/components/UrlComponentPreview.tsx","../src/preview/property_previews/SkeletonPropertyComponent.tsx","../src/preview/components/StorageThumbnail.tsx","../src/preview/components/Markdown.tsx","../src/core/util/hash.ts","../src/core/util/chip_utils.ts","../src/core/util/enums.ts","../src/preview/components/ColorChip.tsx","../src/preview/property_previews/StringPropertyPreview.tsx","../src/preview/property_previews/ArrayOfMapsPreview.tsx","../src/preview/property_previews/ArrayPropertyPreview.tsx","../src/core/util/field_colors.tsx","../src/preview/components/ReferencePreview.tsx","../src/preview/property_previews/ArrayOfReferencesPreview.tsx","../src/preview/property_previews/ArrayOfStorageComponentsPreview.tsx","../src/preview/components/ArrayEnumPreview.tsx","../src/preview/property_previews/ArrayPropertyEnumPreview.tsx","../src/preview/property_previews/ArrayOfStringsPreview.tsx","../src/core/util/common.tsx","../src/preview/property_previews/ArrayOneOfPreview.tsx","../src/preview/property_previews/MapPropertyPreview.tsx","../src/core/util/dates.ts","../src/preview/components/DatePreview.tsx","../src/preview/components/BooleanPreview.tsx","../src/preview/property_previews/NumberPropertyPreview.tsx","../src/preview/PropertyPreview.tsx","../src/preview/components/AsyncPreviewComponent.tsx","../src/core/util/objects.ts","../src/core/util/entities.ts","../src/core/util/collections.ts","../src/core/util/strings.ts","../src/core/util/paths.ts","../src/core/util/regexp.ts","../src/core/util/useDebounce.ts","../src/core/util/useDebounceValue.ts","../src/form/components/FormikArrayContainer.tsx","../src/form/components/FieldDescription.tsx","../src/form/components/LabelWithIcon.tsx","../src/form/components/DebouncedTextField.tsx","../src/form/components/SwitchControl.tsx","../src/core/components/ErrorBoundary.tsx","../src/form/field_bindings/ReadOnlyFieldBinding.tsx","../src/form/PropertyFieldBinding.tsx","../src/form/field_bindings/ArrayCustomShapedFieldBinding.tsx","../src/form/field_bindings/SelectFieldBinding.tsx","../src/form/field_bindings/ArrayEnumSelectBinding.tsx","../src/form/field_bindings/ArrayOfReferencesFieldBinding.tsx","../src/core/util/storage.ts","../src/core/util/useStorageUploadController.tsx","../src/form/components/StorageUploadProgress.tsx","../src/form/components/StorageItemPreview.tsx","../src/form/field_bindings/StorageUploadFieldBinding.tsx","../src/core/components/fields/TextareaAutosize.tsx","../src/core/components/fields/DisabledTextField.tsx","../src/core/components/fields/TextInput.tsx","../src/form/field_bindings/TextFieldBinding.tsx","../src/core/components/fields/BooleanSwitch.tsx","../src/form/field_bindings/SwitchFieldBinding.tsx","../src/form/field_bindings/DateTimeFieldBinding.tsx","../src/form/components/ReferenceWidget.tsx","../src/form/field_bindings/ReferenceFieldBinding.tsx","../src/form/field_bindings/MapFieldBinding.tsx","../src/form/field_bindings/KeyValueFieldBinding.tsx","../src/core/components/ExpandablePanel.tsx","../src/form/field_bindings/RepeatFieldBinding.tsx","../src/form/field_bindings/BlockFieldBinding.tsx","../src/form/field_bindings/MarkdownFieldBinding.tsx","../src/form/validation.ts","../src/form/components/ErrorFocus.tsx","../src/core/util/resolutions.ts","../src/form/components/CustomIdField.tsx","../src/form/EntityForm.tsx","../src/core/form_field_configs.tsx","../src/core/util/property_utils.tsx","../src/core/util/permissions.ts","../src/core/util/icons.tsx","../src/core/util/plurals.ts","../src/core/util/references.ts","../src/core/components/EntityPreview.tsx","../src/core/components/EntityCollectionTable/internal/common.tsx","../src/core/components/Table/fields/TableInput.tsx","../src/core/components/Table/fields/TableSelect.tsx","../src/core/components/Table/fields/TableNumberInput.tsx","../src/core/components/Table/fields/TableSwitch.tsx","../src/core/components/Table/fields/TableDateField.tsx","../src/core/components/EntityCollectionTable/fields/TableReferenceField.tsx","../src/core/components/EntityCollectionTable/fields/TableStorageUpload.tsx","../src/core/components/Table/common.tsx","../src/core/components/EntityCollectionTable/internal/TableCell.tsx","../src/core/components/EntityCollectionTable/internal/PropertyTableCell.tsx","../src/core/components/EntityCollectionTable/internal/popup_field/useDraggable.tsx","../src/core/components/EntityCollectionTable/internal/popup_field/useWindowSize.tsx","../src/core/components/EntityCollectionTable/internal/popup_field/ElementResizeListener.tsx","../src/core/components/CustomDialogActions.tsx","../src/core/components/EntityCollectionTable/internal/popup_field/PopupFormField.tsx","../src/core/components/CircularProgressCenter.tsx","../src/core/components/Table/VirtualTableHeader.tsx","../src/core/components/Table/VirtualTableHeaderRow.tsx","../src/core/components/Table/VirtualTableRow.tsx","../src/core/components/Table/VirtualTableCell.tsx","../src/core/components/Table/VirtualTable.tsx","../src/core/components/EntityCollectionTable/internal/EntityCollectionRowActions.tsx","../src/core/components/EntityCollectionTable/internal/SearchBar.tsx","../src/core/components/fields/FilledSelect.tsx","../src/core/components/EntityCollectionTable/internal/CollectionTableToolbar.tsx","../src/core/components/EntityCollectionTable/filters/ReferenceFilterField.tsx","../src/core/components/EntityCollectionTable/filters/StringNumberFilterField.tsx","../src/core/components/EntityCollectionTable/filters/BooleanFilterField.tsx","../src/core/components/fields/DateTimeField.tsx","../src/core/components/EntityCollectionTable/filters/DateTimeFilterField.tsx","../src/core/components/EntityCollectionTable/EntityCollectionTable.tsx","../src/core/internal/SideDialogDrawer.tsx","../src/core/internal/useUnsavedChangesDialog.tsx","../src/core/SideDialogs.tsx","../src/core/components/EntityCollectionTable/internal/DeleteEntityDialog.tsx","../src/core/util/csv.ts","../src/core/components/EntityCollectionTable/internal/ExportButton.tsx","../src/core/components/EntityCollectionView/EntityCollectionViewActions.tsx","../src/hooks/data/useDataOrder.ts","../src/core/components/EntityCollectionTable/useDebouncedData.ts","../src/core/components/EntityCollectionTable/useTableController.tsx","../src/core/components/EntityCollectionView/isFilterCombinationValidForFirestore.tsx","../src/core/components/EntityCollectionView/EntityCollectionView.tsx","../src/core/components/ReferenceSelectionInner.tsx","../src/core/util/arrays.ts","../src/core/components/HomePage/NavigationGroup.tsx","../src/core/components/HomePage/NavigationCollectionCard.tsx","../src/core/components/HomePage/FavouritesView.tsx","../src/core/internal/useRestoreScroll.tsx","../src/core/components/HomePage/FireCMSHomePage.tsx","../src/core/components/BreadcrumbUpdater.tsx","../src/core/components/NotFoundPage.tsx","../src/core/components/DeleteConfirmationDialog.tsx","../src/core/components/FireCMSLogo.tsx","../src/core/components/CenteredView.tsx","../src/core/components/InfoLabel.tsx","../src/core/Drawer.tsx","../src/core/Scaffold.tsx","../src/core/components/FireCMSAppBar.tsx","../src/core/components/ArrayContainer.tsx","../src/core/internal/useLargeSideLayout.tsx","../src/core/internal/EntityView.tsx","../src/core/EntitySidePanel.tsx","../src/core/internal/useBuildSideEntityController.tsx","../src/core/util/parent_references_from_path.ts","../src/core/internal/useBuildNavigationContext.tsx","../src/core/internal/useBuildSideDialogsController.tsx","../src/core/FireCMS.tsx","../src/core/theme.ts","../src/core/NavigationRoutes.tsx","../src/core/builders.ts","../src/core/useBuildModeController.tsx","../src/core/useBuildLocalConfigurationPersistence.tsx","../src/core/contexts/SnackbarContext.tsx","../src/firebase_app/hooks/useFirebaseAuthController.ts","../src/firebase_app/util/dates.ts","../src/firebase_app/hooks/useFirestoreDataSource.ts","../src/firebase_app/hooks/useFirebaseStorageSource.ts","../src/firebase_app/hooks/useValidateAuthenticator.tsx","../src/firebase_app/hooks/useInitialiseFirebase.ts","../src/firebase_app/hooks/useInitializeAppCheck.ts","../src/firebase_app/components/social_icons.tsx","../src/firebase_app/hooks/useRecaptcha.tsx","../src/firebase_app/components/FirebaseLoginView.tsx","../src/firebase_app/FirebaseCMSApp.tsx","../src/firebase_app/types/text_search.ts"],"sourcesContent":["import React, { useState } from \"react\";\nimport {\n    BreadcrumbEntry,\n    BreadcrumbsController\n} from \"../../hooks/useBreadcrumbsContext\";\n\nconst DEFAULT_BREADCRUMBS_CONTROLLER = {\n    breadcrumbs: [],\n    set: (props: {\n        breadcrumbs: BreadcrumbEntry[];\n    }) => {\n    }\n};\n\nexport const BreadcrumbContext = React.createContext<BreadcrumbsController>(DEFAULT_BREADCRUMBS_CONTROLLER);\n\ninterface BreadcrumbsProviderProps {\n    children: React.ReactNode;\n}\n\nexport const BreadcrumbsProvider: React.FC<BreadcrumbsProviderProps> = ({ children }) => {\n\n    const [breadcrumbs, setBreadcrumbs] = useState<BreadcrumbEntry[]>([]);\n\n    const set = (props: {\n        breadcrumbs: BreadcrumbEntry[];\n    }) => {\n        setBreadcrumbs(props.breadcrumbs);\n    };\n\n    return (\n        <BreadcrumbContext.Provider\n            value={{\n                breadcrumbs,\n                set\n            }}\n        >\n            {children}\n        </BreadcrumbContext.Provider>\n    );\n};\n","import React from \"react\";\nimport { ModeController } from \"../../hooks\";\n\nconst DEFAULT_MODE_STATE: ModeController = {\n    mode: \"light\",\n    setMode: (mode: \"light\" | \"dark\") => {\n    },\n    toggleMode: () => {\n    }\n};\nexport const ModeControllerContext = React.createContext<ModeController>(DEFAULT_MODE_STATE);\n\nexport const ModeControllerProvider = ModeControllerContext.Provider;\n","import { EntityCollection } from \"../../types\";\n\nexport function removeInitialAndTrailingSlashes(s: string): string {\n    return removeInitialSlash(removeTrailingSlash(s));\n}\n\nexport function removeInitialSlash(s: string) {\n    if (s.startsWith(\"/\"))\n        return s.slice(1);\n    else return s;\n}\n\nexport function removeTrailingSlash(s: string) {\n    if (s.endsWith(\"/\"))\n        return s.slice(0, -1);\n    else return s;\n}\n\nexport function addInitialSlash(s: string) {\n    if (s.startsWith(\"/\"))\n        return s;\n    else return `/${s}`;\n}\n\nexport function getLastSegment(path: string) {\n    const cleanPath = removeInitialAndTrailingSlashes(path);\n    if (cleanPath.includes(\"/\")) {\n        const segments = cleanPath.split(\"/\");\n        return segments[segments.length - 1];\n    }\n    return cleanPath;\n}\n\nexport function resolveCollectionPathAliases(path: string, allCollections: EntityCollection[]): string {\n\n    const cleanPath = removeInitialAndTrailingSlashes(path);\n    const subpaths = cleanPath.split(\"/\");\n    if (subpaths.length % 2 === 0) {\n        throw Error(`Collection paths must have an odd number of segments: ${path}`);\n    }\n\n    const aliasedCollection = allCollections.find((col) => col.alias === subpaths[0]);\n    let resolvedAliased;\n    if (aliasedCollection) {\n        resolvedAliased = aliasedCollection.path;\n    }\n\n    if (subpaths.length > 1) {\n        const segmentCollection = getCollectionByPathOrAlias(resolvedAliased ?? subpaths[0], allCollections);\n        if (!segmentCollection?.subcollections) {\n            return cleanPath;\n        }\n        const restOfThePath = cleanPath.split(\"/\").slice(2).join(\"/\");\n        return (resolvedAliased ?? subpaths[0]) + \"/\" + subpaths[1] + \"/\" + resolveCollectionPathAliases(restOfThePath, segmentCollection.subcollections);\n    } else {\n        return resolvedAliased ?? cleanPath;\n    }\n}\n\n/**\n * Find the corresponding view at any depth for a given path.\n * Note that path or segments of the paths can be collection aliases.\n * @param pathOrAlias\n * @param collections\n */\nexport function getCollectionByPathOrAlias<M extends Record<string, any>>(pathOrAlias: string, collections: EntityCollection[]): EntityCollection | undefined {\n\n    const subpaths = removeInitialAndTrailingSlashes(pathOrAlias).split(\"/\");\n    if (subpaths.length % 2 === 0) {\n        throw Error(`Collection paths must have an odd number of segments: ${pathOrAlias}`);\n    }\n\n    const subpathCombinations = getCollectionPathsCombinations(subpaths);\n    let result: EntityCollection | undefined;\n    for (let i = 0; i < subpathCombinations.length; i++) {\n        const subpathCombination = subpathCombinations[i];\n        const navigationEntry = collections && collections\n            .sort((a, b) => (a.alias ?? \"\").localeCompare(b.alias ?? \"\"))\n            .find((entry) => entry.alias === subpathCombination || entry.path === subpathCombination);\n\n        if (navigationEntry) {\n\n            if (subpathCombination === pathOrAlias) {\n                result = navigationEntry;\n            } else if (navigationEntry.subcollections) {\n                const newPath = pathOrAlias.replace(subpathCombination, \"\").split(\"/\").slice(2).join(\"/\");\n                if (newPath.length > 0)\n                    result = getCollectionByPathOrAlias(newPath, navigationEntry.subcollections);\n            }\n        }\n        if (result) break;\n    }\n    return result;\n}\n\n/**\n * Get the subcollection combinations from a path:\n * \"sites/es/locales\" => [\"sites/es/locales\", \"sites\"]\n * @param subpaths\n */\nexport function getCollectionPathsCombinations(subpaths: string[]): string[] {\n    const entries = subpaths.length > 0 && subpaths.length % 2 === 0 ? subpaths.splice(0, subpaths.length - 1) : subpaths;\n\n    const length = entries.length;\n    const result: string[] = [];\n    for (let i = length; i > 0; i = i - 2) {\n        result.push(entries.slice(0, i).join(\"/\"));\n    }\n    return result;\n\n}\n","import { EntityCollection, EntityCustomView } from \"../../types\";\nimport {\n    getCollectionPathsCombinations,\n    removeInitialAndTrailingSlashes\n} from \"./navigation_utils\";\n\nexport type NavigationViewInternal<M extends Record<string, any> = any> =\n    | NavigationViewEntityInternal<M>\n    | NavigationViewCollectionInternal<M>\n    | NavigationViewEntityCustomInternal<M>;\n\nexport interface NavigationViewEntityInternal<M extends Record<string, any>> {\n    type: \"entity\";\n    entityId: string;\n    path: string;\n    parentCollection: EntityCollection<M>;\n}\n\nexport interface NavigationViewCollectionInternal<M extends Record<string, any>> {\n    type: \"collection\";\n    path: string;\n    collection: EntityCollection<M>;\n}\n\nexport interface NavigationViewEntityCustomInternal<M extends Record<string, any>> {\n    type: \"custom_view\";\n    path: string;\n    view: EntityCustomView<M>;\n}\n\nexport function getNavigationEntriesFromPathInternal(props: {\n    path: string,\n    collections: EntityCollection[] | undefined,\n    customViews?: EntityCustomView<any>[],\n    currentFullPath?: string,\n}): NavigationViewInternal [] {\n\n    const {\n        path,\n        collections = [],\n        currentFullPath\n    } = props;\n\n    const subpaths = removeInitialAndTrailingSlashes(path).split(\"/\");\n    const subpathCombinations = getCollectionPathsCombinations(subpaths);\n\n    const result: NavigationViewInternal[] = [];\n    for (let i = 0; i < subpathCombinations.length; i++) {\n        const subpathCombination = subpathCombinations[i];\n\n        const collection: EntityCollection<any> | undefined = collections && collections.find((entry) => entry.alias === subpathCombination || entry.path === subpathCombination);\n\n        if (collection) {\n            const pathOrAlias = collection.alias ?? collection.path;\n            const collectionPath = currentFullPath && currentFullPath.length > 0\n                ? (currentFullPath + \"/\" + pathOrAlias)\n                : pathOrAlias;\n\n            result.push({\n                type: \"collection\",\n                path: collectionPath,\n                collection\n            });\n            const restOfThePath = removeInitialAndTrailingSlashes(removeInitialAndTrailingSlashes(path).replace(subpathCombination, \"\"));\n            const nextSegments = restOfThePath.length > 0 ? restOfThePath.split(\"/\") : [];\n            if (nextSegments.length > 0) {\n                const entityId = nextSegments[0];\n                const fullPath = collectionPath + \"/\" + entityId;\n                result.push({\n                    type: \"entity\",\n                    entityId,\n                    path: collectionPath,\n                    parentCollection: collection\n                });\n                if (nextSegments.length > 1) {\n                    const newPath = nextSegments.slice(1).join(\"/\");\n                    if (!collection) {\n                        throw Error(\"collection not found resolving path: \" + collection);\n                    }\n                    const customViews = collection.views;\n                    const customView = customViews && customViews.find((entry) => entry.path === newPath);\n                    if (customView) {\n                        const path = currentFullPath && currentFullPath.length > 0\n                            ? (currentFullPath + \"/\" + customView.path)\n                            : customView.path;\n                        result.push({\n                            type: \"custom_view\",\n                            path,\n                            view: customView\n                        });\n                    } else if (collection.subcollections) {\n                        result.push(...getNavigationEntriesFromPathInternal({\n                            path: newPath,\n                            customViews,\n                            collections: collection.subcollections,\n                            currentFullPath: fullPath\n                        }));\n                    }\n                }\n            }\n            break;\n        }\n\n    }\n    return result;\n}\n","export const CONTAINER_FULL_WIDTH = \"100vw\";\n\nexport const ADDITIONAL_TAB_WIDTH = \"55vw\";\n\nexport const FORM_CONTAINER_WIDTH = \"700px\";\n","import React from \"react\";\nimport { DataSource } from \"../../types\";\n\nexport const DataSourceContext = React.createContext<DataSource>({} as DataSource);\n","import { useContext } from \"react\";\nimport { DataSource } from \"../../types\";\nimport { DataSourceContext } from \"../../core/contexts/DataSourceContext\";\n\n/**\n * Use this hook to get the datasource being used\n * @category Hooks and utilities\n */\nexport const useDataSource = (): DataSource => useContext(DataSourceContext);\n","import React from \"react\";\nimport { NavigationContext } from \"../../types\";\n\nexport const NavigationContextInstance = React.createContext<NavigationContext>({} as NavigationContext);\n","import { NavigationContext } from \"../types\";\nimport { useContext } from \"react\";\nimport { NavigationContextInstance } from \"../core/contexts/NavigationContext\";\n\n/**\n * Use this hook to get the navigation of the app.\n * This controller provides the resolved collections for the CMS as well\n * as utility methods.\n *\n * @category Hooks and utilities\n */\nexport const useNavigationContext = (): NavigationContext => useContext(NavigationContextInstance);\n","import React from \"react\";\nimport { AuthController } from \"../../types\";\n\nexport const AuthControllerContext = React.createContext<AuthController>({} as AuthController);\n","import { AuthController, User } from \"../types\";\nimport { useContext } from \"react\";\nimport { AuthControllerContext } from \"../core/contexts/AuthControllerContext\";\n\n/**\n * Hook to retrieve the AuthContext.\n *\n * Consider that in order to use this hook you need to have a parent\n * `FireCMS`\n *\n * @see AuthController\n * @category Hooks and utilities\n */\nexport const useAuthController = <UserType extends User = User, AuthControllerType extends AuthController<UserType> = AuthController<UserType>>(): AuthControllerType => useContext(AuthControllerContext) as AuthControllerType;\n","import React from \"react\";\nimport { SideDialogsController } from \"../../types\";\n\nexport const SideDialogsControllerContext = React.createContext<SideDialogsController>({} as SideDialogsController);\n","import { SideDialogsController } from \"../types\";\nimport {\n    SideDialogsControllerContext\n} from \"../core/contexts/SideDialogsControllerContext\";\nimport { useContext } from \"react\";\n\n/**\n * Hook to retrieve the side dialogs' controller.\n *\n * This hook allows you to open and close side dialogs. This is the mechanism\n * used when open a side entity dialog, or when selecting a reference.\n *\n * If you want to open a side entity dialog, you can use the {@link useSideEntityController}\n * hook.\n *\n * If you want to select a reference, you can use the {@link useReferenceDialog}\n *\n * Consider that in order to use this hook you need to have a parent\n * `FireCMS`\n *\n * @category Hooks and utilities\n */\nexport const useSideDialogsController = (): SideDialogsController => useContext(SideDialogsControllerContext);\n","import React from \"react\";\nimport { SideEntityController } from \"../../types\";\n\nexport const SideEntityControllerContext = React.createContext<SideEntityController>({} as SideEntityController);\n","import { SideEntityController } from \"../types\";\nimport { useContext } from \"react\";\nimport {\n    SideEntityControllerContext\n} from \"../core/contexts/SideEntityControllerContext\";\n\n/**\n * Use this hook to retrieve an entity controller that allows you to open\n * a side dialog to edit an entity.\n *\n * Consider that in order to use this hook you need to have a parent\n * `FireCMS`\n *\n * @see SideEntityController\n * @category Hooks and utilities\n */\nexport const useSideEntityController = (): SideEntityController => useContext(SideEntityControllerContext);\n","import React from \"react\";\nimport { StorageSource } from \"../../types\";\n\nexport const StorageSourceContext = React.createContext<StorageSource>({} as StorageSource);\n","import { StorageSource } from \"../types\";\nimport { StorageSourceContext } from \"../core/contexts/StorageSourceContext\";\nimport { useContext } from \"react\";\n\n/**\n * Use this hook to get the storage source being used\n * @category Hooks and utilities\n */\nexport const useStorageSource = (): StorageSource => useContext(StorageSourceContext);\n","import { useSnackbar } from \"notistack\";\nimport { useCallback } from \"react\";\n\n/**\n * Possible snackbar types\n * @category Hooks and utilities\n */\nexport type SnackbarMessageType = \"success\" | \"info\" | \"warning\" | \"error\";\n\n/**\n * Controller to display snackbars\n * @category Hooks and utilities\n */\nexport interface SnackbarController {\n\n    /**\n     * Close the currently open snackbar\n     */\n    close: () => void;\n\n    /**\n     * Display a new snackbar. You need to specify the type and message.\n     * You can optionally specify a title\n     */\n    open: (props: {\n        type: SnackbarMessageType;\n        message: React.ReactNode;\n        autoHideDuration?: number;\n    }) => void;\n\n}\n\n/**\n * Hook to retrieve the SnackbarContext.\n *\n * Consider that in order to use this hook you need to have a parent\n * `FireCMS`\n *\n * @see SnackbarController\n * @category Hooks and utilities\n */\nexport const useSnackbarController = () => {\n\n    const {\n        enqueueSnackbar,\n        closeSnackbar\n    } = useSnackbar();\n\n    const open = useCallback((props: {\n        type: SnackbarMessageType;\n        // title?: string;\n        message: React.ReactNode;\n        autoHideDuration?: number;\n    }) => {\n        const {\n            type,\n            message,\n            autoHideDuration\n        } = props;\n        enqueueSnackbar({\n            message,\n            variant: type,\n            autoHideDuration\n        })\n    }, []);\n\n    return {\n        open,\n        close: closeSnackbar\n    }\n\n};\n","import React from \"react\";\nimport { UserConfigurationPersistence } from \"../../types\";\n\nexport const UserConfigurationPersistenceContext = React.createContext<UserConfigurationPersistence | undefined>(undefined);\n","import { UserConfigurationPersistence } from \"../types\";\nimport React, { useContext } from \"react\";\nimport {\n    UserConfigurationPersistenceContext\n} from \"../core/contexts/UserConfigurationPersistenceContext\";\n\n/**\n * Use this controller to access the configuration that is stored externally,\n * and not defined in code\n *\n * @category Hooks and utilities\n */\nexport const useUserConfigurationPersistence = (): UserConfigurationPersistence | undefined => useContext(UserConfigurationPersistenceContext);\n","import { createContext, useContext } from \"react\";\nimport { AuthController, FireCMSContext, User } from \"../types\";\nimport { useAuthController } from \"./useAuthController\";\nimport { useSideDialogsController } from \"./useSideDialogsController\";\nimport { useNavigationContext } from \"./useNavigationContext\";\nimport { useSideEntityController } from \"./useSideEntityController\";\nimport { useDataSource } from \"./data/useDataSource\";\nimport { useStorageSource } from \"./useStorageSource\";\nimport { useSnackbarController } from \"./useSnackbarController\";\nimport {\n    useUserConfigurationPersistence\n} from \"./useUserConfigurationPersistence\";\n\nexport const FireCMSContextInstance = createContext<Partial<FireCMSContext>>({\n    sideDialogsController: {} as any,\n    sideEntityController: {} as any,\n    navigation: {} as any,\n    dataSource: {} as any,\n    storageSource: {} as any,\n    authController: {} as any,\n    snackbarController: {} as any,\n    fields: {}\n});\n\n/**\n * Hook to retrieve the {@link FireCMSContext}.\n *\n * Consider that in order to use this hook you need to have a parent\n * `FireCMS` component.\n *\n * @see FireCMSContext\n * @category Hooks and utilities\n */\nexport const useFireCMSContext = <UserType extends User = User, AuthControllerType extends AuthController<UserType> = AuthController<UserType>>(): FireCMSContext<UserType, AuthControllerType> => {\n\n    const partialContext = useContext(FireCMSContextInstance) as FireCMSContext<UserType, AuthControllerType>;\n    const authController = useAuthController<UserType, AuthControllerType>();\n    const sideDialogsController = useSideDialogsController();\n    const sideEntityController = useSideEntityController();\n    const navigation = useNavigationContext();\n    const dataSource = useDataSource();\n    const storageSource = useStorageSource();\n    const snackbarController = useSnackbarController();\n    const userConfigPersistence = useUserConfigurationPersistence();\n\n    return {\n        ...partialContext,\n        authController,\n        sideDialogsController,\n        sideEntityController,\n        navigation,\n        dataSource,\n        storageSource,\n        snackbarController,\n        userConfigPersistence\n    }\n\n};\n","import { useEffect, useState } from \"react\";\nimport {\n    Entity,\n    EntityCollection,\n    FilterValues,\n    FireCMSContext,\n    User\n} from \"../../types\";\nimport { useDataSource } from \"./useDataSource\";\nimport { useNavigationContext } from \"../useNavigationContext\";\nimport { useFireCMSContext } from \"../useFireCMSContext\";\n\n/**\n * @category Hooks and utilities\n */\nexport interface CollectionFetchProps<M extends Record<string, any>> {\n\n    /**\n     * Absolute collection path\n     */\n    path: string;\n\n    /**\n     * collection of the entity displayed by this collection\n     */\n    collection: EntityCollection<M>\n\n    /**\n     * Number of entities to fetch\n     */\n    itemCount?: number;\n\n    /**\n     * Filter the fetched data by the property\n     */\n    filterValues?: FilterValues<Extract<keyof M, string>>;\n\n    /**\n     * Sort the results by\n     */\n    sortBy?: [Extract<keyof M, string>, \"asc\" | \"desc\"];\n\n    /**\n     * Search string\n     */\n    searchString?: string;\n}\n\n/**\n * @category Hooks and utilities\n */\nexport interface CollectionFetchResult<M extends Record<string, any>> {\n    data: Entity<M>[];\n    dataLoading: boolean;\n    noMoreToLoad: boolean;\n    dataLoadingError?: Error;\n}\n\n/**\n * This hook is used to fetch collections using a given collection\n * @param path\n * @param collection\n * @param filterValues\n * @param sortBy\n * @param itemCount\n * @param searchString\n * @category Hooks and utilities\n */\nexport function useCollectionFetch<M extends Record<string, any>, UserType extends User>(\n    {\n        path: inputPath,\n        collection,\n        filterValues,\n        sortBy,\n        itemCount,\n        searchString\n    }: CollectionFetchProps<M>): CollectionFetchResult<M> {\n\n    const dataSource = useDataSource();\n    const navigationContext = useNavigationContext();\n\n    const path = navigationContext.resolveAliasesFrom(inputPath);\n\n    const sortByProperty = sortBy ? sortBy[0] : undefined;\n    const currentSort = sortBy ? sortBy[1] : undefined;\n\n    const context: FireCMSContext<UserType> = useFireCMSContext();\n\n    const [data, setData] = useState<Entity<M>[]>([]);\n\n    const [dataLoading, setDataLoading] = useState<boolean>(false);\n    const [dataLoadingError, setDataLoadingError] = useState<Error | undefined>();\n    const [noMoreToLoad, setNoMoreToLoad] = useState<boolean>(false);\n\n    useEffect(() => {\n\n        setDataLoading(true);\n\n        const onEntitiesUpdate = async (entities: Entity<M>[]) => {\n            if (collection.callbacks?.onFetch) {\n                try {\n                    entities = await Promise.all(\n                        entities.map((entity) =>\n                            collection.callbacks!.onFetch!({\n                                collection,\n                                path,\n                                entity,\n                                context\n                            })));\n                } catch (e: any) {\n                    console.error(e);\n                }\n            }\n            setDataLoading(false);\n            setDataLoadingError(undefined);\n            setData(entities);\n            setNoMoreToLoad(!itemCount || entities.length < itemCount);\n        };\n\n        const onError = (error: Error) => {\n            console.error(\"ERROR\", error);\n            setDataLoading(false);\n            setData([]);\n            setDataLoadingError(error);\n        };\n\n        if (dataSource.listenCollection) {\n            return dataSource.listenCollection<M>({\n                path,\n                collection,\n                onUpdate: onEntitiesUpdate,\n                onError,\n                searchString,\n                filter: filterValues,\n                limit: itemCount,\n                startAfter: undefined,\n                orderBy: sortByProperty,\n                order: currentSort\n            });\n        } else {\n            dataSource.fetchCollection<M>({\n                path,\n                collection,\n                searchString,\n                filter: filterValues,\n                limit: itemCount,\n                startAfter: undefined,\n                orderBy: sortByProperty,\n                order: currentSort\n            })\n                .then(onEntitiesUpdate)\n                .catch(onError);\n            return () => {\n            };\n        }\n    }, [path, itemCount, currentSort, sortByProperty, filterValues, searchString]);\n\n    return {\n        data,\n        dataLoading,\n        dataLoadingError,\n        noMoreToLoad\n    };\n\n}\n","import { useEffect, useState } from \"react\";\nimport { Entity, EntityCollection, FireCMSContext, User } from \"../../types\";\nimport { useDataSource } from \"./useDataSource\";\nimport { useNavigationContext } from \"../useNavigationContext\";\nimport { useFireCMSContext } from \"../useFireCMSContext\";\n\n/**\n * @category Hooks and utilities\n */\nexport interface EntityFetchProps<M extends Record<string, any>> {\n    path: string;\n    entityId?: string;\n    collection: EntityCollection<M>;\n    useCache?: boolean;\n}\n\n/**\n * @category Hooks and utilities\n */\nexport interface EntityFetchResult<M extends Record<string, any>> {\n    entity?: Entity<M>,\n    dataLoading: boolean,\n    dataLoadingError?: Error\n}\n\nconst CACHE:Record<string, Entity<any>| undefined> = {};\n\n/**\n * This hook is used to fetch an entity.\n * It gives real time updates if the datasource supports it.\n * @param path\n * @param collection\n * @param entityId\n * @param useCache\n * @category Hooks and utilities\n */\n\nexport function useEntityFetch<M extends Record<string, any>, UserType extends User>(\n    {\n        path: inputPath,\n        entityId,\n        collection,\n        useCache = false\n    }: EntityFetchProps<M>): EntityFetchResult<M> {\n\n    const dataSource = useDataSource();\n    const navigationContext = useNavigationContext();\n\n    const path = navigationContext.resolveAliasesFrom(inputPath);\n\n    const context: FireCMSContext<UserType> = useFireCMSContext();\n\n    const [entity, setEntity] = useState<Entity<M> | undefined>();\n    const [dataLoading, setDataLoading] = useState<boolean>(true);\n    const [dataLoadingError, setDataLoadingError] = useState<Error | undefined>();\n\n    useEffect(() => {\n\n        setDataLoading(true);\n\n        const onEntityUpdate = async (updatedEntity: Entity<M> | undefined) => {\n            if (collection.callbacks?.onFetch && updatedEntity) {\n                try {\n                    updatedEntity = await collection.callbacks.onFetch({\n                        collection,\n                        path,\n                        entity: updatedEntity,\n                        context\n                    });\n                } catch (e: any) {\n                    console.error(e);\n                }\n            }\n            CACHE[`${path}/${entityId}`] = updatedEntity;\n            setEntity(updatedEntity);\n            setDataLoading(false);\n            setDataLoadingError(undefined);\n        };\n\n        const onError = (error: Error) => {\n            console.error(\"ERROR fetching entity\", error);\n            setDataLoading(false);\n            setEntity(undefined);\n            setDataLoadingError(error);\n        };\n\n        if (entityId && useCache && CACHE[`${path}/${entityId}`]) {\n            setEntity(CACHE[`${path}/${entityId}`]);\n            setDataLoading(false);\n            setDataLoadingError(undefined);\n            // eslint-disable-next-line @typescript-eslint/no-empty-function\n            return () => {\n            };\n        } else if (entityId && path && collection) {\n            if (dataSource.listenEntity) {\n                return dataSource.listenEntity<M>({\n                    path,\n                    entityId,\n                    collection,\n                    onUpdate: onEntityUpdate,\n                    onError\n                });\n            } else {\n                dataSource.fetchEntity<M>({\n                    path,\n                    entityId,\n                    collection\n                })\n                    .then(onEntityUpdate)\n                    .catch(onError);\n                return () => {\n                };\n            }\n        }\n        // if no entityId is provided we do nothing\n        else {\n            onEntityUpdate(undefined);\n            return () => {\n            };\n        }\n    }, [entityId, path]);\n\n    return {\n        entity,\n        dataLoading,\n        dataLoadingError\n    };\n\n}\n","import {\n    DataSource,\n    Entity,\n    EntityCallbacks,\n    EntityValues,\n    FireCMSContext,\n    SaveEntityProps,\n    User\n} from \"../../types\";\nimport { useDataSource } from \"./useDataSource\";\nimport { resolveCollection } from \"../../core\";\n\n/**\n * @category Hooks and utilities\n */\nexport type SaveEntityWithCallbacksProps<M extends Record<string, any>> =\n    SaveEntityProps<M> &\n    {\n        callbacks?: EntityCallbacks<M>;\n        onSaveSuccess?: (updatedEntity: Entity<M>) => void,\n        onSaveFailure?: (e: Error) => void,\n        onPreSaveHookError?: (e: Error) => void,\n        onSaveSuccessHookError?: (e: Error) => void\n    }\n\n/**\n * This function is in charge of saving an entity to the datasource.\n * It will run all the save callbacks specified in the collection.\n * It is also possible to attach callbacks on save success or error, and callback\n * errors.\n *\n * If you just want to save the data without running the `onSaveSuccess`,\n * `onSaveFailure` and `onPreSave` callbacks, you can use the `saveEntity` method\n * in the datasource ({@link useDataSource}).\n *\n * @param collection\n * @param path\n * @param entityId\n * @param callbacks\n * @param values\n * @param previousValues\n * @param status\n * @param dataSource\n * @param context\n * @param onSaveSuccess\n * @param onSaveFailure\n * @param onPreSaveHookError\n * @param onSaveSuccessHookError\n * @see useDataSource\n * @category Hooks and utilities\n */\nexport async function saveEntityWithCallbacks<M extends Record<string, any>, UserType extends User>({\n                                                               collection,\n                                                               path,\n                                                               entityId,\n                                                               values,\n                                                               previousValues,\n                                                               status,\n                                                               dataSource,\n                                                               context,\n                                                               onSaveSuccess,\n                                                               onSaveFailure,\n                                                               onPreSaveHookError,\n                                                               onSaveSuccessHookError\n                                                           }: SaveEntityWithCallbacksProps<M> & {\n                                                               dataSource: DataSource,\n                                                               context: FireCMSContext<UserType>,\n                                                           }\n): Promise<void> {\n\n    let updatedValues: Partial<EntityValues<M>>;\n\n    const resolvedPath = context.navigation.resolveAliasesFrom(path);\n\n    const callbacks = collection.callbacks;\n    if (callbacks?.onPreSave) {\n        try {\n            const resolvedCollection = resolveCollection<M>({\n                collection,\n                path,\n                values: previousValues as EntityValues<M>,\n                entityId,\n                fields: context.fields\n            });\n            updatedValues = await callbacks.onPreSave({\n                collection: resolvedCollection,\n                path,\n                resolvedPath,\n                entityId,\n                values,\n                previousValues,\n                status,\n                context\n            });\n        } catch (e: any) {\n            console.error(e);\n            if (onPreSaveHookError)\n                onPreSaveHookError(e);\n            return;\n        }\n    } else {\n        updatedValues = values;\n    }\n\n    return dataSource.saveEntity({\n        collection,\n        path: resolvedPath,\n        entityId,\n        values: updatedValues,\n        previousValues,\n        status\n    }).then((entity) => {\n        try {\n            if (callbacks?.onSaveSuccess) {\n                const resolvedCollection = resolveCollection<M>({\n                    collection,\n                    path,\n                    values: updatedValues as EntityValues<M>,\n                    entityId,\n                    fields: context.fields\n                });\n                callbacks.onSaveSuccess({\n                    collection: resolvedCollection,\n                    path,\n                    resolvedPath,\n                    entityId: entity.id,\n                    values: updatedValues,\n                    previousValues,\n                    status,\n                    context\n                });\n            }\n        } catch (e: any) {\n            if (onSaveSuccessHookError)\n                onSaveSuccessHookError(e);\n        }\n        if (onSaveSuccess)\n            onSaveSuccess(entity);\n    })\n        .catch((e) => {\n            if (callbacks?.onSaveFailure) {\n\n                const resolvedCollection = resolveCollection<M>({\n                    collection,\n                    path,\n                    values: updatedValues as EntityValues<M>,\n                    entityId,\n                    fields: context.fields\n                });\n                callbacks.onSaveFailure({\n                    collection: resolvedCollection,\n                    path,\n                    resolvedPath,\n                    entityId,\n                    values: updatedValues,\n                    previousValues,\n                    status,\n                    context\n                });\n            }\n            if (onSaveFailure) onSaveFailure(e);\n        });\n}\n","import {\n    DataSource,\n    DeleteEntityProps,\n    Entity,\n    EntityCallbacks,\n    EntityOnDeleteProps,\n    FireCMSContext,\n    ResolvedEntityCollection,\n    User\n} from \"../../types\";\n\n/**\n * @category Hooks and utilities\n */\nexport type DeleteEntityWithCallbacksProps<M extends Record<string, any>> =\n    DeleteEntityProps<M>\n    & {\n    callbacks?: EntityCallbacks<M>;\n    onDeleteSuccess?: (entity: Entity<M>) => void;\n    onDeleteFailure?: (entity: Entity<M>, e: Error) => void;\n    onPreDeleteHookError?: (entity: Entity<M>, e: Error) => void;\n    onDeleteSuccessHookError?: (entity: Entity<M>, e: Error) => void;\n}\n\n/**\n * This function is in charge of deleting an entity in the datasource.\n * It will run all the delete callbacks specified in the collection.\n * It is also possible to attach callbacks on save success or error, and callback\n * errors.\n *\n * If you just want to delete any data without running the `onPreDelete`,\n * and `onDelete` callbacks, you can use the `deleteEntity` method\n * in the datasource ({@link useDataSource}).\n *\n * @param dataSource\n * @param entity\n * @param collection\n * @param callbacks\n * @param onDeleteSuccess\n * @param onDeleteFailure\n * @param onPreDeleteHookError\n * @param onDeleteSuccessHookError\n * @param context\n * @category Hooks and utilities\n */\nexport async function deleteEntityWithCallbacks<M extends Record<string, any>, UserType extends User>({\n                                                                 dataSource,\n                                                                 entity,\n                                                                 collection,\n                                                                 callbacks,\n                                                                 onDeleteSuccess,\n                                                                 onDeleteFailure,\n                                                                 onPreDeleteHookError,\n                                                                 onDeleteSuccessHookError,\n                                                                 context\n                                                             }: DeleteEntityWithCallbacksProps<M> & {\n                                                                 collection: ResolvedEntityCollection<M>,\n                                                                 dataSource: DataSource,\n                                                                 context: FireCMSContext<UserType>\n                                                             }\n): Promise<boolean> {\n\n    console.debug(\"Deleting entity\", entity.path, entity.id);\n\n    const entityDeleteProps: EntityOnDeleteProps<M, UserType> = {\n        entity,\n        collection,\n        entityId: entity.id,\n        path: entity.path,\n        context\n    };\n\n    if (callbacks?.onPreDelete) {\n        try {\n            await callbacks.onPreDelete(entityDeleteProps);\n        } catch (e: any) {\n            console.error(e);\n            if (onPreDeleteHookError)\n                onPreDeleteHookError(entity, e);\n            return false;\n        }\n    }\n    return dataSource.deleteEntity({\n        entity\n    }).then(() => {\n        onDeleteSuccess && onDeleteSuccess(entity);\n        try {\n            if (callbacks?.onDelete) {\n                callbacks.onDelete(entityDeleteProps);\n            }\n            return true;\n        } catch (e: any) {\n            if (onDeleteSuccessHookError)\n                onDeleteSuccessHookError(entity, e);\n            return false;\n        }\n    }).catch((e) => {\n        if (onDeleteFailure) onDeleteFailure(entity, e);\n        return false;\n    });\n}\n","import { useEffect, useRef } from \"react\";\nimport { CMSType, ResolvedProperty } from \"../types\";\n\n/**\n * Hook we use to restore a value after it has been cleared\n * @param property\n * @param value\n * @param setValue\n * @ignore\n */\nexport function useClearRestoreValue<T extends CMSType>({\n                                                            property,\n                                                            value,\n                                                            setValue\n                                                        }:\n                                                            {\n                                                                property: ResolvedProperty<T>,\n                                                                value: T,\n                                                                setValue: (value: T | null, shouldValidate?: boolean) => void\n                                                            }) {\n\n    const clearedValueRef = useRef<T | null>(null);\n    useEffect(() => {\n        const shouldClearValueIfDisabled = typeof property.disabled === \"object\" && Boolean(property.disabled.clearOnDisabled);\n        if (shouldClearValueIfDisabled) {\n            if (value != null) {\n                clearedValueRef.current = value;\n                setValue(null);\n            }\n        } else if (clearedValueRef.current) {\n            setValue(clearedValueRef.current);\n            clearedValueRef.current = null;\n        }\n    }, [property]);\n}\n","import {\n    Entity,\n    EntityCollection,\n    EntityCustomView,\n    FireCMSContext,\n    User\n} from \"../types\";\nimport { useEffect, useState } from \"react\";\nimport {\n    getNavigationEntriesFromPathInternal\n} from \"../core/util/navigation_from_path\";\nimport { useFireCMSContext } from \"./useFireCMSContext\";\n\n/**\n * @see resolveNavigationFrom\n * @category Hooks and utilities\n */\nexport type ResolvedNavigationEntry<M extends Record<string, any>> =\n    | ResolvedNavigationEntity<M>\n    | ResolvedNavigationCollection<M>\n    | ResolvedNavigationEntityCustom<M>;\n\n/**\n * @see resolveNavigationFrom\n * @category Hooks and utilities\n */\nexport interface ResolvedNavigationEntity<M extends Record<string, any>> {\n    type: \"entity\";\n    entity: Entity<M>;\n    entityId: string;\n    path: string;\n    parentCollection: EntityCollection<M>;\n}\n\n/**\n * @see resolveNavigationFrom\n * @category Hooks and utilities\n */\nexport interface ResolvedNavigationCollection<M extends Record<string, any>> {\n    type: \"collection\";\n    path: string;\n    collection: EntityCollection<M>;\n}\n\n/**\n * @see resolveNavigationFrom\n * @category Hooks and utilities\n */\ninterface ResolvedNavigationEntityCustom<M extends Record<string, any>> {\n    type: \"custom_view\";\n    path: string;\n    view: EntityCustomView<M>;\n}\n\n/**\n * Use this function to retrieve an array of navigation entries (resolved\n * collection, entity or entity custom_view) for the given path. You need to pass the app context\n * that you receive in different callbacks, such as the save hooks.\n *\n * It will take into account the `navigation` provided at the `FireCMS` level.\n *\n * @param path\n * @param context\n * @category Hooks and utilities\n */\nexport function resolveNavigationFrom<M extends Record<string, any>, UserType extends User>({\n                                             path,\n                                             context\n                                         }: { path: string, context: FireCMSContext<UserType> }): Promise<ResolvedNavigationEntry<M>[]> {\n\n    const dataSource = context.dataSource;\n    const navigation = context.navigation;\n\n    if (!navigation) {\n        throw Error(\"Calling getNavigationFrom, but main navigation has not yet been initialised\");\n    }\n\n    const navigationEntries = getNavigationEntriesFromPathInternal({\n        path,\n        collections: navigation.collections ?? []\n    });\n\n    const resultPromises: Promise<ResolvedNavigationEntry<any>>[] = navigationEntries\n        .map((entry) => {\n            if (entry.type === \"collection\") {\n                return Promise.resolve(entry);\n            } else if (entry.type === \"entity\") {\n                const collection = navigation.getCollection(entry.path, entry.entityId);\n                if (!collection) {\n                    throw Error(`No collection defined in the navigation for the entity with path ${entry.path}`);\n                }\n                return dataSource.fetchEntity({\n                    path: entry.path,\n                    entityId: entry.entityId,\n                    collection\n                })\n                    .then((entity) => {\n                        if (!entity) return undefined;\n                        return { ...entry, entity };\n                    });\n            } else if (entry.type === \"custom_view\") {\n                return Promise.resolve(entry);\n            } else {\n                throw Error(\"Unmapped element in useEntitiesFromPath\");\n            }\n        })\n        .filter(v => Boolean(v)) as Promise<ResolvedNavigationEntry<any>>[];\n\n    return Promise.all(resultPromises);\n}\n\n/**\n * @category Hooks and utilities\n */\nexport interface NavigationFromProps {\n    path: string;\n}\n\n/**\n * @category Hooks and utilities\n */\nexport interface NavigationFrom<M extends Record<string, any>> {\n    data?: ResolvedNavigationEntry<M>[]\n    dataLoading: boolean,\n    dataLoadingError?: Error\n}\n\n/**\n * Use this hook to retrieve an array of navigation entries (resolved\n * collection or entity) for the given path. You can use this hook\n * in any React component that lives under `FireCMS`\n * @category Hooks and utilities\n */\nexport function useResolvedNavigationFrom<M extends Record<string, any>, UserType extends User>(\n    {\n        path\n    }: NavigationFromProps): NavigationFrom<M> {\n\n    const context: FireCMSContext<UserType> = useFireCMSContext();\n\n    const [data, setData] = useState<ResolvedNavigationEntry<M>[] | undefined>();\n    const [dataLoading, setDataLoading] = useState<boolean>(false);\n    const [dataLoadingError, setDataLoadingError] = useState<Error | undefined>();\n\n    useEffect(() => {\n        const navigation = context.navigation;\n        if (navigation) {\n            setDataLoading(true);\n            setDataLoadingError(undefined);\n            resolveNavigationFrom<M, UserType>({ path, context })\n                .then((res) => {\n                    setData(res);\n                })\n                .catch((e) => setDataLoadingError(e))\n                .finally(() => setDataLoading(false));\n        }\n\n    }, [path, context]);\n\n    if (!context.navigation) {\n        return { dataLoading: true };\n    }\n\n    return { data, dataLoading, dataLoadingError };\n}\n","import { ModeControllerContext } from \"../core/contexts/ModeController\";\nimport { useContext } from \"react\";\n\n/**\n * Use this controller to change color mode\n * @category Hooks and utilities\n */\nexport interface ModeController {\n    mode: \"light\" | \"dark\";\n    setMode: (mode: \"light\" | \"dark\") => void;\n    toggleMode: () => void;\n}\n\n/**\n * Hook to retrieve the current mode (\"light\" | \"dark\"), and `setMode`\n * or `toggle` functions to change it.\n *\n * Consider that in order to use this hook you need to have a parent\n * `FireCMS`\n *\n * @see ModeController\n * @category Hooks and utilities\n */\nexport const useModeController = () => useContext(ModeControllerContext);\n","// FORKED FROM https://github.com/fayeed/use-clipboard\n\nimport {\n    MutableRefObject,\n    useCallback,\n    useEffect,\n    useRef,\n    useState\n} from \"react\";\n\nexport interface UseClipboardProps {\n    /**\n     * It's callback function that is called after the `copy` command\n     * is executed.\n     *\n     * @param text: The selected clipboard text.\n     */\n    onSuccess?: (text: string) => void;\n\n    /**\n     * Triggers when the hook encounters an error.\n     * If passed hook won't throw an error.\n     *\n     * @param error: cause of the error\n     */\n    onError?: (error: string) => void;\n\n    /**\n     * Disables the new clipboard API `navigator.clipboard` even if\n     * it is supported.\n     */\n    disableClipboardAPI?: boolean;\n\n    /**\n     * revert back the isCopied flag to false again if a value is set.\n     */\n    copiedDuration?: number;\n}\n\nexport interface useClipboardReturnType {\n    /**\n     * Use ref to pull the text content from.\n     */\n    ref: MutableRefObject<any>;\n\n    /**\n     * Use it to perform the copy operation\n     */\n    copy: (text?: string) => void;\n\n    /**\n     * Use it to perform the cut operation\n     */\n    cut: () => void;\n\n    /**\n     * Indicates wheater the content was successfully copied or not.\n     */\n    isCoppied: boolean;\n\n    /**\n     * Current selected clipboard content.\n     */\n    clipboard: string;\n\n    /**\n     * Clears the user clipboard.\n     */\n    clearClipboard: () => void;\n\n    /**\n     * Check to see if the browser supports the new `navigator.clipboard` API.\n     */\n    isSupported: () => boolean;\n}\n\nexport const useClipboard = (\n    options?: UseClipboardProps\n): useClipboardReturnType => {\n    const { onSuccess, onError, disableClipboardAPI = false, copiedDuration } =\n    options || {};\n    const ref = useRef<any>(null);\n    const [isCoppied, setIsCoppied] = useState(false);\n    const [clipboard, setClipbaord] = useState(\"\");\n\n    useEffect(() => {\n        if (copiedDuration) setTimeout(() => setIsCoppied(false), copiedDuration);\n    }, [isCoppied]);\n\n    const isSupported = () => navigator.clipboard !== undefined;\n\n    const handleError = useCallback((error: string) => {\n        if (onError) onError(error);\n        else throw new Error(error);\n    }, [onError]);\n\n    const handleSuccess = useCallback((text: string) => {\n        if (onSuccess) onSuccess(text);\n        setIsCoppied(true);\n        setClipbaord(text);\n    }, [onSuccess]);\n\n    const copyToClipboard = useCallback((text: string) => {\n        navigator.clipboard\n            .writeText(text)\n            .then(() => handleSuccess(text))\n            .catch((err) => {\n                handleError(err);\n                setIsCoppied(false);\n            });\n    }, [handleError, handleSuccess]);\n\n    const clearClipboard = () => {\n        if (isSupported()) {\n            navigator.clipboard.writeText(\"\");\n        }\n    };\n\n    const copy = (text?: string) =>\n        action(\"copy\", typeof text === \"object\" ? undefined : text);\n\n    const cut = () => action(\"cut\");\n\n    const action = useCallback(\n        (operation = \"copy\", text?: string) => {\n            const element = ref.current as HTMLElement;\n\n            const isInput =\n                element &&\n                (element.tagName === \"INPUT\" || element.tagName === \"TEXTAREA\");\n\n            const input = ref.current as HTMLInputElement;\n\n            if (isSupported() && !disableClipboardAPI) {\n                if (text) {\n                    copyToClipboard(text);\n                } else if (element) {\n                    if (isInput) {\n                        copyToClipboard(input.value);\n\n                        if (operation === \"cut\") {\n                            input.value = \"\";\n                        }\n                    } else {\n                        copyToClipboard(element.innerText);\n                    }\n                } else {\n                    handleError(\"Both the ref & text were undefined\");\n                }\n            }\n        },\n        [disableClipboardAPI, copyToClipboard, handleError]\n    );\n\n    return {\n        ref,\n        isCoppied,\n        clipboard,\n        clearClipboard,\n        isSupported,\n        copy,\n        cut\n    };\n};\n","import { useContext } from \"react\";\nimport { BreadcrumbContext } from \"../core/contexts/BreacrumbsContext\";\n\n/**\n * @category Hooks and utilities\n */\nexport interface BreadcrumbsController {\n    breadcrumbs: BreadcrumbEntry[];\n    set: (props: {\n        breadcrumbs: BreadcrumbEntry[];\n    }) => void;\n}\n\n/**\n * @category Hooks and utilities\n */\nexport interface BreadcrumbEntry {\n    title: string;\n    url: string;\n}\n\n/**\n * Hook to retrieve the BreadcrumbContext.\n *\n * Consider that in order to use this hook you need to have a parent\n * `FireCMS`\n *\n * @see BreadcrumbsController\n * @category Hooks and utilities\n */\nexport const useBreadcrumbsContext = (): BreadcrumbsController => useContext(BreadcrumbContext);\n","import { useSideDialogsController } from \"./useSideDialogsController\";\nimport { ReferenceSelectionInner, ReferenceSelectionInnerProps } from \"../core\";\nimport { useCallback } from \"react\";\nimport { useNavigationContext } from \"./useNavigationContext\";\n\n/**\n * This hook is used to open a side dialog that allows the selection\n * of entities under a given path.\n * You can use it in custom views for selecting entities.\n * You need to specify the path of the target collection at least.\n * If your collection is not defined in your  top collection configuration\n * (in your `FireCMS` component), you need to specify explicitly.\n * This is the same hook used internally when a reference property is defined.\n * @category Hooks and utilities\n */\nexport function useReferenceDialog<M extends Record<string, any>>(referenceDialogProps: Omit<ReferenceSelectionInnerProps<M>, \"path\"> & {\n    path?: string | false;\n    onClose?: () => void;\n}): { open: () => void; close: () => void } {\n\n    const navigation = useNavigationContext();\n    const sideDialogsController = useSideDialogsController();\n\n    const open = useCallback(() => {\n        if (referenceDialogProps.path) {\n            let usedCollection = referenceDialogProps.collection;\n            if (!usedCollection)\n                usedCollection = navigation.getCollection(referenceDialogProps.path);\n            if (!usedCollection)\n                throw Error(\"Not able to resolve the collection in useReferenceDialog\");\n            sideDialogsController.open({\n                key: `reference_${referenceDialogProps.path}`,\n                component:\n                    <ReferenceSelectionInner\n                        collection={usedCollection}\n                        {...referenceDialogProps as ReferenceSelectionInnerProps<M>}/>,\n                width: \"90vw\",\n                onClose: () => {\n                    referenceDialogProps.onClose?.();\n                }\n            });\n        } else {\n            throw Error(\"useReferenceDialog: You are trying to open a reference dialog, but have not declared the `path`\")\n        }\n    }, [navigation, referenceDialogProps, sideDialogsController]);\n\n    const close = useCallback(() => {\n        sideDialogsController.close();\n    }, [sideDialogsController]);\n\n    return {\n        open,\n        close\n    }\n\n}\n","import { useEffect } from \"react\";\n\nconst fireCMSLogo = \"data:image/png;base64,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\\n\";\n\n/**\n * Internal hook to handle the browser title and icon\n * @param name\n * @param logo\n */\nexport function useBrowserTitleAndIcon(name: string, logo?: string) {\n    useEffect(() => {\n        if (document) {\n            document.title = `${name} - FireCMS`;\n            let link = document.querySelector(\"link[rel~='icon']\");\n            if (!link) {\n                link = document.createElement(\"link\");\n                // @ts-ignore\n                link.rel = \"icon\";\n                document.getElementsByTagName(\"head\")[0].appendChild(link);\n            }\n            // @ts-ignore\n            link.href = logo ?? fireCMSLogo;\n        }\n    }, [name, logo]);\n}\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\nimport { Tooltip } from \"@mui/material\";\nimport { tooltipClasses, TooltipProps } from \"@mui/material/Tooltip\";\nimport { StyledComponent } from \"@emotion/styled\";\n\nexport const ErrorTooltip: StyledComponent<any> = styled(({\n                                                              className,\n                                                              ...props\n                                                          }: TooltipProps) => (\n    <Tooltip {...props} classes={{ popper: className }}/>\n))(({ theme }) => ({\n    [`& .${tooltipClasses.tooltip}`]: {\n        margin: \"0 8px\",\n        backgroundColor: theme.palette.error.light\n    },\n    [`& .${tooltipClasses.arrow}`]: {\n        color: theme.palette.error.light\n    }\n}));\n","import React from \"react\";\nimport ErrorIcon from \"@mui/icons-material/Error\";\nimport { Box, Typography } from \"@mui/material\";\nimport { ErrorTooltip } from \"./ErrorTooltip\";\n\n/**\n * @category Components\n */\nexport interface ErrorViewProps {\n    title?: string;\n    error: Error | React.ReactElement | string,\n    tooltip?: string\n}\n\n/**\n * Generic error view. Displayed for example when an unexpected value comes\n * from the datasource in a collection view.\n * @param title\n * @param error\n * @param tooltip\n * @constructor\n * @category Components\n */\nexport function ErrorView({\n                              title,\n                              error,\n                              tooltip\n                          }: ErrorViewProps): React.ReactElement {\n    const component = error instanceof Error ? error.message : error;\n\n    const body = (\n        <Box\n            sx={{\n                display: \"flex\",\n                alignItems: \"center\",\n                margin: 1\n            }}>\n            <ErrorIcon fontSize={\"small\"} color={\"error\"}/>\n            <Box sx={{\n                paddingLeft: 2\n            }}>\n                {title && <Typography\n                    variant={\"body2\"}\n                    sx={{\n                        fontWeight: \"500\"\n                    }}>{title}</Typography>}\n                <Typography variant={\"body2\"}>{component}</Typography>\n            </Box>\n        </Box>\n    );\n\n    if (tooltip) {\n        return (\n            <ErrorTooltip title={tooltip}>\n                {body}\n            </ErrorTooltip>\n        );\n    }\n    return body;\n}\n","/**\n * New or existing status\n * @category Models\n */\nexport type EntityStatus = \"new\" | \"existing\" | \"copy\";\n\n/**\n * Representation of an entity fetched from the datasource\n * @category Models\n */\nexport interface Entity<M extends object> {\n\n    /**\n     * ID of the entity\n     */\n    id: string;\n\n    /**\n     * A string representing the path of the referenced document (relative\n     * to the root of the database).\n     */\n    path: string;\n\n    /**\n     * Current values\n     */\n    values: EntityValues<M>;\n}\n\n/**\n * This type represents a record of key value pairs as described in an\n * entity collection.\n * @category Models\n */\nexport type EntityValues<M extends object> = M;\n\n/**\n * Class used to create a reference to an entity in a different path\n */\nexport class EntityReference {\n    /**\n     * ID of the entity\n     */\n    readonly id: string;\n    /**\n     * A string representing the path of the referenced document (relative\n     * to the root of the database).\n     */\n    readonly path: string;\n\n    constructor(id: string, path: string) {\n        this.id = id;\n        this.path = path;\n    }\n\n    get pathWithId() {\n        return `${this.path}/${this.id}`;\n    }\n}\n\nexport class GeoPoint {\n\n    /**\n     * The latitude of this GeoPoint instance.\n     */\n    readonly latitude: number;\n    /**\n     * The longitude of this GeoPoint instance.\n     */\n    readonly longitude: number;\n\n    constructor(latitude: number, longitude: number) {\n        this.latitude = latitude;\n        this.longitude = longitude;\n    }\n}\n","import React from \"react\";\nimport { Box } from \"@mui/material\";\n\n/**\n * @category Preview components\n */\nexport function EmptyValue() {\n\n    return <Box sx={{\n        borderRadius: \"9999px\",\n        backgroundColor: \"rgba(128,128,128,0.1)\",\n        width: \"18px\",\n        height: \"6px\",\n        display: \"inline-block\"\n    }}/>;\n}\n","import { CollectionSize } from \"../types\";\nimport { PreviewSize } from \"./PropertyPreviewProps\";\n\nexport const TINY_THUMBNAIL = 40;\nexport const SMALL_THUMBNAIL = 100;\nexport const REGULAR_THUMBNAIL = 200;\n\nexport function getThumbnailMeasure(size: PreviewSize): number {\n    if (size === \"tiny\")\n        return TINY_THUMBNAIL;\n    else if (size === \"small\")\n        return SMALL_THUMBNAIL;\n    else if (size === \"regular\")\n        return REGULAR_THUMBNAIL;\n    else throw Error(\"Thumbnail size not mapped\");\n}\n\nexport function getPreviewSizeFrom(size: CollectionSize): PreviewSize {\n    switch (size) {\n        case \"xs\":\n        case \"s\":\n            return \"tiny\";\n        case \"m\":\n            return \"small\";\n        case \"l\":\n        case \"xl\":\n            return \"regular\";\n        default:\n            throw Error(\"Missing mapping value in getPreviewSizeFrom\");\n    }\n}\n","import React, { CSSProperties, useMemo, useState } from \"react\";\nimport { Box, IconButton, Tooltip, useTheme } from \"@mui/material\";\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\nimport ContentCopyIcon from \"@mui/icons-material/ContentCopy\";\n\nimport { getThumbnailMeasure } from \"../util\";\nimport { PreviewSize } from \"../PropertyPreviewProps\";\n\n/**\n * @category Preview components\n */\nexport interface ImagePreviewProps {\n    size: PreviewSize,\n    url: string\n}\n\n/**\n * @category Preview components\n */\nexport function ImagePreview({\n                                 size,\n                                 url\n                             }: ImagePreviewProps) {\n\n    const [onHover, setOnHover] = useState(false);\n\n    const imageSize = useMemo(() => getThumbnailMeasure(size), [size]);\n\n    const theme = useTheme();\n\n    if (size === \"tiny\") {\n        return (\n            <img src={url}\n                 key={\"tiny_image_preview_\" + url}\n                 style={{\n                     position: \"relative\",\n                     objectFit: \"cover\",\n                     width: imageSize,\n                     height: imageSize,\n                     borderRadius: theme.shape.borderRadius,\n                     maxHeight: \"100%\"\n                 }}/>\n        );\n    }\n\n    const imageStyle: CSSProperties =\n        {\n            maxWidth: \"100%\",\n            maxHeight: \"100%\",\n            borderRadius: theme.shape.borderRadius\n        };\n\n    return (\n        <Box\n            sx={{\n                position: \"relative\",\n                maxWidth: \"100%\",\n                maxHeight: \"100%\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                width: imageSize,\n                height: imageSize\n            }}\n            key={\"image_preview_\" + url}\n            onMouseEnter={() => setOnHover(true)}\n            onMouseMove={() => setOnHover(true)}\n            onMouseLeave={() => setOnHover(false)}>\n\n            <img src={url}\n                 style={imageStyle}/>\n\n            {onHover && <>\n\n                {navigator && <Tooltip title=\"Copy url to clipboard\">\n                    <Box sx={{\n                        borderRadius: \"9999px\",\n                        position: \"absolute\",\n                        bottom: -4,\n                        right: 32,\n                        backgroundColor: theme.palette.background.default\n                    }}>\n                        <IconButton\n                            size={\"small\"}\n                            onClick={(e) => {\n                                e.stopPropagation();\n                                return navigator.clipboard.writeText(url);\n                            }}>\n                            <ContentCopyIcon htmlColor={\"#666\"}\n                                             fontSize={\"small\"}/>\n                        </IconButton>\n                    </Box>\n                </Tooltip>}\n\n                <Tooltip title=\"Open image in new tab\">\n                    <a\n                        style={{\n                            borderRadius: \"9999px\",\n                            position: \"absolute\",\n                            bottom: -4,\n                            right: -4,\n                            backgroundColor: theme.palette.background.default\n                        }}\n                        href={url}\n                        rel=\"noopener noreferrer\"\n                        target=\"_blank\">\n                        <IconButton\n                            size={\"small\"}\n                            onClick={(e) => e.stopPropagation()}>\n                            <OpenInNewIcon htmlColor={\"#666\"}\n                                           fontSize={\"small\"}/>\n                        </IconButton>\n                    </a>\n                </Tooltip>\n            </>\n            }\n        </Box>\n    );\n}\n","import React from \"react\";\nimport { Box, CardMedia, Link, Tooltip, Typography } from \"@mui/material\";\n\nimport DescriptionOutlinedIcon from \"@mui/icons-material/DescriptionOutlined\";\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\n\nimport { ImagePreview } from \"./ImagePreview\";\nimport { getThumbnailMeasure } from \"../util\";\nimport { PreviewType } from \"../../types\";\nimport { PreviewSize } from \"../PropertyPreviewProps\";\n\n/**\n * @category Preview components\n */\nexport function UrlComponentPreview({\n                                        url,\n                                        previewType,\n                                        size,\n                                        hint\n                                    }: {\n    url: string,\n    previewType?: PreviewType,\n    size: PreviewSize,\n    hint?: string\n}): React.ReactElement {\n\n    if (!previewType) {\n        return (\n            <Link sx={(theme) => ({\n                display: \"flex\",\n                wordBreak: \"break-word\",\n                alignItems: \"center\",\n                fontWeight: theme.typography.fontWeightMedium\n            })}\n                  href={url}\n                  onMouseDown={(e: React.MouseEvent) => {\n                      e.preventDefault();\n                  }}\n                  target=\"_blank\">\n                <OpenInNewIcon style={{ marginRight: 8 }} fontSize={\"small\"}/>\n                {url}\n            </Link>\n        );\n    }\n\n    if (previewType === \"image\") {\n        return <ImagePreview url={url}\n                             size={size}/>;\n    } else if (previewType === \"audio\") {\n        return <audio controls\n                      src={url}>\n            Your browser does not support the\n            <code>audio</code> element.\n        </audio>;\n    } else if (previewType === \"video\") {\n        return <CardMedia\n            sx={{ maxWidth: size === \"small\" ? 300 : 500 }}\n            component=\"video\"\n            controls\n            image={url}\n        />;\n    } else {\n        return (\n            <Box\n                component={\"a\"}\n                href={url}\n                rel=\"noopener noreferrer\"\n                target=\"_blank\"\n                onClick={(e) => e.stopPropagation()}\n                sx={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    width: getThumbnailMeasure(size),\n                    height: getThumbnailMeasure(size)\n                }}>\n                <DescriptionOutlinedIcon sx={{ flexGrow: 1 }}/>\n                {hint &&\n                    <Tooltip title={hint}>\n                        <Typography\n                            sx={{\n                                maxWidth: \"100%\",\n                                whiteSpace: \"nowrap\",\n                                overflow: \"hidden\",\n                                textOverflow: \"ellipsis\",\n                                direction: \"rtl\",\n                                textAlign: \"left\"\n                            }}\n                            variant={\"caption\"}>{hint}</Typography>\n                    </Tooltip>}\n            </Box>\n        );\n    }\n}\n","import {\n    ResolvedArrayProperty,\n    ResolvedMapProperty,\n    ResolvedProperties,\n    ResolvedProperty,\n    ResolvedStringProperty\n} from \"../../types\";\nimport React from \"react\";\nimport {\n    Box,\n    Grid,\n    Skeleton,\n    Table,\n    TableBody,\n    TableCell,\n    TableRow,\n    Typography\n} from \"@mui/material\";\nimport { getThumbnailMeasure } from \"../util\";\nimport { PreviewSize } from \"../PropertyPreviewProps\";\n\nexport interface SkeletonPropertyComponentProps {\n    property: ResolvedProperty,\n    size: PreviewSize\n}\n\n/**\n * @category Preview components\n */\nexport function SkeletonPropertyComponent({\n                                              property,\n                                              size\n                                          }: SkeletonPropertyComponentProps\n) {\n\n    if (!property) {\n        console.error(\"No property assigned for skeleton component\", property, size);\n    }\n\n    let content: React.ReactNode | any;\n    if (property.dataType === \"string\") {\n        const stringProperty = property as ResolvedStringProperty;\n        if (stringProperty.url) {\n            content = renderUrlComponent(stringProperty, size);\n        } else if (stringProperty.storage) {\n            content = renderSkeletonImageThumbnail(size);\n        } else {\n            content = renderSkeletonText();\n        }\n    } else if (property.dataType === \"array\") {\n        const arrayProperty = property as ResolvedArrayProperty;\n\n        if (arrayProperty.of) {\n            if (Array.isArray(arrayProperty.of)) {\n                content = <>{arrayProperty.of.map((p, i) => renderGenericArrayCell(p, i))} </>;\n            } else {\n                if (arrayProperty.of.dataType === \"map\" && arrayProperty.of.properties) {\n                    content = renderArrayOfMaps(arrayProperty.of.properties, size, arrayProperty.of.previewProperties);\n                } else if (arrayProperty.of.dataType === \"string\") {\n                    if (arrayProperty.of.enumValues) {\n                        content = renderArrayEnumTableCell();\n                    } else if (arrayProperty.of.storage) {\n                        content = renderGenericArrayCell(arrayProperty.of);\n                    } else {\n                        content = renderArrayOfStrings();\n                    }\n                } else {\n                    content = renderGenericArrayCell(arrayProperty.of);\n                }\n            }\n        }\n\n    } else if (property.dataType === \"map\") {\n        content = renderMap(property as ResolvedMapProperty, size);\n    } else if (property.dataType === \"date\") {\n        content = renderSkeletonText();\n    } else if (property.dataType === \"reference\") {\n        content = renderReference();\n    } else if (property.dataType === \"boolean\") {\n        content = renderSkeletonText();\n    } else {\n        content = renderSkeletonText();\n    }\n    return (content || null);\n}\n\nfunction renderMap<T extends Record<string, any>>(property: ResolvedMapProperty<T>, size: PreviewSize) {\n\n    if (!property.properties)\n        return <></>;\n\n    let mapPropertyKeys: string[];\n    if (size === \"regular\") {\n        mapPropertyKeys = Object.keys(property.properties);\n    } else {\n        mapPropertyKeys = (property.previewProperties || Object.keys(property.properties)) as string[];\n        if (size === \"small\")\n            mapPropertyKeys = mapPropertyKeys.slice(0, 3);\n        else if (size === \"tiny\")\n            mapPropertyKeys = mapPropertyKeys.slice(0, 1);\n    }\n\n    if (size !== \"regular\")\n        return (\n            <Box sx={theme => ({\n                width: \"100%\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                \"& > *\": {\n                    [theme.breakpoints.down(\"md\")]: {\n                        marginBottom: `${theme.spacing(0.5)} !important`\n                    },\n                    marginBottom: `${theme.spacing(1)} !important`\n                }\n            })}>\n                {mapPropertyKeys.map((key, index) => (\n                    <div key={`map_${key}`}>\n                        {property.properties && property.properties[key] && <SkeletonPropertyComponent\n                            property={property.properties[key]}\n                            size={\"small\"}/>}\n                    </div>\n                ))}\n            </Box>\n        );\n\n    return (\n        <Table size=\"small\">\n            <TableBody>\n                {mapPropertyKeys &&\n                    mapPropertyKeys.map((key, index) => {\n                        return (\n                            <TableRow\n                                key={`map_preview_table__${index}`}\n                                sx={{\n                                    \"&:last-child th, &:last-child td\": {\n                                        borderBottom: 0\n                                    }\n                                }}>\n                                <TableCell key={`table-cell-title--${key}`}\n                                           sx={{\n                                               verticalAlign: \"top\"\n                                           }}\n                                           width=\"30%\"\n                                           component=\"th\">\n                                    <Typography variant={\"caption\"}\n                                                color={\"textSecondary\"}>\n                                        {property.properties![key].name}\n                                    </Typography>\n                                </TableCell>\n                                <TableCell key={`table-cell-${key}`}\n                                           width=\"70%\"\n                                           component=\"th\">\n                                    {property.properties && property.properties[key] && <SkeletonPropertyComponent\n                                        property={property.properties[key]}\n                                        size={\"small\"}/>}\n                                </TableCell>\n                            </TableRow>\n                        );\n                    })}\n            </TableBody>\n        </Table>\n    );\n}\n\nfunction renderArrayOfMaps<M extends Record<string, any>>(properties: ResolvedProperties<M>, size: PreviewSize, previewProperties?: string[]) {\n    let tableProperties = previewProperties;\n    if (!tableProperties || !tableProperties.length) {\n        tableProperties = Object.keys(properties) as string[];\n        if (size)\n            tableProperties = tableProperties.slice(0, 3);\n    }\n\n    return (\n        <Table size={\"small\"}>\n            <TableBody>\n                {\n                    [0, 1, 2].map((value, index) => {\n                        return (\n                            <TableRow key={`table_${value}_${index}`}>\n                                {tableProperties && tableProperties.map(\n                                    (key) => (\n                                        <TableCell\n                                            key={`table-cell-${key}`}\n                                            component=\"th\"\n                                        >\n                                            <SkeletonPropertyComponent\n                                                property={(properties)[key]}\n                                                size={\"small\"}/>\n                                        </TableCell>\n                                    )\n                                )}\n                            </TableRow>\n                        );\n                    })}\n            </TableBody>\n        </Table>\n    );\n}\n\nfunction renderArrayOfStrings() {\n    return (\n        <Grid>\n            {\n                [0, 1].map((value, index) => (\n                    renderSkeletonText(index)\n                ))}\n        </Grid>\n    );\n}\n\nfunction renderArrayEnumTableCell() {\n    return (\n        <Grid>\n            {\n                [0, 1].map((value, index) =>\n                    <>\n                        {renderSkeletonText(index)}\n                    </>\n                )}\n        </Grid>\n    );\n}\n\nfunction renderGenericArrayCell(\n    property: ResolvedProperty,\n    index = 0\n) {\n    return (\n        <Grid key={\"array_index\"}>\n\n            {\n                [0, 1].map((value, index) =>\n                    <>\n                        <SkeletonPropertyComponent key={`i_${index}`}\n                                                   property={property}\n                                                   size={\"small\"}/>\n                    </>\n                )}\n        </Grid>\n    );\n}\n\nfunction renderUrlAudioComponent() {\n    return (\n        <Skeleton variant=\"rectangular\"\n                  width={300}\n                  height={100}/>\n    );\n}\n\nexport function renderSkeletonImageThumbnail(size: PreviewSize) {\n    const imageSize = size === \"tiny\" ? 40 : size === \"small\" ? 100 : 200;\n    return (\n        <Skeleton variant=\"rectangular\"\n                  sx={theme => ({\n                      borderRadius: `${theme.shape.borderRadius}px`\n                  })}\n                  width={imageSize}\n                  height={imageSize}/>\n    );\n}\n\nfunction renderUrlVideo(size: PreviewSize) {\n\n    return (\n        <Skeleton variant=\"rectangular\"\n                  width={size !== \"regular\" ? 300 : 500}\n                  height={size !== \"regular\" ? 200 : 250}/>\n    );\n}\n\nfunction renderReference() {\n    return <Skeleton variant=\"rectangular\" width={200} height={100}/>;\n}\n\nfunction renderUrlComponent(property: ResolvedStringProperty, size: PreviewSize = \"regular\") {\n\n    if (typeof property.url === \"boolean\") {\n        return <div style={{\n            display: \"flex\"\n        }}>\n            {renderSkeletonIcon()}\n            {renderSkeletonText()}\n        </div>;\n    }\n\n    return renderUrlFile(size);\n}\n\nfunction renderUrlFile(size: PreviewSize) {\n\n    return (\n        <Box\n            sx={{\n                width: getThumbnailMeasure(size),\n                height: getThumbnailMeasure(size)\n            }}>\n            {renderSkeletonIcon()}\n        </Box>\n    );\n}\n\nexport function renderSkeletonText(index?: number) {\n    return <Skeleton variant=\"text\" key={`skeleton_${index}`}/>;\n}\n\nexport function renderSkeletonCaptionText(index?: number) {\n    return <Skeleton\n        height={20}\n        variant=\"text\"/>;\n}\n\nexport function renderSkeletonIcon() {\n    return <Skeleton variant=\"rectangular\" width={24} height={24}/>;\n}\n","import React, { useEffect } from \"react\";\n\nimport {\n    renderSkeletonImageThumbnail\n} from \"../property_previews/SkeletonPropertyComponent\";\nimport { UrlComponentPreview } from \"./UrlComponentPreview\";\nimport { useStorageSource } from \"../../hooks\";\nimport { DownloadConfig, FileType } from \"../../types\";\nimport { PreviewSize } from \"../PropertyPreviewProps\";\n\ntype StorageThumbnailProps = {\n    storagePathOrDownloadUrl: string;\n    storeUrl: boolean;\n    size: PreviewSize;\n};\n\n/**\n * @category Preview components\n */\nexport const StorageThumbnail = React.memo<StorageThumbnailProps>(StorageThumbnailInternal, areEqual) as React.FunctionComponent<StorageThumbnailProps>;\n\nfunction areEqual(prevProps: StorageThumbnailProps, nextProps: StorageThumbnailProps) {\n    return prevProps.size === nextProps.size &&\n        prevProps.storagePathOrDownloadUrl === nextProps.storagePathOrDownloadUrl &&\n        prevProps.storeUrl === nextProps.storeUrl;\n}\n\nconst URL_CACHE: Record<string, DownloadConfig> = {};\n\nexport function StorageThumbnailInternal({\n                                             storeUrl,\n                                             storagePathOrDownloadUrl,\n                                             size\n                                         }: StorageThumbnailProps) {\n    const storage = useStorageSource();\n\n    const [downloadConfig, setDownloadConfig] = React.useState<DownloadConfig>(URL_CACHE[storagePathOrDownloadUrl]);\n\n    useEffect(() => {\n        if (!storagePathOrDownloadUrl)\n            return;\n        let unmounted = false;\n        storage.getDownloadURL(storagePathOrDownloadUrl)\n            .then(function (downloadConfig) {\n                if (!unmounted) {\n                    setDownloadConfig(downloadConfig);\n                    URL_CACHE[storagePathOrDownloadUrl] = downloadConfig;\n                }\n            });\n        return () => {\n            unmounted = true;\n        };\n    }, [storagePathOrDownloadUrl]);\n\n    if (!storagePathOrDownloadUrl) return null;\n\n    const filetype = downloadConfig?.metadata ? getFiletype(downloadConfig?.metadata.contentType) : undefined;\n    const previewType = filetype?.startsWith(\"image\")\n        ? \"image\"\n        : (filetype?.startsWith(\"video\")\n            ? \"video\"\n            : (filetype?.startsWith(\"audio\") ? \"audio\" : \"file\"));\n\n    return downloadConfig\n        ? <UrlComponentPreview previewType={previewType}\n                               url={downloadConfig.url}\n                               size={size}\n                               hint={storagePathOrDownloadUrl}/>\n        : renderSkeletonImageThumbnail(size);\n}\n\nfunction getFiletype(input: string): FileType {\n    if (input.startsWith(\"image\")) return \"image/*\";\n    else if (input.startsWith(\"video\")) return \"video/*\";\n    else if (input.startsWith(\"audio\")) return \"audio/*\";\n    else if (input.startsWith(\"application\")) return \"application/*\";\n    else if (input.startsWith(\"text\")) return \"text/*\";\n    else if (input.startsWith(\"font\")) return \"font/*\";\n    else return input;\n}\n","import React, { useMemo } from \"react\";\n\n// @ts-ignore\nimport MarkdownIt from \"markdown-it\";\n\nexport interface MarkdownProps {\n    source: string\n}\n\nconst md = new MarkdownIt({ html: true, });\n/**\n * @category Preview components\n */\nexport const Markdown = React.memo<MarkdownProps>(function Markdown({\n                                                                        source\n                                                                    }: MarkdownProps) {\n        const html = useMemo(() => {\n            return md.render(typeof source === \"string\" ? source : \"\");\n        }, [source]);\n\n        return <div\n            dangerouslySetInnerHTML={{ __html: html }}\n        />;\n    }\n    , areEqual) as React.FunctionComponent<MarkdownProps>;\n\nfunction areEqual(prevProps: MarkdownProps, nextProps: MarkdownProps) {\n    return prevProps.source === nextProps.source;\n}\n","export function hashString(str: string): number {\n    let hash = 0; let i; let chr;\n    for (i = 0; i < str.length; i++) {\n        chr = str.charCodeAt(i);\n        hash = ((hash << 5) - hash) + chr;\n        hash |= 0; // Convert to 32bit integer\n    }\n    return Math.abs(hash);\n}\n","import { hashString } from \"./hash\";\nimport { ChipColorKey, ChipColorScheme } from \"../../types\";\n\nexport const CHIP_COLORS: Record<string, ChipColorScheme> = {\n    blueLighter: { color: \"#cfdfff\", text: \"#102046\" },\n    cyanLighter: { color: \"#d0f0fd\", text: \"#04283f\" },\n    tealLighter: { color: \"#c2f5e9\", text: \"#012524\" },\n    greenLighter: { color: \"#d1f7c4\", text: \"#0b1d05\" },\n    yellowLighter: { color: \"#ffeab6\", text: \"#3b2501\" },\n    orangeLighter: { color: \"#fee2d5\", text: \"#6b2613\" },\n    redLighter: { color: \"#ffdce5\", text: \"#4c0c1c\" },\n    pinkLighter: { color: \"#ffdaf6\", text: \"#400832\" },\n    purpleLighter: { color: \"#ede2fe\", text: \"#280b42\" },\n    grayLighter: { color: \"#eee\", text: \"#040404\" },\n\n    blueLight: { color: \"#9cc7ff\", text: \"#102046\" },\n    cyanLight: { color: \"#77d1f3\", text: \"#04283f\" },\n    tealLight: { color: \"#72ddc3\", text: \"#012524\" },\n    greenLight: { color: \"#93e088\", text: \"#0b1d05\" },\n    yellowLight: { color: \"#ffd66e\", text: \"#3b2501\" },\n    orangeLight: { color: \"#ffa981\", text: \"#6b2613\" },\n    redLight: { color: \"#ff9eb7\", text: \"#4c0c1c\" },\n    pinkLight: { color: \"#f99de2\", text: \"#400832\" },\n    purpleLight: { color: \"#cdb0ff\", text: \"#280b42\" },\n    grayLight: { color: \"#ccc\", text: \"#040404\" },\n\n    blueDark: { color: \"#2d7ff9\", text: \"#fff\" },\n    cyanDark: { color: \"#18bfff\", text: \"#fff\" },\n    tealDark: { color: \"#20d9d2\", text: \"#fff\" },\n    greenDark: { color: \"#20c933\", text: \"#fff\" },\n    yellowDark: { color: \"#fcb400\", text: \"#fff\" },\n    orangeDark: { color: \"#ff6f2c\", text: \"#fff\" },\n    redDark: { color: \"#f82b60\", text: \"#fff\" },\n    pinkDark: { color: \"#ff08c2\", text: \"#fff\" },\n    purpleDark: { color: \"#8b46ff\", text: \"#fff\" },\n    grayDark: { color: \"#666\", text: \"#fff\" },\n\n    blueDarker: { color: \"#2750ae\", text: \"#cfdfff\" },\n    cyanDarker: { color: \"#0b76b7\", text: \"#d0f0fd\" },\n    tealDarker: { color: \"#06a09b\", text: \"#c2f5e9\" },\n    greenDarker: { color: \"#338a17\", text: \"#d1f7c4\" },\n    yellowDarker: { color: \"#b87503\", text: \"#ffeab6\" },\n    orangeDarker: { color: \"#d74d26\", text: \"#fee2d5\" },\n    redDarker: { color: \"#ba1e45\", text: \"#ffdce5\" },\n    pinkDarker: { color: \"#b2158b\", text: \"#ffdaf6\" },\n    purpleDarker: { color: \"#6b1cb0\", text: \"#ede2fe\" },\n    grayDarker: { color: \"#444\", text: \"#eee\" }\n};\n\nexport function getColorSchemeForSeed(seed: string): ChipColorScheme {\n    const hash: number = hashString(seed);\n    const colorKeys = Object.keys(CHIP_COLORS);\n    const index = hash % colorKeys.length;\n    return CHIP_COLORS[colorKeys[index]];\n}\n\nexport function getColorSchemeForKey(key: ChipColorKey): ChipColorScheme {\n    return CHIP_COLORS[key];\n}\n","import { ChipColorScheme, EnumValueConfig, EnumValues } from \"../../types\";\nimport { CHIP_COLORS, getColorSchemeForSeed } from \"./chip_utils\";\n\nexport function enumToObjectEntries(enumValues: EnumValues): EnumValueConfig[] {\n    if (Array.isArray(enumValues)) {\n        return enumValues;\n    } else {\n        return Object.entries(enumValues).map(([id, value]) => {\n            if (typeof value === \"string\") {\n                return {\n                    id,\n                    label: value\n                }\n            } else {\n                return {\n                    ...value,\n                    id\n                }\n            }\n        });\n    }\n}\n\nexport function getLabelOrConfigFrom(enumValues: EnumValueConfig[], key?: string | number): EnumValueConfig | undefined {\n    if (!key) return undefined;\n    return enumValues.find((entry) => entry.id === key);\n}\n\nexport function getColorScheme(enumValues: EnumValueConfig[], key: string | number): ChipColorScheme | undefined {\n    const labelOrConfig = getLabelOrConfigFrom(enumValues, key);\n    if (!labelOrConfig?.color)\n        return getColorSchemeForSeed(key.toString());\n    if (typeof labelOrConfig === \"object\" && \"color\" in labelOrConfig) {\n        if (typeof labelOrConfig.color === \"string\")\n            return CHIP_COLORS[labelOrConfig.color];\n        if (typeof labelOrConfig.color === \"object\")\n            return labelOrConfig.color;\n    }\n    return undefined;\n}\n\nexport function isEnumValueDisabled(labelOrConfig?: string | EnumValueConfig) {\n    return typeof labelOrConfig === \"object\" && (labelOrConfig as EnumValueConfig).disabled;\n}\n\nexport function buildEnumLabel(\n    labelOrConfig?: string | EnumValueConfig\n): string | undefined {\n    if (labelOrConfig === undefined)\n        return undefined;\n    if (typeof labelOrConfig === \"object\") {\n        return labelOrConfig.label;\n    } else {\n        return labelOrConfig;\n    }\n}\n","import { Chip, useTheme } from \"@mui/material\";\nimport React from \"react\";\nimport { ChipColorScheme, EnumValues } from \"../../types\";\nimport {\n    buildEnumLabel,\n    enumToObjectEntries,\n    getColorScheme,\n    getLabelOrConfigFrom\n} from \"../../core/util/enums\";\nimport { getColorSchemeForSeed } from \"../../core/util/chip_utils\";\n\nexport interface EnumValuesChipProps {\n    enumValues?: EnumValues;\n    enumKey: any;\n    small: boolean;\n}\n\n/**\n * @category Preview components\n */\nexport function EnumValuesChip({\n                                   enumValues,\n                                   enumKey,\n                                   small\n                               }: EnumValuesChipProps) {\n    if (!enumValues) return null;\n    const enumValuesConfig = enumToObjectEntries(enumValues);\n    const enumValue = enumKey !== undefined ? getLabelOrConfigFrom(enumValuesConfig, enumKey) : undefined;\n    const label = buildEnumLabel(enumValue);\n    const colorScheme = getColorScheme(enumValuesConfig, enumKey);\n    return <ColorChip\n        colorScheme={colorScheme}\n        label={label !== undefined ? label : enumKey}\n        error={!label}\n        outlined={false}\n        small={small}/>;\n}\n\nexport interface ColorChipProps {\n    label: string;\n    small?: boolean;\n    colorScheme?: ChipColorScheme;\n    error?: boolean;\n    outlined?: boolean;\n}\n\n/**\n * @category Preview components\n */\nexport function ColorChip({\n                              label,\n                              colorScheme,\n                              error,\n                              outlined,\n                              small\n                          }: ColorChipProps) {\n\n    const theme = useTheme();\n\n    const usedColorScheme = colorScheme ?? getColorSchemeForSeed(label);\n    return (\n        <Chip\n            sx={{\n                maxWidth: \"100%\",\n                backgroundColor: error || !usedColorScheme ? \"#eee\" : usedColorScheme.color,\n                color: error || !usedColorScheme ? \"red\" : usedColorScheme.text,\n                fontWeight: theme!.typography.fontWeightRegular\n            }}\n            size={small ? \"small\" : \"medium\"}\n            variant={outlined ? \"outlined\" : \"filled\"}\n            label={label}\n        />\n    );\n}\n","import React from \"react\";\n\nimport { ErrorBoundary, resolvePropertyEnum } from \"../../core\";\nimport { ColorChip, EnumValuesChip } from \"../components/ColorChip\";\nimport { getColorSchemeForSeed } from \"../../core/util/chip_utils\";\nimport { PreviewType } from \"../../types\";\nimport { UrlComponentPreview } from \"../components/UrlComponentPreview\";\nimport { PropertyPreviewProps } from \"../PropertyPreviewProps\";\n\n/**\n * @category Preview components\n */\nexport function StringPropertyPreview({\n                                          propertyKey,\n                                          value,\n                                          property,\n                                          size\n                                      }: PropertyPreviewProps<string>): React.ReactElement {\n\n    if (property.enumValues) {\n        const enumKey = value;\n        const resolvedProperty = resolvePropertyEnum(property);\n        return <EnumValuesChip\n            enumKey={enumKey}\n            enumValues={resolvedProperty.enumValues}\n            small={size !== \"regular\"}/>;\n    } else if (property.previewAsTag) {\n        const colorScheme = getColorSchemeForSeed(propertyKey ?? \"\");\n        return (\n            <ErrorBoundary>\n                <ColorChip\n                    colorScheme={colorScheme}\n                    label={value}\n                    small={size !== \"regular\"}\n                />\n            </ErrorBoundary>);\n    } else if (property.url) {\n        return (\n            <UrlComponentPreview size={size}\n                                 url={value}\n                                 previewType={typeof property.url === \"string\" ? property.url as PreviewType : undefined}/>\n        );\n    } else {\n        if (!value) return <></>;\n        const lines = value.split(\"\\n\");\n        return value && value.includes(\"\\n\")\n            ? <div>\n                {lines.map((str, index) =>\n                    <React.Fragment key={`string_preview_${index}`}>\n                        <span>{str}</span>\n                        {index !== lines.length - 1 && <br/>}\n                    </React.Fragment>)}\n            </div>\n            : <>{value}</>;\n    }\n}\n","import React from \"react\";\nimport { ErrorBoundary, resolveArrayProperty } from \"../../core\";\n\nimport { Table, TableBody, TableCell, TableRow } from \"@mui/material\";\nimport { useFireCMSContext } from \"../../hooks\";\nimport { PropertyPreviewProps } from \"../PropertyPreviewProps\";\nimport { PropertyPreview } from \"../PropertyPreview\";\n\n/**\n * @category Preview components\n */\nexport function ArrayOfMapsPreview({\n                                       propertyKey,\n                                       value,\n                                       property: inputProperty,\n                                       size,\n                                       entity\n                                   }: PropertyPreviewProps<Record<string, any>[]>) {\n    const fireCMSContext = useFireCMSContext();\n\n    const property = resolveArrayProperty({\n        propertyKey,\n        property: inputProperty,\n        propertyValue: value,\n        fields: fireCMSContext.fields\n    });\n\n    if (Array.isArray(property?.of)) {\n        throw Error(\"Using array properties instead of single one in `of` in ArrayProperty\");\n    }\n\n    if (property?.dataType !== \"array\" || !property.of || property.of.dataType !== \"map\")\n        throw Error(\"Picked wrong preview component ArrayOfMapsPreview\");\n\n    const mapProperty = property.of;\n    const properties = mapProperty.properties;\n    if (!properties) {\n        throw Error(`You need to specify a 'properties' prop (or specify a custom field) in your map property ${propertyKey}`);\n    }\n    const values = value;\n    const previewProperties: string[] | undefined = mapProperty.previewProperties;\n\n    if (!values) return null;\n\n    let mapProperties = previewProperties;\n    if (!mapProperties || !mapProperties.length) {\n        mapProperties = Object.keys(properties);\n        if (size)\n            mapProperties = mapProperties.slice(0, 3);\n    }\n\n    return (\n        <Table size=\"small\">\n            <TableBody>\n                {values &&\n                values.map((v, index) => {\n                    return (\n                        <TableRow key={`table_${v}_${index}`}\n                                  sx={{\n                                      \"&:last-child th, &:last-child td\": {\n                                          borderBottom: 0\n                                      }\n                                  }}>\n                            {mapProperties && mapProperties.map(\n                                (key) => (\n                                    <TableCell\n                                        key={`table-cell-${key as string}`}\n                                        component=\"th\"\n                                    >\n                                        <ErrorBoundary>\n                                            <PropertyPreview\n                                                propertyKey={key as string}\n                                                value={(v)[key]}\n                                                property={properties[key as string]}\n                                                entity={entity}\n                                                size={\"small\"}/>\n                                        </ErrorBoundary>\n                                    </TableCell>\n                                )\n                            )}\n                        </TableRow>\n                    );\n                })}\n            </TableBody>\n        </Table>\n    );\n}\n","import React from \"react\";\n\nimport { Box, Divider } from \"@mui/material\";\n\nimport { ErrorBoundary, resolveArrayProperty } from \"../../core\";\nimport { ResolvedProperty } from \"../../types\";\nimport { useFireCMSContext } from \"../../hooks\";\nimport { PreviewSize, PropertyPreviewProps } from \"../PropertyPreviewProps\";\nimport { PropertyPreview } from \"../PropertyPreview\";\n\n/**\n * @category Preview components\n */\nexport function ArrayPropertyPreview({\n                                         propertyKey,\n                                         value,\n                                         property: inputProperty,\n                                         entity,\n                                         size\n                                     }: PropertyPreviewProps<any[]>) {\n\n    const fireCMSContext = useFireCMSContext();\n    const property = resolveArrayProperty({\n        propertyKey,\n        property: inputProperty,\n        propertyValue: value,\n        fields: fireCMSContext.fields\n    });\n\n    if (!property.of) {\n        throw Error(`You need to specify an 'of' prop (or specify a custom field) in your array property ${propertyKey}`);\n    }\n\n    if (property.dataType !== \"array\")\n        throw Error(\"Picked wrong preview component ArrayPreview\");\n\n    const values = value;\n\n    if (!values) return null;\n\n    const childSize: PreviewSize = size === \"regular\" ? \"small\" : \"tiny\";\n\n    return (\n        <Box sx={{\n            display: \"flex\",\n            flexDirection: \"column\"\n        }}>\n            {values &&\n                values.map((value, index) => {\n                    const of:ResolvedProperty = property.resolvedProperties[index] ??\n                        (property.resolvedProperties[index] ?? (Array.isArray(property.of) ? property.of[index] : property.of));\n                    return of\n                        ? <React.Fragment\n                            key={\"preview_array_\" + value + \"_\" + index}>\n                            <Box sx={{\n                                margin: 1\n                            }}>\n                                <ErrorBoundary>\n                                    <PropertyPreview\n                                        propertyKey={propertyKey}\n                                        entity={entity}\n                                        value={value}\n                                        property={of}\n                                        size={childSize}/>\n                                    </ErrorBoundary>\n                                </Box>\n                                {index < values.length - 1 && <Divider/>}\n                            </React.Fragment>\n                            : null;\n                    }\n                )}\n        </Box>\n    );\n}\n","import { Theme } from \"@mui/material\";\n\nexport const fieldBackground = (theme: Theme) =>\n    theme.palette.mode === \"light\" ? \"rgb(238 238 240)\" : \"rgb(39 39 41)\";\nexport const fieldBackgroundHover = (theme: Theme) =>\n    theme.palette.mode === \"light\" ? \"rgb(232 232 234)\" : \"rgb(49,49,50)\";\nexport const fieldBackgroundDisabled = (theme: Theme) =>\n    theme.palette.mode === \"light\" ? \"rgb(224 224 226)\" : \"rgb(47 47 49)\";\nexport const fieldBackgroundSubtleHover = (theme: Theme) =>\n    theme.palette.mode === \"light\" ? \"rgb(248 248 249)\" : \"rgb(21 21 23)\";\n","import * as React from \"react\";\nimport { useMemo } from \"react\";\n\nimport {\n    Box,\n    darken,\n    IconButton,\n    lighten,\n    Skeleton,\n    Tooltip,\n    Typography\n} from \"@mui/material\";\nimport {\n    Entity,\n    EntityCollection,\n    EntityReference,\n    ResolvedProperty\n} from \"../../types\";\n\nimport KeyboardTabIcon from \"@mui/icons-material/KeyboardTab\";\n\nimport {\n    ErrorView,\n    getReferencePreviewKeys,\n    getValueInPath,\n    resolveCollection\n} from \"../../core\";\nimport {\n    useEntityFetch,\n    useFireCMSContext,\n    useNavigationContext,\n    useSideEntityController\n} from \"../../hooks\";\nimport { PropertyPreview } from \"../PropertyPreview\";\nimport { PreviewSize } from \"../PropertyPreviewProps\";\nimport {\n    SkeletonPropertyComponent\n} from \"../property_previews/SkeletonPropertyComponent\";\nimport {\n    fieldBackground,\n    fieldBackgroundHover\n} from \"../../core/util/field_colors\";\n\nexport type ReferencePreviewProps = {\n    disabled?: boolean;\n    reference: EntityReference,\n    size: PreviewSize;\n    previewProperties?: string[];\n    onClick?: () => void;\n    onHover?: boolean;\n    allowEntityNavigation?: boolean;\n};\n\n/**\n * @category Preview components\n */\nexport const ReferencePreview = React.memo<ReferencePreviewProps>(ReferencePreviewInternal, areEqual) as React.FunctionComponent<ReferencePreviewProps>;\n\nfunction areEqual(prevProps: ReferencePreviewProps, nextProps: ReferencePreviewProps) {\n    return prevProps.disabled === nextProps.disabled &&\n        prevProps.size === nextProps.size &&\n        prevProps.onHover === nextProps.onHover &&\n        prevProps.reference?.id === nextProps.reference?.id &&\n        prevProps.reference?.path === nextProps.reference?.path &&\n        prevProps.allowEntityNavigation === nextProps.allowEntityNavigation\n        ;\n}\n\nfunction ReferencePreviewInternal<M extends Record<string, any>>({\n                                                                     disabled,\n                                                                     reference,\n                                                                     previewProperties,\n                                                                     size,\n                                                                     onHover,\n                                                                     onClick,\n                                                                     allowEntityNavigation = true\n                                                                 }: ReferencePreviewProps) {\n\n    const context = useFireCMSContext();\n\n    const navigationContext = useNavigationContext();\n    const sideEntityController = useSideEntityController();\n\n    const collection = navigationContext.getCollection<EntityCollection<M>>(reference.path);\n    if (!collection) {\n        throw Error(`Couldn't find the corresponding collection view for the path: ${reference.path}`);\n    }\n\n    const {\n        entity,\n        dataLoading,\n        dataLoadingError\n    } = useEntityFetch({\n        path: reference.path,\n        entityId: reference.id,\n        collection,\n        useCache: true\n    });\n\n    if (entity) {\n        referencesCache.set(reference.pathWithId, entity);\n    }\n\n    const usedEntity = entity ?? referencesCache.get(reference.pathWithId);\n\n    const resolvedCollection = useMemo(() => resolveCollection({\n        collection,\n        path: reference.path,\n        values: usedEntity?.values,\n        fields: context.fields\n    }), [collection]);\n\n    const listProperties = useMemo(() => getReferencePreviewKeys(resolvedCollection, context.fields, previewProperties, size === \"small\" || size === \"regular\" ? 3 : 1),\n        [previewProperties, resolvedCollection, size]);\n\n    let body: React.ReactNode;\n\n    if (!resolvedCollection) {\n        return <ErrorView\n            error={\"Could not find collection with id \" + resolvedCollection}/>\n    }\n\n    if (!reference) {\n        body = <ErrorView error={\"Reference not set\"}/>;\n    } else if (!(reference instanceof EntityReference)) {\n        console.error(\"Reference preview received value of type\", typeof reference);\n        body = <ErrorView error={\"Unexpected value\"}\n                          tooltip={JSON.stringify(reference)}/>;\n    } else if (usedEntity && !usedEntity.values) {\n        body = <ErrorView error={\"Reference does not exist\"}\n                          tooltip={reference.path}/>;\n    } else {\n        body = (\n            <>\n                <Box sx={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    flexGrow: 1,\n                    width: \"100%\",\n                    maxWidth: \"calc(100% - 52px)\",\n                    margin: 1\n                }}>\n\n                    {size !== \"tiny\" && (\n                        reference\n                            ? <Box sx={{\n                                display: size !== \"regular\" ? \"block\" : undefined,\n                                whiteSpace: size !== \"regular\" ? \"nowrap\" : undefined,\n                                overflow: size !== \"regular\" ? \"hidden\" : undefined,\n                                textOverflow: size !== \"regular\" ? \"ellipsis\" : undefined\n                            }}>\n                                <Typography variant={\"caption\"}\n                                            className={\"mono\"}>\n                                    {reference.id}\n                                </Typography>\n                            </Box>\n                            : <Skeleton variant=\"text\"/>)}\n\n                    {listProperties && listProperties.map((key) => {\n                        const childProperty = resolvedCollection.properties[key as string];\n                        if (!childProperty) return null;\n\n                        return (\n                            <Box key={\"ref_prev_\" + (key as string)}\n                                 sx={{\n                                     my: listProperties.length > 1 ? 0.5 : 0\n                                 }}>\n                                {usedEntity\n                                    ? <PropertyPreview\n                                        propertyKey={key as string}\n                                        value={getValueInPath(usedEntity.values, key)}\n                                        property={childProperty as ResolvedProperty}\n                                        entity={usedEntity}\n                                        size={\"tiny\"}/>\n                                    // eslint-disable-next-line react/jsx-no-undef\n                                    : <SkeletonPropertyComponent\n                                        property={childProperty as ResolvedProperty}\n                                        size={\"tiny\"}/>\n                                }\n                            </Box>\n                        );\n                    })}\n\n                </Box>\n                <Box sx={{\n                    my: size === \"tiny\" ? 0.5 : 1\n                }}>\n                    {!disabled && usedEntity && allowEntityNavigation &&\n                        <Tooltip title={`See details for ${usedEntity.id}`}>\n                            <IconButton\n                                color={\"inherit\"}\n                                size={\"small\"}\n                                onClick={(e) => {\n                                    e.stopPropagation();\n                                    context.onAnalyticsEvent?.(\"entity_click_from_reference\", {\n                                        path: usedEntity.path,\n                                        entityId: usedEntity.id\n                                    });\n                                    sideEntityController.open({\n                                        entityId: usedEntity.id,\n                                        path: usedEntity.path,\n                                        collection: resolvedCollection,\n                                        updateUrl: true\n                                    });\n                                }}>\n                                <KeyboardTabIcon fontSize={\"small\"}/>\n                            </IconButton>\n                        </Tooltip>}\n                </Box>\n            </>\n        );\n    }\n\n    return (\n        <ReferencePreviewWrap onClick={disabled ? undefined : onClick}\n                              onHover={disabled ? undefined : onHover}\n                              size={size}>\n            {body}\n        </ReferencePreviewWrap>\n    );\n}\n\nfunction ReferencePreviewWrap({\n                                  children,\n                                  onHover,\n                                  size,\n                                  onClick\n                              }: {\n    children: React.ReactNode;\n    onHover?: boolean;\n    size: PreviewSize;\n    onClick?: () => void;\n}) {\n    return <Typography variant={\"label\"}\n                       sx={(theme) => {\n                           const clickableStyles = onClick\n                               ? {\n                                   tabindex: 0,\n                                   backgroundColor: onHover\n                                       ? fieldBackgroundHover(theme)\n                                       : fieldBackground(theme),\n                                   transition: \"background-color 300ms ease, box-shadow 300ms ease\",\n                                   boxShadow: onHover ? \"0 0 0 2px rgba(128,128,128,0.05)\" : undefined,\n                                   cursor: onHover ? \"pointer\" : undefined\n                               }\n                               : {};\n                           return ({\n                               width: \"100%\",\n                               display: \"flex\",\n                               borderRadius: `${theme.shape.borderRadius}px`,\n                               overflow: \"hidden\",\n                               padding: size === \"regular\" ? 1 : 0,\n                               itemsAlign: size === \"tiny\" ? \"center\" : undefined,\n                               ...clickableStyles\n                           });\n                       }}\n                       onClick={(event) => {\n                           if (onClick) {\n                               event.preventDefault();\n                               onClick();\n                           }\n                       }}>\n\n        {children}\n\n    </Typography>\n}\n\nconst referencesCache = new Map<string, Entity<any>>();\n","import { ResolvedReferenceProperty } from \"../../types\";\n\nimport { Box } from \"@mui/material\";\nimport { resolveArrayProperty } from \"../../core\";\nimport { useFireCMSContext } from \"../../hooks\";\nimport { PreviewSize, PropertyPreviewProps } from \"../PropertyPreviewProps\";\nimport { ReferencePreview } from \"../components/ReferencePreview\";\n\n/**\n * @category Preview components\n */\nexport function ArrayOfReferencesPreview({\n                                             propertyKey,\n                                             value,\n                                             property: inputProperty,\n                                             size\n                                         }: PropertyPreviewProps<any[]>) {\n\n    const fireCMSContext = useFireCMSContext();\n    const property = resolveArrayProperty({\n        propertyKey,\n        property: inputProperty,\n        propertyValue: value,\n        fields: fireCMSContext.fields\n    });\n\n    if (Array.isArray(property?.of)) {\n        throw Error(\"Using array properties instead of single one in `of` in ArrayProperty\");\n    }\n\n    if (property?.dataType !== \"array\" || !property.of || property.of.dataType !== \"reference\")\n        throw Error(\"Picked wrong preview component ArrayOfReferencesPreview\");\n\n    const childSize: PreviewSize = size === \"regular\" ? \"small\" : \"tiny\";\n\n    return (\n        <Box sx={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            width: \"100%\"\n        }}>\n            {value &&\n                value.map((reference, index) => {\n                        const ofProperty = property.of as ResolvedReferenceProperty;\n                        return <Box sx={{\n                            marginTop: 0.25,\n                            marginBottom: 0.25,\n                            width: \"100%\"\n                        }}\n                                    key={`preview_array_ref_${propertyKey}_${index}`}>\n                            <ReferencePreview\n                                disabled={!ofProperty.path}\n                                previewProperties={ofProperty.previewProperties}\n                                size={childSize}\n                                reference={reference}\n                            />\n                        </Box>;\n                    }\n                )}\n        </Box>\n    );\n}\n","import React from \"react\";\n\nimport { styled } from \"@mui/material/styles\";\n\nimport { ErrorBoundary, resolveArrayProperty } from \"../../core\";\nimport { ResolvedProperty } from \"../../types\";\n\nimport { Theme } from \"@mui/material\";\nimport { useFireCMSContext } from \"../../hooks\";\nimport { PreviewSize, PropertyPreviewProps } from \"../PropertyPreviewProps\";\nimport { PropertyPreview } from \"../PropertyPreview\";\n\nconst PREFIX = \"ArrayOfStorageComponentsPreview\";\n\nconst classes = {\n    arrayWrap: `${PREFIX}-arrayWrap`,\n    arrayItem: `${PREFIX}-arrayItem`\n};\n\nconst Root = styled(\"div\")((\n   { theme } : {\n        theme: Theme\n    }\n) => ({\n    [`&.${classes.arrayWrap}`]: {\n        display: \"flex\",\n        flexWrap: \"wrap\"\n    },\n\n    [`& .${classes.arrayItem}`]: {\n        margin: theme.spacing(0.5)\n    }\n}));\n\n/**\n * @category Preview components\n */\nexport function ArrayOfStorageComponentsPreview({\n                                                    propertyKey,\n                                                    entity,\n                                                    value,\n                                                    property: inputProperty,\n                                                    size\n                                                }: PropertyPreviewProps<any[]>) {\n\n    const fireCMSContext = useFireCMSContext();\n    const property = resolveArrayProperty({\n        propertyKey,\n        property: inputProperty,\n        propertyValue: value,\n        fields: fireCMSContext.fields\n    });\n\n    if (Array.isArray(property.of)) {\n        throw Error(\"Using array properties instead of single one in `of` in ArrayProperty\");\n    }\n\n    if (property.dataType !== \"array\" || !property.of || property.of.dataType !== \"string\")\n        throw Error(\"Picked wrong preview component ArrayOfStorageComponentsPreview\");\n\n    const childSize: PreviewSize = size === \"regular\" ? \"small\" : \"tiny\";\n\n    return (\n        <Root className={classes.arrayWrap}>\n            {value &&\n            value.map((v, index) =>\n                <div className={classes.arrayItem}\n                     key={`preview_array_storage_${propertyKey}_${index}`}>\n                    <ErrorBoundary>\n                        <PropertyPreview\n                            propertyKey={propertyKey}\n                            value={v}\n                            entity={entity}\n                            property={property.of as ResolvedProperty<string>}\n                            size={childSize}/>\n                    </ErrorBoundary>\n                </div>\n            )}\n        </Root>\n    );\n}\n","import React from \"react\";\n\nimport { EnumValueConfig } from \"../../types\";\nimport { ErrorBoundary } from \"../../core\";\nimport { EnumValuesChip } from \"./ColorChip\";\nimport { Box } from \"@mui/material\";\nimport { PreviewSize } from \"../PropertyPreviewProps\";\n\n/**\n * @category Preview components\n */\nexport function ArrayEnumPreview({\n                                     name,\n                                     value,\n                                     enumValues,\n                                     size\n                                 }: {\n    value: string[] | number[],\n    name: string | undefined,\n    enumValues: EnumValueConfig[],\n    size: PreviewSize\n}) {\n\n    return (\n        <Box sx={theme => ({\n            display: \"flex\",\n            flexWrap: \"wrap\",\n            gap: theme.spacing(0.5)\n        })}>\n            {value && value.map((enumKey, index) => {\n                    return (\n                        <ErrorBoundary\n                            key={`preview_array_ref_${name}_${index}`}>\n                            <EnumValuesChip\n                                enumKey={enumKey}\n                                enumValues={enumValues}\n                                small={size !== \"regular\"}/>\n                        </ErrorBoundary>\n                    );\n                }\n                )}\n        </Box>\n    );\n}\n","import { ResolvedNumberProperty, ResolvedStringProperty } from \"../../types\";\nimport { ArrayEnumPreview } from \"../components/ArrayEnumPreview\";\nimport { PropertyPreviewProps } from \"../PropertyPreviewProps\";\n\n/**\n * @category Preview components\n */\nexport function ArrayPropertyEnumPreview({\n                                             propertyKey,\n                                             value,\n                                             property,\n                                             size\n                                         }: PropertyPreviewProps<string[] | number[]>) {\n\n    if (property.dataType !== \"array\")\n        throw Error(\"Picked wrong preview component ArrayEnumPreview\");\n\n    const ofProperty = property.of as ResolvedStringProperty | ResolvedNumberProperty;\n    if (!ofProperty.enumValues)\n        throw Error(\"Picked wrong preview component ArrayEnumPreview\");\n\n    if (!value) return null;\n\n    return <ArrayEnumPreview name={propertyKey}\n                             value={value}\n                             enumValues={ofProperty.enumValues}\n                             size={size}/>;\n}\n","import React from \"react\";\nimport { ResolvedStringProperty } from \"../../types\";\n\nimport { ErrorBoundary, resolveArrayProperty } from \"../../core\";\nimport { StringPropertyPreview } from \"./StringPropertyPreview\";\nimport { Box, Theme } from \"@mui/material\";\nimport { useFireCMSContext } from \"../../hooks\";\nimport { PropertyPreviewProps } from \"../PropertyPreviewProps\";\n\n/**\n * @category Preview components\n */\nexport function ArrayOfStringsPreview({\n                                          propertyKey,\n                                          value,\n                                          property: inputProperty,\n                                          entity,\n                                          size\n                                      }: PropertyPreviewProps<string[]>) {\n\n    const fireCMSContext = useFireCMSContext();\n    const property = resolveArrayProperty({\n        propertyKey,\n        property: inputProperty,\n        propertyValue: value,\n        fields: fireCMSContext.fields\n    });\n\n    if (Array.isArray(property.of)) {\n        throw Error(\"Using array properties instead of single one in `of` in ArrayProperty\");\n    }\n    if (!property.of || property.dataType !== \"array\" || property.of.dataType !== \"string\")\n        throw Error(\"Picked wrong preview component ArrayOfStringsPreview\");\n\n    if (value && !Array.isArray(value)) {\n        return <div>{`Unexpected value: ${value}`}</div>;\n    }\n    const stringProperty = property.of as ResolvedStringProperty;\n\n    return (\n        <Box sx={{\n            display: \"flex\",\n            gap: \"2px\",\n            flexDirection: \"column\",\n        }}>\n            {value &&\n                value.map((v, index) =>\n                    <div key={`preview_array_strings_${propertyKey}_${index}`}>\n                        <ErrorBoundary>\n                            <StringPropertyPreview propertyKey={propertyKey}\n                                                   property={stringProperty}\n                                                   value={v}\n                                                   entity={entity}\n                                                   size={size}/>\n                        </ErrorBoundary>\n                    </div>\n                )}\n        </Box>\n    );\n}\n","export const DEFAULT_ONE_OF_TYPE = \"type\"\nexport const DEFAULT_ONE_OF_VALUE = \"value\"\n","import React from \"react\";\n\nimport { styled } from \"@mui/material/styles\";\n\nimport { Divider, Theme } from \"@mui/material\";\nimport { ErrorBoundary, resolveArrayProperty } from \"../../core\";\nimport { ResolvedProperty } from \"../../types\";\nimport {\n    DEFAULT_ONE_OF_TYPE,\n    DEFAULT_ONE_OF_VALUE\n} from \"../../core/util/common\";\nimport { useFireCMSContext } from \"../../hooks\";\nimport { PreviewSize, PropertyPreviewProps } from \"../PropertyPreviewProps\";\nimport { PropertyPreview } from \"../PropertyPreview\";\n\nconst PREFIX = \"ArrayOneOfPreview\";\n\nconst classes = {\n    array: `${PREFIX}-array`,\n    arrayWrap: `${PREFIX}-arrayWrap`,\n    arrayItemBig: `${PREFIX}-arrayItemBig`\n};\n\nconst Root = styled(\"div\")((\n   { theme } : {\n        theme: Theme\n    }\n) => ({\n    [`&.${classes.array}`]: {\n        display: \"flex\",\n        flexDirection: \"column\"\n    },\n\n    [`& .${classes.arrayWrap}`]: {\n        display: \"flex\",\n        flexWrap: \"wrap\"\n    },\n\n    [`& .${classes.arrayItemBig}`]: {\n        margin: theme.spacing(1)\n    }\n}));\n\n/**\n * @category Preview components\n */\nexport function ArrayOneOfPreview({\n                                      propertyKey,\n                                      value,\n                                      property: inputProperty,\n                                      size,\n                                      entity\n                                  }: PropertyPreviewProps<any[]>) {\n\n    const fireCMSContext = useFireCMSContext();\n    const property = resolveArrayProperty({\n        propertyKey,\n        property: inputProperty,\n        propertyValue: value,\n        fields: fireCMSContext.fields\n    });\n\n    if (property?.dataType !== \"array\")\n        throw Error(\"Picked wrong preview component ArrayPreview\");\n\n    if (!property?.oneOf) {\n        throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${propertyKey}`);\n    }\n\n    const values = value;\n\n    if (!values) return null;\n\n    const childSize: PreviewSize = size === \"regular\" ? \"small\" : \"tiny\";\n\n    const typeField = property.oneOf.typeField ?? DEFAULT_ONE_OF_TYPE;\n    const valueField = property.oneOf.valueField ?? DEFAULT_ONE_OF_VALUE;\n    const properties = property.oneOf.properties;\n\n    return (\n        <Root className={classes.array}>\n            {values &&\n                values.map((value, index) =>\n                    <React.Fragment\n                        key={\"preview_array_\" + value + \"_\" + index}>\n                        <div className={classes.arrayItemBig}>\n                            <ErrorBoundary>\n                                {value && <PropertyPreview\n                                propertyKey={propertyKey}\n                                value={value[valueField]}\n                                entity={entity}\n                                property={(property.resolvedProperties[index] ?? properties[value[typeField]]) as ResolvedProperty<any>}\n                                size={childSize}/>}\n                        </ErrorBoundary>\n                    </div>\n                    {index < values.length - 1 && <Divider/>}\n                </React.Fragment>\n            )}\n        </Root>\n    );\n}\n","import React from \"react\";\nimport {\n    Box,\n    Table,\n    TableBody,\n    TableCell,\n    TableRow,\n    Typography\n} from \"@mui/material\";\n\nimport { ResolvedMapProperty } from \"../../types\";\nimport { ErrorBoundary } from \"../../core\";\nimport { PropertyPreviewProps } from \"../PropertyPreviewProps\";\nimport { PropertyPreview } from \"../PropertyPreview\";\n\n/**\n * @category Preview components\n */\nexport function MapPropertyPreview<T extends Record<string, any> = Record<string, any>>({\n                                                                                            propertyKey,\n                                                                                            value,\n                                                                                            property,\n                                                                                            entity,\n                                                                                            size\n                                                                                        }: PropertyPreviewProps<T>) {\n\n    if (property.dataType !== \"map\") {\n        throw Error(\"Picked wrong preview component MapPropertyPreview\");\n    }\n\n    const mapProperty = property as ResolvedMapProperty;\n    if (!mapProperty.properties) {\n        return (\n            <KeyValuePreview value={value}/>\n        );\n    }\n\n    if (!value) return null;\n\n    let mapPropertyKeys: string[];\n    if (size === \"regular\") {\n        mapPropertyKeys = Object.keys(mapProperty.properties);\n    } else {\n        mapPropertyKeys = (mapProperty.previewProperties || Object.keys(mapProperty.properties)) as string[];\n        if (size === \"small\")\n            mapPropertyKeys = mapPropertyKeys.slice(0, 3);\n        else if (size === \"tiny\")\n            mapPropertyKeys = mapPropertyKeys.slice(0, 1);\n    }\n\n    if (size !== \"regular\")\n        return (\n            <Box sx={theme => ({\n                width: \"100%\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                \"& > *\": {\n                    [theme.breakpoints.down(\"md\")]: {\n                        marginBottom: `${theme.spacing(0.5)} !important`\n                    },\n                    marginBottom: `${theme.spacing(1)} !important`\n                }\n            })}>\n                {mapPropertyKeys.map((key, index) => (\n                    <div key={`map_${key}`}>\n                        <ErrorBoundary\n                            key={\"map_preview_\" + mapProperty.name + key + index}>\n                            <PropertyPreview propertyKey={key}\n                                             value={(value)[key]}\n                                             property={mapProperty.properties![key]}\n                                             entity={entity}\n                                             size={size}/>\n                        </ErrorBoundary>\n                    </div>\n                ))}\n            </Box>\n        );\n\n    return (\n        <Box\n            sx={{ display: \"flex\", flexDirection: \"column\", width: \"100%\" }}>\n            {mapPropertyKeys &&\n                mapPropertyKeys.map((key, index) => {\n                    return (\n                        <Box\n                            key={`map_preview_table_${key}}`}\n                            sx={theme => ({\n                                display: \"flex\",\n                                flexDirection: \"row\",\n                                pt: 0.5,\n                                \"&:not(:last-child)\": {\n                                    borderBottom: `1px solid ${theme.palette.divider}`,\n                                    pb: 0.5\n                                }\n                            })}>\n                            <Box\n                                key={`table-cell-title-${key}-${key}`}\n                                sx={{\n                                    width: \"25%\",\n                                    verticalAlign: \"top\",\n                                    pr: 1\n                                }}>\n                                <Typography variant={\"caption\"}\n                                            className={\"mono\"}\n                                            color={\"textSecondary\"}>\n                                    {mapProperty.properties![key].name}\n                                </Typography>\n                            </Box>\n                            <Box\n                                sx={{\n                                    flexGrow: 1\n                                }}>\n                                <ErrorBoundary>\n                                    <PropertyPreview\n                                        propertyKey={key}\n                                        value={(value)[key]}\n                                        property={mapProperty.properties![key]}\n                                        entity={entity}\n                                        size={\"small\"}/>\n                                </ErrorBoundary>\n                            </Box>\n                        </Box>\n                    );\n                })}\n        </Box>\n    );\n\n}\n\nexport function KeyValuePreview({ value }: { value: any }) {\n    if (typeof value !== \"object\") return null;\n    return <Box\n        sx={{ display: \"flex\", flexDirection: \"column\", width: \"100%\" }}>\n        {\n            Object.entries(value).map(([key, childValue]) => (\n                <Box\n                    key={`map_preview_table_${key}}`}\n                    sx={theme => ({\n                        display: \"flex\",\n                        flexDirection: \"row\",\n                        pt: 0.5,\n                        \"&:not(:last-child)\": {\n                            borderBottom: `1px solid ${theme.palette.divider}`,\n                            pb: 0.5\n                        }\n                    })}>\n                    <Box\n                        key={`table-cell-title-${key}-${key}`}\n                        sx={{\n                            width: \"25%\",\n                            verticalAlign: \"top\",\n                            pr: 1\n                        }}>\n                        <Typography variant={\"caption\"}\n                                    className={\"mono\"}\n                                    color={\"textSecondary\"}>\n                            {key}\n                        </Typography>\n                    </Box>\n                    <Box\n                        sx={{\n                            flexGrow: 1\n                        }}>\n                        <Typography\n                            variant={\"caption\"}\n                            className={\"mono\"}>\n                            <ErrorBoundary>\n                                {JSON.stringify(childValue)}\n                            </ErrorBoundary>\n                        </Typography>\n                    </Box>\n                </Box>\n            ))\n        }\n    </Box>;\n}\n","export const defaultDateFormat = \"MMMM dd, yyyy, HH:mm:ss\";\n","import React from \"react\";\n\nimport format from \"date-fns/format\";\nimport * as locales from \"date-fns/locale\";\nimport { defaultDateFormat } from \"../../core/util/dates\";\nimport { FireCMSContext } from \"../../types\";\nimport { useFireCMSContext } from \"../../hooks\";\n\n/**\n * @category Preview components\n */\nexport function DatePreview({\n                                date\n                            }: { date: Date }): React.ReactElement {\n\n    const appConfig: FireCMSContext<any> | undefined = useFireCMSContext();\n    // @ts-ignore\n    const dateUtilsLocale = appConfig?.locale ? locales[appConfig?.locale] : undefined;\n    const dateFormat: string = appConfig?.dateTimeFormat ?? defaultDateFormat;\n    const formattedDate = date ? format(date, dateFormat, { locale: dateUtilsLocale }) : \"\";\n\n    return (\n        <>\n            {formattedDate}\n        </>\n    );\n}\n","import React from \"react\";\nimport { CheckBox, CheckBoxOutlineBlank } from \"@mui/icons-material\";\n\n/**\n * @category Preview components\n */\nexport function BooleanPreview({ value }: { value: boolean }): React.ReactElement {\n    return value\n        ? <CheckBox color=\"secondary\"/>\n        : <CheckBoxOutlineBlank color=\"disabled\"/>;\n}\n","import React from \"react\";\n\nimport { EnumValuesChip } from \"../components/ColorChip\";\nimport { resolveEnumValues } from \"../../core\";\nimport { PropertyPreviewProps } from \"../PropertyPreviewProps\";\n\n/**\n * @category Preview components\n */\nexport function NumberPropertyPreview({\n                                          value,\n                                          property,\n                                          size\n                                      }: PropertyPreviewProps<number>): React.ReactElement {\n\n    if (property.enumValues) {\n        const enumKey = value;\n        const enumValues = resolveEnumValues(property.enumValues);\n        if (!enumValues)\n            return <>{value}</>;\n        return <EnumValuesChip\n            enumKey={enumKey}\n            enumValues={enumValues}\n            small={size !== \"regular\"}/>;\n    } else {\n        return <>{value}</>;\n    }\n}\n","import React, { createElement } from \"react\";\nimport {\n    CMSType,\n    EntityReference,\n    ResolvedArrayProperty,\n    ResolvedMapProperty,\n    ResolvedNumberProperty,\n    ResolvedStringProperty\n} from \"../types\";\n\nimport { ErrorView, resolveProperty } from \"../core\";\n\nimport { PropertyPreviewProps } from \"./PropertyPreviewProps\";\nimport { useFireCMSContext } from \"../hooks\";\nimport { EmptyValue } from \"./components/EmptyValue\";\nimport { UrlComponentPreview } from \"./components/UrlComponentPreview\";\nimport { StorageThumbnail } from \"./components/StorageThumbnail\";\nimport { Markdown } from \"./components/Markdown\";\nimport {\n    StringPropertyPreview\n} from \"./property_previews/StringPropertyPreview\";\nimport { ArrayOfMapsPreview } from \"./property_previews/ArrayOfMapsPreview\";\nimport { ArrayPropertyPreview } from \"./property_previews/ArrayPropertyPreview\";\nimport {\n    ArrayOfReferencesPreview\n} from \"./property_previews/ArrayOfReferencesPreview\";\nimport {\n    ArrayOfStorageComponentsPreview\n} from \"./property_previews/ArrayOfStorageComponentsPreview\";\nimport {\n    ArrayPropertyEnumPreview\n} from \"./property_previews/ArrayPropertyEnumPreview\";\nimport {\n    ArrayOfStringsPreview\n} from \"./property_previews/ArrayOfStringsPreview\";\nimport { ArrayOneOfPreview } from \"./property_previews/ArrayOneOfPreview\";\nimport { MapPropertyPreview } from \"./property_previews/MapPropertyPreview\";\nimport { ReferencePreview } from \"./components/ReferencePreview\";\nimport { DatePreview } from \"./components/DatePreview\";\nimport { BooleanPreview } from \"./components/BooleanPreview\";\nimport {\n    NumberPropertyPreview\n} from \"./property_previews/NumberPropertyPreview\";\n\n/**\n * @category Preview components\n */\nexport function PropertyPreview<T extends CMSType>(props: PropertyPreviewProps<T>) {\n\n    const fireCMSContext = useFireCMSContext();\n    let content: React.ReactNode | any;\n    const {\n        property: inputProperty,\n        propertyKey,\n        value,\n        size,\n        height,\n        width,\n        entity\n    } = props;\n\n    const property = resolveProperty({\n        propertyKey,\n        propertyOrBuilder: inputProperty,\n        propertyValue: value,\n        fields: fireCMSContext.fields\n    });\n\n    if (value === undefined || property === null) {\n        content = <EmptyValue/>;\n    } else if (property.Preview) {\n        content = createElement(property.Preview as React.ComponentType<PropertyPreviewProps>,\n            {\n                propertyKey,\n                value,\n                property,\n                size,\n                height,\n                width,\n                entity,\n                customProps: property.customProps\n            });\n    } else if (value === null) {\n        content = <EmptyValue/>;\n    } else if (property.dataType === \"string\") {\n        const stringProperty = property as ResolvedStringProperty;\n        if (typeof value === \"string\") {\n            if (stringProperty.url) {\n                if (typeof stringProperty.url === \"boolean\")\n                    content =\n                        <UrlComponentPreview size={props.size}\n                                             url={value}/>;\n                else if (typeof stringProperty.url === \"string\")\n                    content =\n                        <UrlComponentPreview size={props.size}\n                                             url={value}\n                                             previewType={stringProperty.url}/>;\n            } else if (stringProperty.storage) {\n                content = <StorageThumbnail\n                    storeUrl={property.storage?.storeUrl ?? false}\n                    size={props.size}\n                    storagePathOrDownloadUrl={value}/>;\n            } else if (stringProperty.markdown) {\n                content = <Markdown source={value}/>;\n            } else {\n                content = <StringPropertyPreview {...props}\n                                                 property={stringProperty}\n                                                 value={value}/>;\n            }\n        } else {\n            content = buildWrongValueType(propertyKey, property.dataType, value);\n        }\n    } else if (property.dataType === \"array\") {\n        if (value instanceof Array) {\n            const arrayProperty = property as ResolvedArrayProperty;\n            if (!arrayProperty.of && !arrayProperty.oneOf) {\n                throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${propertyKey}`);\n            }\n\n            if (arrayProperty.of) {\n                if (Array.isArray(arrayProperty.of)) {\n                    content = <ArrayPropertyPreview {...props}\n                                                    value={value}\n                                                    property={property as ResolvedArrayProperty}/>;\n                } else if (arrayProperty.of.dataType === \"map\") {\n                    content =\n                        <ArrayOfMapsPreview propertyKey={propertyKey}\n                                            property={property as ResolvedArrayProperty}\n                                            value={value as Record<string, any>[]} // This might be wrong\n                                            entity={entity}\n                                            size={size}\n                        />;\n                } else if (arrayProperty.of.dataType === \"reference\") {\n                    if (typeof arrayProperty.of.path === \"string\") {\n                        content = <ArrayOfReferencesPreview {...props}\n                                                            value={value}\n                                                            property={property as ResolvedArrayProperty}/>;\n                    } else {\n                        content = <EmptyValue/>;\n                    }\n                } else if (arrayProperty.of.dataType === \"string\") {\n                    if (arrayProperty.of.enumValues) {\n                        content = <ArrayPropertyEnumPreview\n                            {...props}\n                            value={value as string[]}\n                            property={property as ResolvedArrayProperty}/>;\n                    } else if (arrayProperty.of.storage) {\n                        content = <ArrayOfStorageComponentsPreview\n                            {...props}\n                            value={value}\n                            property={property as ResolvedArrayProperty}/>;\n                    } else {\n                        content = <ArrayOfStringsPreview\n                            {...props}\n                            value={value as string[]}\n                            property={property as ResolvedArrayProperty}/>;\n                    }\n                } else if (arrayProperty.of.dataType === \"number\" && arrayProperty.of.enumValues) {\n                    content = <ArrayPropertyEnumPreview\n                        {...props}\n                        value={value as string[]}\n                        property={property as ResolvedArrayProperty}/>;\n                } else {\n                    content = <ArrayPropertyPreview {...props}\n                                                    value={value}\n                                                    property={property as ResolvedArrayProperty}/>;\n                }\n            } else if (arrayProperty.oneOf) {\n                content = <ArrayOneOfPreview {...props}\n                                             value={value}\n                                             property={property as ResolvedArrayProperty}/>;\n            }\n        } else {\n            content = buildWrongValueType(propertyKey, property.dataType, value);\n        }\n    } else if (property.dataType === \"map\") {\n        if (typeof value === \"object\") {\n            content =\n                <MapPropertyPreview {...props}\n                                    property={property as ResolvedMapProperty}/>;\n        } else {\n            content = buildWrongValueType(propertyKey, property.dataType, value);\n        }\n    } else if (property.dataType === \"date\") {\n        if (value instanceof Date) {\n            content = <DatePreview date={value}/>;\n        } else {\n            content = buildWrongValueType(propertyKey, property.dataType, value);\n        }\n    } else if (property.dataType === \"reference\") {\n        if (typeof property.path === \"string\") {\n            if (value instanceof EntityReference) {\n                content = <ReferencePreview\n                    disabled={!property.path}\n                    previewProperties={property.previewProperties}\n                    size={props.size}\n                    onClick={props.onClick}\n                    reference={value as EntityReference}\n                />;\n            } else {\n                content = buildWrongValueType(propertyKey, property.dataType, value);\n            }\n        } else {\n            content = <EmptyValue/>;\n        }\n\n    } else if (property.dataType === \"boolean\") {\n        if (typeof value === \"boolean\") {\n            content = <BooleanPreview value={value}/>;\n        } else {\n            content = buildWrongValueType(propertyKey, property.dataType, value);\n        }\n    } else if (property.dataType === \"number\") {\n        if (typeof value === \"number\") {\n            content = <NumberPropertyPreview {...props}\n                                             value={value}\n                                             property={property as ResolvedNumberProperty}/>;\n        } else {\n            content = buildWrongValueType(propertyKey, property.dataType, value);\n        }\n    } else {\n        content = JSON.stringify(value);\n    }\n\n    return content === undefined || content === null ? <EmptyValue/> : content;\n}\n\nfunction buildWrongValueType(name: string | undefined, dataType: string, value: any) {\n    console.error(`Unexpected value for property ${name}, of type ${dataType}`, value);\n    return (\n        <ErrorView title={\"Unexpected value\"}\n                   error={`${JSON.stringify(value)}`}/>\n    );\n}\n","import { Skeleton } from \"@mui/material\";\nimport * as React from \"react\";\nimport { useEffect, useState } from \"react\";\n\nexport interface AsyncPreviewComponentProps {\n    builder: Promise<React.ReactNode>;\n}\n\n/**\n * Utility component used to render the result of an async execution.\n * It shows a loading indicator while at it.\n *\n * @category Preview components\n */\nexport const AsyncPreviewComponent = React.memo(function AsyncPreviewComponentInternal<M extends Record<string, any>>(\n        {\n            builder\n        }: AsyncPreviewComponentProps) {\n\n        const [loading, setLoading] = useState<boolean>(true);\n        const [result, setResult] = useState<React.ReactNode>(null);\n\n        useEffect(() => {\n            let unmounted = false;\n            builder\n                .then((res) => {\n                    if (!unmounted) {\n                        setLoading(false);\n                        setResult(res);\n                    }\n                })\n                .catch(error => {\n                    setLoading(false);\n                    console.error(error);\n                });\n            return () => {\n                unmounted = true;\n            };\n        }, [builder]);\n\n        if (loading)\n            return <Skeleton variant=\"text\"/>;\n\n        return <React.Fragment>{result}</React.Fragment>;\n\n    }\n);\n","import hash from \"object-hash\";\nimport { GeoPoint } from \"../../types\";\n\nexport const pick: <T>(obj: T, ...args: any[]) => T = (obj: any, ...args: any[]) => ({\n    ...args.reduce((res, key) => ({\n        ...res,\n        [key]: obj[key]\n    }), {})\n});\n\nexport function isObject(item: any) {\n    return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\nexport function mergeDeep<T extends object>(target: T, source: any): T {\n    const targetIsObject = isObject(target);\n    const output: T = targetIsObject ? { ...target } : target;\n    if (targetIsObject && isObject(source)) {\n        Object.keys(source).forEach(key => {\n            if (isObject(source[key])) {\n                if (!(key in target))\n                    Object.assign(output, { [key]: source[key] });\n                else\n                    (output as any)[key] = mergeDeep((target as any)[key], source[key]);\n            } else {\n                Object.assign(output, { [key]: source[key] });\n            }\n        });\n    }\n    return output;\n}\n\nexport function getValueInPath(o: object | undefined, path: string): any {\n    if (!o) return undefined;\n    if (typeof o === \"object\") {\n        if (path in o) {\n            return (o as any)[path];\n        }\n        if (path.includes(\".\")) {\n            const pathSegments = path.split(\".\");\n            return getValueInPath((o as any)[pathSegments[0]], pathSegments.slice(1).join(\".\"))\n        }\n    }\n    return undefined;\n}\n\nexport function removeInPath(o: object, path: string): object | undefined {\n    let currentObject = { ...o };\n    const parts = path.split(\".\");\n    const last = parts.pop();\n    for (const part of parts) {\n        currentObject = (currentObject as any)[part]\n    }\n    if (last)\n        delete (currentObject as any)[last];\n    return currentObject;\n}\n\nexport function removeFunctions(o: object | undefined): any {\n    if (typeof o === \"object\") {\n        return Object.entries(o)\n            .filter(([_, value]) => typeof value !== \"function\")\n            .map(([key, value]) => {\n                if (Array.isArray(value)) {\n                    return { [key]: value.map(v => removeFunctions(v)) };\n                } else if (typeof value === \"object\") {\n                    return { [key]: removeFunctions(value) };\n                } else return { [key]: value };\n            })\n            .reduce((a, b) => ({ ...a, ...b }), {});\n    }\n    return o;\n}\n\nexport function getHashValue<T>(v: T) {\n    if (!v) return null;\n    if (typeof v === \"object\") {\n        if (\"id\" in v)\n            return (v as any).id;\n        else if (v instanceof Date)\n            return v.toLocaleString();\n        else if (v instanceof GeoPoint)\n            return hash(v as Record<string, unknown>);\n    }\n    return hash(v, { ignoreUnknown: true });\n}\n\nexport function removeUndefined(value: any): any {\n    if (typeof value === \"function\") {\n        return value;\n    }\n    if (Array.isArray(value)) {\n        return value.map((v: any) => removeUndefined(v));\n    }\n    if (typeof value === \"object\") {\n        const res: object = {};\n        Object.keys(value).forEach((key) => {\n            if (!isEmptyObject(value)) {\n                const childRes = removeUndefined(value[key]);\n                if (childRes !== undefined && !isEmptyObject(childRes))\n                    (res as any)[key] = childRes;\n            }\n        });\n        return res;\n    }\n    return value;\n}\n\nexport function isEmptyObject(obj: object) {\n    return obj &&\n        Object.getPrototypeOf(obj) === Object.prototype &&\n        Object.keys(obj).length === 0\n}\n","import {\n    CMSType, DataType,\n    Entity,\n    EntityReference,\n    EntityStatus,\n    EntityValues,\n    Properties,\n    PropertiesOrBuilders,\n    Property,\n    PropertyBuilder,\n    PropertyOrBuilder,\n    ResolvedProperties,\n    ResolvedProperty\n} from \"../../types\";\nimport { DEFAULT_ONE_OF_TYPE, DEFAULT_ONE_OF_VALUE } from \"./common\";\n\nexport function isReadOnly(property: Property | ResolvedProperty): boolean {\n    if (property.readOnly)\n        return true;\n    if (property.dataType === \"date\") {\n        if (property.autoValue)\n            return true;\n    }\n    if (property.dataType === \"reference\") {\n        return !property.path;\n    }\n    return false;\n}\n\nexport function isHidden(property: Property | ResolvedProperty): boolean {\n    return typeof property.disabled === \"object\" && Boolean(property.disabled.hidden);\n}\n\nexport function isPropertyBuilder<T extends CMSType, M extends Record<string, any>>(propertyOrBuilder?: PropertyOrBuilder<T, M> | Property<T> | ResolvedProperty<T>): propertyOrBuilder is PropertyBuilder<T, M> {\n    return typeof propertyOrBuilder === \"function\";\n}\n\nexport function getDefaultValuesFor<M extends Record<string, any>>(properties: PropertiesOrBuilders<M> | ResolvedProperties<M>): Partial<EntityValues<M>> {\n    if (!properties) return {};\n    return Object.entries(properties)\n        .map(([key, property]) => {\n            const value = getDefaultValueFor(property as PropertyOrBuilder);\n            return value === undefined ? {} : { [key]: value };\n        })\n        .reduce((a, b) => ({ ...a, ...b }), {}) as EntityValues<M>;\n}\n\nexport function getDefaultValueFor(property: PropertyOrBuilder) {\n    if (isPropertyBuilder(property)) return undefined;\n    if (property.dataType === \"map\" && property.properties) {\n        const defaultValuesFor = getDefaultValuesFor(property.properties as Properties);\n        if (Object.keys(defaultValuesFor).length === 0) return undefined;\n        return defaultValuesFor;\n    } else if (property.defaultValue) {\n        return property.defaultValue;\n    } else {\n        return getDefaultValueForDataType(property.dataType);\n    }\n}\n\nexport function getDefaultValueForDataType(dataType: DataType) {\n    if (dataType === \"string\") {\n        return null;\n    } else if (dataType === \"number\") {\n        return null;\n    } else if (dataType === \"boolean\") {\n        return false;\n    } else if (dataType === \"date\") {\n        return null;\n    } else if (dataType === \"array\") {\n        return [];\n    } else if (dataType === \"map\") {\n        return {};\n    } else {\n        return null;\n    }\n}\n\n/**\n * Update the automatic values in an entity before save\n * @category Datasource\n */\nexport function updateDateAutoValues<M extends Record<string, any>>({\n                                                                        inputValues,\n                                                                        properties,\n                                                                        status,\n                                                                        timestampNowValue,\n                                                                        setDateToMidnight\n                                                                    }:\n                                                                        {\n                                                                            inputValues: Partial<EntityValues<M>>,\n                                                                            properties: ResolvedProperties<M>,\n                                                                            status: EntityStatus,\n                                                                            timestampNowValue: any,\n                                                                            setDateToMidnight: (input?: any) => any | undefined\n                                                                        }): EntityValues<M> {\n    return traverseValuesProperties(\n        inputValues,\n        properties,\n        (inputValue, property) => {\n            if (property.dataType === \"date\") {\n                let resultDate;\n                if (status === \"existing\" && property.autoValue === \"on_update\") {\n                    resultDate = timestampNowValue;\n                } else if ((status === \"new\" || status === \"copy\") &&\n                    (property.autoValue === \"on_update\" || property.autoValue === \"on_create\")) {\n                    resultDate = timestampNowValue;\n                } else {\n                    resultDate = inputValue;\n                }\n                if (property.mode === \"date\")\n                    resultDate = setDateToMidnight(resultDate);\n                return resultDate;\n            } else {\n                return inputValue;\n            }\n        }\n    ) ?? {} as M;\n}\n\n/**\n * Add missing required fields, expected in the collection, to the values of an entity\n * @param values\n * @param properties\n * @category Datasource\n */\nexport function sanitizeData<M extends Record<string, any>>\n(\n    values: EntityValues<M>,\n    properties: ResolvedProperties<M>\n) {\n    const result: any = values;\n    Object.entries(properties)\n        .forEach(([key, property]) => {\n            if (values && values[key] !== undefined) result[key] = values[key];\n            else if ((property as Property).validation?.required) result[key] = null;\n        });\n    return result;\n}\n\nexport function getReferenceFrom(entity: Entity<any>): EntityReference {\n    return new EntityReference(entity.id, entity.path);\n}\n\nexport function traverseValuesProperties<M extends Record<string, any>>(\n    inputValues: Partial<EntityValues<M>>,\n    properties: ResolvedProperties<M>,\n    operation: (value: any, property: Property) => any\n): EntityValues<M> | undefined {\n    const updatedValues = Object.entries(properties)\n        .map(([key, property]) => {\n            const inputValue = inputValues && (inputValues)[key];\n            const updatedValue = traverseValueProperty(inputValue, property as Property, operation);\n            if (updatedValue === undefined) return undefined;\n            return ({ [key]: updatedValue });\n        })\n        .reduce((a, b) => ({ ...a, ...b }), {}) as EntityValues<M>;\n    const result = { ...inputValues, ...updatedValues };\n    if (Object.keys(result).length === 0) return undefined;\n    return result;\n}\n\nexport function traverseValueProperty(inputValue: any,\n                                      property: Property,\n                                      operation: (value: any, property: Property) => any): any {\n\n    let value;\n    if (property.dataType === \"map\" && property.properties) {\n        value = traverseValuesProperties(inputValue, property.properties as ResolvedProperties, operation);\n    } else if (property.dataType === \"array\") {\n        if (property.of && Array.isArray(inputValue)) {\n            value = inputValue.map((e) => traverseValueProperty(e, property.of as Property, operation));\n        } else if (property.oneOf && Array.isArray(inputValue)) {\n            const typeField = property.oneOf?.typeField ?? DEFAULT_ONE_OF_TYPE;\n            const valueField = property.oneOf?.valueField ?? DEFAULT_ONE_OF_VALUE;\n            value = inputValue.map((e) => {\n                if (e === null) return null;\n                if (typeof e !== \"object\") return e;\n                const type = e[typeField];\n                const childProperty = property.oneOf?.properties[type];\n                if (!type || !childProperty) return e;\n                return {\n                    [typeField]: type,\n                    [valueField]: traverseValueProperty(e[valueField], childProperty, operation)\n                };\n            });\n        } else {\n            value = inputValue;\n        }\n    } else {\n        value = operation(inputValue, property);\n    }\n\n    return value;\n}\n","import {\n    DefaultSelectedViewBuilder, DefaultSelectedViewParams,\n    EntityCollection,\n    PropertiesOrBuilders,\n    PropertyOrBuilder\n} from \"../../types\";\nimport { mergeDeep } from \"./objects\";\nimport { isPropertyBuilder } from \"./entities\";\n\n/**\n *\n * @param target\n * @param source\n */\nexport function mergeCollections(target: EntityCollection, source: EntityCollection): EntityCollection {\n    const subcollectionsMerged = target.subcollections?.map((targetSubcollection) => {\n        const modifiedCollection =\n            source.subcollections?.find((sourceSubcollection) => sourceSubcollection.path === targetSubcollection.path) ??\n            source.subcollections?.find((sourceSubcollection) => sourceSubcollection.alias === targetSubcollection.alias);\n\n        if (!modifiedCollection) {\n            return targetSubcollection;\n        } else {\n            return mergeCollections(targetSubcollection, modifiedCollection);\n        }\n    });\n\n    const mergedCollection = mergeDeep(target, source);\n    return {\n        ...mergedCollection,\n        subcollections: subcollectionsMerged,\n        properties: sortProperties(mergedCollection.properties, mergedCollection.propertiesOrder)\n    }\n}\n\n/**\n *\n * @param fetchedCollections\n * @param baseCollections\n */\nexport function joinCollectionLists(fetchedCollections: EntityCollection[], baseCollections: EntityCollection[] | undefined): EntityCollection[] {\n    const resolvedFetchedCollections: EntityCollection[] = fetchedCollections.map(c => ({\n        ...c,\n        editable: true,\n        deletable: true\n    }));\n    const updatedCollections = (baseCollections ?? [])\n        .map((navigationCollection) => {\n            const storedCollection = resolvedFetchedCollections?.find((collection) => collection.path === navigationCollection.path) ??\n                resolvedFetchedCollections?.find((collection) => collection.alias === navigationCollection.alias);\n            if (!storedCollection) {\n                return { ...navigationCollection, deletable: false };\n            } else {\n                const mergedCollection = mergeCollections(navigationCollection, storedCollection);\n                return { ...mergedCollection, deletable: false };\n            }\n        });\n    const storedCollections = resolvedFetchedCollections\n        .filter((col) => !updatedCollections.map(c => c.path).includes(col.path) || !updatedCollections.map(c => c.alias).includes(col.alias));\n\n    return [...updatedCollections, ...storedCollections];\n}\n\nexport function sortProperties<M extends Record<string, any>>(properties: PropertiesOrBuilders<M>, propertiesOrder?: (keyof M)[]): PropertiesOrBuilders<M> {\n    try {\n        const propertiesKeys = Object.keys(properties);\n        const allPropertiesOrder = propertiesOrder ?? propertiesKeys;\n        return allPropertiesOrder\n            .map((key) => {\n                if (properties[key as keyof M]) {\n                    const property = properties[key] as PropertyOrBuilder;\n                    if (!isPropertyBuilder(property) && property?.dataType === \"map\" && property.properties) {\n                        return ({\n                            [key]: {\n                                ...property,\n                                properties: sortProperties(property.properties, property.propertiesOrder)\n                            }\n                        });\n                    } else {\n                        return ({ [key]: property });\n                    }\n                } else {\n                    return undefined;\n                }\n            })\n            .filter((a) => a !== undefined)\n            .reduce((a: any, b: any) => ({ ...a, ...b }), {}) as PropertiesOrBuilders<M>;\n    } catch (e) {\n        console.error(\"Error sorting properties\", e);\n        return properties;\n    }\n}\n\nexport function resolveDefaultSelectedView(\n    defaultSelectedView: string | DefaultSelectedViewBuilder | undefined,\n    params: DefaultSelectedViewParams\n) {\n    if (!defaultSelectedView) {\n        return undefined;\n    } else if (typeof defaultSelectedView === \"string\") {\n        return defaultSelectedView;\n    } else {\n        return defaultSelectedView(params);\n    }\n}\n","const kebabCaseRegex = /[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g;\n\nexport const toKebabCase = (str: string) => {\n    const regExpMatchArray = str.match(kebabCaseRegex);\n    if (!regExpMatchArray) return \"\";\n    return regExpMatchArray\n        .map(x => x.toLowerCase())\n        .join(\"-\");\n};\n\nconst snakeCaseRegex = /[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g;\n\nexport const toSnakeCase = (str: string) => {\n    const regExpMatchArray = str.match(snakeCaseRegex);\n    if (!regExpMatchArray) return \"\";\n    return regExpMatchArray\n        .map(x => x.toLowerCase())\n        .join(\"_\");\n};\n\nexport function randomString(strLength = 5) {\n    return Math.random().toString(36).slice(2, 2 + strLength);\n}\n\nexport function randomColor() {\n    return Math.floor(Math.random() * 16777215).toString(16);\n}\n","export const COLLECTION_PATH_SEPARATOR = \"::\";\n\n/**\n * Remove the entity ids from a given path\n * `products/B44RG6APH/locales` => `products::locales`\n * @param path\n */\nexport function stripCollectionPath(path: string): string {\n    return segmentsToStrippedPath(fullPathToCollectionSegments(path));\n}\n\nexport function segmentsToStrippedPath(paths: string[]) {\n    if (paths.length === 1)\n        return paths[0];\n    return paths.reduce((a, b) => `${a}${COLLECTION_PATH_SEPARATOR}${b}`);\n}\n\n/**\n * Extract the collection path routes\n * `products/B44RG6APH/locales` => [`products`, `locales`]\n * @param path\n */\nexport function fullPathToCollectionSegments(path: string): string[] {\n    return path\n        .split(\"/\")\n        .filter((e, i) => i % 2 === 0);\n}\n","export function serializeRegExp(input: RegExp): string {\n    if (!input) return \"\";\n    // const fragments = input.toString().match(/\\/(.*?)\\/([a-z]*)?$/i);\n    // if (fragments) {\n    //     if (fragments[2])\n    //         return input.toString();\n    //     return fragments[1];\n    // }\n    return input.toString();\n}\n\n/**\n * Get a RegExp out of a serialized string\n * @param input\n */\nexport function hydrateRegExp(input?: string): RegExp | undefined {\n    if (!input) return undefined;\n    const fragments = input.match(/\\/(.*?)\\/([a-z]*)?$/i);\n    if (fragments) {\n        return new RegExp(fragments[1], fragments[2] || \"\");\n    } else {\n        return new RegExp(input, \"\");\n    }\n}\n\nexport function isValidRegExp(input: string): boolean {\n    const fullRegexp = input.match(/\\/((?![*+?])(?:[^\\r\\n[/\\\\]|\\\\.|\\[(?:[^\\r\\n\\]\\\\]|\\\\.)*])+)\\/((?:g(?:im?|mi?)?|i(?:gm?|mg?)?|m(?:gi?|ig?)?)?)/);\n    if (fullRegexp)\n        return true;\n    const simpleRegexp = input.match(/((?![*+?])(?:[^\\r\\n[/\\\\]|\\\\.|\\[(?:[^\\r\\n\\]\\\\]|\\\\.)*])+)/);\n    return !!simpleRegexp;\n}\n","import React from \"react\";\n\nexport function useDebounce<T>(value: T, callback: () => void, immediate: boolean, timeoutMs = 300) {\n\n    const pendingUpdate = React.useRef(false);\n    const performUpdate = () => {\n        callback();\n        pendingUpdate.current = false;\n    };\n\n    const handlerRef = React.useRef<number | undefined>(undefined);\n\n    React.useEffect(\n        () => {\n            pendingUpdate.current = true;\n            clearTimeout(handlerRef.current);\n            handlerRef.current = setTimeout(performUpdate, timeoutMs) as any;\n            return () => {\n                if (immediate)\n                    performUpdate();\n            };\n        },\n        [immediate, value]\n    );\n}\n","import { useEffect, useState } from \"react\";\n\nexport function useDebounceValue<T>(value:T, delay = 300):T {\n    // State and setters for debounced value\n    const [debouncedValue, setDebouncedValue] = useState(value);\n    useEffect(\n        () => {\n            const handler = setTimeout(() => {\n                setDebouncedValue(value);\n            }, delay);\n            return () => {\n                clearTimeout(handler);\n            };\n        },\n        [value, delay] // Only re-call effect if value or delay changes\n    );\n    return debouncedValue;\n}\n","import React from \"react\";\n\nimport { ArrayContainer } from \"../../core\";\n\ninterface ArrayContainerProps<T> {\n    value: T[];\n    name: string;\n    addLabel: string;\n    buildEntry: (index: number, internalId: number) => React.ReactNode;\n    disabled?: boolean;\n    small?: boolean;\n    onInternalIdAdded?: (id: number) => void;\n    includeAddButton?: boolean;\n    newDefaultEntry?: T | null;\n    setFieldValue: (field: string, value: any, shouldValidate?: boolean | undefined) => void;\n}\n\n/**\n * @category Form custom fields\n */\nexport function FormikArrayContainer<T>({\n                                            name,\n                                            addLabel,\n                                            value,\n                                            disabled = false,\n                                            buildEntry,\n                                            small,\n                                            onInternalIdAdded,\n                                            includeAddButton,\n                                            newDefaultEntry = null,\n                                            setFieldValue\n                                        }: ArrayContainerProps<T>) {\n\n    return <ArrayContainer droppableId={name}\n                           addLabel={addLabel}\n                           value={value}\n                           disabled={disabled}\n                           buildEntry={buildEntry}\n                           small={small}\n                           onInternalIdAdded={onInternalIdAdded}\n                           includeAddButton={includeAddButton}\n                           newDefaultEntry={newDefaultEntry}\n                           onValueChange={(value) => setFieldValue(name, value)}\n    />\n\n}\n","import React from \"react\";\nimport { CMSType, ResolvedProperty } from \"../../types\";\n\nimport {\n    Box,\n    FormHelperText,\n    IconButton,\n    Tooltip,\n    Typography\n} from \"@mui/material\";\nimport InfoIcon from \"@mui/icons-material/InfoOutlined\";\n\ninterface FieldDescriptionPopoverProps<T extends CMSType> {\n    property: ResolvedProperty<T>,\n}\n\n/**\n * Render the field description for a property\n * @category Form custom fields\n */\nexport function FieldDescription<T extends CMSType>({ property }: FieldDescriptionPopoverProps<T>) {\n    const disabledTooltip: string | undefined = typeof property.disabled === \"object\" ? property.disabled.disabledMessage : undefined;\n    return (\n\n        // <FormHelperText>{disabledTooltip ? disabledTooltip : property.description}</FormHelperText>\n        <Box display=\"flex\">\n\n            <Box flexGrow={1}>\n                <FormHelperText>{disabledTooltip || property.description}</FormHelperText>\n            </Box>\n\n            {property.longDescription &&\n            <Tooltip title={\n                <Typography\n                    variant={\"caption\"}>{property.longDescription}</Typography>\n            }\n                     placement=\"bottom-start\"\n                     arrow>\n                <IconButton\n                    edge={\"start\"}\n                    size={\"small\"}\n                    sx={{\n                        alignSelf: \"flex-start\"\n                    }}>\n\n                    <InfoIcon color={\"disabled\"}\n                              fontSize={\"small\"}/>\n                </IconButton>\n            </Tooltip>}\n\n        </Box>\n    );\n}\n","import React from \"react\";\nimport { Box, SxProps, Theme, Typography } from \"@mui/material\";\n\ninterface LabelWithIconProps {\n    icon: React.ReactNode;\n    title?: string;\n    small?: boolean;\n    sx?: SxProps<Theme>;\n    required?: boolean;\n}\n\n/**\n * Render the label of a form field for a given property, with the corresponding\n * icon.\n * @category Form custom fields\n */\nexport function LabelWithIcon({\n                                  icon,\n                                  title,\n                                  small,\n                                  sx,\n                                  required\n                              }: LabelWithIconProps) {\n    return (\n        <Box sx={{\n            display: \"inline-flex\",\n            marginBottom: \"2px\",\n            alignItems: \"center\",\n            gap: small ? 1 : 1.5,\n            ...sx\n        }} component={\"span\"}>\n\n            {icon}\n            <Typography component={\"span\"}\n                        sx={{\n                            fontWeight: 500,\n                            fontSize: small ? \"1rem\" : \".85rem\",\n                            transformOrigin: \"left top\",\n                            transform: small ? \"translate(8px, 0px) scale(0.75)\" : undefined\n                        }}>{(title ?? \"\") + (required ? \" *\" : \"\")}</Typography>\n\n        </Box>\n    );\n}\n","import React, {\n    ChangeEvent,\n    useCallback,\n    useDeferredValue,\n    useEffect\n} from \"react\";\nimport { TextField, TextFieldProps } from \"@mui/material\";\n\nexport function DebouncedTextField(props: TextFieldProps) {\n\n    const previousEventRef = React.useRef<ChangeEvent<any>>();\n    const [internalValue, setInternalValue] = React.useState(props.value);\n\n    const deferredValue = useDeferredValue(internalValue);\n\n    useEffect(() => {\n        setInternalValue(props.value);\n    }, [props.value]);\n\n    useEffect(() => {\n        const emptyInitialValue = !props.value;\n        if (emptyInitialValue && !deferredValue)\n            return;\n        if (deferredValue !== props.value && previousEventRef.current && props.onChange)\n            props.onChange(previousEventRef.current);\n    }, [deferredValue, props.value, props.onChange]);\n\n    const internalOnChange = useCallback((event: ChangeEvent<any>) => {\n        previousEventRef.current = event;\n        setInternalValue(event.target.value);\n    }, []);\n\n    return <TextField {...props}\n                      onChange={internalOnChange}\n                      value={internalValue}/>\n}\n","import React from \"react\";\n\nimport { FieldProps } from \"formik\";\nimport { FormControlLabel, Switch, Tooltip, Typography } from \"@mui/material\";\n\nexport function SwitchControl({\n                                 field,\n                                 form,\n                                 label,\n                                 tooltip,\n                                 disabled,\n                                 size = \"small\"\n                             }: FieldProps & { label: string, tooltip?: string, disabled?: boolean, size: \"small\" | \"medium\" }) {\n    const formControlLabel = <FormControlLabel\n        checked={field.value ?? false}\n        sx={{ ml: 0 }}\n        disabled={disabled}\n        control={\n            <Switch size={size}\n                    disabled={disabled}\n                    onChange={(e, checked) => form.setFieldValue(field.name, checked)}/>\n        }\n        label={<Typography variant={\"body2\"}>{label}</Typography>}\n    />;\n    if (tooltip)\n        return (\n            <Tooltip\n                title={tooltip}>\n                {formControlLabel}\n            </Tooltip>\n        );\n    return formControlLabel;\n}\n","import { Box, Typography } from \"@mui/material\";\nimport React, { ErrorInfo, PropsWithChildren } from \"react\";\n\nimport ErrorIcon from \"@mui/icons-material/Error\";\n\nexport class ErrorBoundary extends React.Component<PropsWithChildren<Record<string, unknown>>, { error: Error | null }> {\n    constructor(props: any) {\n        super(props);\n        this.state = { error: null };\n    }\n\n    // eslint-disable-next-line n/handle-callback-err\n    static getDerivedStateFromError(error: Error) {\n        return { error };\n    }\n\n    componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n        console.error(error);\n        // logErrorToMyService(error, errorInfo);\n    }\n\n    render() {\n        if (this.state.error) {\n            return (\n                <Box\n                    display={\"flex\"}\n                    flexDirection={\"column\"}\n                    m={0.5}>\n                    <Box\n                        display={\"flex\"}\n                        alignItems={\"center\"}\n                        m={0.5}>\n                        <ErrorIcon color={\"error\"} fontSize={\"small\"}/>\n                        <Box marginLeft={1}>Error</Box>\n                    </Box>\n                    <Typography variant={\"caption\"}>\n                        {this.state.error?.message ?? \"See the error in the console\"}\n                    </Typography>\n                </Box>\n            );\n        }\n\n        return this.props.children;\n    }\n}\n","import React from \"react\";\nimport { FormControl, FormHelperText, Paper } from \"@mui/material\";\n\nimport { Entity, FieldProps } from \"../../types\";\n\nimport { PropertyPreview } from \"../../preview\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { ErrorBoundary } from \"../../core/components/ErrorBoundary\";\nimport { getIconForProperty } from \"../../core\";\n\n/**\n *\n * Simply render the non-editable preview of a field\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function ReadOnlyFieldBinding({\n                                         propertyKey,\n                                         value,\n                                         setValue,\n                                         error,\n                                         showError,\n                                         isSubmitting,\n                                         touched,\n                                         tableMode,\n                                         property,\n                                         includeDescription,\n                                         context\n                                     }: FieldProps<any>) {\n\n    if (!context.entityId)\n        throw new Error(\"ReadOnlyFieldBinding: Entity id is null\");\n\n    const entity: Entity<any> = {\n        id: context.entityId!,\n        values: context.values,\n        path: context.path\n    };\n\n    return (\n\n        <FormControl fullWidth error={showError}>\n\n            {!tableMode && <FormHelperText filled>\n                <LabelWithIcon icon={getIconForProperty(property)}\n                               required={property.validation?.required}\n                               title={property.name}/>\n            </FormHelperText>}\n\n            <Paper\n                sx={(theme) => ({\n                    minHeight: \"56px\",\n                    elevation: 0,\n                    padding: theme.spacing(2),\n                    [theme.breakpoints.up(\"md\")]: {\n                        padding: theme.spacing(3)\n                    }\n                })}\n                variant={\"outlined\"}>\n\n                <ErrorBoundary>\n                    <PropertyPreview propertyKey={propertyKey}\n                                     value={value}\n                                     property={property}\n                                     entity={entity}\n                                     size={\"regular\"}/>\n                </ErrorBoundary>\n\n            </Paper>\n\n            {showError &&\n                typeof error === \"string\" &&\n                <FormHelperText error={true}>{error}</FormHelperText>}\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n        </FormControl>\n    );\n}\n","import React, { ComponentType, ReactElement, useCallback, useRef } from \"react\";\nimport equal from \"react-fast-compare\"\n\nimport { FormHelperText } from \"@mui/material\";\n\nimport { FastField, Field, FieldProps as FormikFieldProps, getIn } from \"formik\";\n\nimport {\n    CMSType,\n    EntityCollection,\n    FieldProps,\n    FireCMSPlugin,\n    PluginFieldBuilderParams,\n    Property,\n    PropertyFieldBindingProps,\n    PropertyOrBuilder,\n    ResolvedProperty\n} from \"../types\";\nimport { ReadOnlyFieldBinding } from \"./field_bindings/ReadOnlyFieldBinding\";\n\nimport {\n    ErrorBoundary,\n    getFieldConfig,\n    getFieldId,\n    isHidden,\n    isPropertyBuilder,\n    isReadOnly,\n    resolveProperty\n} from \"../core\";\nimport { useFireCMSContext } from \"../hooks\";\n\n/**\n * This component renders a form field creating the corresponding configuration\n * from a property. For example if bound to a string property, it will generate\n * a text field.\n *\n * You can use it when you are creating a custom field, and need to\n * render additional fields mapped to properties. This is useful if you\n * need to build a complex property mapping, like an array where each index\n * is a different property.\n *\n * Please note that if you build a custom field in a component, the\n * **validation** passed in the property will have no effect. You need to set\n * the validation in the `EntityCollection` definition.\n *\n * @param propertyKey You can use nested names such as `address.street` or `friends[2]`\n * @param property\n * @param context\n * @param includeDescription\n * @param underlyingValueHasChanged\n * @param disabled\n * @param tableMode\n * @param partOfArray\n * @param autoFocus\n * @category Form custom fields\n */\n// export const PropertyFieldBinding = PropertyFieldBindingInternal;\nexport const PropertyFieldBinding = React.memo(PropertyFieldBindingInternal, (a: PropertyFieldBindingProps<any>, b: PropertyFieldBindingProps<any>) => {\n    if (a.propertyKey !== b.propertyKey) {\n        return false;\n    }\n    const aIsBuilder = isPropertyBuilder(a.property) || a.property.fromBuilder;\n    const bIsBuilder = isPropertyBuilder(b.property) || b.property.fromBuilder;\n\n    const baseCheck = (aIsBuilder === bIsBuilder || equal(a.property, b.property)) &&\n        a.disabled === b.disabled;\n    if (!baseCheck) {\n        return false;\n    }\n\n    if (shouldPropertyReRender(b.property)) {\n        return false;\n    }\n\n    return false;\n}) as typeof PropertyFieldBindingInternal;\n\nfunction PropertyFieldBindingInternal<T extends CMSType = CMSType, CustomProps = any, M extends Record<string, any> = Record<string, any>>\n({\n     propertyKey,\n     property,\n     context,\n     includeDescription,\n     underlyingValueHasChanged,\n     disabled,\n     tableMode,\n     partOfArray,\n     autoFocus,\n     context: {\n         values,\n         collection,\n         path,\n         entityId\n     }\n }: PropertyFieldBindingProps<T, M>): ReactElement<PropertyFieldBindingProps<T, M>> {\n\n    const fireCMSContext = useFireCMSContext();\n\n    const shouldAlwaysRerender = shouldPropertyReRender(property, fireCMSContext.plugins);\n    // we use the standard Field for user defined fields, since it rebuilds\n    // when there are changes in other values, in contrast to FastField\n    const FieldComponent = shouldAlwaysRerender ? Field : FastField;\n\n    return (\n        <FieldComponent\n            // required={property.validation?.required}\n            name={propertyKey}\n        >\n            {(fieldProps: FormikFieldProps<T>) => {\n\n                let Component: ComponentType<FieldProps<T>> | undefined;\n                const resolvedProperty: ResolvedProperty<T> | null = resolveProperty({\n                    propertyKey,\n                    propertyValue: fieldProps.field.value,\n                    propertyOrBuilder: property,\n                    values: fieldProps.form.values,\n                    path: context.path,\n                    entityId: context.entityId,\n                    fields: fireCMSContext.fields\n                });\n\n                if (resolvedProperty === null || isHidden(resolvedProperty)) {\n                    return <></>;\n                } else if (isReadOnly(resolvedProperty)) {\n                    Component = ReadOnlyFieldBinding;\n                } else if (resolvedProperty.Field) {\n                    if (typeof resolvedProperty.Field === \"function\") {\n                        Component = resolvedProperty.Field as ComponentType<FieldProps<any>>;\n                    }\n                } else {\n                    const fieldConfig = getFieldConfig(resolvedProperty);\n                    if (!fieldConfig) {\n                        throw new Error(`INTERNAL: Could not find field config for property ${propertyKey}`);\n                    }\n                    Component = fieldConfig.Field as ComponentType<FieldProps<T>>;\n\n                }\n                if (!Component) {\n                    return (\n                        <div>{`Currently the field ${resolvedProperty.dataType} is not supported`}</div>\n                    );\n                    // return null;\n                }\n\n                const componentProps: ResolvedPropertyFieldBindingProps<T, M> = {\n                    propertyKey,\n                    property: resolvedProperty,\n                    includeDescription,\n                    underlyingValueHasChanged,\n                    context,\n                    disabled,\n                    tableMode,\n                    partOfArray,\n                    autoFocus\n                };\n\n                return <FieldInternal\n                    Component={Component as ComponentType<FieldProps>}\n                    componentProps={componentProps}\n                    fieldProps={fieldProps}/>;\n            }}\n        </FieldComponent>\n    );\n\n}\n\n\ntype ResolvedPropertyFieldBindingProps<T extends CMSType = CMSType, M extends Record<string, any> = Record<string, any>> =\n    Omit<PropertyFieldBindingProps<T, M>, \"property\">\n    & {\n    property: ResolvedProperty<T>\n};\n\nfunction FieldInternal<T extends CMSType, CustomProps, M extends Record<string, any>>\n({\n     Component,\n     componentProps: {\n         propertyKey,\n         property,\n         includeDescription,\n         underlyingValueHasChanged,\n         tableMode,\n         partOfArray,\n         autoFocus,\n         context,\n         disabled\n     },\n     fieldProps\n }:\n     {\n         Component: ComponentType<FieldProps<T, any, M>>,\n         componentProps: ResolvedPropertyFieldBindingProps<T, M>,\n         fieldProps: FormikFieldProps<T>\n     }) {\n\n    const { plugins } = useFireCMSContext();\n\n    const customFieldProps: any = property.customProps;\n    const value = fieldProps.field.value;\n    const initialValue = fieldProps.meta.initialValue;\n    const error = getIn(fieldProps.form.errors, propertyKey);\n    const touched = getIn(fieldProps.form.touched, propertyKey);\n\n    const showError: boolean = error &&\n        (fieldProps.form.submitCount > 0 || property.validation?.unique) &&\n        (!Array.isArray(error) || !!error.filter((e: any) => !!e).length);\n\n    const WrappedComponent: ComponentType<FieldProps<T, any, M>> | null = useWrappedComponent(context.path, context.collection, propertyKey, property, Component, plugins);\n    const UsedComponent: ComponentType<FieldProps<T>> = WrappedComponent ?? Component;\n    // const UsedComponent: ComponentType<FieldProps<T>> = Component;\n\n    const isSubmitting = fieldProps.form.isSubmitting;\n\n    const setValue = useCallback((value: T | null, shouldValidate?: boolean) => {\n        fieldProps.form.setFieldTouched(propertyKey, true, false);\n        fieldProps.form.setFieldValue(propertyKey, value, shouldValidate);\n    }, []);\n\n    const setFieldValue = useCallback((otherPropertyKey: string, value: CMSType | null, shouldValidate?: boolean) => {\n        fieldProps.form.setFieldTouched(propertyKey, true, false);\n        fieldProps.form.setFieldValue(otherPropertyKey, value, shouldValidate);\n    }, []);\n\n    const cmsFieldProps: FieldProps<T, CustomProps, M> = {\n        propertyKey,\n        value: value as T,\n        initialValue,\n        setValue,\n        setFieldValue,\n        error,\n        touched,\n        showError,\n        isSubmitting,\n        includeDescription: includeDescription ?? true,\n        property: property as ResolvedProperty<T>,\n        disabled: disabled ?? false,\n        underlyingValueHasChanged: underlyingValueHasChanged ?? false,\n        tableMode: tableMode ?? false,\n        partOfArray: partOfArray ?? false,\n        autoFocus: autoFocus ?? false,\n        customProps: customFieldProps,\n        context\n    };\n\n    return (\n        <ErrorBoundary>\n\n            <UsedComponent {...cmsFieldProps}/>\n\n            {underlyingValueHasChanged && !isSubmitting &&\n                <FormHelperText>\n                    This value has been updated elsewhere\n                </FormHelperText>}\n\n        </ErrorBoundary>);\n\n}\n\nconst shouldPropertyReRender = (property: PropertyOrBuilder | ResolvedProperty, plugins?: FireCMSPlugin[]): boolean => {\n    if (plugins?.some((plugin) => plugin.form?.fieldBuilder)) {\n        return true;\n    }\n    if (isPropertyBuilder(property)) {\n        return true;\n    }\n    const defAProperty = property as Property | ResolvedProperty;\n    const rerenderThisProperty = Boolean(defAProperty.Field) || (\"fromBuilder\" in defAProperty && defAProperty.fromBuilder);\n    if (defAProperty.dataType === \"map\" && defAProperty.properties) {\n        return rerenderThisProperty || Object.values(defAProperty.properties).some((childProperty) => shouldPropertyReRender(childProperty, plugins));\n    } else if (defAProperty.dataType === \"array\" && \"resolvedProperties\" in defAProperty) {\n        // @ts-ignore\n        return rerenderThisProperty || defAProperty.resolvedProperties?.some((childProperty) => childProperty && shouldPropertyReRender(childProperty, plugins));\n    } else {\n        return rerenderThisProperty;\n    }\n}\n\nfunction useWrappedComponent<T extends CMSType = CMSType, M extends Record<string, any> = any>(\n    path: string,\n    collection: EntityCollection<M>,\n    propertyKey: string,\n    property: ResolvedProperty<T>,\n    Component: ComponentType<FieldProps<T, any, M>>,\n    plugins?: FireCMSPlugin[]\n): ComponentType<FieldProps<T, any, M>> | null {\n\n    const wrapperRef = useRef<ComponentType<FieldProps<T, any, M>> | null>((() => {\n        let Wrapper: ComponentType<FieldProps<T, any, M>> | null = null;\n        if (plugins) {\n            plugins.forEach((plugin) => {\n                const fieldId = getFieldId(property);\n                if (fieldId && plugin.form?.fieldBuilder) {\n                    const params: PluginFieldBuilderParams<T> = {\n                        fieldConfigId: fieldId,\n                        propertyKey,\n                        property,\n                        Field: Component,\n                        plugin,\n                        path,\n                        collection\n                    };\n                    const enabled = plugin.form?.fieldBuilderEnabled?.(params);\n                    if (enabled === undefined || enabled)\n                        Wrapper = plugin.form.fieldBuilder(params) || Wrapper;\n                }\n                if (!fieldId) {\n                    console.warn(\"INTERNAL: Field id not found for property\", property);\n                }\n            });\n        }\n        return Wrapper;\n    })());\n\n    return wrapperRef.current;\n}\n","import React from \"react\";\nimport { FieldProps } from \"../../types\";\nimport { Box, FormControl, FormHelperText } from \"@mui/material\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { PropertyFieldBinding } from \"../PropertyFieldBinding\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { ExpandablePanel, getIconForProperty } from \"../../core\";\n\n/**\n * Array field used for custom\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function ArrayCustomShapedFieldBinding<T extends Array<any>>({\n                                                                        propertyKey,\n                                                                        value,\n                                                                        error,\n                                                                        showError,\n                                                                        isSubmitting,\n                                                                        setValue,\n                                                                        tableMode,\n                                                                        property,\n                                                                        includeDescription,\n                                                                        underlyingValueHasChanged,\n                                                                        context,\n                                                                        disabled\n                                                                    }: FieldProps<T, any, any>) {\n\n    if (!Array.isArray(property.resolvedProperties))\n        throw Error(\"ArrayCustomShapedFieldBinding misconfiguration. Property `of` not set\");\n\n    const expanded = property.expanded === undefined ? true : property.expanded;\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const title = <LabelWithIcon icon={getIconForProperty(property)}\n                                 required={property.validation?.required}\n                                 title={property.name}/>;\n\n    const body = property.resolvedProperties.map((childProperty, index) => {\n        const fieldProps = {\n            propertyKey: `${propertyKey}[${index}]`,\n            disabled,\n            property: childProperty,\n            includeDescription,\n            underlyingValueHasChanged,\n            context,\n            tableMode: false,\n            partOfArray: true,\n            autoFocus: false\n        };\n        return <Box key={`custom_shaped_array_${index}`} pb={1}>\n            <PropertyFieldBinding {...fieldProps}/>\n        </Box>;\n    });\n\n    return (\n\n        <FormControl fullWidth error={showError}>\n\n            {!tableMode && <ExpandablePanel initiallyExpanded={expanded} title={title}>\n                {body}\n            </ExpandablePanel>}\n\n            {tableMode && body}\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n            {showError && typeof error === \"string\" &&\n                <FormHelperText error={true}>{error}</FormHelperText>}\n\n        </FormControl>\n    );\n}\n","import React, { useCallback } from \"react\";\nimport {\n    FormControl,\n    FormHelperText,\n    IconButton,\n    InputLabel,\n    MenuItem,\n    Select as MuiSelect\n} from \"@mui/material\";\n\nimport ClearIcon from \"@mui/icons-material/Clear\";\n\nimport { EnumType, FieldProps } from \"../../types\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { isEnumValueDisabled } from \"../../core/util/enums\";\nimport { EnumValuesChip } from \"../../preview\";\nimport { getIconForProperty } from \"../../core\";\n\ntype SelectProps<T extends EnumType> = FieldProps<T>;\n\n/**\n * If `enumValues` are set in the string config, this field renders a select\n * where each option is a colored chip.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function SelectFieldBinding<T extends EnumType>({\n                                                           propertyKey,\n                                                           value,\n                                                           setValue,\n                                                           error,\n                                                           showError,\n                                                           disabled,\n                                                           autoFocus,\n                                                           touched,\n                                                           property,\n                                                           includeDescription\n                                                       }: SelectProps<T>) {\n\n    const enumValues = property.enumValues;\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const handleClearClick = useCallback(() => {\n        setValue(null);\n    }, [setValue]);\n\n    return (\n        <FormControl\n            fullWidth\n            error={showError}\n            disabled={disabled}\n            sx={{\n                \"& .MuiInputLabel-root\": {\n                    mt: 1 / 2,\n                    ml: 1 / 2\n                },\n                \"& .MuiInputLabel-shrink\": {\n                    mt: 2\n                }\n            }}\n        >\n\n            <InputLabel id={`${propertyKey}-select-label`}>\n                <LabelWithIcon icon={getIconForProperty(property)}\n                               required={property.validation?.required}\n                               title={property.name}/>\n            </InputLabel>\n\n            <MuiSelect\n                sx={(theme) => ({\n                    minHeight: \"64px\",\n                    borderRadius: `${theme.shape.borderRadius}px`\n                })}\n                variant={\"filled\"}\n                labelId={`${propertyKey}-select-label`}\n                autoFocus={autoFocus}\n                value={value ?? \"\"}\n                disabled={disabled}\n                disableUnderline={true}\n                endAdornment={\n                    property.clearable && <IconButton\n                        sx={{\n                            position: \"absolute\",\n                            top: \"12px\",\n                            right: \"32px\"\n                        }}\n                        onClick={handleClearClick}>\n                        <ClearIcon/>\n                    </IconButton>\n                }\n                onChange={(evt: any) => {\n                    const eventValue = evt.target.value;\n                    const newValue = eventValue\n                        ? (property.dataType === \"number\" ? parseFloat(eventValue) : eventValue)\n                        : null;\n\n                    return setValue(newValue);\n                }}\n                renderValue={(enumKey: any) => {\n                    return <EnumValuesChip\n                        enumKey={enumKey}\n                        enumValues={enumValues}\n                        small={false}/>;\n                }\n                }>\n\n                {enumValues && enumValues.map((enumConfig) => {\n                    return (\n                        <MenuItem key={`select_${propertyKey}_${enumConfig.id}`}\n                                  value={enumConfig.id}\n                                  disabled={isEnumValueDisabled(enumConfig)}>\n                            <EnumValuesChip\n                                enumKey={enumConfig.id}\n                                enumValues={enumValues}\n                                small={true}/>\n                        </MenuItem>\n                    );\n                })}\n            </MuiSelect>\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n            {showError && <FormHelperText error={true}>{error}</FormHelperText>}\n\n        </FormControl>\n    );\n}\n","import React, { useCallback } from \"react\";\nimport {\n    Checkbox,\n    FormControl,\n    FormHelperText,\n    IconButton,\n    InputLabel,\n    ListItemText,\n    MenuItem,\n    Select as MuiSelect\n} from \"@mui/material\";\n\nimport ClearIcon from \"@mui/icons-material/Clear\";\n\nimport { EnumType, FieldProps, ResolvedProperty } from \"../../types\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport {\n    enumToObjectEntries,\n    isEnumValueDisabled\n} from \"../../core/util/enums\";\nimport { ArrayEnumPreview, EnumValuesChip } from \"../../preview\";\nimport { ErrorView, getIconForProperty } from \"../../core\";\n\n/**\n * This fields renders a dropdown with multiple selection.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function ArrayEnumSelectBinding({\n                                           propertyKey,\n                                           value,\n                                           setValue,\n                                           error,\n                                           showError,\n                                           disabled,\n                                           property,\n                                           includeDescription,\n                                           autoFocus\n                                       }: FieldProps<EnumType[], any, any>) {\n\n    const of = property.of;\n    if (!of) {\n        throw Error(\"Using wrong component ArrayEnumSelect\");\n    }\n\n    if (Array.isArray(of)) {\n        throw Error(\"Using array properties instead of single one in `of` in ArrayProperty\");\n    }\n\n    if (of.dataType !== \"string\" && of.dataType !== \"number\") {\n        throw Error(\"Field misconfiguration: array field of type string or number\");\n    }\n\n    const enumValues = of.enumValues;\n    if (!enumValues) {\n        console.error(property);\n        throw Error(\"Field misconfiguration: array field of type string or number needs to have enumValues\");\n    }\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const handleClearClick = useCallback(() => {\n        setValue(null);\n    }, [setValue]);\n\n    if (enumValues instanceof Error) {\n        return <ErrorView error={enumValues.message}/>;\n    }\n\n    const validValue = !!value && Array.isArray(value);\n    return (\n        <FormControl\n            fullWidth\n            required={property.validation?.required}\n            error={showError}\n            sx={{\n                \"& .MuiInputLabel-root\": {\n                    mt: 1 / 2,\n                    ml: 1 / 2\n                },\n                \"& .MuiInputLabel-shrink\": {\n                    mt: 2\n                }\n            }}\n        >\n\n            <InputLabel id={`${propertyKey}-multiselect-label`}>\n                <LabelWithIcon icon={getIconForProperty(property)}\n                               required={property.validation?.required}\n                               title={property.name}/>\n            </InputLabel>\n\n            <MuiSelect\n                multiple\n                sx={(theme) => ({\n                    minHeight: \"64px\",\n                    borderRadius: `${theme.shape.borderRadius}px`\n                })}\n                variant={\"filled\"}\n                labelId={`${propertyKey}-multiselect-label`}\n                value={validValue ? value.map(v => v.toString()) : []}\n                autoFocus={autoFocus}\n                disabled={disabled}\n                disableUnderline={true}\n                endAdornment={\n                    of.clearable && <IconButton\n                        sx={{\n                            position: \"absolute\",\n                            top: \"12px\",\n                            right: \"32px\"\n                        }}\n                        onClick={handleClearClick}>\n                        <ClearIcon/>\n                    </IconButton>\n                }\n                onChange={(evt: any) => {\n                    let newValue;\n                    if ((of as ResolvedProperty)?.dataType === \"number\")\n                        newValue = evt.target.value ? evt.target.value.map((e: any) => parseFloat(e)) : [];\n                    else\n                        newValue = evt.target.value;\n                    return setValue(\n                        newValue\n                    );\n                }}\n                renderValue={(selected: any) => (\n                    <ArrayEnumPreview value={selected}\n                                      name={propertyKey}\n                                      enumValues={enumValues}\n                                      size={\"regular\"}/>\n                )}>\n\n                {enumToObjectEntries(enumValues)\n                    .map((enumConfig) => {\n                        const enumKey = enumConfig.id;\n                        const checked = validValue && value.map(v => v.toString()).includes(enumKey.toString());\n                        return (\n                            <MenuItem\n                                key={`form-select-${propertyKey}-${enumKey}`}\n                                value={enumKey}\n                                disabled={isEnumValueDisabled(enumConfig)}\n                                dense={true}>\n                                <Checkbox checked={checked}/>\n                                <ListItemText primary={\n                                    <EnumValuesChip\n                                        enumKey={enumKey}\n                                        enumValues={enumValues}\n                                        small={true}/>\n                                }/>\n                            </MenuItem>\n                        );\n                    })}\n            </MuiSelect>\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n            {showError && <FormHelperText error={true}>{error}</FormHelperText>}\n\n        </FormControl>\n    );\n}\n","import React, { useCallback, useMemo } from \"react\";\nimport { Box, Button, FormControl, FormHelperText } from \"@mui/material\";\nimport {\n    Entity,\n    EntityCollection,\n    EntityReference,\n    FieldProps,\n    ResolvedProperty\n} from \"../../types\";\nimport { ReferencePreview } from \"../../preview\";\nimport { FormikArrayContainer, FieldDescription, LabelWithIcon } from \"../components\";\nimport {\n    ErrorView,\n    ExpandablePanel,\n    getIconForProperty,\n    getReferenceFrom\n} from \"../../core\";\n\nimport {\n    useClearRestoreValue,\n    useNavigationContext,\n    useReferenceDialog\n} from \"../../hooks\";\n\ntype ArrayOfReferencesFieldProps = FieldProps<EntityReference[]>;\n\n/**\n * This field allows selecting multiple references.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function ArrayOfReferencesFieldBinding({\n                                                  propertyKey,\n                                                  value,\n                                                  error,\n                                                  showError,\n                                                  isSubmitting,\n                                                  tableMode,\n                                                  property,\n                                                  includeDescription,\n                                                  setValue,\n                                                  setFieldValue\n                                              }: ArrayOfReferencesFieldProps) {\n\n    const ofProperty = property.of as ResolvedProperty;\n    if (ofProperty.dataType !== \"reference\") {\n        throw Error(\"ArrayOfReferencesField expected a property containing references\");\n    }\n\n    const expanded = property.expanded === undefined ? true : property.expanded;\n    const [onHover, setOnHover] = React.useState(false);\n    const selectedEntityIds = value && Array.isArray(value) ? value.map((ref) => ref.id) : [];\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const navigationContext = useNavigationContext();\n    const collection: EntityCollection | undefined = useMemo(() => {\n        return ofProperty.path ? navigationContext.getCollection(ofProperty.path) : undefined;\n    }, [ofProperty.path]);\n\n    if (!collection) {\n        throw Error(`Couldn't find the corresponding collection for the path: ${ofProperty.path}`);\n    }\n\n    const onMultipleEntitiesSelected = useCallback((entities: Entity<any>[]) => {\n        setValue(entities.map(e => getReferenceFrom(e)));\n    }, [setValue]);\n\n    const referenceDialogController = useReferenceDialog({\n            multiselect: true,\n            path: ofProperty.path,\n            collection,\n            onMultipleEntitiesSelected,\n            selectedEntityIds,\n            forceFilter: ofProperty.forceFilter\n        }\n    );\n\n    const onEntryClick = useCallback(() => {\n        referenceDialogController.open();\n    }, [referenceDialogController]);\n\n    const buildEntry = useCallback((index: number, internalId: number) => {\n        const entryValue = value && value.length > index ? value[index] : undefined;\n        if (!entryValue)\n            return <div>Internal ERROR</div>;\n        return (\n            <div\n                onMouseEnter={() => setOnHover(true)}\n                onMouseMove={() => setOnHover(true)}\n                onMouseLeave={() => setOnHover(false)}>\n                <ReferencePreview\n                    disabled={!ofProperty.path}\n                    previewProperties={ofProperty.previewProperties}\n                    size={\"regular\"}\n                    onClick={onEntryClick}\n                    reference={entryValue}\n                    onHover={onHover}\n                />\n            </div>\n        );\n    }, [ofProperty.path, ofProperty.previewProperties, onHover, value]);\n\n    const title = (\n        <LabelWithIcon icon={getIconForProperty(property)}\n                       required={property.validation?.required}\n                       title={property.name}/>\n    );\n\n    const body = <>\n        {!collection && <ErrorView\n            error={\"The specified collection does not exist. Check console\"}/>}\n\n        {collection && <>\n\n            <FormikArrayContainer value={value}\n                                  addLabel={property.name ? \"Add reference to \" + property.name : \"Add reference\"}\n                                  name={propertyKey}\n                                  buildEntry={buildEntry}\n                                  disabled={isSubmitting}\n                                  setFieldValue={setFieldValue}\n                                  newDefaultEntry={property.of.defaultValue}/>\n\n            <Box p={1}\n                 justifyContent=\"center\"\n                 textAlign={\"left\"}>\n                <Button variant=\"outlined\"\n                        color=\"primary\"\n                        disabled={isSubmitting}\n                        onClick={onEntryClick}>\n                    Edit {property.name}\n                </Button>\n            </Box>\n        </>}\n    </>;\n\n    return (\n        <>\n            <FormControl fullWidth error={showError}>\n\n                {!tableMode &&\n                    <ExpandablePanel initiallyExpanded={expanded} title={title}>\n                        {body}\n                    </ExpandablePanel>}\n\n                {tableMode && body}\n\n                {includeDescription &&\n                    <FieldDescription property={property}/>}\n\n                {showError &&\n                    typeof error === \"string\" &&\n                    <FormHelperText error={true}>{error}</FormHelperText>}\n\n            </FormControl>\n        </>\n    );\n}\n","import {\n    EntityValues,\n    ResolvedArrayProperty,\n    ResolvedStringProperty,\n    StorageConfig,\n    UploadedFileContext\n} from \"../../types\";\nimport { randomString } from \"./strings\";\n\nexport async function resolveFilenameString<M extends object>(\n    input: string | ((context: UploadedFileContext) => Promise<string> | string),\n    storage: StorageConfig,\n    values: EntityValues<M>,\n    entityId: string,\n    path: string,\n    property: ResolvedStringProperty | ResolvedArrayProperty<string[]>,\n    file: File,\n    propertyKey: string): Promise<string> {\n    let result;\n    if (typeof input === \"function\") {\n        result = await input({\n            path,\n            entityId,\n            values,\n            property,\n            file,\n            storage,\n            propertyKey\n        });\n        if (!result)\n            console.warn(\"Storage callback returned empty result. Using default name value\")\n    } else {\n        result = replacePlaceholders(file, input, entityId, propertyKey, path);\n    }\n\n    if (!result)\n        result = randomString() + \"_\" + file.name;\n\n    return result;\n}\n\nexport function resolveStoragePathString<M extends object>(\n    input: string | ((context: UploadedFileContext) => string),\n    storage: StorageConfig,\n    values: EntityValues<M>,\n    entityId: string,\n    path: string,\n    property: ResolvedStringProperty | ResolvedArrayProperty<string[]>,\n    file: File,\n    propertyKey: string): string {\n    let result;\n    if (typeof input === \"function\") {\n        result = input({\n            path,\n            entityId,\n            values,\n            property,\n            file,\n            storage,\n            propertyKey\n        });\n        if (!result)\n            console.warn(\"Storage callback returned empty result. Using default name value\")\n    } else {\n        result = replacePlaceholders(file, input, entityId, propertyKey, path);\n    }\n\n    if (!result)\n        result = randomString() + \"_\" + file.name;\n\n    return result;\n}\n\nfunction replacePlaceholders(file: File, input: string, entityId: string, propertyKey: string, path: string) {\n    const ext = file.name.split(\".\").pop();\n    let result = input.replace(\"{entityId}\", entityId)\n        .replace(\"{propertyKey}\", propertyKey)\n        .replace(\"{rand}\", randomString())\n        .replace(\"{file}\", file.name)\n        .replace(\"{file.type}\", file.type)\n        .replace(\"{path}\", path);\n    if (ext) {\n        result = result.replace(\"{file.ext}\", ext);\n        const name = file.name.replace(`.${ext}`, \"\");\n        result = result.replace(\"{file.name}\", name)\n    }\n\n    if (!result)\n        result = randomString() + \"_\" + file.name;\n\n    return result;\n}\n","import Resizer from \"react-image-file-resizer\";\nimport equal from \"react-fast-compare\";\n\nimport {\n    EntityValues,\n    ImageCompression,\n    Property,\n    ResolvedArrayProperty,\n    ResolvedStringProperty,\n    StorageConfig,\n    StorageSource,\n    StringProperty\n} from \"../../types\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { PreviewSize } from \"../../preview\";\nimport { randomString } from \"./strings\";\nimport { resolveFilenameString, resolveStoragePathString } from \"./storage\";\n\n/**\n * Internal representation of an item in the storage\n * It can have two states, having a storagePathOrDownloadUrl set,\n * which means the file has been uploaded, and it is rendered as a preview\n * Or have a pending file being uploaded.\n */\nexport interface StorageFieldItem {\n    id: number; // generated on the fly for internal use only\n    storagePathOrDownloadUrl?: string;\n    file?: File;\n    fileName?: string;\n    metadata?: any,\n    size: PreviewSize\n}\n\nexport function useStorageUploadController<M extends object>({\n                                                                 entityId,\n                                                                 entityValues,\n                                                                 path,\n                                                                 value,\n                                                                 property,\n                                                                 propertyKey,\n                                                                 storageSource,\n                                                                 disabled,\n                                                                 onChange\n                                                             }:\n                                                                 {\n                                                                     entityId: string,\n                                                                     entityValues: EntityValues<M>,\n                                                                     value: string | string[] | null;\n                                                                     path: string,\n                                                                     propertyKey: string,\n                                                                     property: ResolvedStringProperty | ResolvedArrayProperty<string[]>,\n                                                                     storageSource: StorageSource,\n                                                                     disabled: boolean,\n                                                                     onChange: (value: string | string[] | null) => void\n                                                                 }) {\n\n    const storage: StorageConfig | undefined = property.dataType === \"string\"\n        ? property.storage\n        : property.dataType === \"array\" &&\n        (property.of as Property).dataType === \"string\"\n            ? (property.of as StringProperty).storage\n            : undefined;\n\n    const multipleFilesSupported = property.dataType === \"array\";\n\n    if (!storage)\n        throw Error(\"Storage meta must be specified\");\n\n    const metadata: Record<string, any> | undefined = storage?.metadata;\n    const size = multipleFilesSupported ? \"small\" : \"regular\";\n\n    const compression: ImageCompression | undefined = storage?.imageCompression;\n\n    const internalInitialValue: StorageFieldItem[] =\n        (multipleFilesSupported\n            ? (value ?? []) as string[]\n            : value ? [value as string] : []).map(entry => (\n            {\n                id: getRandomId(),\n                storagePathOrDownloadUrl: entry,\n                metadata,\n                size\n            }\n        ));\n\n    const [initialValue, setInitialValue] = useState<string | string[] | null>(value);\n    const [internalValue, setInternalValue] = useState<StorageFieldItem[]>(internalInitialValue);\n\n    useEffect(() => {\n        if (!equal(initialValue, value)) {\n            setInitialValue(value);\n            setInternalValue(internalInitialValue);\n        }\n    }, [internalInitialValue, value, initialValue]);\n\n    const fileNameBuilder = useCallback(async (file: File) => {\n        if (storage.fileName) {\n            const fileName = await resolveFilenameString(storage.fileName, storage, entityValues, entityId, path, property, file, propertyKey);\n            if (!fileName || fileName.length === 0) {\n                throw Error(\"You need to return a valid filename\");\n            }\n            return fileName;\n        }\n        return randomString() + \"_\" + file.name;\n    }, [entityId, entityValues, path, property, propertyKey, storage]);\n\n    const storagePathBuilder = useCallback((file: File) => {\n        return resolveStoragePathString(storage.storagePath, storage, entityValues, entityId, path, property, file, propertyKey) ?? \"/\";\n    }, [entityId, entityValues, path, property, propertyKey, storage]);\n\n    const onFileUploadComplete = useCallback(async (uploadedPath: string,\n                                                    entry: StorageFieldItem,\n                                                    metadata?: any) => {\n\n        console.debug(\"onFileUploadComplete\", uploadedPath, entry);\n\n        let uploadPathOrDownloadUrl = uploadedPath;\n        if (storage.storeUrl) {\n            uploadPathOrDownloadUrl = (await storageSource.getDownloadURL(uploadedPath)).url;\n        }\n        if (storage.postProcess) {\n            uploadPathOrDownloadUrl = await storage.postProcess(uploadPathOrDownloadUrl);\n        }\n\n        let newValue: StorageFieldItem[];\n\n        entry.storagePathOrDownloadUrl = uploadPathOrDownloadUrl;\n        entry.metadata = metadata;\n        newValue = [...internalValue];\n\n        newValue = removeDuplicates(newValue);\n        setInternalValue(newValue);\n\n        const fieldValue = newValue\n            .filter(e => !!e.storagePathOrDownloadUrl)\n            .map(e => e.storagePathOrDownloadUrl as string);\n\n        if (multipleFilesSupported) {\n            onChange(fieldValue);\n        } else {\n            onChange(fieldValue ? fieldValue[0] : null);\n        }\n    }, [internalValue, multipleFilesSupported, onChange, storage, storageSource]);\n\n    const onFilesAdded = useCallback(async (acceptedFiles: File[]) => {\n\n        if (!acceptedFiles.length || disabled)\n            return;\n\n        let newInternalValue: StorageFieldItem[];\n        if (multipleFilesSupported) {\n            newInternalValue = [...internalValue,\n                ...(await Promise.all(acceptedFiles.map(async file => {\n                    if (compression && compressionFormat(file)) {\n                        file = await resizeAndCompressImage(file, compression)\n                    }\n\n                    return {\n                        id: getRandomId(),\n                        file,\n                        fileName: await fileNameBuilder(file),\n                        metadata,\n                        size\n                    } as StorageFieldItem;\n                })))];\n        } else {\n            let file = acceptedFiles[0]\n            if (compression && compressionFormat(file)) {\n                file = await resizeAndCompressImage(file, compression)\n            }\n\n            newInternalValue = [{\n                id: getRandomId(),\n                file,\n                fileName: await fileNameBuilder(file),\n                metadata,\n                size\n            }];\n        }\n\n        // Remove either storage path or file duplicates\n        newInternalValue = removeDuplicates(newInternalValue);\n        setInternalValue(newInternalValue);\n    }, [disabled, fileNameBuilder, internalValue, metadata, multipleFilesSupported, size]);\n\n    return {\n        internalValue,\n        setInternalValue,\n        storage,\n        fileNameBuilder,\n        storagePathBuilder,\n        onFileUploadComplete,\n        onFilesAdded,\n        multipleFilesSupported\n    }\n}\n\nfunction removeDuplicates(items: StorageFieldItem[]) {\n    return items.filter(\n        (item, i) => {\n            return ((items.map((v) => v.storagePathOrDownloadUrl).indexOf(item.storagePathOrDownloadUrl) === i) || !item.storagePathOrDownloadUrl) &&\n                ((items.map((v) => v.file).indexOf(item.file) === i) || !item.file);\n        }\n    );\n}\n\nfunction getRandomId() {\n    return Math.floor(Math.random() * Math.floor(Number.MAX_SAFE_INTEGER));\n}\n\nconst supportedTypes: Record<string, string> = {\n    \"image/jpeg\": \"JPEG\",\n    \"image/png\": \"PNG\",\n    \"image/webp\": \"WEBP\"\n}\nconst compressionFormat = (file: File) => supportedTypes[file.type] ? supportedTypes[file.type] : null;\n\nconst defaultQuality = 100;\nconst resizeAndCompressImage = (file: File, compression: ImageCompression) => new Promise<File>((resolve) => {\n\n    const inputQuality = compression.quality === undefined ? defaultQuality : compression.quality;\n    const quality = inputQuality >= 0 ? inputQuality <= 100 ? inputQuality : 100 : 100;\n\n    const format = compressionFormat(file);\n    if (!format) {\n        throw Error(\"resizeAndCompressImage: Unsupported image format\");\n    }\n    Resizer.imageFileResizer(\n        file,\n        compression.maxWidth || Number.MAX_VALUE,\n        compression.maxHeight || Number.MAX_VALUE,\n        format,\n        quality,\n        0,\n        (file: string | Blob | File | ProgressEvent<FileReader>) => resolve(file as File),\n        \"file\"\n    )\n});\n","import React, { useCallback } from \"react\";\nimport { useSnackbarController, useStorageSource } from \"../../hooks\";\nimport { StorageFieldItem } from \"../../core/util/useStorageUploadController\";\nimport { Box, Paper, Skeleton } from \"@mui/material\";\nimport { ErrorView } from \"../../core\";\n\nexport interface StorageUploadItemProps {\n    storagePath: string;\n    metadata?: any,\n    entry: StorageFieldItem,\n    onFileUploadComplete: (value: string,\n                           entry: StorageFieldItem,\n                           metadata?: any) => Promise<void>;\n    imageSize: number;\n    simple: boolean;\n}\n\nexport function StorageUploadProgress({\n                                          storagePath,\n                                          entry,\n                                          metadata,\n                                          onFileUploadComplete,\n                                          imageSize,\n                                          simple\n                                      }: StorageUploadItemProps) {\n\n    const storage = useStorageSource();\n\n    const snackbarController = useSnackbarController();\n\n    const [error, setError] = React.useState<Error | undefined>();\n    const [loading, setLoading] = React.useState<boolean>(false);\n    const mounted = React.useRef(false);\n    const uploading = React.useRef(false);\n\n    const upload = useCallback((file: File, fileName?: string) => {\n\n        if (uploading.current) return;\n        uploading.current = true;\n        setError(undefined);\n        setLoading(true);\n\n        storage.uploadFile({\n            file,\n            fileName,\n            path: storagePath,\n            metadata\n        })\n            .then(async ({ path }) => {\n                console.debug(\"Upload successful\");\n                await onFileUploadComplete(path, entry, metadata);\n                if (mounted.current)\n                    setLoading(false);\n            })\n            .catch((e) => {\n                console.error(\"Upload error\", e);\n                if (mounted.current) {\n                    setError(e);\n                    setLoading(false);\n                    snackbarController.open({\n                        type: \"error\",\n                        message: \"Error uploading file: \" + e.message\n                    });\n                }\n            })\n            .finally(() => {\n                uploading.current = false;\n            });\n    }, [entry, metadata, onFileUploadComplete, storage, storagePath]);\n\n    React.useEffect(() => {\n        mounted.current = true;\n        if (entry.file)\n            upload(entry.file, entry.fileName);\n        return () => {\n            mounted.current = false;\n        };\n    }, [entry.file, entry.fileName, upload]);\n\n    if (simple) {\n        return <Box m={1} sx={{\n            width: imageSize,\n            height: imageSize\n        }}>\n\n            {loading && <Skeleton variant=\"rectangular\" sx={{\n                width: imageSize,\n                height: imageSize\n            }}/>}\n\n        </Box>\n    }\n    return (\n\n        <Box m={1}>\n            <Paper elevation={0}\n                   sx={{\n                       padding: 1,\n                       boxSizing: \"border-box\",\n                       minWidth: imageSize,\n                       minHeight: imageSize\n                   }}\n                   variant={\"outlined\"}>\n\n                {loading && <Skeleton variant=\"rectangular\" sx={{\n                    width: \"100%\",\n                    height: \"100%\"\n                }}/>}\n\n                {error && <ErrorView title={\"Error uploading file\"}\n                                     error={error}/>}\n\n            </Paper>\n        </Box>\n\n    );\n\n}\n","import React from \"react\";\n\nimport { Box, IconButton, Paper, Tooltip } from \"@mui/material\";\nimport { Entity, ResolvedStringProperty } from \"../../types\";\nimport RemoveIcon from \"@mui/icons-material/Remove\";\nimport { PreviewSize, PropertyPreview } from \"../../preview\";\n\nimport { ErrorBoundary } from \"../../core\";\n\ninterface StorageItemPreviewProps {\n    name: string;\n    property: ResolvedStringProperty;\n    value: string,\n    entity: Entity<any>,\n    onRemove: (value: string) => void;\n    size: PreviewSize;\n    disabled: boolean;\n}\n\nexport function StorageItemPreview({\n                                       name,\n                                       property,\n                                       value,\n                                       entity,\n                                       onRemove,\n                                       disabled,\n                                       size\n                                   }: StorageItemPreviewProps) {\n\n    return (\n        <Box m={1} position={\"relative\"}>\n\n            <Paper\n                elevation={0}\n                sx={{\n                    padding: 1,\n                    boxSizing: \"border-box\",\n                    minWidth: size === \"regular\" ? 220 : 118,\n                    minHeight: size === \"regular\" ? 220 : 118\n                }}\n                variant={\"outlined\"}>\n\n                {!disabled &&\n                    <Box\n                        sx={(theme) => ({\n                            position: \"absolute\",\n                            borderRadius: \"9999px\",\n                            top: -8,\n                            right: -8,\n                            zIndex: 1,\n                            backgroundColor: theme.palette.background.paper\n                        })}>\n\n                        <Tooltip\n                            title=\"Remove\">\n                            <IconButton\n                                size={\"small\"}\n                                onClick={(event) => {\n                                    event.stopPropagation();\n                                    onRemove(value);\n                                }}>\n                                <RemoveIcon fontSize={\"small\"}/>\n                            </IconButton>\n                        </Tooltip>\n                    </Box>\n                }\n\n                {value &&\n                    <ErrorBoundary>\n                        <PropertyPreview propertyKey={name}\n                                         value={value}\n                                         property={property}\n                                         entity={entity}\n                                         size={size}/>\n                    </ErrorBoundary>\n                }\n\n            </Paper>\n\n        </Box>\n    );\n\n}\n","import React, { useCallback } from \"react\";\n\nimport { styled, Theme } from \"@mui/material/styles\";\n\nimport { Box, FormControl, FormHelperText, Typography } from \"@mui/material\";\nimport {\n    ArrayProperty,\n    Entity,\n    FieldProps,\n    ResolvedArrayProperty,\n    ResolvedStringProperty,\n    StorageConfig\n} from \"../../types\";\nimport { useDropzone } from \"react-dropzone\";\nimport { PreviewSize } from \"../../preview\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\n\nimport { getIconForProperty, isReadOnly } from \"../../core\";\nimport clsx from \"clsx\";\nimport {\n    useClearRestoreValue,\n    useSnackbarController,\n    useStorageSource\n} from \"../../hooks\";\nimport { DragDropContext, Draggable, Droppable } from \"@hello-pangea/dnd\";\nimport {\n    StorageFieldItem,\n    useStorageUploadController\n} from \"../../core/util/useStorageUploadController\";\nimport { StorageUploadProgress } from \"../components/StorageUploadProgress\";\nimport { StorageItemPreview } from \"../components/StorageItemPreview\";\nimport {\n    fieldBackground,\n    fieldBackgroundHover\n} from \"../../core/util/field_colors\";\n\nconst PREFIX = \"StorageUploadField\";\n\nconst classes = {\n    dropZone: `${PREFIX}-dropZone`,\n    disabled: `${PREFIX}-disabled`,\n    nonActiveDrop: `${PREFIX}-nonActiveDrop`,\n    activeDrop: `${PREFIX}-activeDrop`,\n    acceptDrop: `${PREFIX}-acceptDrop`,\n    rejectDrop: `${PREFIX}-rejectDrop`\n};\n\nconst StyledBox = styled(Box)(({ theme }:\n                                   {\n                                       theme: Theme\n                                   }\n) => ({\n    [`&.${classes.dropZone}`]: {\n        position: \"relative\",\n        paddingTop: \"2px\",\n        border: \"2px solid transparent\",\n        minHeight: \"254px\",\n        outline: 0,\n        borderRadius: `${theme.shape.borderRadius}px`,\n        backgroundColor: fieldBackground(theme),\n        boxSizing: \"border-box\",\n        transition: \"border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms\",\n        \"&:focus\": {\n            border: `2px solid ${theme.palette.primary.main}`\n        }\n    },\n\n    [`&.${classes.disabled}`]: {\n        backgroundColor: \"rgba(0, 0, 0, 0.12)\",\n        color: theme.palette.mode === \"light\" ? \"rgba(0, 0, 0, 0.38)\" : \"rgba(255, 255, 255, 0.38)\",\n        border: `1px dotted ${theme.palette.grey[400]}`\n    },\n\n    [`&.${classes.nonActiveDrop}`]: {\n        \"&:hover\": {\n            backgroundColor: fieldBackgroundHover(theme)\n        }\n    },\n\n    [`&.${classes.activeDrop}`]: {\n        paddingTop: \"0px\",\n        boxSizing: \"border-box\",\n        border: \"2px solid\"\n    },\n\n    [`&.${classes.acceptDrop}`]: {\n        transition: \"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms\",\n        background: \"repeating-linear-gradient( 45deg, rgba(0, 0, 0, 0.09), rgba(0, 0, 0, 0.09) 10px, rgba(0, 0, 0, 0.12) 10px, rgba(0, 0, 0, 0.12) 20px) !important\",\n        border: \"2px solid\",\n        borderColor: theme.palette.success.light\n    },\n\n    [`&.${classes.rejectDrop}`]: {\n        border: \"2px solid\",\n        borderColor: theme.palette.error.light\n    }\n\n}));\n\ntype StorageUploadFieldProps = FieldProps<string | string[]>;\n\n/**\n * Field that allows to upload files to Google Cloud Storage.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function StorageUploadFieldBinding({\n                                              propertyKey,\n                                              value,\n                                              setValue,\n                                              error,\n                                              showError,\n                                              autoFocus,\n                                              tableMode,\n                                              property,\n                                              includeDescription,\n                                              context,\n                                              isSubmitting\n                                          }: StorageUploadFieldProps) {\n\n    if (!context.entityId)\n        throw new Error(\"StorageUploadFieldBinding: Entity id is null\");\n\n    const storageSource = useStorageSource();\n    const disabled = isReadOnly(property) || !!property.disabled || isSubmitting;\n\n    const {\n        internalValue,\n        setInternalValue,\n        onFilesAdded,\n        storage,\n        onFileUploadComplete,\n        storagePathBuilder,\n        multipleFilesSupported\n    } = useStorageUploadController({\n        entityValues: context.values,\n        entityId: context.entityId,\n        path: context.path,\n        property,\n        propertyKey,\n        value,\n        storageSource,\n        disabled,\n        onChange: setValue\n    });\n\n    useClearRestoreValue<string | string[]>({\n        property,\n        value,\n        setValue\n    });\n\n    const entity: Entity<any> = {\n        id: context.entityId,\n        values: context.values,\n        path: context.path\n    };\n\n    return (\n\n        <FormControl fullWidth\n                     required={property.validation?.required}\n                     error={showError}>\n\n            {!tableMode &&\n                <FormHelperText filled>\n                    <LabelWithIcon icon={getIconForProperty(property)}\n                                   required={property.validation?.required}\n                                   title={property.name}/>\n                </FormHelperText>}\n\n            <StorageUpload\n                value={internalValue}\n                name={propertyKey}\n                disabled={disabled}\n                autoFocus={autoFocus}\n                property={property}\n                onChange={setValue}\n                setInternalValue={setInternalValue}\n                onFilesAdded={onFilesAdded}\n                entity={entity}\n                onFileUploadComplete={onFileUploadComplete}\n                storagePathBuilder={storagePathBuilder}\n                storage={storage}\n                multipleFilesSupported={multipleFilesSupported}/>\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n            {showError && <FormHelperText error={true}>{error}</FormHelperText>}\n\n        </FormControl>\n    );\n}\n\nfunction FileDropComponent({\n                               storage,\n                               disabled,\n                               isDraggingOver,\n                               onFilesAdded,\n                               multipleFilesSupported,\n                               droppableProvided,\n                               autoFocus,\n                               internalValue,\n                               property,\n                               entity,\n                               onClear,\n                               metadata,\n                               storagePathBuilder,\n                               onFileUploadComplete,\n                               size,\n                               name,\n                               helpText\n                           }: {\n    storage: StorageConfig,\n    disabled: boolean,\n    isDraggingOver: boolean,\n    droppableProvided: any,\n    onFilesAdded: (acceptedFiles: File[]) => void,\n    multipleFilesSupported: boolean,\n    autoFocus: boolean,\n    internalValue: StorageFieldItem[],\n    property: ResolvedStringProperty,\n    onClear: (clearedStoragePathOrDownloadUrl: string) => void,\n    metadata: any,\n    entity: Entity<any>;\n    storagePathBuilder: (file: File) => string,\n    onFileUploadComplete: (uploadedPath: string, entry: StorageFieldItem, fileMetadata?: any) => Promise<void>,\n    size: PreviewSize,\n    name: string,\n    helpText: string\n}) {\n\n    const snackbarContext = useSnackbarController();\n\n    const {\n        getRootProps,\n        getInputProps,\n        isDragActive,\n        isDragAccept,\n        isDragReject\n    } = useDropzone({\n            accept: storage.acceptedFiles ? storage.acceptedFiles.map(e => ({ [e]: [] })).reduce((a, b) => ({ ...a, ...b }), {}) : undefined,\n            disabled: disabled || isDraggingOver,\n            noDragEventsBubbling: true,\n            maxSize: storage.maxSize,\n            onDrop: onFilesAdded,\n            onDropRejected: (fileRejections, event) => {\n                for (const fileRejection of fileRejections) {\n                    for (const error of fileRejection.errors) {\n                        snackbarContext.open({\n                            type: \"error\",\n                            message: `Error uploading file: File is larger than ${storage.maxSize} bytes`\n                        });\n                    }\n                }\n            }\n        }\n    );\n\n    return (\n        <StyledBox\n            {...getRootProps()}\n            className={clsx(classes.dropZone, {\n                [classes.nonActiveDrop]: !isDragActive,\n                [classes.activeDrop]: isDragActive,\n                [classes.rejectDrop]: isDragReject,\n                [classes.acceptDrop]: isDragAccept,\n                [classes.disabled]: disabled\n            })}\n            sx={{\n                display: multipleFilesSupported && internalValue.length ? undefined : \"flex\",\n                alignItems: \"center\"\n            }}\n        >\n            <Box\n                {...droppableProvided.droppableProps}\n                ref={droppableProvided.innerRef}\n                sx={{\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    overflow: multipleFilesSupported && internalValue.length ? \"auto\" : undefined,\n                    minHeight: multipleFilesSupported && internalValue.length ? 180 : 250,\n                    p: 1,\n                    \"&::-webkit-scrollbar\": {\n                        display: \"none\"\n                    }\n                }}\n            >\n\n                <input\n                    autoFocus={autoFocus}\n                    {...getInputProps()} />\n\n                {internalValue.map((entry, index) => {\n                    let child: any;\n                    if (entry.storagePathOrDownloadUrl) {\n                        child = (\n                            <StorageItemPreview\n                                name={`storage_preview_${entry.storagePathOrDownloadUrl}`}\n                                property={property}\n                                disabled={disabled}\n                                entity={entity}\n                                value={entry.storagePathOrDownloadUrl}\n                                onRemove={onClear}\n                                size={entry.size}/>\n                        );\n                    } else if (entry.file) {\n                        child = (\n                            <StorageUploadProgress\n                                entry={entry}\n                                metadata={metadata}\n                                storagePath={storagePathBuilder(entry.file)}\n                                onFileUploadComplete={onFileUploadComplete}\n                                imageSize={size === \"regular\" ? 220 : 118}\n                                simple={false}\n                            />\n                        );\n                    }\n\n                    return (\n                        <Draggable\n                            key={`array_field_${name}_${entry.id}`}\n                            draggableId={`array_field_${name}_${entry.id}`}\n                            index={index}>\n                            {(provided, snapshot) => (\n                                <Box\n                                    ref={provided.innerRef}\n                                    {...provided.draggableProps}\n                                    {...provided.dragHandleProps}\n                                    style={\n                                        provided.draggableProps.style\n                                    }\n                                    sx={theme => ({\n                                        borderRadius: `${theme.shape.borderRadius}px`\n                                    })}\n                                >\n                                    {child}\n                                </Box>\n                            )}\n                        </Draggable>\n                    );\n                })\n                }\n\n                {droppableProvided.placeholder}\n\n            </Box>\n\n            <Box\n                sx={{\n                    flexGrow: 1,\n                    minHeight: 38,\n                    boxSizing: \"border-box\",\n                    m: 2\n                }}>\n                <Typography align={\"center\"}\n                            variant={\"label\"}>\n                    {helpText}\n                </Typography>\n            </Box>\n\n        </StyledBox>\n    );\n}\n\nexport interface StorageUploadProps {\n    value: StorageFieldItem[];\n    setInternalValue: (v: StorageFieldItem[]) => void;\n    name: string;\n    property: ResolvedStringProperty | ResolvedArrayProperty<string[]>;\n    onChange: (value: string | string[] | null) => void;\n    multipleFilesSupported: boolean;\n    autoFocus: boolean;\n    disabled: boolean;\n    entity: Entity<any>;\n    storage: StorageConfig;\n    onFilesAdded: (acceptedFiles: File[]) => void;\n    storagePathBuilder: (file: File) => string;\n    onFileUploadComplete: (uploadedPath: string, entry: StorageFieldItem, fileMetadata?: any) => Promise<void>;\n}\n\nexport function StorageUpload({\n                                  property,\n                                  name,\n                                  value,\n                                  setInternalValue,\n                                  onChange,\n                                  multipleFilesSupported,\n                                  onFileUploadComplete,\n                                  disabled,\n                                  onFilesAdded,\n                                  autoFocus,\n                                  storage,\n                                  entity,\n                                  storagePathBuilder\n                              }: StorageUploadProps) {\n\n    if (multipleFilesSupported) {\n        const arrayProperty = property as ResolvedArrayProperty<string[]>;\n        if (arrayProperty.of) {\n            if (Array.isArray(arrayProperty.of)) {\n                throw Error(\"Storage field using array must be of data type string\");\n            }\n            if (arrayProperty.of.dataType !== \"string\") {\n                throw Error(\"Storage field using array must be of data type string\");\n            }\n        } else {\n            throw Error(\"Storage field using array must be of data type string\");\n        }\n    }\n\n    const metadata: Record<string, unknown> | undefined = storage?.metadata;\n    const size = multipleFilesSupported ? \"small\" : \"regular\";\n\n    const moveItem = useCallback((fromIndex: number, toIndex: number) => {\n        if (!multipleFilesSupported) return;\n        const newValue = [...value];\n        const item = newValue[fromIndex];\n        newValue.splice(fromIndex, 1);\n        newValue.splice(toIndex, 0, item);\n        setInternalValue(newValue);\n        const fieldValue = newValue\n            .filter(e => !!e.storagePathOrDownloadUrl)\n            .map(e => e.storagePathOrDownloadUrl as string);\n        onChange(fieldValue);\n    }, [multipleFilesSupported, onChange, setInternalValue, value]);\n\n    const onDragEnd = useCallback((result: any) => {\n        // dropped outside the list\n        if (!result.destination) {\n            return;\n        }\n\n        moveItem(result.source.index, result.destination.index);\n\n    }, [moveItem])\n\n    const onClear = useCallback((clearedStoragePathOrDownloadUrl: string) => {\n        if (multipleFilesSupported) {\n            const newValue: StorageFieldItem[] = value.filter(v => v.storagePathOrDownloadUrl !== clearedStoragePathOrDownloadUrl);\n            onChange(newValue.filter(v => !!v.storagePathOrDownloadUrl).map(v => v.storagePathOrDownloadUrl as string));\n            setInternalValue(newValue);\n        } else {\n            onChange(null);\n            setInternalValue([]);\n        }\n    }, [value, multipleFilesSupported, onChange]);\n\n    const helpText = multipleFilesSupported\n        ? \"Drag 'n' drop some files here, or click to select files\"\n        : \"Drag 'n' drop a file here, or click to select one\";\n\n    const renderProperty: ResolvedStringProperty = multipleFilesSupported\n        ? (property as ArrayProperty<string[]>).of as ResolvedStringProperty\n        : property as ResolvedStringProperty;\n\n    return (\n        <DragDropContext onDragEnd={onDragEnd}>\n            <Droppable\n                droppableId={`droppable_${name}`}\n                direction=\"horizontal\"\n                renderClone={(provided, snapshot, rubric) => {\n                    const entry = value[rubric.source.index];\n                    return (\n                        <Box\n                            ref={provided.innerRef}\n                            {...provided.draggableProps}\n                            {...provided.dragHandleProps}\n                            style={\n                                provided.draggableProps.style\n                            }\n                            sx={theme => ({\n                                borderRadius: theme.shape.borderRadius\n                            })}\n                        >\n                            <StorageItemPreview\n                                name={`storage_preview_${entry.storagePathOrDownloadUrl}`}\n                                property={renderProperty}\n                                disabled={true}\n                                entity={entity}\n                                value={entry.storagePathOrDownloadUrl as string}\n                                onRemove={onClear}\n                                size={entry.size}/>\n                        </Box>\n                    );\n                }}\n            >\n                {(provided, snapshot) => {\n                    return <FileDropComponent storage={storage}\n                                              disabled={disabled}\n                                              isDraggingOver={snapshot.isDraggingOver}\n                                              droppableProvided={provided}\n                                              onFilesAdded={onFilesAdded}\n                                              multipleFilesSupported={multipleFilesSupported}\n                                              autoFocus={autoFocus}\n                                              internalValue={value}\n                                              property={renderProperty}\n                                              entity={entity}\n                                              onClear={onClear}\n                                              metadata={metadata}\n                                              storagePathBuilder={storagePathBuilder}\n                                              onFileUploadComplete={onFileUploadComplete}\n                                              size={size}\n                                              name={name}\n                                              helpText={helpText}/>\n                }}\n            </Droppable>\n        </DragDropContext>\n    );\n\n}\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport {\n    unstable_debounce as debounce,\n    unstable_ownerWindow as ownerWindow,\n    unstable_useEnhancedEffect as useEnhancedEffect,\n    unstable_useForkRef as useForkRef\n} from \"@mui/utils\";\n\ntype State = {\n    outerHeightStyle: number;\n    overflow?: boolean | undefined;\n};\n\nfunction getStyleValue(value: string) {\n    return parseInt(value, 10) || 0;\n}\n\nconst styles: {\n    shadow: React.CSSProperties;\n} = {\n    shadow: {\n        // Visibility needed to hide the extra text area on iPads\n        visibility: \"hidden\",\n        // Remove from the content flow\n        position: \"absolute\",\n        // Ignore the scrollbar width\n        overflow: \"hidden\",\n        height: 0,\n        top: 0,\n        left: 0,\n        // Create a new layer, increase the isolation of the computed values\n        transform: \"translateZ(0)\"\n    }\n};\n\nfunction isEmpty(obj: State) {\n    return (\n        obj === undefined ||\n        obj === null ||\n        Object.keys(obj).length === 0 ||\n        (obj.outerHeightStyle === 0 && !obj.overflow)\n    );\n}\n\nexport const TextareaAutosize = React.forwardRef(function TextareaAutosize(\n    props: TextareaAutosizeProps,\n    ref: React.ForwardedRef<Element>\n) {\n    const {\n        onChange,\n        onScroll,\n        onResize,\n        maxRows,\n        minRows = 1,\n        style,\n        value,\n        onFocus,\n        onBlur,\n        sizeRef,\n        ...other\n    } = props;\n\n    const { current: isControlled } = React.useRef(value != null);\n    const inputRef = React.useRef<HTMLInputElement>(null);\n    const handleRef = useForkRef(ref, inputRef);\n    const shadowRef = React.useRef<HTMLTextAreaElement>(null);\n    const renders = React.useRef(0);\n    const [state, setState] = React.useState<State>({\n        outerHeightStyle: 0\n    });\n\n    const getUpdatedState = React.useCallback(() => {\n\n        const input = inputRef.current!;\n\n        const containerWindow = ownerWindow(input);\n        const computedStyle = containerWindow.getComputedStyle(input);\n\n        // If input's width is shrunk and it's not visible, don't sync height.\n        if (computedStyle.width === \"0px\") {\n            return {\n                outerHeightStyle: 0\n            };\n        }\n\n        const sizeReferenceElement = sizeRef?.current ?? shadowRef.current!;\n        const inputShallow = shadowRef.current!;\n\n        sizeReferenceElement.style.width = computedStyle.width;\n        inputShallow.value = input.value || props.placeholder || \"x\";\n        if (inputShallow.value.slice(-1) === \"\\n\") {\n            // Certain fonts which overflow the line height will cause the textarea\n            // to report a different scrollHeight depending on whether the last line\n            // is empty. Make it non-empty to avoid this issue.\n            inputShallow.value += \" \";\n        }\n\n        const boxSizing = computedStyle.boxSizing;\n        const padding =\n            getStyleValue(computedStyle.paddingBottom) + getStyleValue(computedStyle.paddingTop);\n        const border =\n            getStyleValue(computedStyle.borderBottomWidth) + getStyleValue(computedStyle.borderTopWidth);\n\n        // The height of the inner content\n        const innerHeight = sizeReferenceElement.scrollHeight;\n\n        // Measure height of a textarea with a single row\n        inputShallow.value = \"x\";\n        const singleRowHeight = sizeReferenceElement.scrollHeight;\n\n        // The height of the outer content\n        let outerHeight = innerHeight;\n\n        if (minRows) {\n            outerHeight = Math.max(Number(minRows) * singleRowHeight, outerHeight);\n        }\n        if (maxRows) {\n            outerHeight = Math.min(Number(maxRows) * singleRowHeight, outerHeight);\n        }\n        outerHeight = Math.max(outerHeight, singleRowHeight);\n\n        // Take the box sizing into account for applying this value as a style.\n        const outerHeightStyle = outerHeight + (boxSizing === \"border-box\" ? padding + border : 0);\n        const overflow = Math.abs(outerHeight - innerHeight) <= 1;\n\n        return { outerHeightStyle, overflow };\n    }, [maxRows, minRows, props.placeholder]);\n\n    const updateState = (prevState: State, newState: State) => {\n        const { outerHeightStyle, overflow } = newState;\n        // Need a large enough difference to update the height.\n        // This prevents infinite rendering loop.\n        if (\n            renders.current < 20 &&\n            ((outerHeightStyle > 0 &&\n                    Math.abs((prevState.outerHeightStyle || 0) - outerHeightStyle) > 1) ||\n                prevState.overflow !== overflow)\n        ) {\n            renders.current += 1;\n            return {\n                overflow,\n                outerHeightStyle\n            };\n        }\n        if (process.env.NODE_ENV !== \"production\") {\n            if (renders.current === 20) {\n                console.error(\n                    [\n                        \"MUI: Too many re-renders. The layout is unstable.\",\n                        \"TextareaAutosize limits the number of renders to prevent an infinite loop.\"\n                    ].join(\"\\n\")\n                );\n            }\n        }\n        return prevState;\n    };\n\n    const syncHeight = React.useCallback(() => {\n        const newState = getUpdatedState();\n\n        if (isEmpty(newState)) {\n            return;\n        }\n        if (onResize) {\n            onResize(newState);\n        }\n\n        setState((prevState) => {\n            return updateState(prevState, newState);\n        });\n    }, [getUpdatedState, onResize]);\n\n    const syncHeightWithFlushSync = () => {\n        const newState = getUpdatedState();\n\n        if (isEmpty(newState)) {\n            return;\n        }\n\n        // In React 18, state updates in a ResizeObserver's callback are happening after the paint which causes flickering\n        // when doing some visual updates in it. Using flushSync ensures that the dom will be painted after the states updates happen\n        // Related issue - https://github.com/facebook/react/issues/24331\n        ReactDOM.flushSync(() => {\n            setState((prevState) => {\n                return updateState(prevState, newState);\n            });\n        });\n    };\n\n    React.useEffect(() => {\n        const handleResize = debounce(() => {\n            renders.current = 0;\n\n            // If the TextareaAutosize component is replaced by Suspense with a fallback, the last\n            // ResizeObserver's handler that runs because of the change in the layout is trying to\n            // access a dom node that is no longer there (as the fallback component is being shown instead).\n            // See https://github.com/mui/material-ui/issues/32640\n            if (inputRef.current) {\n                syncHeightWithFlushSync();\n            }\n        });\n        let resizeObserver: ResizeObserver;\n\n        const input = inputRef.current!;\n        const containerWindow = ownerWindow(input);\n\n        containerWindow.addEventListener(\"resize\", handleResize);\n\n        if (typeof ResizeObserver !== \"undefined\") {\n            resizeObserver = new ResizeObserver(handleResize);\n            resizeObserver.observe(input);\n        }\n\n        return () => {\n            handleResize.clear();\n            containerWindow.removeEventListener(\"resize\", handleResize);\n            if (resizeObserver) {\n                resizeObserver.disconnect();\n            }\n        };\n    });\n\n    useEnhancedEffect(() => {\n        syncHeight();\n    });\n\n    React.useEffect(() => {\n        renders.current = 0;\n    }, [value]);\n\n    const handleChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n        renders.current = 0;\n\n        if (!isControlled) {\n            syncHeight();\n        }\n\n        if (onChange) {\n            onChange(event);\n        }\n    };\n\n    return (\n        <React.Fragment>\n            <textarea\n                value={value}\n                onChange={handleChange}\n                ref={handleRef}\n                onFocus={onFocus}\n                onBlur={onBlur}\n                // Apply the rows prop to get a \"correct\" first SSR paint\n                rows={minRows as number}\n                style={{\n                    height: state.outerHeightStyle,\n                    // Need a large enough difference to allow scrolling.\n                    // This prevents infinite rendering loop.\n                    overflow: state.overflow ? \"hidden\" : undefined,\n                    ...style\n                }}\n                onScroll={onScroll}\n                {...other}\n            />\n            <textarea\n                aria-hidden\n                className={props.className}\n                readOnly\n                ref={shadowRef}\n                tabIndex={-1}\n                style={{\n                    ...styles.shadow,\n                    ...style,\n                    padding: 0\n                }}\n            />\n        </React.Fragment>\n    );\n});\n\nexport interface TextareaAutosizeProps {\n    /**\n     * @ignore\n     */\n    className?: string;\n\n    onFocus?: React.FocusEventHandler<HTMLTextAreaElement>;\n\n    onBlur?: React.FocusEventHandler<HTMLTextAreaElement>;\n\n    /**\n     * Maximum number of rows to display.\n     */\n    maxRows?: number | string;\n    /**\n     * Minimum number of rows to display.\n     * @default 1\n     */\n    minRows?: number | string;\n    /**\n     * @ignore\n     */\n    onChange?: (event: React.ChangeEvent<HTMLTextAreaElement>) => void;\n    /**\n     * @ignore\n     */\n    placeholder?: string;\n    /**\n     * @ignore\n     */\n    style?: object;\n    /**\n     * @ignore\n     */\n    value?: string[] | number | string;\n\n    sizeRef?: React.RefObject<HTMLDivElement>;\n\n    onScroll?: (event: React.UIEvent<HTMLTextAreaElement>) => void;\n\n    onResize?: (state: State) => void;\n\n    autoFocus?: boolean;\n}\n","import React from \"react\";\n\nimport { Box, InputLabel, Typography } from \"@mui/material\";\nimport { fieldBackgroundDisabled } from \"../../util/field_colors\";\n\nexport function DisabledTextField<T extends string | number>({\n                                                                 label,\n                                                                 small,\n                                                                 value\n                                                             }: {\n    label: React.ReactNode,\n    small?: boolean,\n    value: T\n}) {\n    return <Box sx={theme => ({\n        position: \"relative\",\n        background: fieldBackgroundDisabled,\n        borderRadius: `${theme.shape.borderRadius}px`,\n        maxWidth: \"100%\",\n        minHeight: small ? \"48px\" : \"64px\",\n        color: theme.palette.text.disabled\n    })}>\n        <InputLabel\n            shrink={Boolean(value)}\n            sx={{\n                position: \"absolute\",\n                color: theme => theme.palette.text.disabled,\n                left: 0,\n                top: \"4px\",\n                pointerEvents: \"none\"\n            }}\n            variant={\"filled\"}>{label}</InputLabel>\n        <Box sx={{\n            padding: label ? \"32px 12px 8px 12px\" : (small ? \"12px\" : \"8px 12px 8px 12px\"),\n            overflow: \"auto\"\n        }}>\n            <Typography variant={\"body1\"}\n                        sx={{\n                            fontFamily: \"inherit\"\n                        }}>{value}</Typography>\n        </Box>\n    </Box>;\n}\n","import React, { useCallback, useRef } from \"react\";\nimport { styled } from \"@mui/system\";\n\nimport { Box, InputLabel } from \"@mui/material\";\nimport { TextareaAutosize } from \"./TextareaAutosize\";\nimport { DisabledTextField } from \"./DisabledTextField\";\nimport { fieldBackground, fieldBackgroundHover } from \"../../util/field_colors\";\n\nexport type InputType = \"text\" | \"number\";\n\nexport function TextInput<T extends string | number>({\n                                                         value,\n                                                         onChange,\n                                                         label,\n                                                         inputType = \"text\",\n                                                         multiline = false,\n                                                         disabled,\n                                                         error,\n                                                         endAdornment,\n                                                         autoFocus,\n                                                         placeholder,\n                                                         small\n                                                     }: {\n    inputType?: InputType,\n    value: T,\n    onChange?: (event: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => void,\n    label?: React.ReactNode,\n    multiline?: boolean,\n    disabled?: boolean,\n    error?: boolean,\n    endAdornment?: React.ReactNode,\n    autoFocus?: boolean,\n    placeholder?: string,\n    small?: boolean\n}) {\n\n    const inputRef = useRef(null);\n    const [focused, setFocused] = React.useState(document.activeElement === inputRef.current);\n\n    const hasValue = value !== undefined && value !== null && value !== \"\";\n\n    const numberInputOnWheelPreventChange = useCallback((e: any) => {\n        e.target.blur()\n        e.stopPropagation()\n        setTimeout(() => {\n            e.target.focus()\n        }, 0)\n    }, []);\n\n    if (disabled) {\n        return <DisabledTextField label={label}\n                                  small={small}\n                                  value={value}/>\n    }\n\n    const input = multiline\n        ? <StyledTextArea ref={inputRef}\n                          placeholder={placeholder}\n                          autoFocus={autoFocus}\n                          onFocus={() => setFocused(true)}\n                          onBlur={() => setFocused(false)}\n                          value={value ?? \"\"}\n                          onChange={onChange}/>\n        : <StyledInput ref={inputRef}\n                       onWheel={inputType === \"number\" ? numberInputOnWheelPreventChange : undefined}\n                       sx={{\n                           padding: label ? \"32px 12px 8px 12px\" : \"8px 12px 8px 12px\",\n                       }}\n                       small={small ?? false}\n                       placeholder={placeholder}\n                       autoFocus={autoFocus}\n                       onFocus={() => setFocused(true)}\n                       onBlur={() => setFocused(false)}\n                       type={inputType}\n                       value={Number.isNaN(value) ? \"\" : (value ?? \"\")}\n                       onChange={onChange}/>;\n\n    const inner = endAdornment\n        ? <Box sx={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"space-between\"\n        }}>\n            {input}\n            <Box sx={{\n                mr: 2,\n                my: 1\n            }}>{endAdornment}</Box>\n        </Box>\n        : input;\n\n    return (\n        <Box\n            sx={theme => ({\n                position: \"relative\",\n                background: fieldBackground(theme),\n                borderRadius: `${theme.shape.borderRadius}px`,\n                maxWidth: \"100%\",\n                minHeight: small ? \"48px\" : \"64px\",\n                \"&:hover\": {\n                    backgroundColor: fieldBackgroundHover(theme)\n                }\n            })}>\n            <InputLabel\n                shrink={hasValue || focused}\n                sx={{\n                    position: \"absolute\",\n                    left: 0,\n                    top: \"4px\",\n                    pointerEvents: \"none\",\n                    color: theme => (!error ? (focused ? theme.palette.primary.main : undefined) : theme.palette.error.main)\n                }}\n                variant={\"filled\"}>{label}</InputLabel>\n\n            {inner}\n        </Box>\n    );\n}\n\nconst StyledInput = styled(\"input\")(({ small }: {\n    small: boolean\n}) => ({\n    width: \"100%\",\n    outlineWidth: 0,\n    minHeight: small ? \"48px\" : \"64px\",\n    fontSize: \"16px\",\n    padding: \"32px 12px 8px 12px\",\n    font: \"inherit\",\n    letterSpacing: \"inherit\",\n    color: \"currentcolor\",\n    border: \"0px\",\n    background: \"none\",\n    height: \"1.4375em\",\n    margin: \"0px\",\n    WebkitTapHighlightColor: \"transparent\",\n    display: \"block\",\n    minWidth: \"0px\",\n    animationName: \"mui-auto-fill-cancel\",\n    animationDuration: \"10ms\",\n    \"&::-webkit-inner-spin-button\": {\n        WebkitAppearance: \"none\",\n        margin: 0\n    }\n}));\n\nconst StyledTextArea = styled(TextareaAutosize)({\n    width: \"100%\",\n    outlineWidth: 0,\n    resize: \"none\",\n    minHeight: \"64px\",\n    fontSize: \"16px\",\n    padding: \"32px 12px 8px 12px\",\n    font: \"inherit\",\n    letterSpacing: \"inherit\",\n    color: \"currentcolor\",\n    border: \"0px\",\n    background: \"none\",\n    height: \"1.4375em\",\n    margin: \"0px\",\n    WebkitTapHighlightColor: \"transparent\",\n    display: \"block\",\n    minWidth: \"0px\",\n    animationName: \"mui-auto-fill-cancel\",\n    animationDuration: \"10ms\"\n});\n","import React, { useCallback } from \"react\";\nimport {\n    Box,\n    Collapse,\n    FormControlLabel,\n    FormHelperText,\n    IconButton,\n    Switch,\n    Typography\n} from \"@mui/material\";\n\nimport ClearIcon from \"@mui/icons-material/Clear\";\n\nimport { FieldProps, PreviewType } from \"../../types\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { getIconForProperty } from \"../../core\";\nimport { TextInput } from \"../../core/components/fields/TextInput\";\nimport { PropertyPreview } from \"../../preview\";\n\ninterface TextFieldProps<T extends string | number> extends FieldProps<T> {\n    allowInfinity?: boolean\n}\n\n/**\n * Generic text field.\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function TextFieldBinding<T extends string | number>({\n                                                                propertyKey,\n                                                                value,\n                                                                setValue,\n                                                                error,\n                                                                showError,\n                                                                disabled,\n                                                                autoFocus,\n                                                                property,\n                                                                includeDescription,\n                                                                allowInfinity\n                                                            }: TextFieldProps<T>) {\n\n    let multiline: boolean | undefined;\n    let url: boolean | PreviewType | undefined;\n    if (property.dataType === \"string\") {\n        multiline = property.multiline;\n        url = property.url;\n    }\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const handleClearClick = useCallback(() => {\n        setValue(null);\n    }, [setValue]);\n\n    const onChange = (event: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n        if (inputType === \"number\") {\n            const numberValue = event.target.value ? parseFloat(event.target.value) : undefined;\n            if (numberValue && isNaN(numberValue)) {\n                setValue(null);\n            } else if (numberValue !== undefined && numberValue !== null) {\n                setValue(numberValue as T);\n            } else {\n                setValue(null);\n            }\n        } else {\n            setValue(event.target.value as T);\n        }\n    };\n\n    const isMultiline = Boolean(multiline);\n\n    const internalValue = value ?? (property.dataType === \"string\" ? \"\" : value === 0 ? 0 : \"\");\n\n    const valueIsInfinity = internalValue === Infinity;\n    const inputType = !valueIsInfinity && property.dataType === \"number\" ? \"number\" : undefined;\n\n    return (\n        <>\n            <TextInput\n                value={value}\n                onChange={onChange}\n                autoFocus={autoFocus}\n                label={<LabelWithIcon icon={getIconForProperty(property)}\n                                      required={property.validation?.required}\n                                      title={property.name}/>}\n                inputType={inputType}\n                multiline={isMultiline}\n                disabled={disabled}\n                endAdornment={\n                    property.clearable && <IconButton\n                        onClick={handleClearClick}>\n                        <ClearIcon/>\n                    </IconButton>\n                }\n                error={showError ? error : undefined}/>\n\n            {((showError && error) ||\n                    (includeDescription && (property.description || property.longDescription)) ||\n                    allowInfinity) &&\n                <Box display={\"flex\"}\n                     sx={{ marginLeft: \"14px\" }}\n                >\n\n                    <Box flexGrow={1}>\n                        {showError && <FormHelperText\n                            error={true}>{error}</FormHelperText>}\n\n                        {includeDescription &&\n                            <FieldDescription property={property}/>}\n                    </Box>\n                </Box>}\n\n            {url && <Collapse\n                sx={{\n                    marginTop: 1,\n                    marginLeft: 1\n                }}\n                in={Boolean(value)}\n                appear={true}\n                timeout={500}>\n                <PropertyPreview value={value}\n                                 property={property}\n                                 size={\"regular\"}/>\n            </Collapse>}\n\n        </>\n    );\n\n}\n","import React, { useState } from \"react\";\nimport { FormControl, FormControlLabel, Switch } from \"@mui/material\";\nimport { fieldBackground, fieldBackgroundHover } from \"../../util/field_colors\";\n\ntype BooleanSwitchProps = {\n    value: boolean,\n    position?: \"start\" | \"end\",\n    onChange?: (event: React.ChangeEvent<HTMLInputElement>) => void,\n    label?: React.ReactNode,\n    disabled?: boolean,\n    error?: boolean,\n    autoFocus?: boolean,\n    small?: boolean,\n};\n\n/**\n * Simple boolean switch.\n *\n */\nexport const BooleanSwitch = React.forwardRef(function SwitchFieldBinding({\n                                                                              value,\n                                                                              position = \"end\",\n                                                                              onChange,\n                                                                              error,\n                                                                              label,\n                                                                              autoFocus,\n                                                                              disabled,\n                                                                              small,\n                                                                          }: BooleanSwitchProps, ref) {\n\n    const [focus, setFocus] = useState<boolean>(autoFocus ?? false);\n    return (\n        <>\n            <FormControl fullWidth>\n\n                <FormControlLabel\n                    sx={theme => ({\n                        color: error ? theme.palette.error.main : (focus ? theme.palette.primary.main : theme.palette.text.secondary),\n                        justifyContent: \"space-between\",\n                        margin: 0,\n                        width: \"100%\",\n                        minHeight: small ? \"48px\" : \"64px\",\n                        paddingLeft: small ? \"8px\" : \"16px\",\n                        paddingRight: small ? \"16px\" : \"24px\",\n                        boxSizing: \"border-box\",\n                        position: \"relative\",\n                        display: \"inline-flex\",\n                        alignItems: \"center\",\n                        flexDirection: position === \"end\" ? \"row-reverse\" : \"row\",\n                        backgroundColor: fieldBackground(theme),\n                        borderRadius: `${theme.shape.borderRadius}px`,\n                        transition: \"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms\",\n                        \"&:hover\": {\n                            backgroundColor: fieldBackgroundHover(theme)\n                        }\n                    })}\n                    onClick={(e) => setFocus(true)}\n                    labelPlacement={\"start\"}\n                    checked={Boolean(value)}\n                    inputRef={ref}\n                    control={\n                        <Switch\n                            size={small ? \"small\" : \"medium\"}\n                            type={\"checkbox\"}\n                            color={\"secondary\"}\n                            autoFocus={autoFocus}\n                            disabled={disabled}\n                            onFocus={(e) => setFocus(true)}\n                            onBlur={(e) => setFocus(false)}\n                            onChange={(evt) => {\n                                setFocus(true);\n                                onChange?.(evt);\n                            }}/>\n                    }\n                    disabled={disabled}\n                    label={label}\n                />\n\n            </FormControl>\n\n        </>\n\n    );\n});\n","import React from \"react\";\nimport { Box, FormHelperText } from \"@mui/material\";\n\nimport { FieldProps } from \"../../types\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { getIconForProperty } from \"../../core\";\nimport { BooleanSwitch } from \"../../core/components/fields/BooleanSwitch\";\n\ntype SwitchFieldProps = FieldProps<boolean>;\n\n/**\n * Simple boolean switch biding to a boolean property.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport const SwitchFieldBinding = React.forwardRef(function SwitchFieldBinding({\n                                                                                   propertyKey,\n                                                                                   value,\n                                                                                   setValue,\n                                                                                   error,\n                                                                                   showError,\n                                                                                   autoFocus,\n                                                                                   disabled,\n                                                                                   touched,\n                                                                                   property,\n                                                                                   includeDescription\n                                                                               }: SwitchFieldProps, ref) {\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    return (\n        <>\n\n            <BooleanSwitch\n                value={value}\n                onChange={(e) => setValue(e.target.checked)}\n                error={showError}\n                label={<LabelWithIcon icon={getIconForProperty(property)}\n                                      required={property.validation?.required}\n                                      title={property.name}/>}\n                disabled={disabled}\n                autoFocus={autoFocus}\n                small={false}\n            />\n\n            {((showError && error) ||\n                    (includeDescription && (property.description || property.longDescription))) &&\n                <Box display={\"flex\"}\n                     sx={{ marginLeft: \"14px\" }}\n                >\n                    {includeDescription &&\n                        <FieldDescription property={property}/>}\n\n                    {showError &&\n                        <FormHelperText error={true}>{error}</FormHelperText>}\n                </Box>}\n        </>\n\n    );\n});\n","import React, { useCallback } from \"react\";\n\nimport { Box, IconButton, TextField as MuiTextField } from \"@mui/material\";\nimport { DatePicker } from \"@mui/x-date-pickers/DatePicker\";\nimport { DateTimePicker } from \"@mui/x-date-pickers/DateTimePicker\";\nimport ClearIcon from \"@mui/icons-material/Clear\";\n\nimport { FieldProps } from \"../../types\";\n\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { getIconForProperty } from \"../../core\";\nimport {\n    fieldBackground,\n    fieldBackgroundHover\n} from \"../../core/util/field_colors\";\n\ntype DateTimeFieldProps = FieldProps<Date>;\n\n/**\n * Field that allows selecting a date\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function DateTimeFieldBinding({\n                                         propertyKey,\n                                         value,\n                                         setValue,\n                                         autoFocus,\n                                         error,\n                                         showError,\n                                         disabled,\n                                         touched,\n                                         property,\n                                         includeDescription\n                                     }: DateTimeFieldProps) {\n\n    const internalValue = value || null;\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const handleClearClick = useCallback(() => {\n        setValue(null);\n    }, [setValue]);\n\n    const PickerComponent = property.mode === undefined || property.mode === \"date_time\"\n        ? DateTimePicker\n        : DatePicker;\n\n    return (\n        <>\n\n            <PickerComponent\n                autoFocus={autoFocus}\n                value={internalValue}\n                renderInput={(params) =>\n                    (\n                        <MuiTextField {...params}\n                                      fullWidth\n                                      sx={(theme) => ({\n                                          minHeight: \"64px\",\n                                          borderRadius: `${theme.shape.borderRadius}px`,\n                                          backgroundColor: fieldBackground(theme),\n                                          \"&:hover\": {\n                                              backgroundColor: fieldBackgroundHover(theme)\n                                          }\n                                      })}\n                                      label={\n                                          <LabelWithIcon\n                                              icon={getIconForProperty(property)}\n                                              required={property.validation?.required}\n                                              title={property.name}/>\n                                      }\n                                      InputProps={{\n                                          ...params.InputProps,\n                                          sx: (theme) => ({\n                                              minHeight: \"64px\",\n                                              borderRadius: `${theme.shape.borderRadius}px`,\n                                              backgroundColor: fieldBackground(theme),\n                                              \"&:hover\": {\n                                                  backgroundColor: fieldBackgroundHover(theme)\n                                              }\n                                          }),\n                                          disableUnderline: true,\n                                          endAdornment: <Box\n                                              sx={{\n                                                  pr: 2,\n                                                  gap: 2\n                                              }}>\n                                              {property.clearable && <IconButton\n                                                  sx={{\n                                                      position: \"absolute\",\n                                                      right: \"56px\",\n                                                      top: \"12px\"\n                                                  }}\n                                                  onClick={handleClearClick}>\n                                                  <ClearIcon/>\n                                              </IconButton>}\n                                              {params.InputProps?.endAdornment}\n                                          </Box>\n                                      }}\n                                      error={showError}\n                                      variant={\"filled\"}\n                                      helperText={showError ? error : null}/>\n                    )}\n                disabled={disabled}\n                onChange={(dateValue) => setValue(dateValue)}\n            />\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n        </>\n    );\n}\n","import React, { useCallback, useMemo } from \"react\";\n\nimport { Box, Button, IconButton, Tooltip, Typography } from \"@mui/material\";\n\nimport LinkIcon from \"@mui/icons-material/Link\";\nimport ErrorIcon from \"@mui/icons-material/Error\";\nimport ClearIcon from \"@mui/icons-material/Clear\";\nimport KeyboardTabIcon from \"@mui/icons-material/KeyboardTab\";\n\nimport {\n    Entity,\n    EntityCollection,\n    EntityReference,\n    FilterValues,\n    ResolvedProperty\n} from \"../../types\";\nimport {\n    ErrorBoundary,\n    ErrorView,\n    getReferenceFrom,\n    getReferencePreviewKeys\n} from \"../../core\";\nimport { PropertyPreview, SkeletonPropertyComponent } from \"../../preview\";\nimport { LabelWithIcon } from \"../components\";\nimport {\n    useEntityFetch,\n    useFireCMSContext,\n    useNavigationContext,\n    useReferenceDialog,\n    useSideEntityController\n} from \"../../hooks\";\nimport {\n    fieldBackground,\n    fieldBackgroundHover\n} from \"../../core/util/field_colors\";\n\n/**\n * This field allows selecting reference/s.\n * @param name\n * @param path\n * @param disabled\n * @param value\n * @param setValue\n * @param previewProperties\n * @param forceFilter\n * @constructor\n */\nexport function ReferenceWidget<M extends Record<string, any>>({\n                                                                   name,\n                                                                   path,\n                                                                   disabled,\n                                                                   value,\n                                                                   setValue,\n                                                                   previewProperties,\n                                                                   forceFilter\n                                                               }: {\n    name?: string,\n    value?: EntityReference,\n    setValue: (value: EntityReference | null) => void,\n    path: string,\n    disabled?: boolean,\n    previewProperties?: string[];\n    /**\n     * Allow selection of entities that pass the given filter only.\n     */\n    forceFilter?: FilterValues<string>;\n}) {\n\n    const fireCMSContext = useFireCMSContext();\n    const navigationContext = useNavigationContext();\n    const sideEntityController = useSideEntityController();\n\n    const collection: EntityCollection | undefined = useMemo(() => {\n        return navigationContext.getCollection(path);\n    }, [path, navigationContext]);\n\n    if (!collection) {\n        throw Error(`Couldn't find the corresponding collection for the path: ${path}`);\n    }\n\n    const validValue = value && value instanceof EntityReference;\n\n    const {\n        entity,\n        dataLoading,\n        dataLoadingError\n    } = useEntityFetch({\n        path,\n        entityId: validValue ? value.id : undefined,\n        collection,\n        useCache: true\n    });\n\n    const onSingleEntitySelected = useCallback((entity: Entity<M>) => {\n        if (disabled)\n            return;\n        setValue(entity ? getReferenceFrom(entity) : null);\n    }, [disabled, setValue]);\n\n    const referenceDialogController = useReferenceDialog({\n            multiselect: false,\n            path,\n            collection,\n            onSingleEntitySelected,\n            forceFilter\n        }\n    );\n\n    const handleClickOpen = useCallback(() => {\n        referenceDialogController.open();\n    }, [referenceDialogController]);\n\n    const clearValue = useCallback((e: React.MouseEvent) => {\n        e.stopPropagation();\n        setValue(null);\n    }, [setValue]);\n\n    const seeEntityDetails = useCallback((e: React.MouseEvent) => {\n        e.stopPropagation();\n        if (entity) {\n            fireCMSContext.onAnalyticsEvent?.(\"entity_click_from_reference\", {\n                path: entity.path,\n                entityId: entity.id\n            });\n            sideEntityController.open({\n                entityId: entity.id,\n                path,\n                updateUrl: true\n            });\n        }\n    }, [entity, path, sideEntityController]);\n\n    const buildEntityView = (collection?: EntityCollection<any>) => {\n\n        const missingEntity = entity && !entity.values;\n\n        let body: React.ReactNode;\n        if (!collection) {\n            body = (\n                <ErrorView\n                    error={\"The specified collection does not exist. Check console\"}/>\n            );\n        } else if (missingEntity) {\n            body = (\n                <Tooltip title={value && value.path}>\n                    <Box\n                        display={\"flex\"}\n                        alignItems={\"center\"}\n                        p={1}\n                        flexGrow={1}>\n                        <ErrorIcon fontSize={\"small\"} color={\"error\"}/>\n                        <Box marginLeft={1}>Missing\n                            reference {entity && entity.id}</Box>\n                    </Box>\n                </Tooltip>\n            );\n        } else {\n            if (validValue) {\n\n                const listProperties = getReferencePreviewKeys(collection, fireCMSContext.fields, previewProperties, 3);\n\n                body = (\n                    <Box display={\"flex\"}\n                         flexDirection={\"column\"}\n                         flexGrow={1}\n                         ml={1}\n                         mr={1}>\n\n                        {listProperties && listProperties.map((key) => {\n                            const property = collection.properties[key as string];\n                            if (!property) return null;\n                            return (\n                                <Box\n                                    key={`reference_previews_${key as string}`}\n                                    mt={0.25}\n                                    mb={0.25}>\n                                    <ErrorBoundary>{\n                                        entity\n                                            ? <PropertyPreview\n                                                propertyKey={key as string}\n                                                value={(entity.values)[key]}\n                                                property={property as ResolvedProperty}\n                                                entity={entity}\n                                                size={\"tiny\"}/>\n                                            : <SkeletonPropertyComponent\n                                                property={property as ResolvedProperty}\n                                                size={\"tiny\"}/>}\n                                    </ErrorBoundary>\n                                </Box>\n                            );\n                        })}\n                    </Box>\n                );\n            } else {\n                body = <Box p={1}\n                            onClick={disabled ? undefined : handleClickOpen}\n                            justifyContent=\"center\"\n                            display=\"flex\">\n                    <Typography variant={\"label\"} sx={(theme) => ({\n                        flexGrow: 1,\n                        textAlign: \"center\"\n                    })}>No value set</Typography>\n                    {!disabled && <Button variant=\"outlined\"\n                                          color=\"primary\">\n                        Set\n                    </Button>}\n                </Box>;\n            }\n        }\n\n        return (\n            <Box\n                onClick={disabled ? undefined : handleClickOpen}\n                display=\"flex\">\n\n                <Box display={\"flex\"}\n                     flexDirection={\"column\"}\n                     flexGrow={1}>\n\n                    <Box display={\"flex\"}\n                         flexDirection={\"row\"}\n                         flexGrow={1}>\n                        <LabelWithIcon icon={<LinkIcon color={\"inherit\"}\n                                                       fontSize={\"inherit\"}/>}\n                                       sx={{\n                                           flexGrow: 1,\n                                           color: \"text.secondary\",\n                                           ml: 1\n                                       }}\n                                       title={name}\n                        />\n\n                        {entity &&\n                            <Box\n                                alignSelf={\"center\"}\n                                m={1}>\n                                <Tooltip title={value && value.path}>\n                                    <Typography variant={\"caption\"}\n                                                className={\"mono\"}>\n                                        {entity.id}\n                                    </Typography>\n                                </Tooltip>\n                            </Box>}\n\n                        {!missingEntity && entity && value && <Box>\n                            <Tooltip title={`See details for ${entity.id}`}>\n                                <span>\n                                <IconButton\n                                    onClick={seeEntityDetails}\n                                    size=\"large\">\n                                    <KeyboardTabIcon/>\n                                </IconButton>\n                                    </span>\n                            </Tooltip>\n                        </Box>}\n\n                        {value && <Box>\n                            <Tooltip title=\"Clear\">\n                                <span>\n                                <IconButton\n                                    disabled={disabled}\n                                    onClick={disabled ? undefined : clearValue}\n                                    size=\"large\">\n                                    <ClearIcon/>\n                                </IconButton>\n                                </span>\n                            </Tooltip>\n                        </Box>}\n\n                    </Box>\n\n                    {body}\n\n                </Box>\n            </Box>\n        );\n    };\n\n    return <Typography variant={\"label\"} sx={(theme) => ({\n        elevation: 0,\n        width: \"100%\",\n        padding: theme.spacing(1),\n        position: \"relative\",\n        transition: \"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms\",\n        borderRadius: `${theme.shape.borderRadius}px`,\n        backgroundColor: disabled ? \"rgba(0, 0, 0, 0.12)\" : fieldBackground(theme),\n        \"&:hover\": {\n            cursor: disabled ? undefined : \"pointer\",\n            backgroundColor: disabled ? \"rgba(0, 0, 0, 0.12)\" : fieldBackgroundHover(theme)\n        },\n        color: disabled ? (theme.palette.mode === \"light\" ? \"rgba(0, 0, 0, 0.38)\" : \"rgba(255, 255, 255, 0.38)\") : undefined,\n        fontWeight: theme.typography.fontWeightMedium\n    })}>\n\n        {collection && buildEntityView(collection)}\n\n    </Typography>;\n}\n","import React from \"react\";\n\nimport { FormControl, FormHelperText } from \"@mui/material\";\n\nimport { EntityReference, FieldProps } from \"../../types\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { ReferenceWidget } from \"../components/ReferenceWidget\";\nimport { ReadOnlyFieldBinding } from \"./ReadOnlyFieldBinding\";\nimport { FieldDescription } from \"../components\";\n\n/**\n * Field that opens a reference selection dialog.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function ReferenceFieldBinding<M extends Record<string, any>>(props: FieldProps<EntityReference>) {\n\n    if (typeof props.property.path !== \"string\") {\n        return <ReadOnlyFieldBinding {...props}/>\n    }\n\n    return <ReferenceFieldBindingInternal {...props}/>;\n\n}\n\nfunction ReferenceFieldBindingInternal<M extends Record<string, any>>({\n                                                                          propertyKey,\n                                                                          value,\n                                                                          setValue,\n                                                                          error,\n                                                                          showError,\n                                                                          disabled,\n                                                                          touched,\n                                                                          autoFocus,\n                                                                          property,\n                                                                          includeDescription,\n                                                                          context\n                                                                      }: FieldProps<EntityReference>) {\n    if (!property.path) {\n        throw new Error(\"Property path is required for ReferenceFieldBinding\");\n    }\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const validValue = value && value instanceof EntityReference;\n    const path = validValue ? value.path : property.path;\n\n    return (\n        <FormControl error={showError} fullWidth>\n\n            <ReferenceWidget\n                name={property.name}\n                path={path}\n                forceFilter={property.forceFilter}\n                previewProperties={property.previewProperties}\n                value={value}\n                disabled={Boolean(property.disabled)}\n                setValue={setValue}\n            />\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n            {showError && <FormHelperText error={true}>{error}</FormHelperText>}\n\n        </FormControl>\n    );\n}\n","import React from \"react\";\nimport { FieldProps, Properties, ResolvedProperties } from \"../../types\";\nimport {\n    Box,\n    FormControl,\n    Grid,\n    InputLabel,\n    MenuItem,\n    Select\n} from \"@mui/material\";\nimport { SelectChangeEvent } from \"@mui/material/Select\";\n\nimport {\n    ExpandablePanel,\n    getIconForProperty,\n    isHidden,\n    pick\n} from \"../../core\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { PropertyFieldBinding } from \"../PropertyFieldBinding\";\n\n/**\n * Field that renders the children property fields\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function MapFieldBinding<T extends Record<string, any>>({\n                                                                   propertyKey,\n                                                                   value,\n                                                                   showError,\n                                                                   disabled,\n                                                                   property,\n                                                                   setValue,\n                                                                   tableMode,\n                                                                   includeDescription,\n                                                                   underlyingValueHasChanged,\n                                                                   autoFocus,\n                                                                   context\n                                                               }: FieldProps<T>) {\n\n    const pickOnlySomeKeys = property.pickOnlySomeKeys || false;\n    const expanded = (property.expanded === undefined ? true : property.expanded) || autoFocus;\n\n    if (!property.properties) {\n        throw Error(`You need to specify a 'properties' prop (or specify a custom field) in your map property ${propertyKey}`);\n    }\n\n    let mapProperties: ResolvedProperties;\n    if (pickOnlySomeKeys) {\n        if (value) {\n            mapProperties = pick(property.properties,\n                ...Object.keys(value)\n                    .filter(key => key in property.properties!)\n            );\n        } else {\n            mapProperties = {};\n        }\n    } else {\n        mapProperties = property.properties;\n    }\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const mapFormView = <>\n        <Box sx={{ py: 1, display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n            {Object.entries(mapProperties)\n                .filter(([_, property]) => !isHidden(property))\n                .map(([entryKey, childProperty], index) => {\n                        const fieldProps = {\n                            propertyKey: `${propertyKey}.${entryKey}`,\n                            disabled,\n                            property: childProperty,\n                            includeDescription,\n                            underlyingValueHasChanged,\n                            context,\n                            tableMode: false,\n                            partOfArray: false,\n                            autoFocus: autoFocus && index === 0\n                        };\n                        return (\n                            <div key={`map-${propertyKey}-${index}`}>\n                                <PropertyFieldBinding\n                                    {...fieldProps}/>\n                            </div>\n                        );\n                    }\n                )}\n        </Box>\n\n        {pickOnlySomeKeys && buildPickKeysSelect(disabled, property.properties, setValue, value)}\n\n    </>;\n\n    const title = <LabelWithIcon icon={getIconForProperty(property)}\n                                 required={property.validation?.required}\n                                 title={property.name}/>;\n\n    return (\n        <FormControl fullWidth error={showError}>\n\n            {!tableMode && <ExpandablePanel initiallyExpanded={expanded}\n                                            title={title}>{mapFormView}</ExpandablePanel>}\n\n            {tableMode && mapFormView}\n\n            {includeDescription && <FieldDescription property={property}/>}\n\n        </FormControl>\n    );\n}\n\nconst buildPickKeysSelect = (disabled: boolean, properties: Properties, setValue: (value: any) => void, value: any) => {\n\n    const keys = Object.keys(properties)\n        .filter((key) => !value || !(key in value));\n\n    const handleAddProperty = (event: SelectChangeEvent) => {\n        setValue({\n            ...value,\n            [event.target.value as string]: null\n        });\n    };\n\n    if (!keys.length) return <></>;\n\n    return <Box m={1}>\n        <FormControl fullWidth>\n            <InputLabel>Add property</InputLabel>\n            <Select\n                variant={\"standard\"}\n                value={\"\"}\n                disabled={disabled}\n                onChange={handleAddProperty}>\n                {keys.map((key) => (\n                    <MenuItem key={key} value={key}>\n                        {(properties as Properties)[key].name || key}\n                    </MenuItem>\n                ))}\n            </Select>\n        </FormControl>\n    </Box>;\n};\n\n","import React, { useEffect, useState } from \"react\";\nimport { DataType, EntityReference, FieldProps, GeoPoint } from \"../../types\";\nimport {\n    Box,\n    Button,\n    FormControl,\n    IconButton,\n    Typography\n} from \"@mui/material\";\n\nimport Menu from \"@mui/material/Menu\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport RemoveIcon from \"@mui/icons-material/Remove\";\nimport ArrowDropDownIcon from \"@mui/icons-material/ArrowDropDown\";\nimport AddIcon from \"@mui/icons-material/Add\";\n\nimport {\n    ArrayContainer,\n    BooleanSwitch,\n    DateTimeField,\n    ExpandablePanel, getDefaultValueForDataType,\n    getIconForProperty,\n    TextInput\n} from \"../../core\";\nimport { FieldDescription, LabelWithIcon } from \"../components\";\n\ntype MapEditViewRowState = [number, {\n    key: string,\n    dataType: DataType\n}];\n\n/**\n * Field that allows edition of key value pairs.\n *\n * @category Form fields\n */\nexport function KeyValueFieldBinding<T extends Record<string, any>>({\n                                                                        propertyKey,\n                                                                        value,\n                                                                        showError,\n                                                                        disabled,\n                                                                        property,\n                                                                        setValue,\n                                                                        tableMode,\n                                                                        includeDescription,\n                                                                        underlyingValueHasChanged,\n                                                                        autoFocus,\n                                                                        context\n                                                                    }: FieldProps<T>) {\n\n    const expanded = (property.expanded === undefined ? true : property.expanded) || autoFocus;\n\n    if (!property.keyValue) {\n        throw Error(`Your property ${propertyKey} needs to have the 'keyValue' prop in order to use this field binding`);\n    }\n    const mapFormView = <MapEditView value={value}\n                                     setValue={setValue}\n                                     disabled={disabled}\n                                     fieldName={property.name ?? propertyKey}/>;\n\n    const title = <LabelWithIcon\n        icon={getIconForProperty(property)}\n        required={property.validation?.required}\n        title={property.name}/>;\n\n    return (\n        <FormControl fullWidth error={showError}>\n\n            {!tableMode && <ExpandablePanel initiallyExpanded={expanded}\n                                            title={title}>{mapFormView}</ExpandablePanel>}\n\n            {tableMode && mapFormView}\n\n            {includeDescription && <FieldDescription property={property}/>}\n\n        </FormControl>\n    );\n}\n\nfunction MapKeyValueRow<T extends Record<string, any>>({\n                                                           rowId,\n                                                           fieldKey,\n                                                           value,\n                                                           onFieldKeyChange,\n                                                           onDeleteClick,\n                                                           setValue,\n                                                           entryValue,\n                                                           dataType,\n                                                           updateDataType,\n                                                           disabled\n                                                       }: {\n    rowId: number,\n    fieldKey: string,\n    value: T,\n    onFieldKeyChange: (newKey: string) => void,\n    onDeleteClick: () => void,\n    setValue: (value: (T | null)) => void,\n    entryValue: any,\n    dataType: DataType,\n    disabled?: boolean,\n    updateDataType: (rowId: number, dataType: DataType) => void\n}) {\n\n    const [menuAnchorEl, setMenuAnchorEl] = React.useState<null | HTMLElement>(null);\n    const menuOpen = Boolean(menuAnchorEl);\n\n    const openTypeSelectMenu = (event: React.MouseEvent<HTMLButtonElement>) => {\n        setMenuAnchorEl(event.currentTarget);\n    };\n\n    const handleMenuClose = () => {\n        setMenuAnchorEl(null);\n    };\n\n    function buildInput(entryValue: any, fieldKey: string, dataType: DataType) {\n        if (dataType === \"string\" || dataType === \"number\") {\n            return <TextInput\n                key={dataType}\n                value={entryValue}\n                inputType={dataType === \"number\" ? \"number\" : \"text\"}\n                small={true}\n                disabled={disabled || !fieldKey}\n                onChange={(event) => {\n                    if (dataType === \"number\") {\n                        const numberValue = event.target.value ? parseFloat(event.target.value) : undefined;\n                        if (numberValue && isNaN(numberValue)) {\n                            setValue({\n                                ...value,\n                                [fieldKey]: null\n                            });\n                        } else if (numberValue !== undefined && numberValue !== null) {\n                            setValue({\n                                ...value,\n                                [fieldKey]: numberValue\n                            });\n                        } else {\n                            setValue({\n                                ...value,\n                                [fieldKey]: null\n                            });\n                        }\n                    } else {\n                        setValue({\n                            ...value,\n                            [fieldKey]: event.target.value\n                        });\n                    }\n                }}/>;\n        } else if (dataType === \"date\") {\n            return <DateTimeField value={entryValue}\n                                  small={true}\n                                  disabled={disabled || !fieldKey}\n                                  onChange={(date) => {\n                                      setValue({\n                                          ...value,\n                                          [fieldKey]: date\n                                      });\n                                  }}/>;\n        } else if (dataType === \"boolean\") {\n            return <BooleanSwitch value={entryValue}\n                                  small={true}\n                                  position={\"start\"}\n                                  disabled={disabled || !fieldKey}\n                                  onChange={(event) => {\n                                      const newValue = event.target.checked;\n                                      setValue({\n                                          ...value,\n                                          [fieldKey]: newValue\n                                      });\n                                  }}/>;\n        } else if (dataType === \"array\") {\n            return <Box sx={theme => ({\n                ml: 1,\n                pl: 1,\n                borderLeft: `1px solid ${theme.palette.divider}`\n            })}>\n                <ArrayContainer value={entryValue}\n                                newDefaultEntry={\"\"}\n                                droppableId={rowId.toString()}\n                                addLabel={fieldKey ? `Add to ${fieldKey}` : \"Add\"}\n                                small={true}\n                                disabled={disabled || !fieldKey}\n                                includeAddButton={true}\n                                onValueChange={(newValue) => {\n                                    setValue({\n                                        ...value,\n                                        [fieldKey]: newValue\n                                    });\n                                }}\n                                buildEntry={(index, internalId) => {\n                                    return <ArrayKeyValueRow\n                                        index={index}\n                                        id={internalId}\n                                        value={entryValue[index]}\n                                        disabled={disabled || !fieldKey}\n                                        setValue={(newValue) => {\n                                            const newArrayValue = [...entryValue];\n                                            newArrayValue[index] = newValue;\n                                            setValue({\n                                                ...value,\n                                                [fieldKey]: newArrayValue\n                                            });\n                                        }}\n                                    />\n                                }}/>\n            </Box>;\n        } else if (dataType === \"map\") {\n            return <Box sx={theme => ({\n                ml: 1,\n                pl: 1,\n                borderLeft: `1px solid ${theme.palette.divider}`\n            })}>\n                <MapEditView value={entryValue}\n                             fieldName={fieldKey}\n                             setValue={(updatedValue) => {\n                                 setValue({\n                                     ...value,\n                                     [fieldKey]: updatedValue\n                                 });\n                             }}/>\n            </Box>;\n        } else {\n            return <Typography\n                variant={\"caption\"}>\n                {`Data type ${dataType} not supported yet`}\n            </Typography>;\n        }\n    }\n\n    function doUpdateDataType(dataType: DataType) {\n        updateDataType(rowId, dataType);\n        handleMenuClose();\n    }\n\n    return (<>\n            <Typography key={rowId.toString()}\n                        component={\"div\"}\n                        className={\"mono\"}\n                        sx={{\n                            display: \"flex\",\n                            flexDirection: \"row\",\n                            gap: 1,\n                            alignItems: \"center\"\n                        }}>\n                <Box sx={{ width: \"200px\", maxWidth: \"25%\" }}>\n                    <TextInput\n                        value={fieldKey}\n                        disabled={disabled || Boolean(entryValue)}\n                        small={true}\n                        onChange={(event) => {\n                            onFieldKeyChange(event.target.value);\n                        }}/>\n                </Box>\n\n                <Box sx={{ flexGrow: 1 }}>\n                    {(dataType !== \"map\" && dataType !== \"array\") && buildInput(entryValue, fieldKey, dataType)}\n                </Box>\n\n                <IconButton size={\"small\"}\n                            sx={theme => ({\n                                background: theme.palette.background.default,\n                                height: \"28px\",\n                                width: \"28px\"\n                            })}\n                            onClick={openTypeSelectMenu}>\n                    <ArrowDropDownIcon/>\n                </IconButton>\n\n                <IconButton aria-label=\"delete\"\n                            size={\"small\"}\n                            onClick={onDeleteClick}\n                            sx={{\n                                height: \"28px\",\n                                width: \"28px\"\n                            }}>\n                    <RemoveIcon fontSize={\"small\"}/>\n                </IconButton>\n            </Typography>\n\n            {(dataType === \"map\" || dataType === \"array\") && buildInput(entryValue, fieldKey, dataType)}\n\n            <Menu\n                anchorEl={menuAnchorEl}\n                open={menuOpen}\n                onClose={handleMenuClose}\n            >\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"string\")}>string</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"number\")}>number</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"boolean\")}>boolean</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"date\")}>date</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"map\")}>map</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"array\")}>array</MenuItem>\n            </Menu>\n        </>\n\n    );\n}\n\nfunction ArrayKeyValueRow<T>({\n                                 id,\n                                 index,\n                                 value,\n                                 setValue,\n                             }: {\n    id: number,\n    index: number,\n    value: T,\n    setValue: (value: T | null) => void,\n    disabled?: boolean,\n}) {\n\n    const [selectedDataType, setSelectedDataType] = useState<DataType>(getDataType(value) ?? \"string\");\n\n    function doUpdateDataType(dataType: DataType) {\n        setSelectedDataType(dataType);\n        handleMenuClose();\n    }\n\n    const [menuAnchorEl, setMenuAnchorEl] = React.useState<null | HTMLElement>(null);\n    const menuOpen = Boolean(menuAnchorEl);\n\n    const openTypeSelectMenu = (event: React.MouseEvent<HTMLButtonElement>) => {\n        setMenuAnchorEl(event.currentTarget);\n    };\n\n    const handleMenuClose = () => {\n        setMenuAnchorEl(null);\n    };\n\n    function buildInput(entryValue: any, dataType: DataType) {\n        if (dataType === \"string\" || dataType === \"number\") {\n            return <TextInput value={entryValue}\n                              inputType={dataType === \"number\" ? \"number\" : \"text\"}\n                              small={true}\n                              onChange={(event) => {\n                                  if (dataType === \"number\") {\n                                      const numberValue = event.target.value ? parseFloat(event.target.value) : undefined;\n                                      if (numberValue && isNaN(numberValue)) {\n                                          setValue(null);\n                                      } else if (numberValue !== undefined && numberValue !== null) {\n                                          setValue(numberValue as T);\n                                      } else {\n                                          setValue(null);\n                                      }\n                                  } else {\n                                      setValue(event.target.value as T);\n                                  }\n                              }}/>;\n        } else if (dataType === \"date\") {\n            return <DateTimeField value={entryValue}\n                                  small={true}\n                                  onChange={(date) => {\n                                      setValue(date as T);\n                                  }}/>;\n        } else if (dataType === \"boolean\") {\n            return <BooleanSwitch value={entryValue}\n                                  small={true}\n                                  position={\"start\"}\n                                  onChange={(event) => {\n                                      setValue(event.target.checked as T);\n                                  }}/>;\n        } else if (dataType === \"array\") {\n            return <Typography variant={\"caption\"}>\n                Arrays of arrays are not supported.\n            </Typography>;\n        } else if (dataType === \"map\") {\n            return <Box sx={theme => ({\n                ml: 1,\n                pl: 1,\n                borderLeft: `1px solid ${theme.palette.divider}`\n            })}>\n                <MapEditView value={entryValue}\n                             setValue={(updatedValue) => {\n                                 setValue(updatedValue);\n                             }}/>\n            </Box>;\n        } else {\n            return <Typography\n                variant={\"caption\"}>\n                {`Data type ${dataType} not supported yet`}\n            </Typography>;\n        }\n    }\n\n    return (<>\n            <Typography key={id.toString()}\n                        component={\"div\"}\n                        className={\"mono\"}\n                        sx={{\n                            display: \"flex\",\n                            minHeight: \"48px\",\n                            flexDirection: \"row\",\n                            gap: 1,\n                            alignItems: \"center\"\n                        }}>\n\n                <Box sx={{ flexGrow: 1 }}>\n                    {selectedDataType !== \"map\" && buildInput(value, selectedDataType)}\n                </Box>\n\n                <IconButton size={\"small\"}\n                            sx={theme => ({\n                                background: theme.palette.background.default,\n                                height: \"28px\",\n                                width: \"28px\"\n                            })}\n                            onClick={openTypeSelectMenu}>\n                    <ArrowDropDownIcon/>\n                </IconButton>\n\n            </Typography>\n\n            {selectedDataType === \"map\" && buildInput(value, selectedDataType)}\n\n            <Menu\n                anchorEl={menuAnchorEl}\n                open={menuOpen}\n                onClose={handleMenuClose}\n            >\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"string\")}>string</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"number\")}>number</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"boolean\")}>boolean</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"map\")}>map</MenuItem>\n                <MenuItem dense\n                          onClick={() => doUpdateDataType(\"date\")}>date</MenuItem>\n            </Menu>\n        </>\n\n    );\n}\n\ninterface MapEditViewParams<T extends Record<string, any>> {\n    value: T;\n    setValue: (value: (T | null)) => void;\n    fieldName?: string,\n    disabled?: boolean\n}\n\nfunction MapEditView<T extends Record<string, any>>({\n                                                        value,\n                                                        setValue,\n                                                        fieldName,\n                                                        disabled\n                                                    }: MapEditViewParams<T>) {\n    const [internalState, setInternalState] = React.useState<MapEditViewRowState[]>(\n        Object.keys(value ?? {}).map((key) => [getRandomId(), {\n            key,\n            dataType: getDataType(value[key]) ?? \"string\"\n        }])\n    );\n\n    useEffect(() => {\n        const currentKeys = internalState.map(([id, { key }]) => key);\n        const newKeys = Object.entries(value ?? {}).filter(([key, v]) => v !== undefined).map(([key]) => key);\n        const keysToAdd = newKeys.filter((key) => !currentKeys.includes(key));\n        const keysToRemove = currentKeys.filter((key) => !newKeys.includes(key));\n        const newRowIds = [...internalState];\n        keysToAdd.forEach((key) => {\n            newRowIds.push([getRandomId(), {\n                key,\n                dataType: getDataType(value[key]) ?? \"string\"\n            }]);\n        });\n        keysToRemove.forEach((key) => {\n            const index = newRowIds.findIndex(([id, { key: k }]) => k === key);\n            newRowIds.splice(index, 1);\n        });\n        setInternalState(newRowIds);\n    }, [value]);\n\n    const originalValue = React.useRef<T>(value);\n\n    const updateDataType = (rowId: number, dataType: DataType) => {\n        if (!rowId) {\n            console.warn(\"No key selected for data type update\");\n            return;\n        }\n        setInternalState(internalState.map((row) => {\n            if (row[0] === rowId) {\n                return [row[0], {\n                    key: row[1].key,\n                    dataType\n                }];\n            }\n            return row;\n        }));\n        setValue({\n            ...value,\n            [internalState.find((row) => row[0] === rowId)?.[1].key ?? \"\"]: getDefaultValueForDataType(dataType)\n        })\n    };\n\n    return <Box sx={{\n        py: 1,\n        display: \"flex\",\n        flexDirection: \"column\",\n        gap: 1\n    }}>\n        {internalState\n            .map(([rowId, { key: fieldKey, dataType }], index) => {\n                    const entryValue = fieldKey ? value[fieldKey] : \"\";\n                    const onFieldKeyChange = (newKey: string) => {\n\n                        setInternalState(internalState.map((currentRowId) => {\n                            if (currentRowId[0] === rowId) {\n                                return [rowId, {\n                                    key: newKey ?? \"\",\n                                    dataType: currentRowId[1].dataType\n                                }];\n                            }\n                            return currentRowId;\n                        }));\n\n                        if (typeof value === \"object\" && newKey in value) {\n                            // if the key is already there, don't delete the previous value\n                            return;\n                        }\n\n                        const newValue = { ...value };\n                        if (originalValue.current && fieldKey in originalValue.current) {\n                            // @ts-ignore\n                            newValue[fieldKey] = undefined; // set to undefined to remove from the object, the datasource will remove it from the backend\n                        } else {\n                            // @ts-ignore\n                            delete newValue[fieldKey];\n                        }\n                        setValue({\n                            ...newValue,\n                            [newKey ?? \"\"]: entryValue\n                        });\n                    };\n                    return <MapKeyValueRow rowId={rowId}\n                                           key={rowId}\n                                           fieldKey={fieldKey}\n                                           value={value}\n                                           onDeleteClick={() => {\n                                               const newValue = { ...value };\n                                               if (originalValue.current && fieldKey in originalValue.current) {\n                                                   // @ts-ignore\n                                                   newValue[fieldKey] = undefined;\n                                               } else {\n                                                   // @ts-ignore\n                                                   delete newValue[fieldKey];\n                                               }\n                                               setInternalState(internalState.filter((currentRowId) => currentRowId[0] !== rowId));\n                                               setValue({\n                                                   ...newValue\n                                               });\n                                           }}\n                                           onFieldKeyChange={onFieldKeyChange}\n                                           setValue={setValue}\n                                           entryValue={entryValue}\n                                           dataType={dataType}\n                                           disabled={disabled}\n                                           updateDataType={updateDataType}/>;\n                }\n            )}\n\n        <Box p={1}\n             justifyContent=\"center\"\n             textAlign={\"left\"}>\n            <Button variant={\"text\"}\n                    size={\"small\"}\n                    color=\"primary\"\n                    fullWidth={false}\n                    disabled={disabled}\n                    startIcon={<AddIcon/>}\n                    onClick={() => {\n                        setValue({\n                            ...value,\n                            \"\": null\n                        });\n                        setInternalState([...internalState, [getRandomId(), {\n                            key: \"\",\n                            dataType: \"string\"\n                        }]]);\n                    }\n                    }>\n                {fieldName ? `Add to ${fieldName}` : \"Add\"}\n            </Button>\n        </Box>\n\n    </Box>;\n}\n\nfunction getRandomId() {\n    return Math.floor(Math.random() * Math.floor(Number.MAX_SAFE_INTEGER));\n}\n\nfunction getDataType(value: any): DataType | undefined {\n    if (typeof value === \"string\") {\n        return \"string\";\n    } else if (typeof value === \"number\") {\n        return \"number\";\n    } else if (typeof value === \"boolean\") {\n        return \"boolean\";\n    } else if (Array.isArray(value)) {\n        return \"array\";\n    } else if (value instanceof Date) {\n        return \"date\";\n    } else if (value instanceof EntityReference) {\n        return \"reference\";\n    } else if (value instanceof GeoPoint) {\n        return \"geopoint\";\n    } else if (typeof value === \"object\") {\n        return \"map\";\n    }\n\n    return undefined;\n}\n","import React, { PropsWithChildren, useCallback, useState } from \"react\";\n\nimport {\n    Accordion,\n    AccordionDetails,\n    AccordionSummary, darken,\n    lighten\n} from \"@mui/material\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport { fieldBackgroundSubtleHover } from \"../util/field_colors\";\n\nexport function ExpandablePanel({\n                                    title,\n                                    children,\n                                    invisible = false,\n                                    initiallyExpanded = true,\n                                    highlightOnHover = false,\n                                    padding = 1,\n                                    dark = true,\n                                    onExpandedChange\n                                }: PropsWithChildren<{\n    title: React.ReactNode,\n    invisible?: boolean,\n    initiallyExpanded?: boolean;\n    padding?: number | string;\n    highlightOnHover?: boolean,\n    dark?: boolean,\n    onExpandedChange?: (expanded: boolean) => void\n}>) {\n\n    const [onHover, setOnHover] = React.useState(false);\n    const setOnHoverTrue = useCallback(() => setOnHover(true), []);\n    const setOnHoverFalse = useCallback(() => setOnHover(false), []);\n\n    const [expandedInternal, setExpandedInternal] = useState(initiallyExpanded);\n    return (\n        <Accordion variant={\"outlined\"}\n                   onMouseEnter={setOnHoverTrue}\n                   onMouseMove={setOnHoverTrue}\n                   onMouseLeave={setOnHoverFalse}\n                   disableGutters\n                   expanded={expandedInternal}\n                   sx={theme => ({\n                       backgroundColor: invisible ? \"transparent\" : (dark ? (\n                           onHover && highlightOnHover\n                               ? fieldBackgroundSubtleHover(theme)\n                               : \"transparent\"\n                       ) : \"inherit\"),\n\n                       borderRadius: invisible ? 0 : `${theme.shape.borderRadius}px`,\n                       border: invisible ? \"none\" : undefined,\n                       \"&::before\": {\n                           display: \"none\"\n                       },\n                       // color: \"inherit\"\n\n                   })}\n                   TransitionProps={{ unmountOnExit: true }}\n                   onChange={useCallback((event: React.SyntheticEvent, expanded: boolean) => {\n                       onExpandedChange?.(expanded);\n                       setExpandedInternal(expanded);\n                   }, [onExpandedChange])}>\n\n            <AccordionSummary expandIcon={<ExpandMoreIcon/>}\n                              sx={(theme) => ({\n                                  color: theme.palette.text.secondary,\n                                  padding: invisible ? 0 : undefined,\n                                  minHeight: \"56px\",\n                                  alignItems: \"center\",\n                                  borderTopLeftRadius: `${theme.shape.borderRadius}px`,\n                                  borderTopRightRadius: `${theme.shape.borderRadius}px`,\n                                  borderBottomLeftRadius: !expandedInternal && !invisible ? `${theme.shape.borderRadius}px` : undefined,\n                                  borderBottomRightRadius: !expandedInternal && !invisible ? `${theme.shape.borderRadius}px` : undefined,\n                                  border: invisible ? \"none\" : undefined,\n                                  borderBottom: invisible ? `1px solid ${theme.palette.divider}` : undefined,\n                                  \"&.Mui-expanded\": {\n                                      borderBottom: `1px solid ${theme.palette.divider}`\n                                  }\n                              })}>\n                {title}\n            </AccordionSummary>\n\n            <AccordionDetails sx={(theme) => ({\n                padding: invisible ? 0 : typeof padding === \"string\" ? padding : theme.spacing(padding),\n                py: theme.spacing(2),\n                border: invisible ? \"none\" : undefined,\n                color: \"inherit\"\n            })}>\n                {children}\n            </AccordionDetails>\n\n        </Accordion>\n    )\n}\n","import React, { useState } from \"react\";\nimport { CMSType, FieldProps, ResolvedProperty } from \"../../types\";\nimport { FormControl, FormHelperText } from \"@mui/material\";\nimport { FieldDescription, FormikArrayContainer, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { ExpandablePanel } from \"../../core/components/ExpandablePanel\";\nimport { PropertyFieldBinding } from \"../PropertyFieldBinding\";\nimport { getIconForProperty } from \"../../core\";\n\n/**\n * Generic array field that allows reordering and renders the child property\n * as nodes.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function RepeatFieldBinding<T extends Array<any>>({\n                                                             propertyKey,\n                                                             value,\n                                                             error,\n                                                             showError,\n                                                             isSubmitting,\n                                                             setValue,\n                                                             setFieldValue,\n                                                             tableMode,\n                                                             property,\n                                                             includeDescription,\n                                                             underlyingValueHasChanged,\n                                                             context,\n                                                             disabled\n                                                         }: FieldProps<T>) {\n\n    if (!property.of)\n        throw Error(\"RepeatFieldBinding misconfiguration. Property `of` not set\");\n\n    if (!property.resolvedProperties || !Array.isArray(property.resolvedProperties))\n        throw Error(\"RepeatFieldBinding - Internal error: Expected array in 'property.resolvedProperties'\");\n\n    const expanded = property.expanded === undefined ? true : property.expanded;\n    const ofProperty: ResolvedProperty<CMSType[]> = property.of as ResolvedProperty<CMSType[]>;\n\n    const [lastAddedId, setLastAddedId] = useState<number | undefined>();\n\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const buildEntry = (index: number, internalId: number) => {\n        const childProperty = property.resolvedProperties[index] ?? ofProperty;\n        const fieldProps = {\n            propertyKey: `${propertyKey}.${index}`,\n            disabled,\n            property: childProperty,\n            includeDescription,\n            underlyingValueHasChanged,\n            context,\n            tableMode: false,\n            partOfArray: true,\n            autoFocus: internalId === lastAddedId\n        };\n        return <PropertyFieldBinding {...fieldProps}/>;\n    };\n\n    const arrayContainer = <FormikArrayContainer value={value}\n                                                 addLabel={property.name ? \"Add entry to \" + property.name : \"Add entry\"}\n                                                 name={propertyKey}\n                                                 setFieldValue={setFieldValue}\n                                                 buildEntry={buildEntry}\n                                                 onInternalIdAdded={setLastAddedId}\n                                                 disabled={isSubmitting || Boolean(property.disabled)}\n                                                 includeAddButton={!property.disabled}\n                                                 newDefaultEntry={property.of.defaultValue}/>;\n\n    const title = (<LabelWithIcon icon={getIconForProperty(property)}\n                                  required={property.validation?.required}\n                                  title={property.name}/>);\n\n    return (\n\n        <FormControl fullWidth error={showError}>\n\n            {!tableMode && <ExpandablePanel initiallyExpanded={expanded}\n                                            title={title}>\n                {arrayContainer}\n            </ExpandablePanel>}\n\n            {tableMode && arrayContainer}\n\n            {includeDescription &&\n                <FieldDescription property={property}/>\n            }\n\n            {showError && typeof error === \"string\" &&\n                <FormHelperText error={true}>{error}</FormHelperText>}\n\n        </FormControl>\n    )\n        ;\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { FormControl, FormHelperText, InputLabel, MenuItem, Paper, Select } from \"@mui/material\";\nimport { FastField, FieldProps as FormikFieldProps, useFormikContext } from \"formik\";\n\nimport { FieldDescription, FormikArrayContainer, LabelWithIcon } from \"../components\";\nimport { useClearRestoreValue } from \"../../hooks\";\nimport { PropertyFieldBinding } from \"../PropertyFieldBinding\";\nimport { EnumValuesChip } from \"../../preview\";\nimport { EnumValueConfig, FieldProps, FormContext, PropertyOrBuilder } from \"../../types\";\nimport { ExpandablePanel, getDefaultValueFor, getIconForProperty } from \"../../core\";\nimport { DEFAULT_ONE_OF_TYPE, DEFAULT_ONE_OF_VALUE } from \"../../core/util/common\";\n\n/**\n * If the `oneOf` property is specified, this fields render each array entry as\n * a `type` select and the corresponding field widget to the selected `type.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function BlockFieldBinding<T extends Array<any>>({\n                                                            propertyKey,\n                                                            value,\n                                                            error,\n                                                            showError,\n                                                            isSubmitting,\n                                                            setValue,\n                                                            setFieldValue,\n                                                            tableMode,\n                                                            property,\n                                                            includeDescription,\n                                                            underlyingValueHasChanged,\n                                                            context,\n                                                            disabled\n                                                        }: FieldProps<T>) {\n\n    if (!property.oneOf)\n        throw Error(\"ArrayOneOfField misconfiguration. Property `oneOf` not set\");\n\n    const expanded = property.expanded === undefined ? true : property.expanded;\n    useClearRestoreValue({\n        property,\n        value,\n        setValue\n    });\n\n    const [lastAddedId, setLastAddedId] = useState<number | undefined>();\n\n    const buildEntry = useCallback((index: number, internalId: number) => {\n        return <BlockEntry\n            key={`array_one_of_${index}`}\n            name={`${propertyKey}.${index}`}\n            index={index}\n            value={value[index]}\n            typeField={property.oneOf!.typeField ?? DEFAULT_ONE_OF_TYPE}\n            valueField={property.oneOf!.valueField ?? DEFAULT_ONE_OF_VALUE}\n            properties={property.oneOf!.properties}\n            autoFocus={internalId === lastAddedId}\n            context={context}/>;\n    }, [context, lastAddedId, property.oneOf, propertyKey, value]);\n\n    const title = (\n        <LabelWithIcon icon={getIconForProperty(property)}\n                       required={property.validation?.required}\n                       title={property.name}/>\n    );\n\n    const firstOneOfKey = Object.keys(property.oneOf.properties)[0];\n    const body = <FormikArrayContainer value={value}\n                                       name={propertyKey}\n                                       addLabel={property.name ? \"Add entry to \" + property.name : \"Add entry\"}\n                                       buildEntry={buildEntry}\n                                       onInternalIdAdded={setLastAddedId}\n                                       disabled={isSubmitting || Boolean(property.disabled)}\n                                       includeAddButton={!property.disabled}\n                                       setFieldValue={setFieldValue}\n                                       newDefaultEntry={{\n                                           [property.oneOf!.typeField ?? DEFAULT_ONE_OF_TYPE]: firstOneOfKey,\n                                           [property.oneOf!.valueField ?? DEFAULT_ONE_OF_VALUE]: getDefaultValueFor(property.oneOf.properties[firstOneOfKey])\n                                       }}/>;\n    return (\n\n        <FormControl fullWidth error={showError}>\n\n            {!tableMode &&\n                <ExpandablePanel initiallyExpanded={expanded} title={title}>\n                    {body}\n                </ExpandablePanel>}\n\n            {tableMode && body}\n\n            {includeDescription &&\n                <FieldDescription property={property}/>}\n\n            {showError &&\n                typeof error === \"string\" &&\n                <FormHelperText error={true}>{error}</FormHelperText>}\n\n        </FormControl>\n    );\n}\n\ninterface BlockEntryProps {\n    name: string;\n    index: number;\n    value: any;\n    /**\n     * Name of the field to use as the discriminator for type\n     * Defaults to `type`\n     */\n    typeField: string;\n    /**\n     * Name of the  field to use as the value\n     * Defaults to `value`\n     */\n    valueField: string;\n\n    autoFocus: boolean;\n    /**\n     * Record of properties, where the key is the `type` and the value\n     * is the corresponding property\n     */\n    properties: Record<string, PropertyOrBuilder>;\n\n    /**\n     * Additional values related to the state of the form or the entity\n     */\n    context: FormContext<any>;\n\n}\n\nfunction BlockEntry({\n                        name,\n                        index,\n                        value,\n                        typeField,\n                        valueField,\n                        properties,\n                        autoFocus,\n                        context\n                    }: BlockEntryProps) {\n\n    const type = value && value[typeField];\n    const [typeInternal, setTypeInternal] = useState<string | undefined>(type ?? undefined);\n\n    const formikContext = useFormikContext();\n\n    useEffect(() => {\n        if (!type) {\n            updateType(Object.keys(properties)[0]);\n        }\n    }, []);\n\n    useEffect(() => {\n        if (type !== typeInternal) {\n            setTypeInternal(type);\n        }\n    }, [type]);\n\n    const property = typeInternal ? properties[typeInternal] : undefined;\n\n    const enumValuesConfigs: EnumValueConfig[] = Object.entries(properties)\n        .map(([key, property]) => ({\n            id: key,\n            label: property.name ?? key\n        }));\n\n    const typeFieldName = `${name}.${typeField}`;\n    const valueFieldName = `${name}.${valueField}`;\n\n    const fieldProps = property\n        ? {\n            propertyKey: valueFieldName,\n            property,\n            context,\n            autoFocus,\n            tableMode: false\n        }\n        : undefined;\n\n    const updateType = (newType: any) => {\n        const newSelectedProperty = newType ? properties[newType] : undefined;\n        setTypeInternal(newType);\n        formikContext.setFieldTouched(typeFieldName);\n        formikContext.setFieldValue(typeFieldName, newType);\n        formikContext.setFieldValue(valueFieldName, newSelectedProperty ? getDefaultValueFor(newSelectedProperty) : null);\n    };\n\n    return (\n        <Paper sx={(theme) => ({\n            background: \"transparent\",\n            padding: theme.spacing(1),\n            my: 1,\n            py: 2\n        })} elevation={0}>\n\n            <FastField\n                required={true}\n                name={typeFieldName}\n            >\n                {(fieldProps: FormikFieldProps) =>\n                    (\n                        <FormControl fullWidth size=\"small\">\n                            <InputLabel\n                                id={`${name}_${index}_select_label`}>\n                                <span>Type</span>\n                            </InputLabel>\n                            <Select\n                                fullWidth\n                                sx={{ marginBottom: 2 }}\n                                labelId={`${name}_${index}_select_label`}\n                                label={\"Type\"}\n                                value={fieldProps.field.value !== undefined && fieldProps.field.value !== null ? fieldProps.field.value : \"\"}\n                                onChange={(evt: any) => {\n                                    const newType = evt.target.value;\n                                    updateType(newType);\n                                }}\n                                renderValue={(enumKey: any) =>\n                                    <EnumValuesChip\n                                        enumKey={enumKey}\n                                        enumValues={enumValuesConfigs}\n                                        small={true}/>\n                                }>\n                                {enumValuesConfigs\n                                    .map((enumValueConfig) => {\n                                        const enumKey = enumValueConfig.id;\n                                        return (\n                                            <MenuItem\n                                                key={`select_${name}_${index}_${enumKey}`}\n                                                value={enumKey}>\n                                                <EnumValuesChip\n                                                    enumKey={enumKey}\n                                                    enumValues={enumValuesConfigs}\n                                                    small={true}/>\n                                            </MenuItem>\n                                        );\n                                    })}\n                            </Select>\n                        </FormControl>\n                    )\n                }\n            </FastField>\n\n            {fieldProps && (\n                <FormControl fullWidth\n                             key={`form_control_${name}_${typeInternal}`}>\n                    <PropertyFieldBinding {...fieldProps}/>\n                </FormControl>\n            )}\n\n        </Paper>\n    );\n}\n","import React, { useDeferredValue, useEffect, useRef } from \"react\";\n\nimport { styled } from \"@mui/material/styles\";\n\nimport {\n    Box,\n    darken,\n    FormControl,\n    FormHelperText,\n    lighten,\n    Theme\n} from \"@mui/material\";\n\n// @ts-ignore\nimport MarkdownIt from \"markdown-it\";\nimport MdEditor, { Plugins } from \"react-markdown-editor-lite\";\n\nimport { FieldDescription, LabelWithIcon } from \"../components\";\nimport { FieldProps } from \"../../types\";\nimport { getIconForProperty } from \"../../core\";\nimport { fieldBackground } from \"../../core/util/field_colors\";\n\nconst mdParser = new MarkdownIt();\nMdEditor.use(Plugins.AutoResize, {\n    min: 100\n})\nMdEditor.unuse(Plugins.FontUnderline)\nMdEditor.unuse(Plugins.Clear);\n\n/**\n * Render a markdown field that allows edition and seeing the preview.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function MarkdownFieldBinding({\n                                         propertyKey,\n                                         value,\n                                         setValue,\n                                         error,\n                                         showError,\n                                         disabled,\n                                         autoFocus,\n                                         touched,\n                                         property,\n                                         tableMode,\n                                         includeDescription,\n                                         context\n                                     }: FieldProps<string>) {\n\n    const [internalValue, setInternalValue] = React.useState(value);\n    const valueRef = useRef(value);\n\n    const deferred = useDeferredValue({\n        internalValue,\n        value\n    });\n\n    useEffect(() => {\n        valueRef.current = value;\n        setInternalValue(value);\n    }, [value]);\n\n    useEffect(() => {\n        if (deferred.internalValue !== valueRef.current)\n            setValue(deferred.internalValue);\n    }, [deferred]);\n\n    return (\n        <StyledFormControl\n            required={property.validation?.required}\n            error={showError}\n            fullWidth>\n\n            {!tableMode && <FormHelperText filled>\n                <LabelWithIcon icon={getIconForProperty(property)}\n                               required={property.validation?.required}\n                               title={property.name}/>\n            </FormHelperText>}\n\n            <MdEditor value={internalValue ?? \"\"}\n                      readOnly={disabled}\n                      renderHTML={text => mdParser.render(text)}\n                      view={{\n                          menu: true,\n                          md: true,\n                          html: false\n                      }}\n                      onChange={({\n                                     html,\n                                     text\n                                 }) => {\n                          setInternalValue(text ?? null);\n                      }}/>\n\n            <Box display={\"flex\"}>\n                <Box flexGrow={1}>\n                    {showError &&\n                        typeof error === \"string\" &&\n                        <FormHelperText error={true}>{error}</FormHelperText>}\n                    {includeDescription &&\n                        <FieldDescription property={property}/>}\n                </Box>\n            </Box>\n\n        </StyledFormControl>\n    );\n\n}\n\nconst StyledFormControl = styled(FormControl)((\n    { theme }: {\n        theme: Theme\n    }\n) => (`\n  @font-face {\n    font-family: rmel-iconfont;\n    src: url(data:application/vnd.ms-fontobject;base64,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NS4BJyMOAd0VGwEBGxWRFRsbFWEcFBQcYRUbGxWRFRsBARsCK2EVGxsVkRUbAQEbKRySARsVYRwpGwEBGxWRFRsBHwEbFZEVGwEBGykcYRUbwwEbFWEcKRsBARsVkRUb/qscKRsBARsVkRUbGxUBtRQcYRUbGxWRFRsBARsAAAAAAAASAN4AAQAAAAAAAAAVAAAAAQAAAAAAAQANABUAAQAAAAAAAgAHACIAAQAAAAAAAwANACkAAQAAAAAABAANADYAAQAAAAAABQALAEMAAQAAAAAABgANAE4AAQAAAAAACgArAFsAAQAAAAAACwATAIYAAwABBAkAAAAqAJkAAwABBAkAAQAaAMMAAwABBAkAAgAOAN0AAwABBAkAAwAaAOsAAwABBAkABAAaAQUAAwABBAkABQAWAR8AAwABBAkABgAaATUAAwABBAkACgBWAU8AAwABBAkACwAmAaUKQ3JlYXRlZCBieSBpY29uZm9udApybWVsLWljb25mb250UmVndWxhcnJtZWwtaWNvbmZvbnRybWVsLWljb25mb250VmVyc2lvbiAxLjBybWVsLWljb25mb250R2VuZXJhdGVkIGJ5IHN2ZzJ0dGYgZnJvbSBGb250ZWxsbyBwcm9qZWN0Lmh0dHA6Ly9mb250ZWxsby5jb20ACgBDAHIAZQBhAHQAZQBkACAAYgB5ACAAaQBjAG8AbgBmAG8AbgB0AAoAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABSAGUAZwB1AGwAYQByAHIAbQBlAGwALQBpAGMAbwBuAGYAbwBuAHQAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABWAGUAcgBzAGkAbwBuACAAMQAuADAAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABHAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAHMAdgBnADIAdAB0AGYAIABmAHIAbwBtACAARgBvAG4AdABlAGwAbABvACAAcAByAG8AagBlAGMAdAAuAGgAdAB0AHAAOgAvAC8AZgBvAG4AdABlAGwAbABvAC4AYwBvAG0AAAAAAgAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaAQIBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwADdGFiCGtleWJvYXJkBmRlbGV0ZQpjb2RlLWJsb2NrBGNvZGUKdmlzaWJpbGl0eQp2aWV3LXNwbGl0BGxpbmsEcmVkbwR1bmRvBGJvbGQGaXRhbGljDGxpc3Qtb3JkZXJlZA5saXN0LXVub3JkZXJlZAVxdW90ZQ1zdHJpa2V0aHJvdWdoCXVuZGVybGluZQR3cmFwCWZvbnQtc2l6ZQRncmlkBWltYWdlC2V4cGFuZC1sZXNzC2V4cGFuZC1tb3JlD2Z1bGxzY3JlZW4tZXhpdApmdWxsc2NyZWVuAAAAAAA=);\n    src: url(data:font/ttf;base64,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) format(\"truetype\")\n  }\n\n  .rmel-iconfont {\n    font-family: rmel-iconfont !important;\n    font-size: 16px;\n    font-style: normal;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale\n  }\n\n  .rmel-icon-tab:before {\n    content: \"\\\\e76d\"\n  }\n\n  .rmel-icon-keyboard:before {\n    content: \"\\\\ed80\"\n  }\n\n  .rmel-icon-delete:before {\n    content: \"\\\\ed3c\"\n  }\n\n  .rmel-icon-code-block:before {\n    content: \"\\\\e941\"\n  }\n\n  .rmel-icon-code:before {\n    content: \"\\\\ed3b\"\n  }\n\n  .rmel-icon-visibility:before {\n    content: \"\\\\ed44\"\n  }\n\n  .rmel-icon-view-split:before {\n    content: \"\\\\ed45\"\n  }\n\n  .rmel-icon-link:before {\n    content: \"\\\\ed5f\"\n  }\n\n  .rmel-icon-redo:before {\n    content: \"\\\\ed60\"\n  }\n\n  .rmel-icon-undo:before {\n    content: \"\\\\ed61\"\n  }\n\n  .rmel-icon-bold:before {\n    content: \"\\\\ed6f\"\n  }\n\n  .rmel-icon-italic:before {\n    content: \"\\\\ed70\"\n  }\n\n  .rmel-icon-list-ordered:before {\n    content: \"\\\\ed71\"\n  }\n\n  .rmel-icon-list-unordered:before {\n    content: \"\\\\ed72\"\n  }\n\n  .rmel-icon-quote:before {\n    content: \"\\\\ed73\"\n  }\n\n  .rmel-icon-strikethrough:before {\n    content: \"\\\\ed74\"\n  }\n\n  .rmel-icon-underline:before {\n    content: \"\\\\ed75\"\n  }\n\n  .rmel-icon-wrap:before {\n    content: \"\\\\ed77\"\n  }\n\n  .rmel-icon-font-size:before {\n    content: \"\\\\ed78\"\n  }\n\n  .rmel-icon-grid:before {\n    content: \"\\\\ed8c\"\n  }\n\n  .rmel-icon-image:before {\n    content: \"\\\\ed8d\"\n  }\n\n  .rmel-icon-expand-less:before {\n    content: \"\\\\ed9f\"\n  }\n\n  .rmel-icon-expand-more:before {\n    content: \"\\\\eda0\"\n  }\n\n  .rmel-icon-fullscreen-exit:before {\n    content: \"\\\\eda1\"\n  }\n\n  .rmel-icon-fullscreen:before {\n    content: \"\\\\eda2\"\n  }\n\n  .rc-md-editor {\n    padding-bottom: 1px;\n    position: relative;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    overflow: hidden;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: column;\n    -ms-flex-direction: column;\n    flex-direction: column;\n            border-radius: 6px;\n            background-color: ${fieldBackground(theme)};\n  }\n\n  .rc-md-editor.full {\n    width: 100%;\n    height: 100% !important;\n    position: fixed;\n    left: 0;\n    top: 0;\n    z-index: 1000\n  }\n\n  .rc-md-editor .editor-container {\n    -webkit-box-flex: 1;\n    -webkit-flex: 1;\n    -ms-flex: 1;\n    flex: 1;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    width: 100%;\n    min-height: 0;\n    position: relative;\n                background-color: ${fieldBackground(theme)};\n\n  }\n\n  .rc-md-editor .editor-container > .section {\n    -webkit-box-flex: 1;\n    -webkit-flex-grow: 1;\n    -ms-flex-positive: 1;\n    flex-grow: 1;\n    -webkit-flex-shrink: 1;\n    -ms-flex-negative: 1;\n    flex-shrink: 1;\n    -webkit-flex-basis: 1px;\n    -ms-flex-preferred-size: 1px;\n    flex-basis: 1px;\n    padding: 4px;\n    \n            border: none\n  }\n\n  .rc-md-editor .editor-container > .section.in-visible {\n    display: none\n  }\n\n  .rc-md-editor .editor-container > .section > .section-container {\n    padding: 8x 16px 16px\n  }\n  \n  .rc-md-editor .editor-container > .section:last-child {\n    border-radius: unset\n  }\n\n  .rc-md-editor .editor-container .sec-md {\n    min-height: 0;\n    min-width: 0\n  }\n\n  .rc-md-editor .editor-container .sec-md .input {\n    display: block;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    width: 100%;\n    height: 100%;\n    overflow-y: scroll;\n    border: none;\n    resize: none;\n    outline: none;\n    min-height: 0;\n    color: inherit;\n    font-size: 14px;\n    line-height: 1.7;   \n             background-color: ${fieldBackground(theme)};\n\n  }\n\n  .rc-md-editor .editor-container .sec-html {\n    min-height: 0;\n    min-width: 0;         \n       background-color: ${fieldBackground(theme)};\n\n  }\n\n  .rc-md-editor .editor-container .sec-html .html-wrap {\n    height: 100%;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    overflow: auto\n  }\n\n  .custom-html-style {\n    color: inherit\n  }\n\n  .custom-html-style h1 {\n    font-size: 32px;\n    padding: 0;\n    border: none;\n    font-weight: 700;\n    margin: 32px 0;\n    line-height: 1.2\n  }\n\n  .custom-html-style h2 {\n    font-size: 24px;\n    padding: 0;\n    border: none;\n    font-weight: 700;\n    margin: 24px 0;\n    line-height: 1.7\n  }\n\n  .custom-html-style h3 {\n    font-size: 18px;\n    margin: 18px 0;\n    padding: 0;\n    line-height: 1.7;\n    border: none\n  }\n\n  .custom-html-style p {\n    font-size: 14px;\n    line-height: 1.7;\n    margin: 8px 0\n  }\n\n  .custom-html-style a {\n    color: ${darken(theme.palette.text.secondary, 0.00)}\n  }\n\n  .custom-html-style a:hover {\n    text-decoration: none\n  }\n\n  .custom-html-style strong {\n    font-weight: 700\n  }\n\n  .custom-html-style ol, .custom-html-style ul {\n    font-size: 14px;\n    line-height: 28px;\n    padding-left: 36px\n  }\n\n  .custom-html-style li {\n    margin-bottom: 8px;\n    line-height: 1.7\n  }\n\n  .custom-html-style hr {\n    margin-top: 20px;\n    margin-bottom: 20px;\n    border: 0;\n    border-top: 1px solid ${theme.palette.divider}\n  }\n\n  .custom-html-style pre {\n    display: block;\n    padding: 20px;\n    line-height: 28px;\n    word-break: break-word\n  }\n\n  .custom-html-style code, .custom-html-style pre {\n    background-color: ${darken(theme.palette.background.default, 0.10)};\n    font-size: 14px;\n    border-radius: 0;\n    overflow-x: auto\n  }\n\n  .custom-html-style code {\n    padding: 3px 0;\n    margin: 0;\n    word-break: normal\n  }\n\n  .custom-html-style code:after, .custom-html-style code:before {\n    letter-spacing: 0\n  }\n\n  .custom-html-style blockquote {\n    position: relative;\n    margin: 16px 0;\n    padding: 5px 8px 5px 30px;\n    background: none repeat scroll 0 0 ${\"rgb(39 39 41)\"};\n    color: inherit;\n    border: none;\n    border-left: 10px solid #d6dbdf\n  }\n\n  .custom-html-style img, .custom-html-style video {\n    max-width: 100%\n  }\n\n  .custom-html-style table {\n    font-size: 14px;\n    line-height: 1.7;\n    max-width: 100%;\n    overflow: auto;\n    border: 1px solid ${theme.palette.divider};\n    border-collapse: collapse;\n    border-spacing: 0;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box\n  }\n\n  .custom-html-style table td, .custom-html-style table th {\n    word-break: break-all;\n    word-wrap: break-word;\n    white-space: normal\n  }\n\n  .custom-html-style table tr {\n    border: 1px solid ${theme.palette.divider}\n  }\n\n  .custom-html-style table tr:nth-of-type(2n) {\n    background-color: transparent\n  }\n\n  .custom-html-style table th {\n    text-align: center;\n    font-weight: 700;\n    border: 1px solid ${theme.palette.divider};\n    padding: 10px 6px;\n    background-color: #f5f7fa;\n    word-break: break-word\n  }\n\n  .custom-html-style table td {\n    border: 1px solid ${theme.palette.divider};\n    text-align: left;\n    padding: 10px 15px;\n    word-break: break-word;\n    min-width: 60px\n  }\n\n  .rc-md-editor .drop-wrap {\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 28px;\n    z-index: 2;\n    min-width: 20px;\n    padding: 10px 0;\n    text-align: center;\n    background-color: ${darken(theme.palette.background.default, 0.00)};\n    border-color: ${theme.palette.divider};\n    border-style: solid;\n    border-width: 1px\n  }\n\n  .rc-md-editor .drop-wrap.hidden {\n    display: none !important\n  }\n\n  .rc-md-editor .rc-md-navigation {\n    min-height: 38px;\n    padding: 0 8px;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    border-bottom: 1px solid ${theme.palette.divider};\n    font-size: 16px;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n    -ms-flex-direction: row;\n    flex-direction: row;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n    \n            color: \"inherit\",\n            background-color: ${theme.palette.mode === \"light\" ? \"rgb(39 39 41)\" : \"rgb(39 39 41)\"};\n        \n  }\n\n  .rc-md-editor .rc-md-navigation.in-visible {\n    display: none\n  }\n\n  .rc-md-editor .rc-md-navigation .navigation-nav {\n    -webkit-box-align: center;\n    -webkit-align-items: center;\n    -ms-flex-align: center;\n    align-items: center;\n    -webkit-box-pack: center;\n    -webkit-justify-content: center;\n    -ms-flex-pack: center;\n    justify-content: center;\n    font-size: 14px;\n    color: ${darken(theme.palette.text.secondary, 0.00)};\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap, .rc-md-editor .rc-md-navigation .navigation-nav {\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: row;\n    -ms-flex-direction: row;\n    flex-direction: row\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap {\n    -webkit-flex-wrap: wrap;\n    -ms-flex-wrap: wrap;\n    flex-wrap: wrap\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap .button {\n    position: relative;\n    min-width: 22px;\n    height: 28px;\n    margin-left: 3px;\n    margin-right: -2px;\n    display: inline-block;\n    cursor: pointer;\n    line-height: 28px;\n    text-align: center;\n    color: ${theme.palette.text.secondary};\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap .button:hover {\n    color: ${darken(theme.palette.text.secondary, 0.20)};\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap .button.disabled {\n    color: ${darken(theme.palette.text.disabled, 0.00)};\n    cursor: not-allowed\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap .button:first-of-type {\n    margin-left: 0\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap .button:last-child {\n    margin-right: 0\n  }\n\n  .rc-md-editor .rc-md-navigation .button-wrap .rmel-iconfont {\n    font-size: 18px\n  }\n\n  .rc-md-editor .rc-md-navigation li, .rc-md-editor .rc-md-navigation ul {\n    list-style: none;\n    margin: 0;\n    padding: 0\n  }\n\n  .rc-md-editor .rc-md-navigation .h1, .rc-md-editor .rc-md-navigation .h2, .rc-md-editor .rc-md-navigation .h3, .rc-md-editor .rc-md-navigation .h4, .rc-md-editor .rc-md-navigation .h5, .rc-md-editor .rc-md-navigation .h6, .rc-md-editor .rc-md-navigation h1, .rc-md-editor .rc-md-navigation h2, .rc-md-editor .rc-md-navigation h3, .rc-md-editor .rc-md-navigation h4, .rc-md-editor .rc-md-navigation h5, .rc-md-editor .rc-md-navigation h6 {\n    font-family: inherit;\n    font-weight: 500;\n    color: inherit;\n    padding: 0;\n    margin: 0;\n    line-height: 1.1\n  }\n\n  .rc-md-editor .rc-md-navigation h1 {\n    font-size: 34px\n  }\n\n  .rc-md-editor .rc-md-navigation h2 {\n    font-size: 30px\n  }\n\n  .rc-md-editor .rc-md-navigation h3 {\n    font-size: 24px\n  }\n\n  .rc-md-editor .rc-md-navigation h4 {\n    font-size: 18px\n  }\n\n  .rc-md-editor .rc-md-navigation h5 {\n    font-size: 14px\n  }\n\n  .rc-md-editor .rc-md-navigation h6 {\n    font-size: 12px\n  }\n\n  .rc-md-editor .tool-bar {\n    position: absolute;\n    z-index: 1;\n    right: 8px;\n    top: 8px\n  }\n\n  .rc-md-editor .tool-bar .button {\n    min-width: 24px;\n    height: 28px;\n    margin-right: 5px;\n    display: inline-block;\n    cursor: pointer;\n    font-size: 14px;\n    line-height: 28px;\n    text-align: center;\n    color: #999\n  }\n\n  .rc-md-editor .tool-bar .button:hover {\n    color: inherit\n  }\n\n  .rc-md-editor .rc-md-divider {\n    display: block;\n    width: 1px;\n    background-color: ${darken(theme.palette.background.paper, 0.0)}\n  }\n\n  .rc-md-editor .table-list.wrap {\n    position: relative;\n    margin: 0 10px;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box\n  }\n\n  .rc-md-editor .table-list.wrap .list-item {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    background-color: ${darken(theme.palette.background.paper, 0.05)};\n    border-radius: 4px\n  }\n\n  .rc-md-editor .table-list.wrap .list-item.active {\n    background: ${lighten(theme.palette.background.paper, 0.20)}\n  }\n\n  .rc-md-editor .tab-map-list .list-item {\n    width: 120px;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box\n  }\n\n  .rc-md-editor .tab-map-list .list-item:hover {\n    background: ${darken(theme.palette.background.default, 0.10)}\n  }\n\n  .rc-md-editor .tab-map-list .list-item.active {\n    font-weight: 700\n  }\n\n  .rc-md-editor .header-list .list-item {\n    width: 100px;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    padding: 8px 0\n  }\n\n  .rc-md-editor .header-list .list-item:hover {\n    background: ${darken(theme.palette.background.default, 0.10)}\n  }\n\n`\n));\n","import {\n    CMSType,\n    EntityReference,\n    GeoPoint,\n    ResolvedArrayProperty,\n    ResolvedMapProperty,\n    ResolvedProperties,\n    ResolvedProperty\n} from \"../types\";\nimport * as yup from \"yup\";\nimport { AnySchema, ArraySchema, BooleanSchema, DateSchema, NumberSchema, ObjectSchema, StringSchema } from \"yup\";\nimport { enumToObjectEntries } from \"../core/util/enums\";\nimport { getValueInPath, hydrateRegExp, isPropertyBuilder } from \"../core\";\n\n// Add custom unique function for array values\ndeclare module \"yup\" {\n    // tslint:disable-next-line\n    interface ArraySchema<T> {\n        uniqueInArray(mapper: (a: T) => T, message: string): ArraySchema<T>;\n    }\n}\nyup.addMethod(yup.array, \"uniqueInArray\", function (\n    mapper = (a: any) => a,\n    message: string\n) {\n    return this.test(\"uniqueInArray\", message, values => {\n        return !values || values.length === new Set(values.map(mapper)).size;\n    });\n});\n\nexport type CustomFieldValidator = (props: {\n    name: string,\n    value: any,\n    property: ResolvedProperty,\n    entityId?: string,\n    parentProperty?: ResolvedMapProperty | ResolvedArrayProperty,\n}) => Promise<boolean>;\n\ninterface PropertyContext<T extends CMSType> {\n    property: ResolvedProperty<T>,\n    parentProperty?: ResolvedMapProperty | ResolvedArrayProperty,\n    entityId: string,\n    customFieldValidator?: CustomFieldValidator,\n    name?: any\n}\n\nexport function getYupEntitySchema<M extends Record<string, any>>(\n    entityId: string,\n    properties: ResolvedProperties<M>,\n    customFieldValidator?: CustomFieldValidator): ObjectSchema<any> {\n    const objectSchema: any = {};\n    Object.entries(properties as Record<string, ResolvedProperty>)\n        .forEach(([name, property]) => {\n            objectSchema[name] = mapPropertyToYup({\n                property: property as ResolvedProperty<any>,\n                customFieldValidator,\n                name,\n                entityId\n            });\n        });\n    return yup.object().shape(objectSchema);\n}\n\nexport function mapPropertyToYup<T extends CMSType>(propertyContext: PropertyContext<T>): AnySchema<unknown> {\n\n    const property = propertyContext.property;\n    if (isPropertyBuilder(property)) {\n        console.error(\"Error in property\", propertyContext);\n        throw Error(\"Trying to create a yup mapping from a property builder. Please use resolved properties only\");\n    }\n\n    if (property.dataType === \"string\") {\n        return getYupStringSchema(propertyContext as PropertyContext<string>);\n    } else if (property.dataType === \"number\") {\n        return getYupNumberSchema(propertyContext as PropertyContext<number>);\n    } else if (property.dataType === \"boolean\") {\n        return getYupBooleanSchema(propertyContext as PropertyContext<boolean>);\n    } else if (property.dataType === \"map\") {\n        return getYupMapObjectSchema(propertyContext as PropertyContext<object>);\n    } else if (property.dataType === \"array\") {\n        return getYupArraySchema(propertyContext as PropertyContext<any[]>);\n    } else if (property.dataType === \"date\") {\n        return getYupDateSchema(propertyContext as PropertyContext<Date>);\n    } else if (property.dataType === \"geopoint\") {\n        return getYupGeoPointSchema(propertyContext as PropertyContext<GeoPoint>);\n    } else if (property.dataType === \"reference\") {\n        return getYupReferenceSchema(propertyContext as PropertyContext<EntityReference>);\n    }\n    console.error(\"Unsupported data type in yup mapping\", property)\n    throw Error(\"Unsupported data type in yup mapping\");\n}\n\nexport function getYupMapObjectSchema<M extends Record<string, any>>({\n                                                                         property,\n                                                                         entityId,\n                                                                         customFieldValidator,\n                                                                         name\n                                                                     }: PropertyContext<M>): ObjectSchema<any> {\n    const objectSchema: any = {};\n    const validation = property.validation;\n    if (property.properties)\n        Object.entries(property.properties).forEach(([childName, childProperty]: [string, ResolvedProperty]) => {\n            objectSchema[childName] = mapPropertyToYup<any>({\n                property: childProperty,\n                parentProperty: property as ResolvedMapProperty,\n                customFieldValidator,\n                name: `${name}[${childName}]`,\n                entityId\n            });\n        });\n\n    return yup.object().shape(objectSchema);\n    // const object: ObjectSchema<any> = yup.object().shape(objectSchema);\n    // return validation?.required\n    //     ? object.required(validation?.requiredMessage ? validation.requiredMessage : \"Required\").nullable(true)\n    //     : yup.object().optional().default(undefined).notRequired().nullable(true).test(\n    //         \"empty-check\",\n    //         \"Optional map can be empty\",\n    //         (o: any, testContext: any) => {\n    //             try {\n    //                 if (!o || Object.keys(o).length === 0) return true;\n    //                 return object.validateSync(o);\n    //             } catch (e) {\n    //                 testContext.createError(e);\n    //                 console.error(e);\n    //                 return false;\n    //             }\n    //         });\n}\n\nfunction getYupStringSchema({\n                                property,\n                                parentProperty,\n                                customFieldValidator,\n                                name,\n                                entityId\n                            }: PropertyContext<string>): StringSchema {\n    let collection: StringSchema<any> = yup.string();\n    const validation = property.validation;\n    if (property.enumValues) {\n        if (validation?.required)\n            collection = collection.required(validation?.requiredMessage ? validation.requiredMessage : \"Required\");\n        const entries = enumToObjectEntries(property.enumValues);\n        collection = collection.oneOf(\n            (validation?.required ? entries : [...entries, null])\n                .map((enumValueConfig) => enumValueConfig?.id ?? null)\n        ).nullable(true);\n    }\n    if (validation) {\n        collection = validation.required\n            ? collection.required(validation?.requiredMessage ? validation.requiredMessage : \"Required\").nullable(true)\n            : collection.notRequired().nullable(true);\n        if (validation.unique && customFieldValidator && name)\n            collection = collection.test(\"unique\", \"This value already exists and should be unique\",\n                (value, context) =>\n                    customFieldValidator({\n                        name,\n                        property,\n                        parentProperty,\n                        value,\n                        entityId\n                    }));\n        if (validation.min || validation.min === 0) collection = collection.min(validation.min, `${property.name} must be min ${validation.min} characters long`);\n        if (validation.max || validation.max === 0) collection = collection.max(validation.max, `${property.name} must be max ${validation.max} characters long`);\n        if (validation.matches) {\n            const regExp = typeof validation.matches === \"string\" ? hydrateRegExp(validation.matches) : validation.matches;\n            if (regExp) {\n                collection = collection.matches(regExp, validation.matchesMessage ? { message: validation.matchesMessage } : undefined)\n            }\n        }\n        if (validation.trim) collection = collection.trim();\n        if (validation.lowercase) collection = collection.lowercase();\n        if (validation.uppercase) collection = collection.uppercase();\n        if (property.email) collection = collection.email(`${property.name} must be an email`);\n        if (property.url) collection = collection.url(`${property.name} must be a url`);\n    } else {\n        collection = collection.notRequired().nullable(true);\n    }\n    return collection;\n}\n\nfunction getYupNumberSchema({\n                                property,\n                                parentProperty,\n                                customFieldValidator,\n                                name,\n                                entityId\n                            }: PropertyContext<number>): NumberSchema {\n    const validation = property.validation;\n    let collection: NumberSchema<any> = yup.number().typeError(\"Must be a number\");\n    if (validation) {\n        collection = validation.required\n            ? collection.required(validation.requiredMessage ? validation.requiredMessage : \"Required\").nullable(true)\n            : collection.notRequired().nullable(true);\n        if (validation.unique && customFieldValidator && name)\n            collection = collection.test(\"unique\",\n                \"This value already exists and should be unique\",\n                (value) => customFieldValidator({\n                    name,\n                    property,\n                    parentProperty,\n                    value,\n                    entityId\n                }));\n        if (validation.min || validation.min === 0) collection = collection.min(validation.min, `${property.name} must be higher or equal to ${validation.min}`);\n        if (validation.max || validation.max === 0) collection = collection.max(validation.max, `${property.name} must be lower or equal to ${validation.max}`);\n        if (validation.lessThan || validation.lessThan === 0) collection = collection.lessThan(validation.lessThan, `${property.name} must be higher than ${validation.lessThan}`);\n        if (validation.moreThan || validation.moreThan === 0) collection = collection.moreThan(validation.moreThan, `${property.name} must be lower than ${validation.moreThan}`);\n        if (validation.positive) collection = collection.positive(`${property.name} must be positive`);\n        if (validation.negative) collection = collection.negative(`${property.name} must be negative`);\n        if (validation.integer) collection = collection.integer(`${property.name} must be an integer`);\n    } else {\n        collection = collection.notRequired().nullable(true);\n    }\n    return collection;\n}\n\nfunction getYupGeoPointSchema({\n                                  property,\n                                  parentProperty,\n                                  customFieldValidator,\n                                  name,\n                                  entityId\n                              }: PropertyContext<GeoPoint>): AnySchema {\n    let collection: ObjectSchema<any> = yup.object();\n    const validation = property.validation;\n    if (validation?.unique && customFieldValidator && name)\n        collection = collection.test(\"unique\",\n            \"This value already exists and should be unique\",\n            (value) => customFieldValidator({\n                name,\n                property,\n                parentProperty,\n                value,\n                entityId\n            }));\n    if (validation?.required) {\n        collection = collection.required(validation.requiredMessage).nullable(true);\n    } else {\n        collection = collection.notRequired().nullable(true);\n    }\n    return collection;\n}\n\nfunction getYupDateSchema({\n                              property,\n                              parentProperty,\n                              customFieldValidator,\n                              name,\n                              entityId\n                          }: PropertyContext<Date>): AnySchema | DateSchema {\n    if (property.autoValue) {\n        return yup.object().nullable();\n    }\n    let collection: DateSchema<any> = yup.date();\n    const validation = property.validation;\n    if (validation) {\n        collection = validation.required\n            ? collection.required(validation?.requiredMessage ? validation.requiredMessage : \"Required\")\n            : collection.notRequired();\n        if (validation.unique && customFieldValidator && name)\n            collection = collection.test(\"unique\",\n                \"This value already exists and should be unique\",\n                (value) => customFieldValidator({\n                    name,\n                    property,\n                    parentProperty,\n                    value,\n                    entityId\n                }));\n        if (validation.min) collection = collection.min(validation.min, `${property.name} must be after ${validation.min}`);\n        if (validation.max) collection = collection.max(validation.max, `${property.name} must be before ${validation.min}`);\n    } else {\n        collection = collection.notRequired();\n    }\n    return collection\n        .transform((v: any) => (v instanceof Date ? v : null))\n        .nullable();\n}\n\nfunction getYupReferenceSchema({\n                                   property,\n                                   parentProperty,\n                                   customFieldValidator,\n                                   name,\n                                   entityId\n                               }: PropertyContext<EntityReference>): AnySchema {\n    let collection: ObjectSchema<any> = yup.object();\n    const validation = property.validation;\n    if (validation) {\n        collection = validation.required\n            ? collection.required(validation?.requiredMessage ? validation.requiredMessage : \"Required\").nullable(true)\n            : collection.notRequired().nullable(true);\n        if (validation.unique && customFieldValidator && name)\n            collection = collection.test(\"unique\",\n                \"This value already exists and should be unique\",\n                (value) => customFieldValidator({\n                    name,\n                    property,\n                    parentProperty,\n                    value,\n                    entityId\n                }));\n    } else {\n        collection = collection.notRequired().nullable(true);\n    }\n    return collection;\n}\n\nfunction getYupBooleanSchema({\n                                 property,\n                                 parentProperty,\n                                 customFieldValidator,\n                                 name,\n                                 entityId\n                             }: PropertyContext<boolean>): BooleanSchema {\n    let collection: BooleanSchema<any> = yup.boolean();\n    const validation = property.validation;\n    if (validation) {\n        collection = validation.required\n            ? collection.required(validation?.requiredMessage ? validation.requiredMessage : \"Required\").nullable(true)\n            : collection.notRequired().nullable(true);\n        if (validation.unique && customFieldValidator && name)\n            collection = collection.test(\"unique\",\n                \"This value already exists and should be unique\",\n                (value) => customFieldValidator({\n                    name,\n                    property,\n                    parentProperty,\n                    value,\n                    entityId\n                }));\n    } else {\n        collection = collection.notRequired().nullable(true);\n    }\n    return collection;\n}\n\nfunction hasUniqueInArrayModifier(property: ResolvedProperty): boolean | [string, ResolvedProperty][] {\n    if (property.validation?.uniqueInArray) {\n        return true;\n    } else if (property.dataType === \"map\" && property.properties) {\n        return Object.entries(property.properties)\n            .filter(([key, childProperty]) => childProperty.validation?.uniqueInArray);\n    }\n    return false;\n}\n\nfunction getYupArraySchema({\n                               property,\n                               parentProperty,\n                               customFieldValidator,\n                               name,\n                               entityId\n                           }: PropertyContext<any[]>): AnySchema<any> {\n\n    let arraySchema: ArraySchema<any> = yup.array();\n\n    if (property.of) {\n        if (Array.isArray(property.of)) {\n            const yupProperties = (property.of as ResolvedProperty[]).map((p, index) => ({\n                [`${name}[${index}]`]: mapPropertyToYup({\n                    property: p as ResolvedProperty<any>,\n                    parentProperty: property,\n                    entityId\n                })\n            })).reduce((a, b) => ({ ...a, ...b }), {});\n            return yup.array().of(\n                yup.mixed().test(\n                    \"Dynamic object validation\",\n                    \"Dynamic object validation error\",\n                    (object, context) => {\n                        const yupProperty = getValueInPath(yupProperties, context.path);\n                        return yupProperty.validate(object);\n                    }\n                )\n            );\n        } else {\n            arraySchema = arraySchema.of(mapPropertyToYup({\n                property: property.of,\n                parentProperty: property,\n                entityId\n            }));\n            const arrayUniqueFields = hasUniqueInArrayModifier(property.of);\n            if (arrayUniqueFields) {\n                if (typeof arrayUniqueFields === \"boolean\") {\n                    arraySchema = arraySchema.uniqueInArray(v => v, `${property.name} should have unique values within the array`);\n                } else if (Array.isArray(arrayUniqueFields)) {\n                    arrayUniqueFields.forEach(([name, childProperty]) => {\n                            arraySchema = arraySchema.uniqueInArray(v => v && v[name], `${property.name} → ${childProperty.name ?? name}: should have unique values within the array`);\n                        }\n                    );\n                }\n            }\n        }\n    }\n    const validation = property.validation;\n\n    if (validation) {\n        arraySchema = validation.required\n            ? arraySchema.required(validation?.requiredMessage ? validation.requiredMessage : \"Required\").nullable(true)\n            : arraySchema.notRequired().nullable(true);\n        if (validation.min || validation.min === 0) arraySchema = arraySchema.min(validation.min, `${property.name} should be min ${validation.min} entries long`);\n        if (validation.max) arraySchema = arraySchema.max(validation.max, `${property.name} should be max ${validation.max} entries long`);\n    } else {\n        arraySchema = arraySchema.notRequired().nullable(true);\n    }\n    return arraySchema;\n}\n","import React, { useEffect } from \"react\";\nimport { useFormikContext } from \"formik\";\n\nexport const ErrorFocus = ({ containerRef }:\n                               { containerRef?: React.RefObject<HTMLDivElement> }) => {\n    const { isSubmitting, isValidating, errors } = useFormikContext();\n\n    useEffect(() => {\n        const keys = Object.keys(errors);\n\n        // Whenever there are errors and the form is submitting but finished validating.\n        if (keys.length > 0 && isSubmitting && !isValidating) {\n            const errorElement = containerRef?.current?.querySelector<HTMLDivElement>(\n                `#form_field_${keys[0]}`\n            );\n\n            if (errorElement && containerRef?.current) {\n                const scrollableParent = getScrollableParent(containerRef.current);\n                if (scrollableParent) {\n                    const top = errorElement.getBoundingClientRect().top;\n                    scrollableParent.scrollTo({\n                        top: scrollableParent.scrollTop + top - 64,\n                        behavior: \"smooth\"\n                    });\n                }\n                const input = errorElement.querySelector(\"input\");\n                if (input) input.focus();\n            }\n        }\n    }, [isSubmitting, isValidating, errors, containerRef]);\n\n    // This component does not render anything by itself.\n    return null;\n};\n\nconst isScrollable = (ele: HTMLElement | null) => {\n    const hasScrollableContent = ele && ele.scrollHeight > ele.clientHeight;\n\n    const overflowYStyle = ele ? window.getComputedStyle(ele).overflowY : null;\n    const isOverflowHidden = overflowYStyle && overflowYStyle.indexOf(\"hidden\") !== -1;\n\n    return hasScrollableContent && !isOverflowHidden;\n};\n\nconst getScrollableParent = (ele: HTMLElement | null): HTMLElement | null => {\n    return (!ele || ele === document.body)\n        ? document.body\n        : (isScrollable(ele) ? ele : getScrollableParent(ele.parentNode as HTMLElement));\n};\n","import {\n    ArrayProperty,\n    CMSType,\n    EntityCollection,\n    EntityValues,\n    EnumValueConfig,\n    EnumValues,\n    FieldConfig,\n    NumberProperty,\n    Properties,\n    PropertiesOrBuilders,\n    Property,\n    PropertyOrBuilder,\n    ResolvedArrayProperty,\n    ResolvedEntityCollection,\n    ResolvedNumberProperty,\n    ResolvedProperties,\n    ResolvedProperty,\n    ResolvedStringProperty,\n    StringProperty,\n    UserConfigurationPersistence\n} from \"../../types\";\nimport { getValueInPath, mergeDeep } from \"./objects\";\nimport { getDefaultValuesFor, isPropertyBuilder } from \"./entities\";\nimport { DEFAULT_ONE_OF_TYPE } from \"./common\";\nimport { getIn } from \"formik\";\n\nexport const resolveCollection = <M extends Record<string, any>, >\n({\n     collection,\n     path,\n     entityId,\n     values,\n     previousValues,\n     userConfigPersistence,\n     fields\n }: {\n    collection: EntityCollection<M> | ResolvedEntityCollection<M>;\n    path: string,\n    entityId?: string,\n    values?: Partial<EntityValues<M>>,\n    previousValues?: Partial<EntityValues<M>>,\n    userConfigPersistence?: UserConfigurationPersistence;\n    fields: Record<string, FieldConfig>;\n}): ResolvedEntityCollection<M> => {\n\n    const collectionOverride = userConfigPersistence?.getCollectionConfig<M>(path);\n    const storedProperties = getValueInPath(collectionOverride, \"properties\");\n\n    const defaultValues = getDefaultValuesFor(collection.properties);\n    const usedValues = values ?? defaultValues;\n    const usedPreviousValues = previousValues ?? values ?? defaultValues;\n\n    const resolvedProperties = Object.entries(collection.properties)\n        .map(([key, propertyOrBuilder]) => {\n            const propertyValue = usedValues ? getIn(usedValues, key) : undefined;\n            return ({\n                [key]: resolveProperty({\n                    propertyKey: key,\n                    propertyOrBuilder: propertyOrBuilder as PropertyOrBuilder | ResolvedProperty,\n                    values: usedValues,\n                    previousValues: usedPreviousValues,\n                    path,\n                    propertyValue,\n                    entityId,\n                    fields\n                })\n            });\n        })\n        .filter((a) => a !== null)\n        .reduce((a, b) => ({ ...a, ...b }), {}) as ResolvedProperties<M>;\n\n    const properties: Properties = mergeDeep(resolvedProperties, storedProperties);\n    const cleanedProperties = Object.entries(properties)\n        .filter(([_, property]) => Boolean(property?.dataType))\n        .map(([id, property]) => ({ [id]: property }))\n        .reduce((a, b) => ({ ...a, ...b }), {});\n\n    return {\n        ...collection,\n        properties: cleanedProperties,\n        originalCollection: collection\n    } as ResolvedEntityCollection<M>;\n\n};\n\n/**\n * Resolve property builders, enums and arrays.\n * @param propertyOrBuilder\n * @param propertyValue\n * @param values\n */\nexport function resolveProperty<T extends CMSType = CMSType, M extends Record<string, any> = any>({\n                                                                                                      propertyOrBuilder,\n                                                                                                      propertyValue,\n                                                                                                      fromBuilder = false,\n                                                                                                      ...props\n                                                                                                  }: {\n    propertyKey?: string,\n    propertyOrBuilder: PropertyOrBuilder<T, M> | ResolvedProperty<T>,\n    propertyValue?: unknown,\n    values?: Partial<M>,\n    previousValues?: Partial<M>,\n    path?: string,\n    entityId?: string,\n    index?: number,\n    fromBuilder?: boolean;\n    fields: Record<string, FieldConfig<any>>;\n}): ResolvedProperty<T> | null {\n\n    if (typeof propertyOrBuilder === \"object\" && \"resolved\" in propertyOrBuilder) {\n        return propertyOrBuilder as ResolvedProperty<T>;\n    }\n\n    let resolvedProperty: ResolvedProperty<T> | null = null;\n\n    if (!propertyOrBuilder) {\n        return null;\n    } else if (isPropertyBuilder(propertyOrBuilder)) {\n        const path = props.path;\n        if (!path)\n            throw Error(\"Trying to resolve a property builder without specifying the entity path\");\n\n        const result: Property<T> | null = propertyOrBuilder({\n            ...props,\n            path,\n            propertyValue,\n            values: props.values ?? {},\n            previousValues: props.previousValues ?? props.values ?? {}\n        });\n\n        if (!result) {\n            console.debug(\"Property builder not returning `Property` so it is not rendered\", path, props.entityId, propertyOrBuilder);\n            return null;\n        }\n\n        resolvedProperty = resolveProperty({\n            ...props,\n            propertyValue,\n            propertyOrBuilder: result,\n            fromBuilder: true\n        });\n    } else {\n        const property = propertyOrBuilder as Property<T>;\n        if (property.dataType === \"map\" && property.properties) {\n            const properties = resolveProperties({\n                ...props,\n                properties: property.properties,\n                propertyValue\n            });\n            resolvedProperty = {\n                ...property,\n                resolved: true,\n                fromBuilder,\n                properties\n            } as ResolvedProperty<T>;\n        } else if (property.dataType === \"array\") {\n            resolvedProperty = resolveArrayProperty({\n                property,\n                propertyValue,\n                fromBuilder,\n                ...props\n            }) as ResolvedProperty<any>;\n        } else if ((property.dataType === \"string\" || property.dataType === \"number\") && property.enumValues) {\n            resolvedProperty = resolvePropertyEnum(property, fromBuilder) as ResolvedProperty<any>;\n        }\n    }\n\n    if (!resolvedProperty) {\n        resolvedProperty = {\n            ...propertyOrBuilder,\n            resolved: true,\n            fromBuilder\n        } as ResolvedProperty<T>;\n    }\n\n    if (resolvedProperty.fieldConfig) {\n        const cmsFields = props.fields;\n        if (!cmsFields) {\n            throw Error(`Trying to resolve a property with key ${resolvedProperty.fieldConfig} that inherits from a custom field but no custom fields were provided. Use the property 'fields' in your top level component to provide them`);\n        }\n        const customField: FieldConfig<any> = cmsFields[resolvedProperty.fieldConfig];\n        if (!customField)\n            throw Error(`Trying to resolve a property that inherits from a custom field but no custom field with id ${resolvedProperty.fieldConfig} was found. Check the \\`fields\\` in your top level component`);\n        if (customField.defaultProperty) {\n            const customFieldProperty = resolveProperty<any>({\n                propertyOrBuilder: customField.defaultProperty,\n                propertyValue,\n                ...props\n            });\n            if (customFieldProperty) {\n                resolvedProperty = mergeDeep(customFieldProperty, resolvedProperty);\n            }\n        }\n        if (customField.Field) {\n            resolvedProperty!.Field = customField.Field;\n        }\n    }\n\n    return resolvedProperty\n        ? {\n            ...resolvedProperty,\n            resolved: true\n        }\n        : null;\n}\n\nexport function resolveArrayProperty<T extends any[], M>({\n                                                             propertyKey,\n                                                             property,\n                                                             propertyValue,\n                                                             ...props\n                                                         }: {\n    propertyKey?: string,\n    property: ArrayProperty<T> | ResolvedArrayProperty<T>,\n    propertyValue: any,\n    values?: Partial<M>,\n    previousValues?: Partial<M>,\n    path?: string,\n    entityId?: string,\n    index?: number,\n    fromBuilder?: boolean;\n    fields: Record<string, FieldConfig>;\n}): ResolvedArrayProperty {\n\n    if (property.of) {\n        if (Array.isArray(property.of)) {\n            return {\n                ...property,\n                resolved: true,\n                fromBuilder: props.fromBuilder,\n                resolvedProperties: property.of.map((p, index) => {\n                    return resolveProperty({\n                        propertyKey: `${propertyKey}.${index}`,\n                        propertyOrBuilder: p as Property<any>,\n                        propertyValue: Array.isArray(propertyValue) ? propertyValue[index] : undefined,\n                        ...props,\n                        index\n                    });\n                })\n            } as ResolvedArrayProperty;\n        } else {\n            const of = property.of;\n            const resolvedProperties: ResolvedProperty[] = Array.isArray(propertyValue)\n                ? propertyValue.map((v: any, index: number) => resolveProperty({\n                    propertyKey: `${propertyKey}.${index}`,\n                    propertyOrBuilder: of,\n                    propertyValue: v,\n                    ...props,\n                    index\n                })).filter(e => Boolean(e)) as ResolvedProperty[]\n                : [];\n            const ofProperty = resolveProperty({\n                propertyKey: `${propertyKey}`,\n                propertyOrBuilder: of,\n                propertyValue: undefined,\n                ...props\n            });\n            if (!ofProperty)\n                throw Error(\"When using a property builder as the 'of' prop of an ArrayProperty, you must return a valid child property\")\n            return {\n                ...property,\n                resolved: true,\n                fromBuilder: props.fromBuilder,\n                of: ofProperty,\n                resolvedProperties\n            } as ResolvedArrayProperty;\n        }\n    } else if (property.oneOf) {\n        const typeField = property.oneOf?.typeField ?? DEFAULT_ONE_OF_TYPE;\n        const resolvedProperties: ResolvedProperty[] = Array.isArray(propertyValue)\n            ? propertyValue.map((v, index) => {\n                const type = v && v[typeField];\n                const childProperty = property.oneOf?.properties[type];\n                if (!type || !childProperty) return null;\n                return resolveProperty({\n                    propertyKey: `${propertyKey}.${index}`,\n                    propertyOrBuilder: childProperty,\n                    propertyValue,\n                    ...props\n                });\n            }).filter(e => Boolean(e)) as ResolvedProperty[]\n            : [];\n        const properties = resolveProperties<any>({\n            properties: property.oneOf.properties,\n            propertyValue: undefined,\n            ...props\n        });\n        return {\n            ...property,\n            resolved: true,\n            oneOf: {\n                ...property.oneOf,\n                properties\n            },\n            fromBuilder: props.fromBuilder,\n            resolvedProperties\n        } as ResolvedArrayProperty;\n    } else if (!property.Field) {\n        throw Error(\"The array property needs to declare an 'of' or a 'oneOf' property, or provide a custom `Field`\")\n    } else {\n        return {\n            ...property,\n            resolved: true,\n            fromBuilder: props.fromBuilder\n        } as ResolvedArrayProperty;\n    }\n\n}\n\n/**\n * Resolve enums and arrays for properties\n * @param properties\n * @param value\n */\nexport function resolveProperties<M extends Record<string, any>>({\n                                                                     properties,\n                                                                     propertyValue,\n                                                                     ...props\n                                                                 }: {\n    properties: PropertiesOrBuilders<M>,\n    propertyValue: unknown,\n    values?: Partial<M>,\n    previousValues?: Partial<M>,\n    path?: string,\n    entityId?: string,\n    index?: number,\n    fromBuilder?: boolean;\n    fields: Record<string, FieldConfig>;\n}): ResolvedProperties<M> {\n    return Object.entries<PropertyOrBuilder>(properties as Record<string, PropertyOrBuilder>)\n        .map(([key, property]) => {\n            return {\n                [key]: resolveProperty({\n                    propertyKey: key,\n                    propertyOrBuilder: property,\n                    propertyValue: propertyValue && typeof propertyValue === \"object\" ? getValueInPath(propertyValue, key) : undefined,\n                    ...props\n                })\n            };\n        })\n        .filter((a) => a !== null)\n        .reduce((a, b) => ({ ...a, ...b }), {}) as ResolvedProperties<M>;\n}\n\n/**\n * Resolve enum aliases for a string or number property\n * @param property\n * @param fromBuilder\n */\nexport function resolvePropertyEnum(property: StringProperty | NumberProperty, fromBuilder?: boolean): ResolvedStringProperty | ResolvedNumberProperty {\n    if (typeof property.enumValues === \"object\") {\n        return {\n            ...property,\n            resolved: true,\n            enumValues: resolveEnumValues(property.enumValues)?.filter((value) => value && value.id && value.label) ?? [],\n            fromBuilder: fromBuilder ?? false\n        }\n    }\n    return property as ResolvedStringProperty | ResolvedNumberProperty;\n}\n\nexport function resolveEnumValues(input: EnumValues): EnumValueConfig[] | undefined {\n    if (typeof input === \"object\") {\n        return Object.entries(input).map(([id, value]) =>\n            (typeof value === \"string\"\n                ? {\n                    id,\n                    label: value\n                }\n                : value));\n    } else if (Array.isArray(input)) {\n        return input as EnumValueConfig[];\n    } else {\n        return undefined;\n    }\n}\n","import React, { useMemo } from \"react\";\n\nimport { styled } from \"@mui/material/styles\";\n\nimport {\n    FormControl,\n    IconButton,\n    InputAdornment,\n    InputLabel,\n    MenuItem,\n    Select as MuiSelect,\n    TextField as MuiTextField,\n    Theme,\n    Tooltip\n} from \"@mui/material\";\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\n\nimport { ErrorMessage } from \"formik\";\n\nimport {\n    Entity,\n    EntityStatus,\n    EnumValueConfig,\n    EnumValues,\n    FireCMSContext\n} from \"../../types\";\n\nimport {\n    useClipboard,\n    useFireCMSContext,\n    useSnackbarController\n} from \"../../hooks\";\nimport { resolveEnumValues } from \"../../core/util/resolutions\";\n\nconst PREFIX = \"CustomIdField\";\n\nconst classes = {\n    input: `${PREFIX}-input`,\n    select: `${PREFIX}-select`\n};\n\nconst StyledFormControl = styled(FormControl)((\n    { theme }: {\n        theme: Theme\n    }\n) => ({\n    marginBottom: \"16px\",\n    [`& .${classes.input}`]: {\n        minHeight: \"64px\"\n    },\n\n    [`& .${classes.select}`]: {\n        paddingTop: theme.spacing(1 / 2)\n    }\n}));\n\nexport function CustomIdField<M extends Record<string, any>, UserType>({\n                                                                           customId,\n                                                                           entityId,\n                                                                           status,\n                                                                           onChange,\n                                                                           error,\n                                                                           entity\n                                                                       }: {\n    customId?: boolean | EnumValues | \"optional\"\n    entityId?: string\n    status: EntityStatus,\n    onChange: (id?: string) => void,\n    error: boolean,\n    entity: Entity<M> | undefined\n}) {\n\n    const disabled = status === \"existing\" || !customId;\n    const idSetAutomatically = status !== \"existing\" && !customId;\n\n    const enumValues: EnumValueConfig[] | undefined = useMemo(() => {\n        if (!customId || typeof customId === \"boolean\" || customId === \"optional\")\n            return undefined;\n        return resolveEnumValues(customId);\n    }, [customId]);\n\n    const snackbarController = useSnackbarController();\n    const { copy } = useClipboard({\n        onSuccess: (text) => snackbarController.open({\n            type: \"success\",\n            message: `Copied ${text}`\n        })\n    });\n\n    const appConfig: FireCMSContext | undefined = useFireCMSContext();\n    const inputProps = {\n        sx: (theme:Theme) => ({\n            minHeight: \"64px\",\n            borderRadius: `${theme.shape.borderRadius}px`\n        }),\n        disableUnderline: true,\n        endAdornment: entity\n            ? (\n                <InputAdornment position=\"end\">\n\n                    <IconButton onClick={(e) => copy(entity.id)}\n                                aria-label=\"copy-id\"\n                                size=\"large\">\n                        <Tooltip title={\"Copy\"}>\n                            <svg\n                                className={\"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall\"}\n                                fill={\"currentColor\"}\n                                width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n                                <path\n                                    d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\"/>\n                            </svg>\n                        </Tooltip>\n                    </IconButton>\n\n                    {appConfig?.entityLinkBuilder &&\n                        <a href={appConfig.entityLinkBuilder({ entity })}\n                           rel=\"noopener noreferrer\"\n                           target=\"_blank\">\n                            <IconButton onClick={(e) => e.stopPropagation()}\n                                        aria-label=\"go-to-datasource\"\n                                        size=\"large\">\n                                <Tooltip title={\"Open in the console\"}>\n                                    <OpenInNewIcon fontSize={\"small\"}/>\n                                </Tooltip>\n                            </IconButton>\n                        </a>}\n\n                </InputAdornment>\n            )\n            : undefined\n    };\n\n    const fieldProps: any = {\n        label: idSetAutomatically ? \"ID is set automatically\" : \"ID\",\n        disabled,\n        name: \"id\",\n        type: null,\n        value: (entity && status === \"existing\" ? entity.id : entityId) ?? \"\",\n        variant: \"filled\",\n        sx: (theme:Theme) => ({\n            minHeight: \"64px\",\n            borderRadius: `${theme.shape.borderRadius}px`\n        })\n    };\n\n    return (\n        <StyledFormControl fullWidth\n                           error={error}\n                           {...fieldProps}\n                           key={\"custom-id-field\"}>\n\n            {enumValues &&\n                <>\n                    <InputLabel id={\"id-label\"}>{fieldProps.label}</InputLabel>\n                    <MuiSelect\n                        labelId={\"id-label\"}\n                        fullWidth\n                        className={classes.select}\n                        disableUnderline={true}\n                        error={error}\n                        {...fieldProps}\n                        onChange={(event: any) => onChange(event.target.value)}>\n                        {enumValues.map((enumConfig) =>\n                            <MenuItem\n                                key={`custom-id-item-${enumConfig.id}`}\n                                value={enumConfig.id}>\n                                {`${enumConfig.id} - ${enumConfig.label}`}\n                            </MenuItem>)}\n                    </MuiSelect>\n                </>}\n\n            {!enumValues &&\n                <MuiTextField {...fieldProps}\n                              error={error}\n                              InputProps={inputProps}\n                              helperText={customId === \"optional\" ? \"Autogenerated ID, it can be manually changed\" : (status === \"new\" || status === \"copy\" ? \"ID of the new document\" : \"ID of the document\")}\n                              onChange={(event) => {\n                                  let value = event.target.value;\n                                  if (value) value = value.trim();\n                                  return onChange(value.length ? value : undefined);\n                              }}/>}\n\n            <ErrorMessage name={\"id\"}\n                          component=\"div\">\n                {(_) => \"You need to specify an ID\"}\n            </ErrorMessage>\n\n        </StyledFormControl>\n    );\n}\n","import React, { MutableRefObject, useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { alpha, Box, Grid, Typography } from \"@mui/material\";\nimport Button from \"@mui/material/Button\";\n\nimport {\n    CMSAnalyticsEvent,\n    Entity,\n    EntityCollection,\n    EntityStatus,\n    EntityValues,\n    FormContext,\n    PluginFormActionProps,\n    PropertyFieldBindingProps,\n    ResolvedEntityCollection\n} from \"../types\";\nimport { Form, Formik, FormikHelpers, FormikProps } from \"formik\";\nimport { PropertyFieldBinding } from \"./PropertyFieldBinding\";\nimport { CustomFieldValidator, getYupEntitySchema } from \"./validation\";\nimport equal from \"react-fast-compare\"\nimport { CustomDialogActions, getDefaultValuesFor, isHidden, isReadOnly, resolveCollection } from \"../core\";\nimport { useDataSource, useFireCMSContext } from \"../hooks\";\nimport { ErrorFocus } from \"./components/ErrorFocus\";\nimport { CustomIdField } from \"./components/CustomIdField\";\n\n\n/**\n * @category Components\n */\nexport interface EntityFormProps<M extends Record<string, any>> {\n\n    /**\n     * New or existing status\n     */\n    status: EntityStatus;\n\n    /**\n     * Path of the collection this entity is located\n     */\n    path: string;\n\n    /**\n     * The collection is used to build the fields of the form\n     */\n    collection: EntityCollection<M>\n\n    /**\n     * The updated entity is passed from the parent component when the underlying data\n     * has changed in the datasource\n     */\n    entity?: Entity<M>;\n\n    /**\n     * The callback function called when Save is clicked and validation is correct\n     */\n    onEntitySaveRequested: (\n        props: EntityFormSaveParams<M>\n    ) => Promise<void>;\n\n    /**\n     * The callback function called when discard is clicked\n     */\n    onDiscard?: () => void;\n\n    /**\n     * The callback function when the form is dirty, so the values are different\n     * from the original ones\n     */\n    onModified?: (dirty: boolean) => void;\n\n    /**\n     * The callback function when the form original values have been modified\n     */\n    onValuesChanged?: (values?: EntityValues<M>) => void;\n\n    /**\n     *\n     * @param id\n     */\n    onIdChange?: (id: string) => void;\n\n    currentEntityId?: string;\n\n    onFormContextChange?: (formContext: FormContext<M>) => void;\n\n    hideId?: boolean;\n\n    autoSave?: boolean;\n\n    onIdUpdateError?: (error: any) => void;\n\n}\n\n\nexport type EntityFormSaveParams<M extends Record<string, any>> = {\n    collection: ResolvedEntityCollection<M>,\n    path: string,\n    entityId: string | undefined,\n    values: EntityValues<M>,\n    previousValues?: EntityValues<M>,\n    closeAfterSave: boolean,\n    autoSave: boolean\n};\n\n/**\n * This is the form used internally by the CMS\n * @param status\n * @param path\n * @param collection\n * @param entity\n * @param onEntitySave\n * @param onDiscard\n * @param onModified\n * @param onValuesChanged\n * @constructor\n * @category Components\n */\nexport const EntityForm = React.memo<EntityFormProps<any>>(EntityFormInternal,\n    (a: EntityFormProps<any>, b: EntityFormProps<any>) => {\n        return a.status === b.status &&\n            a.path === b.path &&\n            equal(a.entity?.values, b.entity?.values);\n    }) as typeof EntityFormInternal;\n\nfunction EntityFormInternal<M extends Record<string, any>>({\n                                                               status,\n                                                               path,\n                                                               collection: inputCollection,\n                                                               entity,\n                                                               onEntitySaveRequested,\n                                                               onDiscard,\n                                                               onModified,\n                                                               onValuesChanged,\n                                                               onIdChange,\n                                                               onFormContextChange,\n                                                               hideId,\n                                                               autoSave,\n                                                               onIdUpdateError\n                                                           }: EntityFormProps<M>) {\n    const context = useFireCMSContext();\n    const dataSource = useDataSource();\n    const plugins = context.plugins;\n\n    const initialResolvedCollection = useMemo(() => resolveCollection({\n        collection: inputCollection,\n        path,\n        values: entity?.values,\n        fields: context.fields\n    }), [entity?.values, path]);\n\n    const mustSetCustomId: boolean = (status === \"new\" || status === \"copy\") &&\n        (Boolean(initialResolvedCollection.customId) && initialResolvedCollection.customId !== \"optional\");\n\n    const initialEntityId = useMemo(() => {\n        if (status === \"new\" || status === \"copy\") {\n            if (mustSetCustomId) {\n                return undefined;\n            } else {\n                return dataSource.generateEntityId(path);\n            }\n        } else {\n            return entity?.id;\n        }\n    }, []);\n\n    const closeAfterSaveRef = useRef(false);\n\n    const baseDataSourceValues: Partial<EntityValues<M>> = useMemo(() => {\n        const properties = initialResolvedCollection.properties;\n        if ((status === \"existing\" || status === \"copy\") && entity) {\n            return entity.values ?? getDefaultValuesFor(properties);\n        } else if (status === \"new\") {\n            return getDefaultValuesFor(properties);\n        } else {\n            console.error({\n                status,\n                entity\n            });\n            throw new Error(\"Form has not been initialised with the correct parameters\");\n        }\n    }, [status, initialResolvedCollection, entity]);\n\n    const [entityId, setEntityId] = React.useState<string | undefined>(initialEntityId);\n    const [entityIdError, setEntityIdError] = React.useState<boolean>(false);\n    const [savingError, setSavingError] = React.useState<Error | undefined>();\n\n    const initialValuesRef = useRef<EntityValues<M>>(entity?.values ?? baseDataSourceValues as EntityValues<M>);\n    const initialValues = initialValuesRef.current;\n    const [internalValues, setInternalValues] = useState<EntityValues<M> | undefined>(initialValues);\n\n    const doOnValuesChanges = (values?: EntityValues<M>) => {\n        setInternalValues(values);\n        if (onValuesChanged)\n            onValuesChanged(values);\n        if (autoSave && values && !equal(values, initialValues)) {\n            save(values);\n        }\n    };\n\n    useEffect(() => {\n        if (entityId && onIdChange)\n            onIdChange(entityId);\n    }, [entityId, onIdChange]);\n\n    const collection = resolveCollection<M>({\n        collection: inputCollection,\n        path,\n        entityId,\n        values: internalValues,\n        previousValues: initialValues,\n        fields: context.fields\n    });\n\n    const onIdUpdate = collection.callbacks?.onIdUpdate;\n    useEffect(() => {\n        if (onIdUpdate && internalValues && (status === \"new\" || status === \"copy\")) {\n            try {\n                const updatedId = onIdUpdate({\n                    collection,\n                    path,\n                    entityId,\n                    values: internalValues,\n                    context\n                });\n                setEntityId(updatedId);\n            } catch (e) {\n                onIdUpdateError && onIdUpdateError(e);\n                console.error(e);\n            }\n        }\n    }, [entityId, internalValues, status]);\n\n    const underlyingChanges: Partial<EntityValues<M>> = useMemo(() => {\n        if (initialValues && status === \"existing\") {\n            return Object.entries(collection.properties)\n                .map(([key, property]) => {\n                    if (isHidden(property)) {\n                        return {};\n                    }\n                    const initialValue = initialValues[key];\n                    const latestValue = baseDataSourceValues[key];\n                    if (!equal(initialValue, latestValue)) {\n                        return { [key]: latestValue };\n                    }\n                    return {};\n                })\n                .reduce((a, b) => ({ ...a, ...b }), {}) as Partial<EntityValues<M>>;\n        } else {\n            return {};\n        }\n    }, [baseDataSourceValues, collection.properties, initialValues, status]);\n\n    const save = (values: EntityValues<M>) => {\n        return onEntitySaveRequested({\n            collection,\n            path,\n            entityId,\n            values,\n            previousValues: entity?.values,\n            closeAfterSave: closeAfterSaveRef.current,\n            autoSave: autoSave ?? false,\n        }).then(_ => {\n            const eventName: CMSAnalyticsEvent = status === \"new\"\n                ? \"new_entity_saved\"\n                : (status === \"copy\" ? \"entity_copied\" : (status === \"existing\" ? \"entity_edited\" : \"unmapped_event\"));\n            context.onAnalyticsEvent?.(eventName, { path });\n            initialValuesRef.current = values;\n        })\n            .catch(e => {\n                console.error(e);\n                setSavingError(e);\n            })\n            .finally(() => {\n                closeAfterSaveRef.current = false;\n            });\n    };\n\n    const saveFormValues = (values: EntityValues<M>, formikActions: FormikHelpers<EntityValues<M>>) => {\n\n        if (mustSetCustomId && !entityId) {\n            console.error(\"Missing custom Id\");\n            setEntityIdError(true);\n            formikActions.setSubmitting(false);\n            return;\n        }\n\n        setSavingError(undefined);\n        setEntityIdError(false);\n\n        if (status === \"existing\") {\n            if (!entity?.id) throw Error(\"Form misconfiguration when saving, no id for existing entity\");\n        } else if (status === \"new\" || status === \"copy\") {\n            if (collection.customId) {\n                if (collection.customId !== \"optional\" && !entityId) {\n                    throw Error(\"Form misconfiguration when saving, entityId should be set\");\n                }\n            }\n        } else {\n            throw Error(\"New FormType added, check EntityForm\");\n        }\n\n        save(values)\n            ?.then(_ => {\n                formikActions.resetForm({\n                    values,\n                    submitCount: 0,\n                    touched: {}\n                });\n            })\n            .finally(() => {\n                formikActions.setSubmitting(false);\n            });\n\n    };\n\n    const uniqueFieldValidator: CustomFieldValidator = useCallback(({\n                                                                        name,\n                                                                        value,\n                                                                        property\n                                                                    }) => dataSource.checkUniqueField(path, name, value, property, entityId),\n        [dataSource, path, entityId]);\n\n    const validationSchema = useMemo(() => entityId\n            ? getYupEntitySchema(\n                entityId,\n                collection.properties,\n                uniqueFieldValidator)\n            : undefined,\n        [entityId, collection.properties, uniqueFieldValidator]);\n\n    return (\n        <Formik\n            initialValues={baseDataSourceValues as M}\n            onSubmit={saveFormValues}\n            validationSchema={validationSchema}\n            validate={(values) => console.debug(\"Validating\", values)}\n            onReset={() => onDiscard && onDiscard()}\n        >\n            {(props) => {\n\n                const pluginActions: React.ReactNode[] = [];\n\n                const formContext: FormContext<M> = {\n                    setFieldValue: props.setFieldValue,\n                    values: props.values,\n                    collection: resolveCollection({\n                        collection,\n                        path,\n                        fields: context.fields\n                    }),\n                    entityId,\n                    path,\n                    save\n                };\n\n                // eslint-disable-next-line react-hooks/rules-of-hooks\n                useEffect(() => {\n                    if (onFormContextChange) {\n                        onFormContextChange(formContext);\n                    }\n                }, [onFormContextChange, formContext]);\n\n                if (plugins && collection) {\n                    const actionProps: PluginFormActionProps = {\n                        entityId,\n                        path,\n                        status,\n                        collection: inputCollection,\n                        context,\n                        currentEntityId: entityId,\n                        formContext\n                    };\n                    pluginActions.push(...plugins.map((plugin, i) => (\n                        plugin.form?.Actions\n                            ? <plugin.form.Actions\n                                key={`actions_${plugin.name}`} {...actionProps}/>\n                            : null\n                    )).filter(Boolean));\n                }\n\n                return <>\n\n                    <Box\n                        sx={(theme) => ({\n                            paddingLeft: theme.spacing(4),\n                            paddingRight: theme.spacing(4),\n                            paddingTop: theme.spacing(3),\n                            paddingBottom: theme.spacing(4),\n                            marginBottom: theme.spacing(2),\n                            [theme.breakpoints.down(\"lg\")]: {\n                                paddingLeft: theme.spacing(2),\n                                paddingRight: theme.spacing(2),\n                                paddingTop: theme.spacing(2),\n                                paddingBottom: theme.spacing(3)\n                            },\n                            [theme.breakpoints.down(\"md\")]: {\n                                padding: theme.spacing(2)\n                            }\n                        })}\n                    >\n\n                        {pluginActions.length > 0 && <Box\n                            sx={(theme) => ({\n                                width: \"100%\",\n                                display: \"flex\",\n                                justifyContent: \"flex-end\",\n                                background: theme.palette.mode === \"light\" ? \"rgba(255,255,255,0.6)\" : alpha(theme.palette.background.paper, 0.1),\n                                backdropFilter: \"blur(8px)\",\n                                borderBottom: `1px solid ${theme.palette.divider}`,\n                                flexDirection: \"row\",\n                                alignItems: \"center\",\n                                position: \"absolute\",\n                                top: 0,\n                                right: 0,\n                                left: 0,\n                                textAlign: \"right\",\n                                zIndex: 2,\n                                \"& > *:not(:last-child)\": {\n                                    [theme.breakpoints.down(\"md\")]: {\n                                        mr: theme.spacing(1)\n                                    },\n                                    mr: theme.spacing(2)\n                                }\n                            })}>\n                            {pluginActions}\n                        </Box>}\n\n                        <Box\n                            sx={(theme) => ({\n                                width: \"100%\",\n                                marginTop: theme.spacing(4 + (pluginActions ? 4 : 0)),\n                                paddingY: 2,\n                                display: \"flex\",\n                                alignItems: \"center\",\n                                [theme.breakpoints.down(\"lg\")]: {\n                                    marginTop: theme.spacing(3 + (pluginActions ? 4 : 0))\n                                },\n                                [theme.breakpoints.down(\"md\")]: {\n                                    marginTop: theme.spacing(2 + (pluginActions ? 4 : 0))\n                                }\n                            })}>\n\n                            <Typography\n                                sx={{\n                                    marginTop: 4,\n                                    marginBottom: collection.hideIdFromForm ? 0 : 4,\n                                    flexGrow: 1\n                                }}\n                                variant={\"h4\"}>{collection.singularName ?? collection.name + \" entry\"}\n                            </Typography>\n                        </Box>\n\n                        {!hideId &&\n                            <CustomIdField customId={collection.customId}\n                                           entityId={entityId}\n                                           status={status}\n                                           onChange={setEntityId}\n                                           error={entityIdError}\n                                           entity={entity}/>}\n\n                        {entityId && <InnerForm\n                            {...props}\n                            initialValues={initialValues}\n                            onModified={onModified}\n                            onValuesChanged={doOnValuesChanges}\n                            underlyingChanges={underlyingChanges}\n                            entity={entity}\n                            collection={collection}\n                            formContext={formContext}\n                            status={status}\n                            savingError={savingError}\n                            closeAfterSaveRef={closeAfterSaveRef}\n                            autoSave={autoSave}/>}\n\n                    </Box>\n                </>\n            }}\n        </Formik>\n    );\n}\n\nfunction InnerForm<M extends Record<string, any>>(props: FormikProps<M> & {\n    onModified: ((modified: boolean) => void) | undefined,\n    onValuesChanged?: (changedValues?: EntityValues<M>) => void,\n    underlyingChanges: Partial<M>,\n    entity: Entity<M> | undefined,\n    collection: EntityCollection<M>,\n    formContext: FormContext<M>,\n    status: \"new\" | \"existing\" | \"copy\",\n    savingError?: Error,\n    closeAfterSaveRef: MutableRefObject<boolean>,\n    autoSave?: boolean\n}) {\n\n    const {\n        values,\n        onModified,\n        onValuesChanged,\n        underlyingChanges,\n        formContext,\n        entity,\n        touched,\n        setFieldValue,\n        collection,\n        isSubmitting,\n        status,\n        handleSubmit,\n        savingError,\n        dirty,\n        closeAfterSaveRef,\n        autoSave,\n    } = props;\n\n    const modified = dirty;\n    useEffect(() => {\n        if (onModified)\n            onModified(modified);\n        if (onValuesChanged)\n            onValuesChanged(values);\n    }, [modified, values]);\n\n    useEffect(() => {\n        if (!autoSave && underlyingChanges && entity) {\n            // we update the form fields from the Firestore data\n            // if they were not touched\n            Object.entries(underlyingChanges).forEach(([key, value]) => {\n                const formValue = values[key];\n                if (!equal(value, formValue) && !touched[key]) {\n                    console.debug(\"Updated value from the datasource:\", key, value);\n                    setFieldValue(key, value !== undefined ? value : null);\n                }\n            });\n        }\n    }, [autoSave, underlyingChanges, entity, values, touched, setFieldValue]);\n\n    const formFields = (\n        <Grid container spacing={6}>\n            {Object.entries(collection.properties)\n                .map(([key, property]) => {\n\n                    const underlyingValueHasChanged: boolean =\n                        !!underlyingChanges &&\n                        Object.keys(underlyingChanges).includes(key) &&\n                        !!touched[key];\n\n                    const disabled = (!autoSave && isSubmitting) || isReadOnly(property) || Boolean(property.disabled);\n                    const hidden = isHidden(property);\n                    if (hidden) return null;\n                    const cmsFormFieldProps: PropertyFieldBindingProps<any, M> = {\n                        propertyKey: key,\n                        disabled,\n                        property,\n                        includeDescription: true,\n                        underlyingValueHasChanged: underlyingValueHasChanged && !autoSave,\n                        context: formContext,\n                        tableMode: false,\n                        partOfArray: false,\n                        autoFocus: false\n                    };\n\n                    return (\n                        <Grid item\n                              xs={12}\n                              id={`form_field_${key}`}\n                              key={`field_${collection.name}_${key}`}>\n                            <PropertyFieldBinding {...cmsFormFieldProps}/>\n                        </Grid>\n                    );\n                })\n                .filter(Boolean)}\n\n        </Grid>\n    );\n\n    const disabled = isSubmitting || (!modified && status === \"existing\");\n    const formRef = React.createRef<HTMLDivElement>();\n\n    return (\n\n        <Form onSubmit={handleSubmit}\n              noValidate>\n            <Box sx={{ mt: 4 }}\n                 ref={formRef}>\n\n                {formFields}\n\n                <ErrorFocus containerRef={formRef}/>\n\n            </Box>\n\n            <Box sx={{ height: 56 }}/>\n\n            {!autoSave && <CustomDialogActions position={\"absolute\"}>\n\n                {savingError &&\n                    <Box textAlign=\"right\">\n                        <Typography color={\"error\"}>\n                            {savingError.message}\n                        </Typography>\n                    </Box>}\n\n                <Button\n                    variant=\"text\"\n                    color=\"primary\"\n                    disabled={disabled}\n                    type=\"reset\"\n                >\n                    {status === \"existing\" ? \"Discard\" : \"Clear\"}\n                </Button>\n\n                <Button\n                    variant=\"text\"\n                    color=\"primary\"\n                    type=\"submit\"\n                    disabled={disabled}\n                    onClick={() => {\n                        closeAfterSaveRef.current = false;\n                    }}\n                >\n                    {status === \"existing\" && \"Save\"}\n                    {status === \"copy\" && \"Create copy\"}\n                    {status === \"new\" && \"Create\"}\n                </Button>\n\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    type=\"submit\"\n                    disabled={disabled}\n                    onClick={() => {\n                        closeAfterSaveRef.current = true;\n                    }}\n                >\n                    {status === \"existing\" && \"Save and close\"}\n                    {status === \"copy\" && \"Create copy and close\"}\n                    {status === \"new\" && \"Create and close\"}\n                </Button>\n\n            </CustomDialogActions>}\n        </Form>\n    );\n}\n","import React from \"react\";\nimport ShortTextIcon from \"@mui/icons-material/ShortText\";\nimport SubjectIcon from \"@mui/icons-material/Subject\";\nimport AddLinkIcon from \"@mui/icons-material/AddLink\";\nimport ListIcon from \"@mui/icons-material/List\";\nimport ScheduleIcon from \"@mui/icons-material/Schedule\";\nimport UploadFileIcon from \"@mui/icons-material/UploadFile\";\nimport DriveFolderUploadIcon from \"@mui/icons-material/DriveFolderUpload\";\nimport RepeatIcon from \"@mui/icons-material/Repeat\";\nimport ViewStreamIcon from \"@mui/icons-material/ViewStream\";\nimport ListAltIcon from \"@mui/icons-material/ListAlt\";\nimport LinkIcon from \"@mui/icons-material/Link\";\nimport HttpIcon from \"@mui/icons-material/Http\";\nimport FlagIcon from \"@mui/icons-material/Flag\";\nimport NumbersIcon from \"@mui/icons-material/Numbers\";\nimport FormatListNumberedIcon from \"@mui/icons-material/FormatListNumbered\";\nimport FormatQuoteIcon from \"@mui/icons-material/FormatQuote\";\nimport EmailIcon from \"@mui/icons-material/Email\";\nimport BallotOutlinedIcon from \"@mui/icons-material/BallotOutlined\";\n\nimport {\n    ArrayCustomShapedFieldBinding\n} from \"../form/field_bindings/ArrayCustomShapedFieldBinding\";\nimport {\n    ArrayProperty,\n    FieldConfig,\n    FieldConfigId,\n    FieldProps,\n    Property, ResolvedProperty\n} from \"../types\";\nimport {\n    ArrayEnumSelectBinding,\n    ArrayOfReferencesFieldBinding,\n    BlockFieldBinding,\n    DateTimeFieldBinding,\n    MapFieldBinding,\n    MarkdownFieldBinding,\n    ReferenceFieldBinding,\n    RepeatFieldBinding,\n    SelectFieldBinding,\n    StorageUploadFieldBinding,\n    SwitchFieldBinding,\n    TextFieldBinding\n} from \"../form\";\nimport { isPropertyBuilder } from \"./util\";\nimport {\n    KeyValueFieldBinding\n} from \"../form/field_bindings/KeyValueFieldBinding\";\n\nexport const DEFAULT_FIELD_CONFIGS: Record<FieldConfigId, FieldConfig<any>> = {\n    text_field: {\n        name: \"Text field\",\n        description: \"Simple short text\",\n        dataType: \"string\",\n        Icon: ShortTextIcon,\n        color: \"#2d7ff9\",\n        Field: TextFieldBinding\n    },\n    multiline: {\n        name: \"Multiline\",\n        description: \"Text with multiple lines\",\n        dataType: \"string\",\n        Icon: SubjectIcon,\n        color: \"#2d7ff9\",\n        Field: TextFieldBinding\n    },\n    markdown: {\n        name: \"Markdown\",\n        description: \"Text with advanced markdown syntax\",\n        dataType: \"string\",\n        Icon: FormatQuoteIcon,\n        color: \"#2d7ff9\",\n        Field: MarkdownFieldBinding\n    },\n    url: {\n        name: \"Url\",\n        description: \"Text with URL validation\",\n        dataType: \"string\",\n        Icon: HttpIcon,\n        color: \"#154fb3\",\n        Field: TextFieldBinding\n    },\n    email: {\n        name: \"Email\",\n        description: \"Text with email validation\",\n        dataType: \"string\",\n        Icon: EmailIcon,\n        color: \"#154fb3\",\n        Field: TextFieldBinding\n    },\n    select: {\n        name: \"Select/enum\",\n        description: \"Select one text value from within an enumeration\",\n        dataType: \"string\",\n        Icon: ListIcon,\n        color: \"#4223c9\",\n        Field: SelectFieldBinding\n    },\n    multi_select: {\n        name: \"Multi select\",\n        description: \"Select multiple text values from within an enumeration\",\n        dataType: \"array\",\n        Icon: ListAltIcon,\n        color: \"#4223c9\",\n        Field: ArrayEnumSelectBinding\n    },\n    number_input: {\n        name: \"Number input\",\n        description: \"Simple number field with validation\",\n        dataType: \"number\",\n        Icon: NumbersIcon,\n        color: \"#bec920\",\n        Field: TextFieldBinding\n    },\n    number_select: {\n        name: \"Number select\",\n        description: \"Select a number value from within an enumeration\",\n        dataType: \"number\",\n        Icon: FormatListNumberedIcon,\n        color: \"#bec920\",\n        Field: SelectFieldBinding\n    },\n    multi_number_select: {\n        name: \"Multiple number select\",\n        description: \"Select multiple number values from within an enumeration\",\n        dataType: \"array\",\n        Icon: FormatListNumberedIcon,\n        color: \"#bec920\",\n        Field: ArrayEnumSelectBinding\n    },\n    file_upload: {\n        name: \"File upload\",\n        description: \"Input for uploading single files\",\n        dataType: \"string\",\n        Icon: UploadFileIcon,\n        color: \"#f92d9a\",\n        Field: StorageUploadFieldBinding as React.ComponentType<FieldProps<string>>\n    },\n    multi_file_upload: {\n        name: \"Multiple file upload\",\n        description: \"Input for uploading multiple files\",\n        dataType: \"array\",\n        Icon: DriveFolderUploadIcon,\n        color: \"#f92d9a\",\n        Field: StorageUploadFieldBinding\n    },\n    reference: {\n        name: \"Reference\",\n        description: \"The value refers to a different collection\",\n        dataType: \"reference\",\n        Icon: LinkIcon,\n        color: \"#ff0042\",\n        Field: ReferenceFieldBinding\n    },\n    multi_references: {\n        name: \"Multiple references\",\n        description: \"Multiple values that refer to a different collection\",\n        dataType: \"array\",\n        Icon: AddLinkIcon,\n        color: \"#ff0042\",\n        Field: ArrayOfReferencesFieldBinding\n    },\n    switch: {\n        name: \"Switch\",\n        description: \"True or false field (or yes or no, 0 or 1...)\",\n        dataType: \"boolean\",\n        Icon: FlagIcon,\n        color: \"#20d9d2\",\n        Field: SwitchFieldBinding\n    },\n    date_time: {\n        name: \"Date/time\",\n        description: \"A date time select field\",\n        dataType: \"date\",\n        Icon: ScheduleIcon,\n        color: \"#8b46ff\",\n        Field: DateTimeFieldBinding\n    },\n    group: {\n        name: \"Group\",\n        description: \"Group of multiple fields\",\n        dataType: \"map\",\n        Icon: BallotOutlinedIcon,\n        color: \"#ff9408\",\n        Field: MapFieldBinding\n    },\n    key_value: {\n        name: \"Key-value\",\n        description: \"Flexible field that allows the user to add multiple key-value pairs\",\n        dataType: \"map\",\n        Icon: BallotOutlinedIcon,\n        color: \"#ff9408\",\n        Field: KeyValueFieldBinding\n    },\n    repeat: {\n        name: \"Repeat/list\",\n        description: \"A field that gets repeated multiple times (e.g. multiple text fields)\",\n        dataType: \"array\",\n        Icon: RepeatIcon,\n        color: \"#ff9408\",\n        Field: RepeatFieldBinding\n    },\n    custom_array: {\n        name: \"Custom array\",\n        description: \"A field that saved its value as an array of custom objects\",\n        dataType: \"array\",\n        Icon: RepeatIcon,\n        color: \"#ff9408\",\n        Field: ArrayCustomShapedFieldBinding\n    },\n    block: {\n        name: \"Block\",\n        description: \"A complex field that allows the user to compose different fields together, with a key->value format\",\n        dataType: \"array\",\n        Icon: ViewStreamIcon,\n        color: \"#ff9408\",\n        Field: BlockFieldBinding\n    }\n};\n\nexport function getFieldConfig(property: Property | ResolvedProperty): FieldConfig | undefined {\n    const fieldId = getFieldId(property);\n    return fieldId ? DEFAULT_FIELD_CONFIGS[fieldId] : undefined;\n}\n\nexport function getFieldId(property: Property | ResolvedProperty): FieldConfigId | undefined {\n    if (property.dataType === \"string\") {\n        if (property.multiline) {\n            return \"multiline\";\n        } else if (property.markdown) {\n            return \"markdown\";\n        } else if (property.storage) {\n            return \"file_upload\";\n        } else if (property.url) {\n            return \"url\";\n        } else if (property.email) {\n            return \"email\";\n        } else if (property.enumValues) {\n            return \"select\";\n        } else {\n            return \"text_field\";\n        }\n    } else if (property.dataType === \"number\") {\n        if (property.enumValues) {\n            return \"number_select\";\n        }\n        return \"number_input\";\n    } else if (property.dataType === \"map\") {\n        if (property.keyValue)\n            return \"key_value\";\n        if (property.properties)\n            return \"group\";\n    } else if (property.dataType === \"array\") {\n        const of = (property as ArrayProperty).of;\n        const oneOf = (property as ArrayProperty).oneOf;\n        if (Array.isArray(of)) {\n            return \"custom_array\";\n        } else if (isPropertyBuilder(of)) {\n            return \"repeat\";\n        } else if (of?.dataType === \"string\" && of.enumValues) {\n            return \"multi_select\";\n        } else if (of?.dataType === \"number\" && of.enumValues) {\n            return \"multi_number_select\";\n        } else if (of?.dataType === \"string\" && of.storage) {\n            return \"multi_file_upload\";\n        } else if (of?.dataType === \"reference\") {\n            return \"multi_references\";\n        } else if (oneOf) {\n            return \"block\";\n        } else {\n            return \"repeat\";\n        }\n    } else if (property.dataType === \"boolean\") {\n        return \"switch\";\n    } else if (property.dataType === \"date\") {\n        return \"date_time\";\n    } else if (property.dataType === \"reference\") {\n        return \"reference\";\n    }\n\n    console.error(\"Unsupported field config mapping\", property);\n    return undefined;\n}\n","import React from \"react\";\nimport AdjustIcon from \"@mui/icons-material/Adjust\";\nimport FunctionsIcon from \"@mui/icons-material/Functions\";\nimport Crop75Icon from \"@mui/icons-material/Crop75\";\n\nimport {\n    FieldConfig,\n    PropertiesOrBuilders,\n    PropertyOrBuilder,\n    ResolvedProperty\n} from \"../../types\";\nimport { getFieldConfig } from \"../form_field_configs\";\nimport { Box } from \"@mui/material\";\nimport { isPropertyBuilder } from \"./entities\";\nimport { resolveProperty } from \"./resolutions\";\n\nexport function isReferenceProperty(propertyOrBuilder: PropertyOrBuilder,\n                                    fields: Record<string, FieldConfig>) {\n    const resolvedProperty = resolveProperty({\n        propertyKey: \"ignore\", // TODO\n        propertyOrBuilder,\n        fields\n    });\n    if (!resolvedProperty) return null;\n    if (resolvedProperty.dataType === \"reference\") {\n        return true;\n    }\n    if (resolvedProperty.dataType === \"array\") {\n        if (Array.isArray(resolvedProperty.of)) return false;\n        else return resolvedProperty.of?.dataType === \"reference\"\n    }\n    return false;\n}\n\nexport function getIdIcon(\n    color: \"inherit\" | \"primary\" | \"secondary\" | \"action\" | \"disabled\" | \"error\" = \"inherit\",\n    fontSize: \"inherit\" | \"medium\" | \"large\" | \"small\" | undefined = \"inherit\"): React.ReactNode {\n    return <AdjustIcon color={color} fontSize={fontSize}/>;\n}\n\nfunction getIconForWidget(widget: FieldConfig | undefined,\n                          color: \"inherit\" | \"primary\" | \"secondary\" | \"action\" | \"disabled\" | \"error\",\n                          fontSize: \"inherit\" | \"medium\" | \"large\" | \"small\" | undefined) {\n    const Icon = widget?.Icon ?? Crop75Icon;\n    return <Icon color={color} fontSize={fontSize}/>;\n}\n\nexport function getIconForProperty(\n    property: PropertyOrBuilder | ResolvedProperty,\n    color: \"inherit\" | \"primary\" | \"secondary\" | \"action\" | \"disabled\" | \"error\" = \"inherit\",\n    fontSize: \"inherit\" | \"medium\" | \"large\" | \"small\" | undefined = \"inherit\"): React.ReactNode {\n\n    if (isPropertyBuilder(property)) {\n        return <FunctionsIcon color={color} fontSize={fontSize}/>;\n    } else {\n        const widget = getFieldConfig(property);\n        return getIconForWidget(widget, color, fontSize);\n    }\n}\n\nexport function getBadgeForWidget(\n    widget: FieldConfig | undefined,\n    color: \"inherit\" | \"primary\" | \"secondary\" | \"action\" | \"disabled\" | \"error\" = \"inherit\"): React.ReactNode {\n\n    return <Box sx={{\n        background: widget?.color ?? \"#888\",\n        height: \"32px\",\n        width: \"32px\",\n        padding: 0.5,\n        borderRadius: \"50%\",\n        boxShadow: \"0px 2px 1px -1px rgb(0 0 0 / 20%), 0px 1px 1px 0px rgb(0 0 0 / 14%), 0px 1px 3px 0px rgb(0 0 0 / 12%)\",\n        color: \"white\"\n    }}>\n        {getIconForWidget(widget, color, \"medium\")}\n    </Box>\n}\n\nexport function getColorForProperty(property: PropertyOrBuilder): string {\n    if (isPropertyBuilder(property)) {\n        return \"#888\";\n    } else {\n        const widget = getFieldConfig(property);\n        return widget?.color ?? \"#666\";\n    }\n}\n\n/**\n * Get a property in a property tree from a path like\n * `address.street`\n * @param properties\n * @param path\n */\nexport function getPropertyInPath<M extends Record<string, any>>(properties: PropertiesOrBuilders<M>, path: string): PropertyOrBuilder<any, M> | undefined {\n    if (typeof properties === \"object\") {\n        if (path in properties) {\n            return properties[path];\n        }\n        if (path.includes(\".\")) {\n            const pathSegments = path.split(\".\");\n            const childProperty = properties[pathSegments[0]];\n            if (typeof childProperty === \"object\" && childProperty.dataType === \"map\" && childProperty.properties) {\n                return getPropertyInPath(childProperty.properties, pathSegments.slice(1).join(\".\"))\n            }\n        }\n    }\n    return undefined;\n}\n\nexport function getResolvedPropertyInPath(properties: Record<string, ResolvedProperty>, path: string): ResolvedProperty | undefined {\n    if (typeof properties === \"object\") {\n        if (path in properties) {\n            return properties[path];\n        }\n        if (path.includes(\".\")) {\n            const pathSegments = path.split(\".\");\n            const childProperty = properties[pathSegments[0]];\n            if (childProperty.dataType === \"map\" && childProperty.properties) {\n                return getResolvedPropertyInPath(childProperty.properties, pathSegments.slice(1).join(\".\"))\n            }\n        }\n    }\n    return undefined;\n}\n\n// replace the dot notation with brackets\n// address.street => address[street]\nexport function getBracketNotation(path: string): string {\n    return path.replace(/\\.([^.]*)/g, \"[$1]\"); ;\n}\n","import {\n    AuthController,\n    Entity,\n    EntityCollection,\n    Permissions,\n    User\n} from \"../../types\";\n\nconst DEFAULT_PERMISSIONS = {\n    read: true,\n    edit: true,\n    create: true,\n    delete: true\n};\n\nexport function resolvePermissions<M extends Record<string, any>, UserType extends User>\n(collection: EntityCollection<M>,\n authController: AuthController<UserType>,\n pathSegments: string[],\n entity: Entity<M> | null): Permissions {\n\n    const permission = collection.permissions;\n    if (permission === undefined) {\n        return DEFAULT_PERMISSIONS;\n    } else if (typeof permission === \"object\") {\n        return permission as Permissions;\n    } else if (typeof permission === \"function\") {\n        return permission({\n            entity,\n            user: authController.user,\n            authController,\n            collection,\n            pathSegments\n        });\n    }\n    console.error(\"Permissions:\", permission);\n    throw Error(\"New type of permission added and not mapped\");\n}\n\nexport function canEditEntity<M extends Record<string, any>, UserType extends User>\n(\n    collection: EntityCollection<M>,\n    authController: AuthController<UserType>,\n    paths: string[],\n    entity: Entity<M> | null): boolean {\n    return resolvePermissions(collection, authController, paths, entity).edit ?? DEFAULT_PERMISSIONS.edit;\n}\n\nexport function canCreateEntity<M extends Record<string, any>, UserType extends User>\n(\n    collection: EntityCollection<M>,\n    authController: AuthController<UserType>,\n    paths: string[],\n    entity: Entity<M> | null): boolean {\n    return resolvePermissions(collection, authController, paths, entity).create ?? DEFAULT_PERMISSIONS.create;\n}\n\nexport function canDeleteEntity<M extends Record<string, any>, UserType extends User>\n(\n    collection: EntityCollection<M>,\n    authController: AuthController<UserType>,\n    paths: string[],\n    entity: Entity<M> | null): boolean {\n    return resolvePermissions(collection, authController, paths, entity).delete ?? DEFAULT_PERMISSIONS.delete;\n}\n\n// export function resolveCollectionsPermissions(roles: Role[]): Record<string, Permissions> {\n//     const collectionIds = Array.from(new Set(roles.flatMap(role => Object.keys(role.collections))));\n//     return collectionIds\n//         .map((colId) => {\n//             const rolesWithCollection = roles.filter((role) => colId in Object.keys(role.collections));\n//             return {\n//                 [colId]: rolesWithCollection\n//                     .map(role => role.collections[colId])\n//                     .reduce((permA, permB) => {\n//                         return {\n//                             read: permA.read ?? permB.read ?? false,\n//                             create: permA.create ?? permB.create ?? false,\n//                             edit: permA.edit ?? permB.edit ?? false,\n//                             delete: permA.delete ?? permB.delete ?? false\n//                         };\n//                     })\n//             };\n//         })\n//         .reduce((a, b) => ({ ...a, ...b }), {});\n// }\n","import * as mui from \"@mui/icons-material\";\n\nimport { CMSView, EntityCollection } from \"../../types\";\nimport { SvgIconTypeMap } from \"@mui/material\";\nimport { hashString } from \"./hash\";\n\nexport function getIcon(iconKey?: string) {\n    if (!iconKey) return undefined;\n    return iconKey in mui ? mui[iconKey as keyof typeof mui] : undefined;\n}\n\nexport function getIconForView(collectionOrView: EntityCollection | CMSView): React.ComponentType<SvgIconTypeMap[\"props\"]> {\n    const icon = getIcon(collectionOrView.icon);\n    if (collectionOrView?.icon && icon)\n        return icon;\n    const iconsCount = collectionIconKeys.length;\n    const key = collectionIconKeys[hashString(collectionOrView.path) % iconsCount] as keyof typeof mui\n    return mui[key];\n}\n\nexport const collectionIconKeys:string[] = [\"AcUnit\", \"Adjust\", \"AlignHorizontalCenter\", \"Album\", \"AllInclusive\", \"AllOut\", \"Animation\", \"Assistant\", \"Attractions\", \"Audiotrack\", \"AutoAwesome\", \"AutoAwesomeMosaic\", \"BeachAccess\", \"Bolt\", \"Brightness1\", \"BreakfastDining\", \"BrokenImage\", \"Brightness5\", \"Cable\", \"CalendarViewMonth\", \"CatchingPokemon\", \"Casino\", \"Category\", \"Cloud\", \"ColorLens\", \"CreditCard\", \"Coronavirus\", \"Earbuds\", \"EggAlt\", \"FiberSmartRecord\", \"Flag\", \"Healing\", \"HeatPump\", \"Hive\", \"Hub\", \"LocalFireDepartment\", \"LocalPizza\", \"Memory\", \"Outlet\", \"Pages\", \"PanoramaPhotosphere\", \"SignalCellular0Bar\", \"SportsBaseball\", \"Storm\", \"Stairs\"];\n","/**\n * Returns the plural of an English word.\n *\n * @export\n * @param {string} word\n * @param {number} [amount]\n * @returns {string}\n */\nexport function plural(word: string, amount?: number): string {\n    if (amount !== undefined && amount === 1) {\n        return word\n    }\n    const plurals: { [key: string]: string } = {\n        \"(quiz)$\": \"$1zes\",\n        \"^(ox)$\": \"$1en\",\n        \"([m|l])ouse$\": \"$1ice\",\n        \"(matr|vert|ind)ix|ex$\": \"$1ices\",\n        \"(x|ch|ss|sh)$\": \"$1es\",\n        \"([^aeiouy]|qu)y$\": \"$1ies\",\n        \"(hive)$\": \"$1s\",\n        \"(?:([^f])fe|([lr])f)$\": \"$1$2ves\",\n        \"(shea|lea|loa|thie)f$\": \"$1ves\",\n        sis$: \"ses\",\n        \"([ti])um$\": \"$1a\",\n        \"(tomat|potat|ech|her|vet)o$\": \"$1oes\",\n        \"(bu)s$\": \"$1ses\",\n        \"(alias)$\": \"$1es\",\n        \"(octop)us$\": \"$1i\",\n        \"(ax|test)is$\": \"$1es\",\n        \"(us)$\": \"$1es\",\n        \"([^s]+)$\": \"$1s\"\n    }\n    const irregular: { [key: string]: string } = {\n        move: \"moves\",\n        foot: \"feet\",\n        goose: \"geese\",\n        sex: \"sexes\",\n        child: \"children\",\n        man: \"men\",\n        tooth: \"teeth\",\n        person: \"people\"\n    }\n    const uncountable: string[] = [\n        \"sheep\",\n        \"fish\",\n        \"deer\",\n        \"moose\",\n        \"series\",\n        \"species\",\n        \"money\",\n        \"rice\",\n        \"information\",\n        \"equipment\",\n        \"bison\",\n        \"cod\",\n        \"offspring\",\n        \"pike\",\n        \"salmon\",\n        \"shrimp\",\n        \"swine\",\n        \"trout\",\n        \"aircraft\",\n        \"hovercraft\",\n        \"spacecraft\",\n        \"sugar\",\n        \"tuna\",\n        \"you\",\n        \"wood\"\n    ]\n    // save some time in the case that singular and plural are the same\n    if (uncountable.indexOf(word.toLowerCase()) >= 0) {\n        return word;\n    }\n    // check for irregular forms\n    for (const w in irregular) {\n        const pattern = new RegExp(`${w}$`, \"i\")\n        const replace = irregular[w]\n        if (pattern.test(word)) {\n            return word.replace(pattern, replace);\n        }\n    }\n    // check for matches using regular expressions\n    for (const reg in plurals) {\n        const pattern = new RegExp(reg, \"i\")\n        if (pattern.test(word)) {\n            return word.replace(pattern, plurals[reg])\n        }\n    }\n    return word;\n}\n\n/**\n * Returns the singular of an English word.\n *\n * @export\n * @param {string} word\n * @param {number} [amount]\n * @returns {string}\n */\nexport function singular(word: string, amount?: number): string {\n    if (amount !== undefined && amount !== 1) {\n        return word;\n    }\n    const singulars: { [key: string]: string } = {\n        \"(quiz)zes$\": \"$1\",\n        \"(matr)ices$\": \"$1ix\",\n        \"(vert|ind)ices$\": \"$1ex\",\n        \"^(ox)en$\": \"$1\",\n        \"(alias)es$\": \"$1\",\n        \"(octop|vir)i$\": \"$1us\",\n        \"(cris|ax|test)es$\": \"$1is\",\n        \"(shoe)s$\": \"$1\",\n        \"(o)es$\": \"$1\",\n        \"(bus)es$\": \"$1\",\n        \"([m|l])ice$\": \"$1ouse\",\n        \"(x|ch|ss|sh)es$\": \"$1\",\n        \"(m)ovies$\": \"$1ovie\",\n        \"(s)eries$\": \"$1eries\",\n        \"([^aeiouy]|qu)ies$\": \"$1y\",\n        \"([lr])ves$\": \"$1f\",\n        \"(tive)s$\": \"$1\",\n        \"(hive)s$\": \"$1\",\n        \"(li|wi|kni)ves$\": \"$1fe\",\n        \"(shea|loa|lea|thie)ves$\": \"$1f\",\n        \"(^analy)ses$\": \"$1sis\",\n        \"((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$\": \"$1$2sis\",\n        \"([ti])a$\": \"$1um\",\n        \"(n)ews$\": \"$1ews\",\n        \"(h|bl)ouses$\": \"$1ouse\",\n        \"(corpse)s$\": \"$1\",\n        \"(us)es$\": \"$1\",\n        s$: \"\"\n    }\n    const irregular: { [key: string]: string } = {\n        move: \"moves\",\n        foot: \"feet\",\n        goose: \"geese\",\n        sex: \"sexes\",\n        child: \"children\",\n        man: \"men\",\n        tooth: \"teeth\",\n        person: \"people\"\n    }\n    const uncountable: string[] = [\n        \"sheep\",\n        \"fish\",\n        \"deer\",\n        \"moose\",\n        \"series\",\n        \"species\",\n        \"money\",\n        \"rice\",\n        \"information\",\n        \"equipment\",\n        \"bison\",\n        \"cod\",\n        \"offspring\",\n        \"pike\",\n        \"salmon\",\n        \"shrimp\",\n        \"swine\",\n        \"trout\",\n        \"aircraft\",\n        \"hovercraft\",\n        \"spacecraft\",\n        \"sugar\",\n        \"tuna\",\n        \"you\",\n        \"wood\"\n    ]\n    // save some time in the case that singular and plural are the same\n    if (uncountable.indexOf(word.toLowerCase()) >= 0) {\n        return word;\n    }\n    // check for irregular forms\n    for (const w in irregular) {\n        const pattern = new RegExp(`${irregular[w]}$`, \"i\");\n        if (pattern.test(word)) {\n            return word.replace(pattern, w);\n        }\n    }\n    // check for matches using regular expressions\n    for (const reg in singulars) {\n        const pattern = new RegExp(reg, \"i\");\n        if (pattern.test(word)) {\n            return word.replace(pattern, singulars[reg]);\n        }\n    }\n    return word;\n}\n","import { EntityCollection, FieldConfig } from \"../../types\";\nimport { isReferenceProperty } from \"./property_utils\";\nimport { isPropertyBuilder } from \"./entities\";\n\nexport function getReferencePreviewKeys(targetCollection: EntityCollection<any>,\n                                        fields: Record<string, FieldConfig>,\n                                        previewProperties?: string[],\n                                        limit = 3) {\n    const allProperties = Object.keys(targetCollection.properties);\n    let listProperties = previewProperties?.filter(p => allProperties.includes(p as string));\n    if (listProperties && listProperties.length > 0) {\n        return listProperties;\n    } else {\n        listProperties = allProperties;\n        return listProperties.filter(key => {\n            const propertyOrBuilder = targetCollection.properties[key];\n            return propertyOrBuilder && !isPropertyBuilder(propertyOrBuilder) && !isReferenceProperty(propertyOrBuilder, fields);\n        }).slice(0, limit);\n    }\n}\n","import * as React from \"react\";\n\nimport { styled } from \"@mui/material/styles\";\n\nimport {\n    Box,\n    IconButton,\n    Table,\n    TableBody,\n    TableCell,\n    TableContainer,\n    TableRow,\n    Theme,\n    Typography\n} from \"@mui/material\";\nimport {\n    Entity,\n    EntityCollection,\n    FireCMSContext,\n    ResolvedEntityCollection,\n    ResolvedProperties\n} from \"../../types\";\nimport { PropertyPreview } from \"../../preview\";\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\nimport { getIconForProperty, getIdIcon, resolveCollection } from \"../util\";\nimport { ErrorBoundary } from \"./ErrorBoundary\";\nimport { useFireCMSContext } from \"../../hooks\";\n\nconst PREFIX = \"EntityPreview\";\n\nconst classes = {\n    property: `${PREFIX}-property`,\n    valuePreview: `${PREFIX}-valuePreview`,\n    iconCell: `${PREFIX}-iconCell`,\n    titleCell: `${PREFIX}-titleCell`\n};\n\nconst StyledTableContainer = styled(TableContainer)((\n    { theme }: {\n        theme: Theme\n    }\n) => ({\n    [`& .${classes.property}`]: {\n        display: \"flex\"\n    },\n\n    [`& .${classes.valuePreview}`]: {\n        height: \"72px\",\n        padding: theme.spacing(2, 3)\n    },\n\n    [`& .${classes.iconCell}`]: {\n        paddingTop: theme.spacing(1)\n    },\n\n    [`& .${classes.titleCell}`]: {\n        width: \"25%\",\n        padding: theme.spacing(1)\n    }\n}));\n\n/**\n * @category Components\n */\nexport interface EntityPreviewProps<M extends Record<string, any>> {\n    entity: Entity<M>;\n    collection: EntityCollection<M>;\n    path: string;\n}\n\n/**\n * Use this component to render a preview of a property values\n * @param entity\n * @param collection\n * @param path\n * @constructor\n * @category Components\n */\nexport function EntityPreview<M extends Record<string, any>>(\n    {\n        entity,\n        collection,\n        path\n    }: EntityPreviewProps<M>) {\n\n    const context = useFireCMSContext();\n    const resolvedCollection: ResolvedEntityCollection<M> = React.useMemo(() => resolveCollection<M>({\n        collection,\n        path,\n        entityId: entity.id,\n        values: entity.values,\n        fields: context.fields\n    }), [collection, path, entity]);\n\n    const appConfig: FireCMSContext | undefined = useFireCMSContext();\n\n    const properties: ResolvedProperties = resolvedCollection.properties;\n\n    return (\n        <>\n\n            <Box\n                sx={(theme) => ({\n                    width: \"100%\",\n                    marginTop: theme.spacing(3),\n                    paddingLeft: theme.spacing(4),\n                    paddingRight: theme.spacing(4),\n                    paddingTop: theme.spacing(3),\n                    [theme.breakpoints.down(\"lg\")]: {\n                        marginTop: theme.spacing(2),\n                        paddingLeft: theme.spacing(2),\n                        paddingRight: theme.spacing(2),\n                        paddingTop: theme.spacing(2)\n                    },\n                    [theme.breakpoints.down(\"md\")]: {\n                        marginTop: theme.spacing(1),\n                        paddingLeft: theme.spacing(2),\n                        paddingRight: theme.spacing(2),\n                        paddingTop: theme.spacing(2)\n                    }\n                })}>\n\n                <Typography\n                    sx={{\n                        marginTop: 4,\n                        marginBottom: 4\n                    }}\n                    variant={\"h4\"}>{collection.singularName ?? collection.name + \" entry\"}\n                </Typography>\n\n            </Box>\n\n            <StyledTableContainer>\n                <Table aria-label=\"entity table\">\n                    <TableBody>\n                        <TableRow>\n                            <TableCell align=\"right\"\n                                       component=\"td\"\n                                       scope=\"row\"\n                                       className={classes.titleCell}>\n                                <Typography variant={\"caption\"}\n                                            color={\"textSecondary\"}>\n                                    Id\n                                </Typography>\n                            </TableCell>\n                            <TableCell padding=\"none\"\n                                       className={classes.iconCell}>\n                                {getIdIcon(\"disabled\", \"small\")}\n                            </TableCell>\n                            <TableCell className={classes.valuePreview}>\n                                <Box display=\"flex\" alignItems=\"center\">\n                                    {entity.id}\n                                    {appConfig?.entityLinkBuilder &&\n                                        <a href={appConfig.entityLinkBuilder({ entity })}\n                                           rel=\"noopener noreferrer\"\n                                           target=\"_blank\">\n                                            <IconButton\n                                                aria-label=\"go-to-entity-datasource\"\n                                                size=\"large\">\n                                                <OpenInNewIcon\n                                                    fontSize={\"small\"}/>\n                                            </IconButton>\n                                        </a>}\n                                </Box>\n                            </TableCell>\n                        </TableRow>\n\n                        {collection && Object.entries(properties)\n                            .map(([key, property]) => {\n                                const value = (entity.values)[key];\n                                return (\n                                    <TableRow\n                                        key={\"entity_prev\" + property.name + key}>\n                                        <TableCell align=\"right\"\n                                                   component=\"td\"\n                                                   scope=\"row\"\n                                                   className={classes.titleCell}>\n                                            <Typography\n                                                sx={{ paddingLeft: 2 }}\n                                                variant={\"caption\"}\n                                                color={\"textSecondary\"}>\n                                                {property.name}\n                                            </Typography>\n                                        </TableCell>\n\n                                        <TableCell padding=\"none\"\n                                                   className={classes.iconCell}>\n                                            {getIconForProperty(property, \"disabled\", \"small\")}\n                                        </TableCell>\n\n                                        <TableCell\n                                            className={classes.valuePreview}>\n                                            <ErrorBoundary>\n                                                <PropertyPreview\n                                                    propertyKey={key}\n                                                    value={value}\n                                                    entity={entity}\n                                                    property={property}\n                                                    size={\"regular\"}/>\n                                            </ErrorBoundary>\n                                        </TableCell>\n\n                                    </TableRow>\n                                );\n                            })}\n                    </TableBody>\n                </Table>\n            </StyledTableContainer>\n\n        </>\n    );\n\n}\n\nexport default EntityPreview;\n","import {\n    EntityCollection,\n    Property,\n    ResolvedArrayProperty,\n    ResolvedProperty\n} from \"../../../../types\";\n\nexport function getCellAlignment(property: Property | ResolvedProperty): \"right\" | \"left\" | \"center\" {\n    if (property.dataType === \"boolean\") {\n        return \"center\";\n    } else if (property.dataType === \"number\") {\n        if (property.enumValues)\n            return \"left\";\n        return \"right\";\n    } else if (property.dataType === \"date\") {\n        return \"right\";\n    } else {\n        return \"left\";\n    }\n}\n\nexport function isPropertyFilterable(property: ResolvedProperty): boolean {\n    if (property.dataType === \"boolean\") {\n        return true;\n    } else if (property.dataType === \"number\") {\n        return true;\n    } else if (property.dataType === \"string\") {\n        return true;\n    } else if (property.dataType === \"date\") {\n        return true;\n    } else if (property.dataType === \"array\") {\n        if (Array.isArray(property.of)) {\n            return false;\n        }\n        if (property.of)\n            return isPropertyFilterable(property.of);\n        else\n            return false;\n    } else {\n        return false;\n    }\n}\n\nexport function getPropertyColumnWidth(property: ResolvedProperty): number {\n\n    if (property.columnWidth) {\n        return property.columnWidth;\n    }\n\n    if (property.dataType === \"string\") {\n        if (property.url) {\n            return 280;\n        } else if (property.storage) {\n            return 160;\n        } else if (property.enumValues) {\n            return 200;\n        } else if (property.multiline) {\n            return 300;\n        } else if (property.markdown) {\n            return 300;\n        } else if (property.email) {\n            return 200;\n        } else {\n            return 200;\n        }\n    } else if (property.dataType === \"array\") {\n        const arrayProperty = property as ResolvedArrayProperty;\n        if (arrayProperty.of) {\n            if (Array.isArray(property.of)) {\n                return 300;\n            } else {\n                return getPropertyColumnWidth(arrayProperty.of as ResolvedProperty);\n            }\n        } else {\n            return 300;\n        }\n    } else if (property.dataType === \"number\") {\n        if (property.enumValues) {\n            return 200;\n        }\n        return 140;\n    } else if (property.dataType === \"map\") {\n        return 360;\n    } else if (property.dataType === \"date\") {\n        return 200;\n    } else if (property.dataType === \"reference\") {\n        return 220;\n    } else if (property.dataType === \"boolean\") {\n        return 140;\n    } else {\n        return 200;\n    }\n}\n\nexport function getSubcollectionColumnId(collection: EntityCollection) {\n    return `subcollection:${collection.alias ?? collection.path}`;\n}\n","import React, { useEffect, useRef, useState } from \"react\";\n\nimport { useDebounce } from \"../../../util\";\nimport { TextareaAutosize } from \"../../fields/TextareaAutosize\";\n\nexport function TableInput(props: {\n    error: Error | undefined;\n    value: string;\n    multiline: boolean;\n    focused: boolean;\n    setFocused: (focused: boolean) => void;\n    disabled: boolean;\n    updateValue: (newValue: (string | null)) => void;\n}) {\n\n    const ref = React.createRef<HTMLTextAreaElement>();\n\n    const { disabled, value, multiline, updateValue, focused } = props;\n    const prevValue = useRef<string | null>(value);\n\n    const [internalValue, setInternalValue] = useState<typeof value>(value);\n    const focusedState = useRef<boolean>(false);\n\n    useEffect(() => {\n        if (prevValue.current !== value && value !== internalValue)\n            setInternalValue(value);\n        prevValue.current = value;\n    }, [value]);\n\n    const doUpdate = React.useCallback(() => {\n        const emptyInitialValue = !value;\n        if (emptyInitialValue && !internalValue)\n            return;\n        if (internalValue !== value) {\n            prevValue.current = internalValue;\n            updateValue(internalValue);\n        }\n    }, [internalValue, value]);\n\n    useDebounce(internalValue, doUpdate, !focused, 2000);\n\n    useEffect(() => {\n        if (ref.current && focused && !focusedState.current) {\n            focusedState.current = true;\n            ref.current.focus({ preventScroll: true });\n            ref.current.selectionStart = ref.current.value.length;\n            ref.current.selectionEnd = ref.current.value.length;\n        } else {\n            focusedState.current = focused;\n        }\n    }, [focused, ref]);\n\n    return (\n        <TextareaAutosize\n            ref={ref}\n            style={{\n                padding: 0,\n                margin: 0,\n                width: \"100%\",\n                color: \"unset\",\n                fontWeight: \"unset\",\n                lineHeight: \"unset\",\n                fontSize: \"unset\",\n                fontFamily: \"unset\",\n                background: \"unset\",\n                border: \"unset\",\n                resize: \"none\",\n                outline: \"none\"\n            }}\n            value={internalValue ?? \"\"}\n            onChange={(evt) => {\n                const newValue = evt.target.value as string;\n                if (multiline || !newValue.endsWith(\"\\n\"))\n                    setInternalValue(newValue);\n            }}\n            onFocus={() => {\n                focusedState.current = true;\n                props.setFocused(true);\n            }}\n            onBlur={() => {\n                focusedState.current = false;\n                doUpdate();\n                props.setFocused(false);\n            }}\n        />\n    );\n}\n","import { EnumValueConfig } from \"../../../../types\";\nimport { ArrayEnumPreview, EnumValuesChip } from \"../../../../preview\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { Checkbox, ListItemText, MenuItem, Select } from \"@mui/material\";\nimport { enumToObjectEntries, isEnumValueDisabled } from \"../../../util/enums\";\nimport { SelectChangeEvent } from \"@mui/material/Select/SelectInput\";\n\nexport function TableSelect(props: {\n    name: string;\n    enumValues: EnumValueConfig[];\n    error: Error | undefined;\n    multiple: boolean;\n    disabled: boolean;\n    small: boolean;\n    internalValue: string | number | string[] | number[] | undefined;\n    valueType: \"string\" | \"number\";\n    updateValue: (newValue: (string | number | string[] | number[] | null)) => void;\n    focused: boolean;\n    onBlur?: React.FocusEventHandler<HTMLInputElement | HTMLTextAreaElement>;\n}) {\n\n    const {\n        name,\n        enumValues,\n        error,\n        internalValue,\n        disabled,\n        small,\n        focused,\n        updateValue,\n        multiple,\n        valueType\n    } = props;\n\n    const [open, setOpen] = useState<boolean>(false);\n    const handleOpen = useCallback(() => {\n        setOpen(true);\n    }, []);\n\n    const handleClose = useCallback(() => {\n        setOpen(false);\n    }, []);\n\n    const validValue = (Array.isArray(internalValue) && multiple) ||\n        (!Array.isArray(internalValue) && !multiple);\n\n    const ref = React.createRef<HTMLInputElement>();\n    useEffect(() => {\n        if (ref.current && focused) {\n            ref.current?.focus({ preventScroll: true });\n        }\n    }, [focused, ref]);\n\n    const onChange = useCallback((evt: SelectChangeEvent<any>) => {\n        if (valueType === \"number\") {\n            if (multiple) {\n                const newValue = (evt.target.value as string[]).map((v) => parseFloat(v));\n                updateValue(newValue);\n            } else {\n                updateValue(parseFloat(evt.target.value as string));\n            }\n        } else if (valueType === \"string\") {\n            if (!evt.target.value)\n                updateValue(null)\n            else\n                updateValue(evt.target.value);\n        } else {\n            throw Error(\"Missing mapping in TableSelect\");\n        }\n    }, [multiple, updateValue, valueType]);\n    const renderValue = (enumKey: unknown) => {\n        if (multiple && Array.isArray(enumKey)) {\n            return <ArrayEnumPreview value={enumKey}\n                                     name={name}\n                                     enumValues={enumValues}\n                                     size={small ? \"small\" : \"regular\"}/>;\n        } else {\n            return <EnumValuesChip\n                enumKey={enumKey}\n                enumValues={enumValues}\n                small={small}/>;\n        }\n    };\n    return (\n        <Select\n            variant={\"standard\"}\n            key={`table_select_${name}`}\n            inputRef={ref}\n            sx={{\n                height: \"100%\"\n            }}\n            open={open}\n            disabled={disabled}\n            multiple={multiple}\n            onClose={handleClose}\n            onOpen={handleOpen}\n            fullWidth\n            inputProps={{\n                sx: {\n                    height: \"100% !important\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    padding: \"0px 0 0px\",\n                    background: \"transparent !important\"\n                }\n            }}\n            disableUnderline\n            error={!!error}\n            value={validValue\n                ? (multiple ? (internalValue as any[]).map(v => v.toString()) : internalValue)\n                : (multiple ? [] : \"\")}\n            onChange={onChange}\n            renderValue={renderValue}>\n\n            {enumToObjectEntries(enumValues).map((enumValueConfig) => {\n\n                const enumKey = enumValueConfig.id;\n                const chip = <EnumValuesChip\n                    enumKey={enumKey}\n                    enumValues={enumValues}\n                    small={true}/>;\n                if (multiple) {\n                    return (\n                        <MenuItem key={`select-${name}-${enumKey}`}\n                                  value={enumKey}\n                                  disabled={isEnumValueDisabled(enumValueConfig)}\n                                  dense={true}>\n                            <Checkbox\n                                checked={Array.isArray(internalValue) && internalValue.map(v => v.toString()).includes(enumKey.toString())}/>\n                            <ListItemText primary={chip}/>\n                        </MenuItem>\n                    );\n                } else {\n                    return (\n                        <MenuItem key={`select-${name}-${enumKey}`}\n                                  value={enumKey}\n                                  disabled={isEnumValueDisabled(enumValueConfig)}\n                                  dense={true}>\n                            {chip}\n                        </MenuItem>\n                    );\n                }\n            })}\n        </Select>\n    );\n}\n","import React, { useEffect, useRef, useState } from \"react\";\nimport { Input } from \"@mui/material\";\nimport { useDebounce } from \"../../../util\";\n\nexport function NumberTableInput(props: {\n    error: Error | undefined;\n    value: number;\n    align: \"right\" | \"left\" | \"center\";\n    updateValue: (newValue: (number | null)) => void;\n    focused: boolean;\n    setFocused: (focused: boolean) => void;\n    disabled: boolean;\n}) {\n\n    const { align, value, updateValue, focused, disabled } = props;\n    const propStringValue = (value && typeof value === \"number\") ? value.toString() : \"\";\n    const [internalValue, setInternalValue] = useState<string | null>(propStringValue);\n\n    const prevValue = useRef<number | null>(value);\n\n    useEffect(() => {\n        if (prevValue.current !== value && String(value) !== internalValue)\n            setInternalValue(value ? value.toString() : null);\n        prevValue.current = value;\n    }, [value]);\n\n    const doUpdate = React.useCallback(() => {\n        if (internalValue !== propStringValue) {\n            if (internalValue !== undefined && internalValue !== null) {\n                const numberValue = parseFloat(internalValue);\n                if (isNaN(numberValue))\n                    return;\n                if (numberValue !== undefined && numberValue !== null)\n                    updateValue(numberValue);\n            } else {\n                updateValue(null);\n            }\n        }\n\n    }, [internalValue, value]);\n\n    useDebounce(internalValue, doUpdate, !focused, 2000);\n\n    useEffect(\n        () => {\n            if (!focused && propStringValue !== internalValue)\n                setInternalValue(value !== undefined && value !== null ? value.toString() : null);\n        },\n        [value, focused]\n    );\n\n    const ref = React.createRef<HTMLInputElement>();\n\n    useEffect(() => {\n        if (ref.current && focused) {\n            ref.current.focus({ preventScroll: true });\n        }\n    }, [focused, ref]);\n\n    const regexp = /^-?[0-9]+[,.]?[0-9]*$/;\n\n    return (\n        <Input\n            inputRef={ref}\n            sx={{\n                width: \"100%\",\n                fontSize: \"unset\",\n                fontFamily: \"unset\",\n                background: \"unset\",\n                border: \"unset\",\n                resize: \"none\",\n                outline: \"none\",\n                padding: 0,\n                margin: 0,\n                color: \"unset\",\n                fontWeight: \"unset\",\n                lineHeight: \"unset\",\n                textAlign: \"right\"\n            }}\n            inputProps={{\n                style: {\n                    textAlign: align\n                }\n            }}\n            disabled={disabled}\n            disableUnderline\n            value={internalValue ?? \"\"}\n            onFocus={() => {\n                props.setFocused(true);\n            }}\n            onBlur={() => {\n                doUpdate();\n                props.setFocused(false);\n            }}\n            onChange={(evt) => {\n                const newValue = evt.target.value.replace(\",\", \".\");\n                if (newValue.length === 0)\n                    setInternalValue(null);\n                if (regexp.test(newValue) || newValue.startsWith(\"-\"))\n                    setInternalValue(newValue);\n            }}\n        />\n    );\n}\n","import React, { useEffect } from \"react\";\nimport { Switch } from \"@mui/material\";\n\nexport function TableSwitch(props: {\n    error: Error | undefined;\n    internalValue?: boolean;\n    focused: boolean;\n    disabled: boolean;\n    updateValue: (newValue: (boolean | null)) => void;\n}) {\n    const { disabled, internalValue, updateValue, focused } = props;\n\n    const ref = React.createRef<HTMLTextAreaElement>();\n    useEffect(() => {\n        if (ref.current && focused) {\n            ref.current.focus({ preventScroll: true });\n        }\n    }, [focused, ref]);\n\n    return (\n        <Switch\n            inputRef={ref}\n            color={\"secondary\"}\n            checked={Boolean(internalValue)}\n            disabled={disabled}\n            onChange={(evt) => {\n                const value = evt.target.checked as boolean;\n                updateValue(value);\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport { Box, TextField as MuiTextField } from \"@mui/material\";\nimport { DateTimePicker } from \"@mui/x-date-pickers/DateTimePicker\";\nimport { DatePicker } from \"@mui/x-date-pickers/DatePicker\";\n\nexport function TableDateField(props: {\n    name: string;\n    error: Error | undefined;\n    mode?: \"date\" | \"date_time\";\n    internalValue: Date | undefined | null;\n    updateValue: (newValue: (Date | null)) => void;\n    focused: boolean;\n    disabled: boolean;\n    onBlur?: React.FocusEventHandler<HTMLInputElement | HTMLTextAreaElement>;\n}) {\n\n    const {\n        disabled,\n        error,\n        mode,\n        internalValue,\n        updateValue\n    } = props;\n\n    const PickerComponent = mode === undefined || mode === \"date_time\"\n        ? DateTimePicker\n        : DatePicker;\n\n    return (\n        <PickerComponent\n            value={internalValue ?? null}\n            disabled={disabled}\n            onChange={(dateValue: Date | null) => {\n                updateValue(dateValue);\n            }}\n            renderInput={(params) =>\n                <MuiTextField {...params}\n                              fullWidth\n                              variant={\"standard\"}\n                              error={Boolean(error)}\n                                  style={{\n                                      height: \"100%\"\n                                  }}\n                                  InputProps={{\n                                      ...params.InputProps,\n                                      style: { fontSize: 14 },\n                                      disableUnderline: true,\n                                      endAdornment: <Box sx={{ pr: 1 }}>\n                                          {params.InputProps?.endAdornment}\n                                      </Box>\n                                  }}\n                    />}\n                InputAdornmentProps={{\n                    style: {\n                        fontSize: \"small\",\n                        height: 26\n                    }\n                }}\n            />\n    );\n}\n","import React, { useCallback, useState } from \"react\";\nimport { Box, Button } from \"@mui/material\";\nimport { ReferencePreview } from \"../../../../preview\";\nimport {\n    CollectionSize,\n    Entity,\n    EntityReference,\n    FilterValues\n} from \"../../../../types\";\n\nimport { getPreviewSizeFrom } from \"../../../../preview/util\";\nimport { getReferenceFrom } from \"../../../util\";\nimport { useNavigationContext, useReferenceDialog } from \"../../../../hooks\";\nimport { ErrorView } from \"../../ErrorView\";\n\nexport function TableReferenceField(props: {\n    name: string;\n    disabled: boolean;\n    internalValue: EntityReference | EntityReference[] | undefined | null;\n    updateValue: (newValue: (EntityReference | EntityReference [] | null)) => void;\n    size: CollectionSize;\n    multiselect: boolean;\n    previewProperties?: string[];\n    title?: string;\n    path: string;\n    forceFilter?: FilterValues<string>;\n}) {\n\n    const {\n        name,\n        internalValue,\n        updateValue,\n        multiselect,\n        path,\n        size,\n        previewProperties,\n        title,\n        disabled,\n        forceFilter\n    } = props;\n\n    const [onHover, setOnHover] = useState(false);\n\n    const hoverTrue = useCallback(() => setOnHover(true), []);\n    const hoverFalse = useCallback(() => setOnHover(false), []);\n\n    const navigationContext = useNavigationContext();\n\n    const collection = navigationContext.getCollection(path);\n    if (!collection) {\n        throw Error(`Couldn't find the corresponding collection view for the path: ${path}`);\n    }\n\n    const onSingleEntitySelected = useCallback((entity: Entity<any>) => {\n        updateValue(entity ? getReferenceFrom(entity) : null);\n    }, [updateValue]);\n\n    const onMultipleEntitiesSelected = useCallback((entities: Entity<any>[]) => {\n        updateValue(entities.map((e) => getReferenceFrom(e)));\n    }, [updateValue]);\n\n    const selectedEntityIds = internalValue\n        ? (Array.isArray(internalValue)\n            ? internalValue.map((ref) => ref.id)\n            : internalValue.id ? [internalValue.id] : [])\n        : [];\n\n    const referenceDialogController = useReferenceDialog({\n            multiselect,\n            path,\n            collection,\n            onMultipleEntitiesSelected,\n            onSingleEntitySelected,\n            selectedEntityIds,\n            forceFilter\n        }\n    );\n\n    const handleOpen = useCallback(() => {\n        if (disabled)\n            return;\n        referenceDialogController.open();\n    }, [disabled, referenceDialogController]);\n\n    const valueNotSet = !internalValue || (Array.isArray(internalValue) && internalValue.length === 0);\n\n    const buildSingleReferenceField = () => {\n        if (internalValue instanceof EntityReference)\n            return <ReferencePreview\n                onClick={disabled ? undefined : handleOpen}\n                size={getPreviewSizeFrom(size)}\n                reference={internalValue as EntityReference}\n                onHover={onHover}\n                disabled={!path}\n                previewProperties={previewProperties}\n            />;\n        else\n            return <ErrorView error={\"Data is not a reference\"}/>;\n    };\n\n    const buildMultipleReferenceField = () => {\n        if (Array.isArray(internalValue))\n            return <>\n                {internalValue.map((reference, index) =>\n                    <Box sx={{ m: 0.5, width: \"100%\" }}\n                         key={`preview_array_ref_${name}_${index}`}>\n                        <ReferencePreview\n                            onClick={disabled ? undefined : handleOpen}\n                            size={\"tiny\"}\n                            reference={reference}\n                            onHover={onHover}\n                            disabled={!path}\n                            previewProperties={previewProperties}\n                        />\n                    </Box>\n                )\n                }\n            </>;\n        else\n            return <ErrorView error={\"Data is not an array of references\"}/>;\n    };\n\n    if (!collection)\n        return <ErrorView error={\"The specified collection does not exist\"}/>;\n\n    return (\n        <Box sx={{ width: \"100%\" }}\n             onMouseEnter={hoverTrue}\n             onMouseMove={hoverTrue}\n             onMouseLeave={hoverFalse}>\n\n            {internalValue && !multiselect && buildSingleReferenceField()}\n\n            {internalValue && multiselect && buildMultipleReferenceField()}\n\n            {valueNotSet &&\n                <Button\n                    onClick={handleOpen}\n                    size={\"small\"}\n                    variant=\"outlined\"\n                    color=\"primary\">\n                    Edit {title}\n                </Button>}\n\n        </Box>\n    );\n}\n","import * as React from \"react\";\nimport { useMemo, useState } from \"react\";\n\nimport { Box, IconButton, Theme, Typography, useTheme } from \"@mui/material\";\n\nimport EditIcon from \"@mui/icons-material/Edit\";\n\nimport {\n    Entity,\n    ResolvedArrayProperty,\n    ResolvedStringProperty,\n    StorageConfig\n} from \"../../../../types\";\nimport { useDropzone } from \"react-dropzone\";\nimport { PreviewSize, PropertyPreview } from \"../../../../preview\";\nimport { ErrorBoundary } from \"../../ErrorBoundary\";\nimport { useSnackbarController, useStorageSource } from \"../../../../hooks\";\nimport { getThumbnailMeasure } from \"../../../../preview/util\";\nimport {\n    StorageFieldItem,\n    useStorageUploadController\n} from \"../../../util/useStorageUploadController\";\nimport {\n    StorageUploadProgress\n} from \"../../../../form/components/StorageUploadProgress\";\n\nconst dropZoneMixin = (hasValue: boolean) => ({\n    transition: \"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms\",\n    position: \"relative\",\n    height: \"100%\",\n    width: \"100%\",\n    outline: 0,\n    display: \"flex\",\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    justifyContent: hasValue ? \"start\" : \"center\",\n    alignItems: \"center\",\n    border: \"2px solid\",\n    borderColor: \"transparent\"\n});\n\nconst activeDropMixin = (theme: Theme) => ({\n    background: theme.palette.mode === \"light\"\n        ? \"repeating-linear-gradient( 45deg, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.2) 10px, rgba(128, 128, 128, 0.25) 10px, rgba(128, 128, 128, 0.25) 20px) !important\"\n        : \"repeating-linear-gradient( 45deg, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.2) 10px, rgba(128, 128, 128, 0.25) 10px, rgba(128, 128, 128, 0.25) 20px) !important\",\n    borderRadius: `${theme.shape.borderRadius}px`,\n    border: \"2px solid\",\n    borderColor: \"transparent\"\n});\n\nconst acceptDropMixin = (theme: Theme) => ({\n    background: \"repeating-linear-gradient( 45deg, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.2) 10px, rgba(128, 128, 128, 0.25) 10px, rgba(128, 128, 128, 0.25) 20px) !important\",\n    // background: \"repeating-linear-gradient( 45deg, rgba(0, 0, 0, 0.09), rgba(0, 0, 0, 0.09) 10px, rgba(0, 0, 0, 0.12) 10px, rgba(0, 0, 0, 0.12) 20px) !important\",\n    borderColor: theme.palette.success.light,\n    border: \"2px solid\"\n});\n\nconst rejectDropMixin = (theme: Theme) => ({\n    borderColor: theme.palette.error.light,\n    border: \"2px solid\"\n});\n\n/**\n * Field that allows to upload files to Google Cloud Storage.\n *\n * This is one of the internal components that get mapped natively inside forms\n * and tables to the specified properties.\n * @category Form fields\n */\nexport function TableStorageUpload(props: {\n    propertyKey: string;\n    error: Error | undefined;\n    disabled: boolean;\n    value: string | string[] | null;\n    updateValue: (newValue: (string | string[] | null)) => void;\n    focused: boolean;\n    property: ResolvedStringProperty | ResolvedArrayProperty<string[]>;\n    entity: Entity<any>;\n    path: string;\n    previewSize: PreviewSize;\n    onBlur?: React.FocusEventHandler<HTMLInputElement | HTMLTextAreaElement>;\n}) {\n\n    const {\n        propertyKey,\n        error,\n        value,\n        disabled,\n        property,\n        entity,\n        path,\n        previewSize,\n        updateValue\n    } = props;\n\n    const storageSource = useStorageSource();\n\n    const {\n        internalValue,\n        setInternalValue,\n        onFilesAdded,\n        storage,\n        onFileUploadComplete,\n        storagePathBuilder,\n        multipleFilesSupported\n    } = useStorageUploadController({\n        entityValues: entity.values,\n        entityId: entity.id,\n        path,\n        property,\n        propertyKey,\n        storageSource,\n        onChange: updateValue,\n        value,\n        disabled\n    });\n\n    return (\n\n        <StorageUpload\n            internalValue={internalValue}\n            setInternalValue={setInternalValue}\n            name={propertyKey}\n            disabled={disabled}\n            autoFocus={false}\n            property={property}\n            onChange={updateValue}\n            entity={entity}\n            storagePathBuilder={storagePathBuilder}\n            storage={storage}\n            multipleFilesSupported={multipleFilesSupported}\n            onFilesAdded={onFilesAdded}\n            onFileUploadComplete={onFileUploadComplete}\n            previewSize={previewSize}/>\n\n    );\n}\n\ninterface StorageUploadProps {\n    internalValue: StorageFieldItem[];\n    setInternalValue: (v: StorageFieldItem[]) => void;\n    name: string;\n    property: ResolvedStringProperty | ResolvedArrayProperty<string[]>;\n    onChange: (value: string | string[] | null) => void;\n    multipleFilesSupported: boolean;\n    autoFocus: boolean;\n    disabled: boolean;\n    entity: Entity<any>;\n    previewSize: PreviewSize;\n    storage: StorageConfig;\n    onFilesAdded: (acceptedFiles: File[]) => void;\n    storagePathBuilder: (file: File) => string;\n    onFileUploadComplete: (uploadedPath: string, entry: StorageFieldItem, fileMetadata?: any) => Promise<void>;\n}\n\nfunction StorageUpload({\n                           property,\n                           name,\n                           internalValue,\n                           setInternalValue,\n                           entity,\n                           onChange,\n                           multipleFilesSupported,\n                           previewSize: previewSizeInput,\n                           disabled,\n                           autoFocus,\n                           storage,\n                           onFilesAdded,\n                           onFileUploadComplete,\n                           storagePathBuilder\n                       }: StorageUploadProps) {\n\n    const [onHover, setOnHover] = useState(false);\n\n    const previewSize = multipleFilesSupported && previewSizeInput === \"regular\" ? \"small\" : previewSizeInput;\n    if (multipleFilesSupported) {\n        const arrayProperty = property as ResolvedArrayProperty<string[]>;\n        if (Array.isArray(arrayProperty.of)) {\n            throw Error(\"Using array properties instead of single one in `of` in ArrayProperty\");\n        }\n        if (arrayProperty.of) {\n            if (arrayProperty.of.dataType !== \"string\") {\n                throw Error(\"Storage field using array must be of data type string\");\n            }\n        } else {\n            throw Error(\"Storage field using array must be of data type string\");\n        }\n    }\n\n    const metadata: any | undefined = storage?.metadata;\n    const hasValue = Boolean(internalValue);\n\n    const snackbarContext = useSnackbarController();\n\n    const {\n        open,\n        getRootProps,\n        getInputProps,\n        isDragActive,\n        isDragAccept,\n        isDragReject\n    } = useDropzone({\n            accept: storage.acceptedFiles ? storage.acceptedFiles.map(e => ({ [e]: [] })).reduce((a, b) => ({ ...a, ...b }), {}) : undefined,\n            disabled,\n            maxSize: storage.maxSize,\n            noClick: true,\n            noKeyboard: true,\n            onDrop: onFilesAdded,\n            onDropRejected: (fileRejections, event) => {\n                for (const fileRejection of fileRejections) {\n                    for (const error of fileRejection.errors) {\n                        snackbarContext.open({\n                            type: \"error\",\n                            message: `Error uploading file: File is larger than ${storage.maxSize} bytes`\n                        });\n                    }\n                }\n            }\n        }\n    );\n\n    const { ...rootProps } = getRootProps();\n\n    const helpText = multipleFilesSupported\n        ? \"Drag 'n' drop some files here, or click here to edit\"\n        : \"Drag 'n' drop a file here, or click here edit\";\n\n    const renderProperty = multipleFilesSupported\n        ? (property as ResolvedArrayProperty<string[]>).of as ResolvedStringProperty\n        : property as ResolvedStringProperty;\n\n    const imageSize = useMemo(() => getThumbnailMeasure(previewSize), [previewSize]);\n\n    const theme = useTheme();\n\n    return (\n        <Box {...rootProps}\n             onMouseEnter={() => setOnHover(true)}\n             onMouseMove={() => setOnHover(true)}\n             onMouseLeave={() => setOnHover(false)}\n             sx={{\n                 ...dropZoneMixin(hasValue),\n                 ...(isDragActive ? activeDropMixin(theme) : {}),\n                 ...(isDragAccept ? acceptDropMixin(theme) : {}),\n                 ...(isDragReject ? rejectDropMixin(theme) : {})\n             }}\n        >\n\n            <input autoFocus={autoFocus} {...getInputProps()} />\n\n            {internalValue.map((entry, index) => {\n                let child;\n                if (entry.storagePathOrDownloadUrl) {\n                    child = (\n                        <TableStorageItemPreview\n                            key={`storage_preview_${index}`}\n                            property={renderProperty}\n                            value={entry.storagePathOrDownloadUrl}\n                            entity={entity}\n                            size={previewSize}/>\n                    );\n                } else if (entry.file) {\n                    child = (\n                        <StorageUploadProgress\n                            key={`storage_progress_${index}`}\n                            entry={entry}\n                            metadata={metadata}\n                            storagePath={storagePathBuilder(entry.file)}\n                            onFileUploadComplete={onFileUploadComplete}\n                            imageSize={imageSize}\n                            simple={true}\n                        />\n                    );\n                }\n\n                return child;\n            })\n            }\n\n            {!internalValue && <Box\n                sx={{\n                    flexGrow: 1,\n                    m: 2,\n                    maxWidth: 200\n                }}\n                onClick={open}>\n                <Typography\n                    sx={{\n                        color: (theme) => (theme.palette.mode === \"light\" ? \"#999\" : \"#444\")\n                    }}\n                    variant={\"body2\"}\n                    align={\"center\"}>\n                    {helpText}\n                </Typography>\n            </Box>}\n\n            {onHover &&\n                <IconButton\n                    color={\"inherit\"}\n                    size={\"small\"}\n                    onClick={open}\n                    sx={{\n                        position: \"absolute\",\n                        bottom: 2,\n                        right: 2\n                    }}>\n                    <EditIcon sx={{\n                        width: 16,\n                        height: 16,\n                        fill: \"#888\"\n                    }\n                    }/>\n                </IconButton>\n            }\n\n        </Box>\n    );\n\n}\n\ninterface TableStorageItemPreviewProps {\n    property: ResolvedStringProperty;\n    value: string,\n    size: PreviewSize;\n    entity: Entity<any>;\n}\n\nexport function TableStorageItemPreview({\n                                            property,\n                                            value,\n                                            size,\n                                            entity\n                                        }: TableStorageItemPreviewProps) {\n\n    return (\n        <Box\n            m={1}\n            position={\"relative\"}\n        >\n\n            {value &&\n                <ErrorBoundary>\n                    <PropertyPreview\n                        propertyKey={\"ignore\"} // TODO: Fix this\n                        value={value}\n                        property={property}\n                        entity={entity}\n                        size={size}/>\n                </ErrorBoundary>\n            }\n\n        </Box>\n    );\n\n}\n","import { TableSize } from \"./VirtualTableProps\";\n\nexport function getRowHeight(size: TableSize): number {\n    switch (size) {\n        case \"xl\":\n            return 400;\n        case \"l\":\n            return 280;\n        case \"m\":\n            return 140;\n        case \"s\":\n            return 80;\n        case \"xs\":\n            return 54;\n        default:\n            throw Error(\"Missing mapping for collection size -> height\");\n    }\n}\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport useMeasure from \"react-use-measure\";\nimport { styled } from \"@mui/system\";\n\nimport {\n    Box,\n    darken,\n    IconButton,\n    lighten,\n    Tooltip,\n    useTheme\n} from \"@mui/material\";\n\nimport ErrorOutlineIcon from \"@mui/icons-material/ErrorOutline\";\nimport RemoveCircleIcon from \"@mui/icons-material/RemoveCircle\";\nimport { TableSize } from \"../../Table\";\nimport { getRowHeight } from \"../../Table/common\";\nimport { ErrorBoundary } from \"../../ErrorBoundary\";\nimport { ErrorTooltip } from \"../../ErrorTooltip\";\n\ninterface TableCellProps {\n    children: React.ReactNode;\n    /**\n     * The value is used only to check changes and force re-renders\n     */\n    value?: any;\n    disabled: boolean;\n    saved?: boolean;\n    error?: Error;\n    allowScroll?: boolean;\n    align: \"right\" | \"left\" | \"center\";\n    size: TableSize;\n    disabledTooltip?: string;\n    width: number;\n    focused: boolean;\n    showExpandIcon?: boolean;\n    removePadding?: boolean;\n    fullHeight?: boolean;\n    selected?: boolean;\n    selectedRow: boolean;\n    onSelect?: (cellRect: DOMRect | undefined) => void;\n    openPopup?: (cellRect: DOMRect | undefined) => void;\n}\n\nfunction getBackgroundColor(onHover: any, selectedRow: boolean, disabled: boolean, saved: boolean, theme: any, isSelected: boolean) {\n    if (onHover && !disabled) {\n        if (theme.palette.mode === \"dark\") {\n            return lighten(theme.palette.background.paper, 0.03);\n        } else {\n            return darken(theme.palette.background.default, 0.02);\n        }\n    }\n    if (isSelected) {\n        if (theme.palette.mode === \"dark\") {\n            return lighten(theme.palette.background.paper, 0.035);\n        } else {\n            return darken(theme.palette.background.default, 0.025);\n        }\n    }\n    if (selectedRow || saved) {\n        if (theme.palette.mode === \"dark\") {\n            return lighten(theme.palette.background.paper, 0.022);\n        } else {\n            return darken(theme.palette.background.default, 0.008);\n        }\n    }\n    return undefined;\n}\n\ntype TableCellRootProps = {\n    padding: string;\n    border: string;\n    justifyContent: string;\n    contain: string,\n    alignItems?: string,\n    backgroundColor?: string\n}\nconst TableCellRoot = styled(\"div\", {})<TableCellRootProps>(({\n                                                                 theme,\n                                                                 justifyContent,\n                                                                 padding,\n                                                                 border,\n                                                                 alignItems,\n                                                                 backgroundColor\n                                                             }) => ({\n    alignItems,\n    backgroundColor,\n    padding,\n    border,\n    justifyContent,\n    display: \"flex\",\n    position: \"relative\",\n    height: \"100%\",\n    borderRadius: \"4px\",\n    overflow: \"hidden\",\n    // contain: \"content\",\n    contain: \"content\",\n    transition: \"border-color 200ms ease-in-out, background-color 500ms ease\"\n}));\n\ntype TableCellInnerProps = {\n    justifyContent: string;\n    scrollable: boolean;\n    faded: boolean;\n    fullHeight: boolean;\n\n}\nconst TableCellInner = styled(\"div\", {})<TableCellInnerProps>(({\n                                                                   theme,\n                                                                   justifyContent,\n                                                                   scrollable,\n                                                                   faded,\n                                                                   fullHeight\n                                                               }) => ({\n\n    display: \"flex\",\n    maxHeight: \"100%\",\n    width: \"100%\",\n    flexDirection: \"column\",\n    height: fullHeight ? \"100%\" : undefined,\n    justifyContent,\n    overflow: scrollable ? \"auto\" : undefined,\n    WebkitMaskImage: faded ? \"linear-gradient(to bottom, black 60%, transparent 100%)\" : undefined,\n    maskImage: faded ? \"linear-gradient(to bottom, black 60%, transparent 100%)\" : undefined,\n    alignItems: faded ? \"start\" : (scrollable ? \"start\" : undefined)\n\n}));\n\nexport const TableCell = React.memo<TableCellProps>(\n    function TableCell({\n                           children,\n                           focused,\n                           size,\n                           selected,\n                           disabled,\n                           disabledTooltip,\n                           saved,\n                           selectedRow,\n                           error,\n                           align,\n                           allowScroll,\n                           openPopup,\n                           removePadding,\n                           fullHeight,\n                           onSelect,\n                           width,\n                           showExpandIcon = true\n                       }: TableCellProps) {\n\n        const [measureRef, bounds] = useMeasure();\n        const theme = useTheme();\n        const ref = React.createRef<HTMLDivElement>();\n\n        const [isOverflowing, setIsOverflowing] = useState<boolean>(false);\n        const maxHeight = useMemo(() => getRowHeight(size), [size]);\n\n        const [onHover, setOnHover] = useState(false);\n        const [internalSaved, setInternalSaved] = useState(saved);\n\n        const showError = !disabled && error;\n\n        const iconRef = React.createRef<HTMLButtonElement>();\n        useEffect(() => {\n            if (iconRef.current && focused) {\n                iconRef.current.focus({ preventScroll: true });\n            }\n        }, [focused]);\n\n        useEffect(() => {\n            if (saved) {\n                setInternalSaved(true);\n            }\n            const handler = setTimeout(() => {\n                setInternalSaved(false);\n            }, 800);\n            return () => {\n                clearTimeout(handler);\n            };\n        }, [saved]);\n\n        let p = theme.spacing(0);\n        if (!removePadding) {\n            switch (size) {\n                case \"l\":\n                case \"xl\":\n                    p = theme.spacing(2);\n                    break;\n                case \"m\":\n                    p = theme.spacing(1);\n                    break;\n                case \"s\":\n                    p = theme.spacing(0.5);\n                    break;\n                default:\n                    p = theme.spacing(0.25);\n                    break;\n            }\n        }\n\n        let justifyContent;\n        switch (align) {\n            case \"right\":\n                justifyContent = \"flex-end\";\n                break;\n            case \"center\":\n                justifyContent = \"center\";\n                break;\n            case \"left\":\n            default:\n                justifyContent = \"flex-start\";\n        }\n\n        const doOpenPopup = useCallback(() => {\n            if (openPopup) {\n                const cellRect = ref && ref?.current?.getBoundingClientRect();\n                openPopup(cellRect);\n            }\n        }, [ref]);\n\n        const onClick = useCallback((event: React.MouseEvent<HTMLDivElement>) => {\n            if (event.detail === 3) {\n                doOpenPopup();\n            }\n        }, [doOpenPopup]);\n\n        const onSelectCallback = useCallback(() => {\n            if (!onSelect) return;\n            const cellRect = ref && ref?.current?.getBoundingClientRect();\n            if (disabled) {\n                onSelect(undefined);\n            } else if (!selected && cellRect) {\n                onSelect(cellRect);\n            }\n        }, [ref, onSelect, selected, disabled]);\n\n        const onFocus = useCallback((event: React.SyntheticEvent<HTMLDivElement>) => {\n            onSelectCallback();\n            event.stopPropagation();\n        }, [onSelectCallback]);\n\n        useEffect(() => {\n            if (bounds) {\n                const newOverflowingValue = bounds.height > maxHeight;\n                if (isOverflowing !== newOverflowingValue)\n                    setIsOverflowing(newOverflowingValue);\n            }\n        }, [bounds, isOverflowing, maxHeight]);\n\n        const isSelected = !showError && selected;\n\n        let border: string;\n        if (internalSaved) {\n            border = `2px solid ${theme.palette.success.light}`;\n        } else if (isSelected) {\n            border = \"2px solid #5E9ED6\";\n        } else if (showError) {\n            border = `2px solid ${theme.palette.error.light} !important`\n        } else {\n            border = \"2px solid transparent\"\n        }\n\n        const scrollable = !disabled && allowScroll && isOverflowing;\n        const faded = !disabled && !allowScroll && isOverflowing;\n\n        const setOnHoverTrue = useCallback(() => setOnHover(true), []);\n        const setOnHoverFalse = useCallback(() => setOnHover(false), []);\n\n        return (\n            <TableCellRoot\n                style={{\n                    width: width ?? \"100%\"\n                }}\n                tabIndex={selected || disabled ? undefined : 0}\n                ref={ref}\n                onFocus={onFocus}\n                onClick={onClick}\n                onMouseEnter={setOnHoverTrue}\n                onMouseMove={setOnHoverTrue}\n                onMouseLeave={setOnHoverFalse}\n                padding={p}\n                contain={scrollable ? \"content\" : \"size\"}\n                border={border}\n                justifyContent={justifyContent}\n                alignItems={disabled || !isOverflowing ? \"center\" : undefined}\n                backgroundColor={getBackgroundColor(onHover, selectedRow, disabled, internalSaved ?? false, theme, isSelected ?? false)}\n            >\n\n                <ErrorBoundary>\n\n                    {fullHeight && !faded && children}\n\n                    {(!fullHeight || faded) && <TableCellInner\n                        fullHeight={fullHeight ?? false}\n                        justifyContent={justifyContent}\n                        scrollable={scrollable ?? false}\n                        faded={faded}>\n\n                        {!fullHeight && <div ref={measureRef}\n                                             style={{\n                                                 display: \"flex\",\n                                                 width: \"100%\",\n                                                 justifyContent,\n                                                 height: fullHeight ? \"100%\" : undefined\n                                             }}>\n                            {children}\n                        </div>}\n\n                    </TableCellInner>}\n                </ErrorBoundary>\n\n                {disabled && onHover && disabledTooltip &&\n                    <Box sx={{\n                        position: \"absolute\",\n                        top: 4,\n                        right: 4,\n                        fontSize: \"14px\"\n                    }}>\n                        <Tooltip title={disabledTooltip}>\n                            <RemoveCircleIcon color={\"disabled\"}\n                                              fontSize={\"inherit\"}/>\n                        </Tooltip>\n                    </Box>}\n\n                {(showError || showExpandIcon) &&\n                    <Box sx={{\n                        position: \"absolute\",\n                        top: \"2px\",\n                        right: \"2px\"\n                    }}>\n\n                        {selected && !disabled && showExpandIcon &&\n                            <IconButton\n                                ref={iconRef}\n                                color={\"inherit\"}\n                                size={\"small\"}\n                                onClick={doOpenPopup}>\n                                <svg\n                                    className={\"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall\"}\n                                    fill={\"#888\"}\n                                    width=\"20\"\n                                    height=\"20\"\n                                    viewBox=\"0 0 24 24\">\n                                    <path className=\"cls-2\"\n                                          d=\"M20,5a1,1,0,0,0-1-1L14,4h0a1,1,0,0,0,0,2h2.57L13.29,9.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L18,7.42V10a1,1,0,0,0,1,1h0a1,1,0,0,0,1-1Z\"/>\n                                    <path className=\"cls-2\"\n                                          d=\"M10.71,13.29a1,1,0,0,0-1.42,0L6,16.57V14a1,1,0,0,0-1-1H5a1,1,0,0,0-1,1l0,5a1,1,0,0,0,1,1h5a1,1,0,0,0,0-2H7.42l3.29-3.29A1,1,0,0,0,10.71,13.29Z\"/>\n                                </svg>\n                            </IconButton>\n                        }\n\n                        {showError && <ErrorTooltip\n                            arrow\n                            placement={\"left\"}\n                            title={showError.message}>\n                            <ErrorOutlineIcon\n                                fontSize={\"inherit\"}\n                                color={\"error\"}\n                            />\n                        </ErrorTooltip>\n                        }\n\n                    </Box>\n                }\n\n            </TableCellRoot>\n        );\n    }, (a, b) =>\n        a.error === b.error &&\n        a.value === b.value &&\n        a.disabled === b.disabled &&\n        a.saved === b.saved &&\n        a.allowScroll === b.allowScroll &&\n        a.align === b.align &&\n        a.size === b.size &&\n        a.disabledTooltip === b.disabledTooltip &&\n        a.width === b.width &&\n        a.focused === b.focused &&\n        a.showExpandIcon === b.showExpandIcon &&\n        a.removePadding === b.removePadding &&\n        a.fullHeight === b.fullHeight &&\n        a.selected === b.selected &&\n        a.selectedRow === b.selectedRow) as React.FunctionComponent<TableCellProps>;\n","import React, {\n    useCallback,\n    useEffect,\n    useMemo,\n    useRef,\n    useState\n} from \"react\";\nimport equal from \"react-fast-compare\"\nimport {\n    CMSType,\n    Entity,\n    EntityCollection,\n    EntityReference,\n    ResolvedArrayProperty,\n    ResolvedNumberProperty,\n    ResolvedProperty,\n    ResolvedStringProperty\n} from \"../../../../types\";\nimport { TableInput } from \"../../Table/fields/TableInput\";\nimport { TableSelect } from \"../../Table/fields/TableSelect\";\nimport { NumberTableInput } from \"../../Table/fields/TableNumberInput\";\nimport { TableSwitch } from \"../../Table/fields/TableSwitch\";\nimport { TableDateField } from \"../../Table/fields/TableDateField\";\nimport { PropertyPreview } from \"../../../../preview\";\nimport { TableReferenceField } from \"../fields/TableReferenceField\";\n\nimport { getPreviewSizeFrom } from \"../../../../preview/util\";\nimport { isReadOnly } from \"../../../util\";\nimport { TableStorageUpload } from \"../fields/TableStorageUpload\";\nimport {\n    CustomFieldValidator,\n    mapPropertyToYup\n} from \"../../../../form/validation\";\nimport { useEntityCollectionTableController } from \"../EntityCollectionTable\";\nimport {\n    useClearRestoreValue,\n    useDataSource,\n    useFireCMSContext\n} from \"../../../../hooks\";\nimport { TableCell } from \"./TableCell\";\nimport { getRowHeight } from \"../../Table/common\";\n\nexport interface PropertyTableCellProps<T extends CMSType, M extends Record<string, any>> {\n    propertyKey: string;\n    columnIndex: number;\n    align: \"right\" | \"left\" | \"center\";\n    customFieldValidator?: CustomFieldValidator;\n    value: T;\n    readonly: boolean;\n    collection: EntityCollection<M>;\n    setFocused: (value: boolean) => void;\n    property: ResolvedProperty<T>;\n    height: number;\n    width: number;\n    entity: Entity<any>;\n    path: string;\n}\n\nfunction isStorageProperty<T>(property: ResolvedProperty) {\n    if (property.dataType === \"string\" && (property as ResolvedStringProperty).storage)\n        return true;\n    if (property.dataType === \"array\") {\n        if (Array.isArray(property.of)) {\n            return false;\n        } else {\n            return ((property as ResolvedArrayProperty).of as ResolvedProperty)?.dataType === \"string\" &&\n                ((property as ResolvedArrayProperty).of as ResolvedStringProperty)?.storage\n        }\n    }\n    return false;\n}\n\nexport const PropertyTableCell = React.memo<PropertyTableCellProps<any, any>>(\n    function PropertyTableCell<T extends CMSType, M extends Record<string, any>>({\n                                                                                     propertyKey,\n                                                                                     columnIndex,\n                                                                                     customFieldValidator,\n                                                                                     value,\n                                                                                     property,\n                                                                                     align,\n                                                                                     width,\n                                                                                     height,\n                                                                                     collection,\n                                                                                     path,\n                                                                                     entity,\n                                                                                     readonly\n                                                                                 }: PropertyTableCellProps<T, M>) {\n\n        const dataSource = useDataSource();\n        const context = useFireCMSContext();\n\n        const {\n            onValueChange,\n            size,\n            selectedCell,\n            focused,\n            setFocused,\n            select,\n            setPopupCell,\n            selectedEntityIds\n        } = useEntityCollectionTableController();\n        const selectedRow = selectedEntityIds?.includes(entity.id) ?? false;\n\n        const selected = selectedCell?.columnIndex === columnIndex &&\n            selectedCell?.entity.path === entity.path &&\n            selectedCell?.entity.id === entity.id;\n\n        const [internalValue, setInternalValue] = useState<any | null>(value);\n        const internalValueRef = useRef(value);\n\n        const [error, setError] = useState<Error | undefined>();\n        const [saved, setSaved] = useState<boolean>(false);\n\n        const onValueUpdated = useCallback(() => {\n            setSaved(true)\n            setTimeout(() => {\n                setSaved(false);\n            }, 100);\n        }, []);\n\n        const customField = Boolean(property.Field);\n        const customPreview = Boolean(property.Preview);\n        const readOnlyProperty = isReadOnly(property);\n        const disabledTooltip: string | undefined = typeof property.disabled === \"object\" ? property.disabled.disabledMessage : undefined;\n        const disabled = Boolean(property.disabled);\n\n        const validation = useMemo(() => mapPropertyToYup({\n            property,\n            entityId: entity.id,\n            customFieldValidator,\n            name: propertyKey\n        }), [entity.id, property, propertyKey]);\n\n        useEffect(\n            () => {\n                if (!equal(value, internalValueRef.current)) {\n                    setError(undefined);\n                    setInternalValue(value);\n                    internalValueRef.current = value;\n                    onValueUpdated();\n                }\n            },\n            [onValueUpdated, value]\n        );\n\n        const saveValues = useCallback((value: any) => {\n            setSaved(false);\n            validation\n                .validate(value)\n                .then(() => {\n                    setError(undefined);\n                    if (onValueChange) {\n                        onValueChange({\n                            value,\n                            propertyKey,\n                            setError,\n                            onValueUpdated,\n                            entity,\n                            fullPath: path,\n                            collection,\n                            dataSource,\n                            context\n                        });\n                    }\n                })\n                .catch((e) => {\n                    setError(e);\n                });\n        }, [entity, onValueChange, propertyKey, validation]);\n\n        useEffect(() => {\n            validation\n                .validate(internalValue)\n                .then(() => setError(undefined))\n                .catch((e) => {\n                    setError(e);\n                });\n        }, [internalValue, validation]);\n\n        const updateValue = useCallback(\n            (newValue: any | null) => {\n\n                let updatedValue: any;\n                if (newValue === undefined) {\n                    updatedValue = null;\n                } else {\n                    updatedValue = newValue;\n                }\n                internalValueRef.current = updatedValue;\n                setInternalValue(updatedValue);\n                saveValues(updatedValue);\n            },\n            [saveValues]\n        );\n\n        useClearRestoreValue<any>({\n            property,\n            value: internalValue,\n            setValue: updateValue\n        });\n\n        const onSelect = useCallback((cellRect: DOMRect | undefined) => {\n            if (!cellRect) {\n                select(undefined);\n            } else {\n                select({\n                    columnIndex,\n                    width,\n                    height,\n                    entity,\n                    cellRect,\n                    propertyKey: propertyKey as keyof M,\n                    collection\n                });\n            }\n        }, [collection, columnIndex, entity, height, propertyKey, select, width]);\n\n        const openPopup = useCallback((cellRect: DOMRect | undefined) => {\n            if (!cellRect) {\n                setPopupCell(undefined);\n            } else {\n                setPopupCell({\n                    columnIndex,\n                    width,\n                    height,\n                    entity,\n                    cellRect,\n                    propertyKey: propertyKey as keyof M,\n                    collection\n                });\n            }\n        }, [collection, columnIndex, entity, height, propertyKey, width]);\n\n        let innerComponent: React.ReactNode | undefined;\n        let allowScroll = false;\n        let showExpandIcon = false;\n        let removePadding = false;\n        let fullHeight = false;\n\n        if (readonly || readOnlyProperty) {\n            return <TableCell\n                size={size}\n                width={width}\n                focused={focused}\n                saved={saved}\n                selectedRow={selectedRow}\n                key={`${propertyKey}_${entity.path}_${entity.id}`}\n                value={internalValue}\n                align={align ?? \"left\"}\n                fullHeight={true}\n                disabledTooltip={disabledTooltip ?? (readOnlyProperty ? \"Read only\" : undefined)}\n                disabled={true}>\n                <PropertyPreview\n                    width={width}\n                    height={getRowHeight(size)}\n                    propertyKey={propertyKey}\n                    property={property}\n                    entity={entity}\n                    value={value}\n                    size={getPreviewSizeFrom(size)}\n                />\n            </TableCell>;\n        }\n\n        if (!customField && (!customPreview || selected)) {\n            const isAStorageProperty = isStorageProperty(property);\n            if (isAStorageProperty) {\n                innerComponent = <TableStorageUpload error={error}\n                                                     disabled={disabled}\n                                                     focused={focused}\n                                                     property={property as ResolvedStringProperty | ResolvedArrayProperty<string[]>}\n                                                     entity={entity}\n                                                     path={path}\n                                                     value={internalValue}\n                                                     previewSize={getPreviewSizeFrom(size)}\n                                                     updateValue={updateValue}\n                                                     propertyKey={propertyKey as string}\n                />;\n                showExpandIcon = true;\n                fullHeight = true;\n                removePadding = true;\n            } else if (selected && property.dataType === \"number\") {\n                const numberProperty = property as ResolvedNumberProperty;\n                if (numberProperty.enumValues) {\n                    innerComponent = <TableSelect name={propertyKey as string}\n                                                  multiple={false}\n                                                  disabled={disabled}\n                                                  focused={focused}\n                                                  valueType={\"number\"}\n                                                  small={getPreviewSizeFrom(size) !== \"regular\"}\n                                                  enumValues={numberProperty.enumValues}\n                                                  error={error}\n                                                  internalValue={internalValue as string | number}\n                                                  updateValue={updateValue}\n                    />;\n                    fullHeight = true;\n                } else {\n                    innerComponent = <NumberTableInput\n                        align={align}\n                        error={error}\n                        focused={focused}\n                        setFocused={setFocused}\n                        disabled={disabled}\n                        value={internalValue as number}\n                        updateValue={updateValue}\n                    />;\n                    allowScroll = true;\n                }\n            } else if (selected && property.dataType === \"string\") {\n                const stringProperty = property as ResolvedStringProperty;\n                if (stringProperty.enumValues) {\n                    innerComponent = <TableSelect name={propertyKey as string}\n                                                  multiple={false}\n                                                  focused={focused}\n                                                  disabled={disabled}\n                                                  valueType={\"string\"}\n                                                  small={getPreviewSizeFrom(size) !== \"regular\"}\n                                                  enumValues={stringProperty.enumValues}\n                                                  error={error}\n                                                  internalValue={internalValue as string | number}\n                                                  updateValue={updateValue}\n                    />;\n                    fullHeight = true;\n                } else if (!stringProperty.storage) {\n                    const multiline = Boolean(stringProperty.multiline) || Boolean(stringProperty.markdown);\n                    innerComponent = <TableInput error={error}\n                                                 disabled={disabled}\n                                                 multiline={multiline}\n                                                 setFocused={setFocused}\n                                                 focused={focused}\n                                                 value={internalValue as string}\n                                                 updateValue={updateValue}\n                    />;\n                    allowScroll = true;\n                }\n            } else if (property.dataType === \"boolean\") {\n                innerComponent = <TableSwitch error={error}\n                                              disabled={disabled}\n                                              focused={focused && selected}\n                                              internalValue={internalValue as boolean}\n                                              updateValue={updateValue}\n                />;\n            } else if (property.dataType === \"date\") {\n                innerComponent = <TableDateField name={propertyKey as string}\n                                                 error={error}\n                                                 disabled={disabled}\n                                                 mode={property.mode}\n                                                 focused={focused}\n                                                 internalValue={internalValue as Date}\n                                                 updateValue={updateValue}\n                />;\n                allowScroll = true;\n            } else if (property.dataType === \"reference\") {\n                if (typeof property.path === \"string\") {\n                    innerComponent =\n                        <TableReferenceField name={propertyKey as string}\n                                             internalValue={internalValue as EntityReference}\n                                             updateValue={updateValue}\n                                             disabled={disabled}\n                                             size={size}\n                                             path={property.path}\n                                             multiselect={false}\n                                             previewProperties={property.previewProperties}\n                                             title={property.name}\n                                             forceFilter={property.forceFilter}\n                        />;\n                }\n                allowScroll = false;\n            } else if (property.dataType === \"array\") {\n                const arrayProperty = (property as ResolvedArrayProperty);\n\n                if (!arrayProperty.of && !arrayProperty.oneOf) {\n                    throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${propertyKey}`);\n                }\n                if (arrayProperty.of && !Array.isArray(arrayProperty.of)) {\n                    if (arrayProperty.of.dataType === \"string\" || arrayProperty.of.dataType === \"number\") {\n                        if (selected && arrayProperty.of.enumValues) {\n                            innerComponent =\n                                <TableSelect name={propertyKey as string}\n                                             multiple={true}\n                                             disabled={disabled}\n                                             focused={focused}\n                                             small={getPreviewSizeFrom(size) !== \"regular\"}\n                                             valueType={arrayProperty.of.dataType}\n                                             enumValues={arrayProperty.of.enumValues}\n                                             error={error}\n                                             internalValue={internalValue as string | number}\n                                             updateValue={updateValue}\n                                />;\n                            allowScroll = true;\n                            fullHeight = true;\n                        }\n                    } else if (arrayProperty.of.dataType === \"reference\") {\n                        if (typeof arrayProperty.of.path === \"string\") {\n                            innerComponent =\n                                <TableReferenceField\n                                    name={propertyKey as string}\n                                    disabled={disabled}\n                                    internalValue={internalValue as EntityReference[]}\n                                    updateValue={updateValue}\n                                    size={size}\n                                    multiselect={true}\n                                    path={arrayProperty.of.path}\n                                    previewProperties={arrayProperty.of.previewProperties}\n                                    title={arrayProperty.of.name}\n                                    forceFilter={arrayProperty.of.forceFilter}\n                                />;\n                        }\n                        allowScroll = false;\n                    }\n                }\n\n            }\n        }\n\n        if (!innerComponent) {\n            allowScroll = false;\n            showExpandIcon = selected && !innerComponent && !disabled && !readOnlyProperty;\n            innerComponent = (\n                <PropertyPreview\n                    width={width}\n                    height={height}\n                    entity={entity}\n                    propertyKey={propertyKey as string}\n                    value={internalValue}\n                    property={property}\n                    size={getPreviewSizeFrom(size)}\n                />\n            );\n        }\n\n        return (\n            <TableCell\n                key={`cell_${propertyKey}_${entity.path}_${entity.id}`}\n                size={size}\n                width={width}\n                focused={focused}\n                onSelect={onSelect}\n                selected={selected}\n                selectedRow={selectedRow}\n                disabled={disabled || readOnlyProperty}\n                disabledTooltip={disabledTooltip ?? \"Disabled\"}\n                removePadding={removePadding}\n                fullHeight={fullHeight}\n                saved={saved}\n                error={error}\n                align={align}\n                allowScroll={allowScroll}\n                showExpandIcon={showExpandIcon}\n                openPopup={!disabled ? openPopup : undefined}\n                value={internalValue}\n            >\n\n                {innerComponent}\n\n            </TableCell>\n        );\n\n    },\n    areEqual) as React.FunctionComponent<PropertyTableCellProps<any, any>>;\n\nfunction areEqual(prevProps: PropertyTableCellProps<any, any>, nextProps: PropertyTableCellProps<any, any>) {\n    return prevProps.height === nextProps.height &&\n        prevProps.propertyKey === nextProps.propertyKey &&\n        prevProps.align === nextProps.align &&\n        prevProps.width === nextProps.width &&\n        equal(prevProps.property, nextProps.property) &&\n        equal(prevProps.value, nextProps.value) &&\n        equal(prevProps.entity.values, nextProps.entity.values)\n        ;\n}\n","import React, { useEffect } from \"react\";\n\ninterface DraggableProps {\n    containerRef: React.RefObject<HTMLDivElement>,\n    innerRef: React.RefObject<HTMLDivElement>,\n    // ref: React.RefObject<HTMLDivElement>,\n    x?: number;\n    y?: number;\n    onMove: (x: number, y: number) => void,\n}\n\nexport function useDraggable({\n                                 containerRef,\n                                 innerRef,\n                                 x,\n                                 y,\n                                 onMove\n                             }: DraggableProps) {\n\n    let relX = 0;\n    let relY = 0;\n\n    const listeningRef = React.useRef(false);\n\n    const onMouseDown = (event: any) => {\n        if (event.button !== 0 || !containerRef.current || event.defaultPrevented || event.innerClicked) {\n            return;\n        }\n\n        const { x, y } = containerRef.current.getBoundingClientRect();\n\n        relX = event.screenX - x;\n        relY = event.screenY - y;\n        document.addEventListener(\"mousemove\", onMouseMove);\n        document.addEventListener(\"mouseup\", onMouseUp);\n        document.addEventListener(\"selectstart\", onSelect);\n        listeningRef.current = true;\n        // event.stopPropagation();\n    };\n    const onMouseDownInner = (event: any) => {\n        // @ts-ignore\n        event.innerClicked = true;\n    };\n\n    const onSelect = (event: any) => {\n        event.preventDefault()\n        event.stopPropagation();\n    };\n\n    const onMouseUp = (event: any) => {\n        document.removeEventListener(\"mousemove\", onMouseMove);\n        document.removeEventListener(\"mouseup\", onMouseUp);\n        document.removeEventListener(\"selectstart\", onSelect);\n        event.stopPropagation();\n        listeningRef.current = false;\n    };\n\n    const onMouseMove = (event: any) => {\n        if (event.target.localName === \"input\" || !listeningRef.current)\n            return;\n        onMove(\n            event.screenX - relX,\n            event.screenY - relY\n        );\n        event.stopPropagation();\n    };\n\n    const update = () => {\n        if (containerRef.current) {\n            containerRef.current.style.top = `${y}px`;\n            containerRef.current.style.left = `${x}px`;\n        }\n    };\n\n    useEffect(() => {\n        const current = containerRef.current;\n        const innerCurrent = innerRef.current;\n        if (!current || !innerCurrent)\n            return;\n        if (innerCurrent)\n            innerCurrent.addEventListener(\"mousedown\", onMouseDownInner);\n        if (current)\n            current.addEventListener(\"mousedown\", onMouseDown);\n        update();\n        return () => {\n            if (current)\n                current.removeEventListener(\"mousedown\", onMouseDown);\n            if (innerCurrent)\n                innerCurrent.removeEventListener(\"mousedown\", onMouseDownInner);\n        };\n    });\n\n}\n","import { useLayoutEffect, useState } from \"react\";\n\ninterface WindowSize {\n    width: number,\n    height: number\n}\n\nexport function useWindowSize(): WindowSize {\n    const [size, setSize] = useState<WindowSize>({ width: 0, height: 0 });\n    useLayoutEffect(() => {\n        function updateSize() {\n            setSize({ width: window.innerWidth, height: window.innerHeight });\n        }\n\n        window.addEventListener(\"resize\", updateSize);\n        updateSize();\n        return () => window.removeEventListener(\"resize\", updateSize);\n    }, []);\n    return size;\n}\n","import { RefObject, useCallback, useEffect, useRef } from \"react\";\n\ninterface Props {\n    onResize: (event: Event) => void;\n}\n\nexport const ElementResizeListener: React.FC<Props> = ({ onResize }) => {\n    const rafRef = useRef(0);\n    const objectRef: RefObject<HTMLObjectElement> = useRef(null);\n    const onResizeRef = useRef(onResize);\n\n    onResizeRef.current = onResize;\n\n    const _onResize = useCallback((e: Event) => {\n        if (rafRef.current) {\n            cancelAnimationFrame(rafRef.current);\n        }\n        rafRef.current = requestAnimationFrame(() => {\n            onResizeRef.current(e);\n        });\n    }, []);\n\n    const onLoad = useCallback(() => {\n        const obj = objectRef.current;\n        if (obj && obj.contentDocument && obj.contentDocument.defaultView) {\n            obj.contentDocument.defaultView.addEventListener(\"resize\", _onResize);\n        }\n    }, [_onResize]);\n\n    useEffect(() => {\n        const obj = objectRef.current;\n        return () => {\n            if (obj && obj.contentDocument && obj.contentDocument.defaultView) {\n                obj.contentDocument.defaultView.removeEventListener(\"resize\", _onResize);\n            }\n        };\n    }, [_onResize]);\n\n    return (\n        <object\n            onLoad={onLoad}\n            ref={objectRef}\n            tabIndex={-1}\n            type={\"text/html\"}\n            data={\"about:blank\"}\n            title={\"\"}\n            style={{\n                position: \"absolute\",\n                top: 0,\n                left: 0,\n                height: \"100%\",\n                width: \"100%\",\n                pointerEvents: \"none\",\n                zIndex: -1,\n                opacity: 0\n            }}\n        />\n    );\n};\n","import { alpha, Box, Breakpoint, Container } from \"@mui/material\";\nimport React from \"react\";\n\nexport function CustomDialogActions({\n                                        children,\n                                        position = \"sticky\",\n                                        maxWidth,\n                                        translucent = true\n                                    }: {\n    children: React.ReactNode,\n    position?: \"sticky\" | \"absolute\",\n    maxWidth?: Breakpoint,\n    translucent?: boolean\n}) {\n    const component = maxWidth\n        ? <Container maxWidth={maxWidth}>\n            {children}\n        </Container>\n        : children;\n\n    return <Box sx={(theme) => ({\n        background: translucent ? theme.palette.mode === \"light\" ? \"rgba(255,255,255,0.6)\" : alpha(theme.palette.background.paper, 0.1) : undefined,\n        backdropFilter: translucent ? \"blur(8px)\" : undefined,\n        borderTop: `1px solid ${theme.palette.divider}`,\n        py: 1,\n        px: 2,\n        display: \"flex\",\n        flexDirection: \"row\",\n        alignItems: \"center\",\n        justifyContent: \"flex-end\",\n        position,\n        bottom: 0,\n        right: 0,\n        left: 0,\n        textAlign: \"right\",\n        zIndex: 2,\n        \"& > *:not(:last-child)\": {\n            [theme.breakpoints.down(\"md\")]: {\n                mr: theme.spacing(1)\n            },\n            mr: theme.spacing(2)\n        }\n    })}\n    >\n        {component}\n    </Box>;\n}\n","import React, { useCallback, useEffect, useLayoutEffect, useMemo, useState } from \"react\";\nimport equal from \"react-fast-compare\"\n\nimport { Box, Button, IconButton, Portal, Typography } from \"@mui/material\";\n\nimport ClearIcon from \"@mui/icons-material/Clear\";\n\nimport {\n    Entity,\n    EntityCollection,\n    EntityValues,\n    FireCMSPlugin,\n    FormContext,\n    PropertyFieldBindingProps,\n    ResolvedEntityCollection,\n    ResolvedProperties,\n    ResolvedProperty\n} from \"../../../../../types\";\nimport { Form, Formik, FormikProps } from \"formik\";\nimport { useDraggable } from \"./useDraggable\";\nimport { CustomFieldValidator, getYupEntitySchema } from \"../../../../../form/validation\";\nimport { useWindowSize } from \"./useWindowSize\";\nimport { ElementResizeListener } from \"./ElementResizeListener\";\nimport { OnCellValueChangeParams } from \"../../types\";\nimport { ErrorView } from \"../../../ErrorView\";\nimport { isReadOnly, resolveCollection } from \"../../../../util\";\nimport { CustomDialogActions } from \"../../../CustomDialogActions\";\nimport { PropertyFieldBinding } from \"../../../../../form\";\nimport { useDataSource, useFireCMSContext } from \"../../../../../hooks\";\n\ninterface PopupFormFieldProps<M extends Record<string, any>> {\n    entity?: Entity<M>;\n    customFieldValidator?: CustomFieldValidator;\n    path: string;\n    tableKey: string;\n    propertyKey?: keyof M;\n    collection?: EntityCollection<M>;\n    cellRect?: DOMRect;\n    open: boolean;\n    onClose: () => void;\n    columnIndex?: number;\n\n    /**\n     * Callback when the value of a cell has been edited\n     * @param params\n     */\n    onCellValueChange?: (params: OnCellValueChangeParams<any, M>) => Promise<void>;\n}\n\nexport function PopupFormField<M extends Record<string, any>>(props: PopupFormFieldProps<M>) {\n    if (!props.open) return null;\n    return <PopupFormFieldInternal {...props} />;\n\n}\n\nexport function PopupFormFieldInternal<M extends Record<string, any>>({\n                                                                          tableKey,\n                                                                          entity,\n                                                                          customFieldValidator,\n                                                                          propertyKey,\n                                                                          collection: inputCollection,\n                                                                          path,\n                                                                          cellRect,\n                                                                          open,\n                                                                          onClose,\n                                                                          columnIndex,\n                                                                          onCellValueChange\n                                                                      }: PopupFormFieldProps<M>) {\n\n    const dataSource = useDataSource();\n    const fireCMSContext = useFireCMSContext();\n\n    const [savingError, setSavingError] = React.useState<any>();\n    const [popupLocation, setPopupLocation] = useState<{\n        x: number,\n        y: number\n    }>();\n    const [internalValue, setInternalValue] = useState<EntityValues<M> | undefined>(entity?.values);\n\n    const collection: ResolvedEntityCollection<M> | undefined = inputCollection\n        ? resolveCollection<M>({\n            collection: inputCollection,\n            path,\n            values: internalValue,\n            entityId: entity?.id,\n            fields: fireCMSContext.fields\n        })\n        : undefined;\n\n    const windowSize = useWindowSize();\n\n    const containerRef = React.useRef<HTMLDivElement>(null);\n    const innerRef = React.useRef<HTMLDivElement>(null);\n\n    const initialPositionSet = React.useRef<boolean>(false);\n\n    useDraggable({\n        containerRef,\n        innerRef,\n        x: popupLocation?.x,\n        y: popupLocation?.y,\n        onMove: (x, y) => onMove({\n            x,\n            y\n        })\n    });\n\n    useEffect(\n        () => {\n            initialPositionSet.current = false;\n        },\n        [propertyKey, entity]\n    );\n\n    const getInitialLocation = useCallback(() => {\n        if (!cellRect) throw Error(\"getInitialLocation error\");\n\n        return {\n            x: cellRect.left < windowSize.width - cellRect.right\n                ? cellRect.x + cellRect.width / 2\n                : cellRect.x - cellRect.width / 2,\n            y: cellRect.top < windowSize.height - cellRect.bottom\n                ? cellRect.y + cellRect.height / 2\n                : cellRect.y - cellRect.height / 2\n        };\n    }, [cellRect, windowSize.height, windowSize.width]);\n\n    const normalizePosition = useCallback(({\n                                               x,\n                                               y\n                                           }: { x: number, y: number }) => {\n\n        const draggableBoundingRect = containerRef.current?.getBoundingClientRect();\n        if (!draggableBoundingRect)\n            throw Error(\"normalizePosition called before draggableBoundingRect is set\");\n\n        return {\n            x: Math.max(0, Math.min(x, windowSize.width - draggableBoundingRect.width)),\n            y: Math.max(0, Math.min(y, windowSize.height - draggableBoundingRect.height))\n        };\n    }, [windowSize]);\n\n    const updatePopupLocation = useCallback((position?: {\n        x: number,\n        y: number\n    }) => {\n\n        const draggableBoundingRect = containerRef.current?.getBoundingClientRect();\n        if (!cellRect || !draggableBoundingRect) return;\n        const newPosition = normalizePosition(position ?? getInitialLocation());\n        if (!popupLocation || newPosition.x !== popupLocation.x || newPosition.y !== popupLocation.y)\n            setPopupLocation(newPosition);\n    }, [cellRect, getInitialLocation, normalizePosition, popupLocation]);\n\n    useEffect(\n        () => {\n            initialPositionSet.current = false;\n        },\n        [propertyKey]\n    );\n\n    useLayoutEffect(\n        () => {\n            const draggableBoundingRect = containerRef.current?.getBoundingClientRect();\n            if (!cellRect || !draggableBoundingRect || initialPositionSet.current) return;\n            updatePopupLocation();\n            initialPositionSet.current = true;\n        },\n        [cellRect, updatePopupLocation, initialPositionSet.current]\n    );\n\n    useLayoutEffect(\n        () => {\n            updatePopupLocation(popupLocation);\n        },\n        [windowSize, cellRect]\n    );\n\n    const validationSchema = useMemo(() => {\n        if (!collection || !entity) return;\n        return getYupEntitySchema(\n            entity.id,\n            propertyKey && collection.properties[propertyKey as string]\n                ? { [propertyKey]: collection.properties[propertyKey as string] } as ResolvedProperties<any>\n                : {} as ResolvedProperties<any>,\n            customFieldValidator);\n    }, [path, propertyKey, collection, entity]);\n\n    const adaptResize = useCallback(() => {\n        return updatePopupLocation(popupLocation);\n    }, [popupLocation, updatePopupLocation]);\n\n    const onMove = useCallback((position: { x: number, y: number }) => {\n        return updatePopupLocation(position);\n    }, [updatePopupLocation]);\n\n    const saveValue = async (values: M) => {\n        setSavingError(null);\n        if (inputCollection && entity && onCellValueChange && propertyKey) {\n            return onCellValueChange({\n                value: values[propertyKey as string],\n                propertyKey: propertyKey as string,\n                entity,\n                setError: setSavingError,\n                onValueUpdated: () => {\n                },\n                fullPath: path,\n                collection: inputCollection,\n                dataSource,\n                context: fireCMSContext\n            });\n        }\n        return Promise.resolve();\n    };\n\n    if (!entity)\n        return <></>;\n\n    const form = entity && (\n        <Box sx={theme => ({\n            overflow: \"auto\",\n            borderRadius: `${theme.shape.borderRadius}px`,\n            backgroundColor: theme.palette.background.paper,\n            visibility: !open ? \"hidden\" : undefined,\n            cursor: \"grab\"\n        })}>\n            <Formik\n                initialValues={(entity?.values ?? {}) as EntityValues<M>}\n                validationSchema={validationSchema}\n                validateOnMount={true}\n                validate={(values) => console.debug(\"Validating\", values)}\n                onSubmit={(values, actions) => {\n                    saveValue(values)\n                        .then(() => onClose())\n                        .finally(() => actions.setSubmitting(false));\n                }}\n            >\n                {({\n                      handleChange,\n                      values,\n                      errors,\n                      touched,\n                      dirty,\n                      setFieldValue,\n                      setFieldTouched,\n                      handleSubmit,\n                      isSubmitting\n                  }: FormikProps<EntityValues<M>>) => {\n\n                    // eslint-disable-next-line react-hooks/rules-of-hooks\n                    useEffect(() => {\n                        if (!equal(values, internalValue)) {\n                            setInternalValue(values);\n                        }\n                    }, [values]);\n\n                    if (!entity)\n                        return <ErrorView\n                            error={\"PopupFormField misconfiguration\"}/>;\n\n                    if (!collection)\n                        return <></>;\n\n                    const disabled = isSubmitting;\n\n                    const formContext: FormContext<M> = {\n                        collection,\n                        entityId: entity.id,\n                        values,\n                        path,\n                        setFieldValue,\n                        save: saveValue\n                    };\n\n                    const property: ResolvedProperty<any> | undefined = propertyKey && collection.properties[propertyKey];\n\n                    const fieldProps: PropertyFieldBindingProps<any, M> | undefined = propertyKey && property\n                        ? {\n                            propertyKey: propertyKey as string,\n                            disabled: isSubmitting || isReadOnly(property) || !!property.disabled,\n                            property,\n                            includeDescription: false,\n                            underlyingValueHasChanged: false,\n                            context: formContext,\n                            tableMode: true,\n                            partOfArray: false,\n                            autoFocus: open\n                        }\n                        : undefined;\n\n                    let internalForm = <><Box\n                        key={`popup_form_${tableKey}_${entity.id}_${columnIndex}`}\n                        sx={{\n                            width: 520,\n                            maxWidth: \"100vw\",\n                            maxHeight: \"85vh\"\n                        }}>\n                        <Form\n                            onSubmit={handleSubmit}\n                            noValidate>\n\n                            <Box\n                                sx={{\n                                    mb: 1,\n                                    padding: 2,\n                                    display: \"flex\",\n                                    flexDirection: \"column\",\n                                    position: \"relative\"\n                                }}>\n                                <Box\n                                    ref={innerRef}\n                                    sx={{\n                                        cursor: \"auto !important\"\n                                    }}>\n                                    {fieldProps &&\n                                        <PropertyFieldBinding {...fieldProps}/>}\n                                </Box>\n                            </Box>\n\n                            <CustomDialogActions>\n                                <Button\n                                    variant=\"contained\"\n                                    color=\"primary\"\n                                    type=\"submit\"\n                                    disabled={disabled}\n                                >\n                                    Save\n                                </Button>\n                            </CustomDialogActions>\n\n                        </Form>\n\n                    </Box></>;\n\n                    const plugins = fireCMSContext.plugins;\n                    if (plugins) {\n                        // const formController: FormContext<M> = {\n                        //     values,\n                        //     setFieldValue\n                        // }\n                        plugins.forEach((plugin: FireCMSPlugin) => {\n                            if (plugin.form?.provider) {\n                                internalForm = (\n                                    <plugin.form.provider.Component\n                                        status={\"existing\"}\n                                        path={path}\n                                        collection={collection}\n                                        entity={entity}\n                                        context={fireCMSContext}\n                                        currentEntityId={entity.id}\n                                        formContext={formContext}\n                                        {...plugin.form.provider.props}>\n                                        {internalForm}\n                                    </plugin.form.provider.Component>\n                                );\n                            }\n                        });\n                    }\n                    return internalForm;\n                }}\n            </Formik>\n\n            {savingError &&\n                <Typography color={\"error\"}>\n                    {savingError.message}\n                </Typography>\n            }\n        </Box>\n    );\n\n    const draggable = (\n        <Box\n            key={`draggable_${propertyKey as string}_${entity.id}_${open}`}\n            sx={theme => ({\n                display: \"inline-block\",\n                // userSelect: \"none\",\n                position: \"fixed\",\n                zIndex: 1300,\n                boxShadow: \"0 0 0 2px rgba(128,128,128,0.2)\",\n                backgroundColor: theme.palette.background.paper,\n                borderRadius: `${theme.shape.borderRadius}px`,\n                visibility: !open ? \"hidden\" : undefined,\n                cursor: \"grab\"\n            })}\n            ref={containerRef}>\n\n            <ElementResizeListener onResize={adaptResize}/>\n\n            <Box\n                sx={{\n                    overflow: \"hidden\"\n                }}>\n\n                {form}\n\n                <Box sx={{\n                    position: \"absolute\",\n                    top: -14,\n                    right: -14,\n                    backgroundColor: \"#888\",\n                    borderRadius: \"32px\"\n                }}>\n                    <IconButton\n                        size={\"small\"}\n                        onClick={(event) => {\n                            event.stopPropagation();\n                            onClose();\n                        }}>\n                        <ClearIcon sx={{ color: \"white\" }}\n                                   fontSize={\"small\"}/>\n                    </IconButton>\n                </Box>\n            </Box>\n\n        </Box>\n    );\n\n    return (\n        <Portal container={document.body}>\n            {draggable}\n        </Portal>\n    );\n\n}\n","import { Box, CircularProgress, CircularProgressProps } from \"@mui/material\";\nimport React from \"react\";\n\n/**\n *\n * @param props\n * @constructor\n * @ignore\n */\nexport function CircularProgressCenter(props: CircularProgressProps) {\n    return (\n        <Box\n            sx={{\n                display: \"flex\",\n                width: \"100vw\",\n                maxHeight: \"100%\",\n                maxWidth: \"100%\",\n                height: \"100vh\",\n                \"@supports (height: 100dvh)\": {\n                    height: \"100dvh\"\n                }\n            }}>\n            <Box m=\"auto\">\n                <CircularProgress {...props}/>\n            </Box>\n        </Box>\n    );\n}\n","import React, {\n    RefObject,\n    useCallback,\n    useEffect,\n    useRef,\n    useState\n} from \"react\";\nimport equal from \"react-fast-compare\";\nimport {\n    Badge,\n    Box,\n    Button,\n    darken,\n    Divider,\n    Grid,\n    IconButton,\n    lighten,\n    Popover\n} from \"@mui/material\";\nimport ArrowUpwardIcon from \"@mui/icons-material/ArrowUpward\";\nimport ArrowDownwardIcon from \"@mui/icons-material/ArrowDownward\";\nimport ArrowDropDownCircleIcon from \"@mui/icons-material/ArrowDropDownCircle\";\n\nimport {\n    TableColumn,\n    TableSort,\n    TableWhereFilterOp\n} from \"./VirtualTableProps\";\nimport { ErrorBoundary } from \"../ErrorBoundary\";\n\ninterface FilterFormProps<T> {\n    column: TableColumn<T>;\n    onFilterUpdate: (filter?: [TableWhereFilterOp, any], newOpenFilterState?: boolean) => void;\n    filter?: [TableWhereFilterOp, any];\n    onHover: boolean,\n    createFilterField: (props: FilterFormFieldProps<T>) => React.ReactNode;\n    popupOpen: boolean;\n    setPopupOpen: (open: boolean) => void;\n    anchorEl: RefObject<HTMLDivElement>;\n}\n\nexport type FilterFormFieldProps<CustomProps> = {\n    id: React.Key,\n    filterValue: [TableWhereFilterOp, any] | undefined,\n    setFilterValue: (filterValue?: [TableWhereFilterOp, any]) => void;\n    column: TableColumn<CustomProps>;\n    popupOpen: boolean;\n    setPopupOpen: (open: boolean) => void;\n};\n\ntype VirtualTableHeaderProps<M extends Record<string, any>> = {\n    resizeHandleRef: RefObject<HTMLDivElement>;\n    columnIndex: number;\n    isResizingIndex: number;\n    column: TableColumn<any>;\n    onColumnSort: (key: Extract<keyof M, string>) => void;\n    filter?: [TableWhereFilterOp, any];\n    sort: TableSort;\n    onFilterUpdate: (column: TableColumn, filterForProperty?: [TableWhereFilterOp, any]) => void;\n    onClickResizeColumn?: (columnIndex: number, column: TableColumn) => void;\n    createFilterField?: (props: FilterFormFieldProps<any>) => React.ReactNode;\n};\n\nexport const VirtualTableHeader = React.memo<VirtualTableHeaderProps<any>>(\n    function VirtualTableHeader<M extends Record<string, any>>({\n                                                                   resizeHandleRef,\n                                                                   columnIndex,\n                                                                   isResizingIndex,\n                                                                   sort,\n                                                                   onColumnSort,\n                                                                   onFilterUpdate,\n                                                                   filter,\n                                                                   column,\n                                                                   onClickResizeColumn,\n                                                                   createFilterField\n                                                               }: VirtualTableHeaderProps<M>) {\n\n        const ref = useRef<HTMLDivElement>(null);\n\n        const [onHover, setOnHover] = useState(false);\n\n        const [openFilter, setOpenFilter] = React.useState(false);\n\n        const handleSettingsClick = useCallback((event: any) => {\n            setOpenFilter(true);\n        }, []);\n\n        const handleClose = useCallback(() => {\n            setOpenFilter(false);\n        }, []);\n\n        const update = useCallback((filterForProperty?: [TableWhereFilterOp, any], newOpenFilterState?: boolean) => {\n            onFilterUpdate(column, filterForProperty);\n            if (newOpenFilterState !== undefined)\n                setOpenFilter(newOpenFilterState);\n        }, [column, onFilterUpdate]);\n\n        const thisColumnIsResizing = isResizingIndex === columnIndex;\n        const anotherColumnIsResizing = isResizingIndex !== columnIndex && isResizingIndex > 0;\n\n        const hovered = !anotherColumnIsResizing && (onHover || thisColumnIsResizing);\n\n        return (\n            <ErrorBoundary>\n                <Grid\n                    sx={theme => ({\n                        width: column.width,\n                        // position: \"relative\",\n                        padding: \"0px 12px\",\n                        color: hovered ? theme.palette.text.primary : theme.palette.text.secondary,\n                        backgroundColor: hovered ? darken(theme.palette.background.default, 0.05) : theme.palette.background.default,\n                        transition: \"color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms\",\n                        height: \"100%\",\n                        fontSize: \"0.750rem\",\n                        textTransform: \"uppercase\",\n                        fontWeight: 600,\n                        position: column.frozen ? \"sticky\" : \"relative\",\n                        left: column.frozen ? 0 : undefined,\n                        zIndex: column.frozen ? 1 : 0,\n                        userSelect: \"none\"\n                    })}\n                    ref={ref}\n                    wrap={\"nowrap\"}\n                    alignItems={\"center\"}\n                    onMouseEnter={() => setOnHover(true)}\n                    onMouseMove={() => setOnHover(true)}\n                    onMouseLeave={() => setOnHover(false)}\n                    container>\n\n                    <Grid item xs={true} sx={{\n                        overflow: \"hidden\",\n                        flexShrink: 1\n                    }}>\n                        <Box sx={{\n                            display: \"flex\",\n                            justifyContent: column.headerAlign,\n                            alignItems: \"center\",\n                            flexDirection: \"row\"\n                        }}>\n                            <Box sx={{\n                                paddingTop: \"4px\"\n                            }}>\n                                {column.icon && column.icon(onHover || openFilter)}\n                            </Box>\n                            <Box sx={{\n                                display: \"-webkit-box\",\n                                margin: \"0px 4px\",\n                                overflow: \"hidden\",\n                                justifyContent: column.align,\n                                WebkitLineClamp: 2,\n                                WebkitBoxOrient: \"vertical\",\n                                textOverflow: \"ellipsis\"\n                            }}>\n                                {column.title}\n                            </Box>\n\n                        </Box>\n                    </Grid>\n\n                    {column.sortable && (sort || hovered || openFilter) &&\n                        <Grid item>\n                            <Badge color=\"secondary\"\n                                   variant=\"dot\"\n                                   overlap=\"circular\"\n                                   invisible={!sort}>\n                                <IconButton\n                                    size={\"small\"}\n                                    sx={(theme) => ({\n                                        backgroundColor: theme.palette.mode === \"light\" ? \"#f5f5f5\" : theme.palette.background.default\n                                    })}\n                                    onClick={() => {\n                                        onColumnSort(column.key as Extract<keyof M, string>);\n                                    }}\n                                >\n                                    {!sort &&\n                                        <ArrowUpwardIcon fontSize={\"small\"}/>}\n                                    {sort === \"asc\" &&\n                                        <ArrowUpwardIcon fontSize={\"small\"}/>}\n                                    {sort === \"desc\" &&\n                                        <ArrowDownwardIcon fontSize={\"small\"}/>}\n                                </IconButton>\n                            </Badge>\n                        </Grid>\n                    }\n\n                    {column.filter && <Grid item>\n                        <Badge color=\"secondary\"\n                               variant=\"dot\"\n                               overlap=\"circular\"\n                               invisible={!filter}>\n                            <IconButton\n                                sx={(theme) => ({\n                                    backgroundColor: theme.palette.mode === \"light\" ? \"#f5f5f5\" : theme.palette.background.default\n                                })}\n                                size={\"small\"}\n                                onClick={handleSettingsClick}>\n                                <ArrowDropDownCircleIcon fontSize={\"small\"}\n                                                         color={onHover || openFilter ? undefined : \"disabled\"}/>\n                            </IconButton>\n\n                        </Badge>\n                    </Grid>}\n\n                    {column.resizable && <Box\n                        ref={resizeHandleRef}\n                        sx={(theme) => ({\n                            position: \"absolute\",\n                            height: \"100%\",\n                            width: \"4px\",\n                            top: 0,\n                            right: 0,\n                            cursor: \"col-resize\",\n                            backgroundColor: hovered ? (theme.palette.mode === \"dark\" ? lighten(theme.palette.background.default, 0.1) : darken(theme.palette.background.default, 0.15)) : undefined\n                        })}\n                        onMouseDown={onClickResizeColumn ? () => onClickResizeColumn(columnIndex, column) : undefined}\n                    />}\n                </Grid>\n\n                {column.filter && createFilterField &&\n                    <FilterForm column={column}\n                                filter={filter}\n                                onHover={onHover}\n                                onFilterUpdate={update}\n                                createFilterField={createFilterField}\n                                popupOpen={openFilter}\n                                setPopupOpen={setOpenFilter}\n                                anchorEl={ref}/>}\n\n            </ErrorBoundary>\n        );\n    }, equal) as React.FunctionComponent<VirtualTableHeaderProps<any>>;\n\nfunction FilterForm<M>({\n                           column,\n                           onFilterUpdate,\n                           filter,\n                           onHover,\n                           createFilterField,\n                           popupOpen,\n                           setPopupOpen,\n                           anchorEl\n                       }: FilterFormProps<M>) {\n\n    const id = column.key;\n\n    const [filterInternal, setFilterInternal] = useState<[TableWhereFilterOp, any] | undefined>(filter);\n\n    useEffect(() => {\n        setFilterInternal(filter);\n    }, [filter]);\n\n    if (!column.filter) return null;\n\n    const submit = () => {\n        onFilterUpdate(filterInternal, false);\n    };\n\n    const reset = (e: any) => {\n        onFilterUpdate(undefined, false);\n    };\n\n    const filterIsSet = !!filter;\n\n    const filterField = createFilterField({\n        id,\n        filterValue: filterInternal,\n        setFilterValue: setFilterInternal,\n        column,\n        popupOpen,\n        setPopupOpen\n    });\n\n    if (!filterField) return null;\n    return (\n        <Popover\n            id={`popover_${column.key}`}\n            open={popupOpen}\n            elevation={3}\n            anchorEl={anchorEl.current}\n            onClose={() => setPopupOpen(false)}\n            anchorOrigin={{\n                vertical: \"bottom\",\n                horizontal: \"right\"\n            }}\n            transformOrigin={{\n                vertical: \"top\",\n                horizontal: \"right\"\n            }}\n        >\n            <Box sx={theme => ({\n                // backgroundColor: theme.palette.background.default\n            })}>\n                <Box sx={theme => ({\n                    p: 2,\n                    fontSize: \"0.750rem\",\n                    fontWeight: 600,\n                    textTransform: \"uppercase\"\n                })}>\n                    {column.title ?? id}\n                </Box>\n                <Divider/>\n                {filterField && <Box p={2}>\n                    {filterField}\n                </Box>}\n                <Box display=\"flex\"\n                     justifyContent=\"flex-end\"\n                     m={2}>\n                    <Box mr={1}>\n                        <Button\n                            disabled={!filterIsSet}\n                            color=\"primary\"\n                            type=\"reset\"\n                            aria-label=\"filter clear\"\n                            onClick={reset}>Clear</Button>\n                    </Box>\n                    <Button\n                        variant=\"outlined\"\n                        color=\"primary\"\n                        onClick={submit}>Filter</Button>\n                </Box>\n            </Box>\n        </Popover>\n    );\n\n}\n","import React, { createRef, useCallback, useEffect, useState } from \"react\";\n\nimport { TableColumn, TableWhereFilterOp } from \"./VirtualTableProps\";\nimport { ErrorBoundary } from \"../ErrorBoundary\";\nimport { VirtualTableHeader } from \"./VirtualTableHeader\";\nimport { VirtualTableContextProps } from \"./types\";\nimport { Box } from \"@mui/material\";\n\nexport const VirtualTableHeaderRow = ({\n                                          columns,\n                                          currentSort,\n                                          onColumnSort,\n                                          onFilterUpdate,\n                                          sortByProperty,\n                                          filter,\n                                          onColumnResize,\n                                          onColumnResizeEnd,\n                                          createFilterField\n                                      }: VirtualTableContextProps<any>) => {\n\n    const columnRefs = columns.map(() => createRef<HTMLDivElement>());\n    const [isResizing, setIsResizing] = useState(-1);\n\n    const adjustWidthColumn = useCallback((index: number, width: number, end: boolean) => {\n        const column = columns[index];\n        const minWidth = 100;\n        const maxWidth = 800;\n        const newWidth = width > maxWidth ? maxWidth : (width < minWidth ? minWidth : width);\n        const params = {\n            width: newWidth,\n            key: column.key as string,\n            column: {\n                ...column,\n                width: newWidth\n            } as TableColumn\n        };\n        if (!end)\n            onColumnResize(params);\n        else\n            onColumnResizeEnd(params);\n    }, [columns, onColumnResize, onColumnResizeEnd]);\n\n    const getEventNewWidth = useCallback((e: MouseEvent) => {\n        if (isResizing >= 0) {\n            const left = columnRefs[isResizing].current?.parentElement?.getBoundingClientRect().left;\n            if (!left) return;\n            return e.clientX - left;\n        }\n        return undefined;\n    }, [columnRefs, isResizing]);\n\n    const setCursorDocument = useCallback((isResizing: boolean) => {\n        document.body.style.cursor = isResizing ? \"col-resize\" : \"auto\";\n    }, []);\n\n    const handleOnMouseMove = useCallback((e: MouseEvent) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const newWidth = getEventNewWidth(e);\n        if (newWidth)\n            adjustWidthColumn(isResizing, newWidth, false);\n    }, [adjustWidthColumn, getEventNewWidth, isResizing]);\n\n    const handleOnMouseUp = useCallback((e: MouseEvent) => {\n        e.stopPropagation();\n        e.preventDefault();\n        const newWidth = getEventNewWidth(e);\n        if (newWidth)\n            adjustWidthColumn(isResizing, newWidth, true);\n        setIsResizing(-1);\n        setCursorDocument(false);\n    }, [adjustWidthColumn, getEventNewWidth, isResizing, setCursorDocument]);\n\n    const removeResizingListeners = useCallback(() => {\n        document.removeEventListener(\"mousemove\", handleOnMouseMove);\n        document.removeEventListener(\"mouseup\", handleOnMouseUp);\n    }, [handleOnMouseMove, handleOnMouseUp]);\n\n    const attachResizeListeners = useCallback(() => {\n        document.addEventListener(\"mousemove\", handleOnMouseMove);\n        document.addEventListener(\"mouseup\", handleOnMouseUp);\n    }, [handleOnMouseMove, handleOnMouseUp]);\n\n    useEffect(() => {\n        if (isResizing >= 0) {\n            attachResizeListeners();\n        } else {\n            removeResizingListeners();\n        }\n        return () => {\n            removeResizingListeners();\n        };\n    }, [attachResizeListeners, isResizing, removeResizingListeners]);\n\n    const onClickResizeColumn = useCallback((index: number) => {\n        setIsResizing(index);\n        setCursorDocument(true);\n    }, [setCursorDocument]);\n\n    return (\n        <Box sx={theme => ({\n            position: \"sticky\",\n            minWidth: \"100%\",\n            backgroundColor: theme.palette.background.default,\n            display: \"flex\",\n            width: \"fit-content\",\n            flexDirection: \"row\",\n            top: 0,\n            left: 0,\n            zIndex: 2,\n            height: 50,\n            borderBottom: `1px solid ${theme.palette.divider}`\n        })}>\n            {columns.map((c, columnIndex) => {\n                const column = columns[columnIndex];\n\n                const filterForThisProperty: [TableWhereFilterOp, any] | undefined =\n                    column && filter && filter[column.key]\n                        ? filter[column.key]\n                        : undefined;\n                return <ErrorBoundary key={\"header_\" + column.key}>\n                    <VirtualTableHeader\n                        resizeHandleRef={columnRefs[columnIndex]}\n                        columnIndex={columnIndex}\n                        isResizingIndex={isResizing}\n                        onFilterUpdate={onFilterUpdate}\n                        filter={filterForThisProperty}\n                        sort={sortByProperty === column.key ? currentSort : undefined}\n                        onColumnSort={onColumnSort}\n                        onClickResizeColumn={onClickResizeColumn}\n                        column={column}\n                        createFilterField={createFilterField}/>\n                </ErrorBoundary>;\n            })}\n        </Box>\n    );\n};\n","import React, { useCallback, useState } from \"react\";\n\nimport equal from \"react-fast-compare\"\n\nimport { lighten, styled } from \"@mui/material\";\n\nimport { getRowHeight } from \"./common\";\nimport { VirtualTableRowProps } from \"./types\";\nimport { OnRowClickParams, TableSize } from \"./VirtualTableProps\";\n\ntype VirtualTableRowInnerProps = {\n    size: TableSize;\n    cursor?: \"pointer\" | \"default\";\n    onRowClick?: (props: OnRowClickParams<any>) => void;\n    hovered?: boolean;\n}\n\nconst VirtualTableRowInner = styled(\"div\", {})<VirtualTableRowInnerProps>(({\n                                                                               theme,\n                                                                               size,\n                                                                               cursor,\n                                                                               hovered\n                                                                           }) => ({\n    display: \"flex\",\n    minWidth: \"100%\",\n    height: getRowHeight(size),\n    cursor,\n    flexDirection: \"row\",\n    fontSize: \"0.875rem\",\n    borderBottom: `1px solid ${theme.palette.divider}`,\n    backgroundColor: hovered\n        ? (theme.palette.mode === \"dark\"\n            ? lighten(theme.palette.background.paper, 0.01)\n            : \"rgb(252, 252, 253)\") //darken(theme.palette.background.default, 0.005))\n        : undefined\n}));\n\nexport const VirtualTableRow = React.memo<VirtualTableRowProps<any>>(\n    function VirtualTableRow<T>({\n                                    rowData,\n                                    rowIndex,\n                                    children,\n                                    onRowClick,\n                                    size,\n                                    style,\n                                    hoverRow\n                                }: VirtualTableRowProps<T>) {\n\n        const [hovered, setHovered] = useState(false);\n\n        const onClick = useCallback((event: React.SyntheticEvent) => onRowClick\n            ? onRowClick({\n                rowData,\n                rowIndex,\n                event\n            })\n            : undefined, [onRowClick, rowData, rowIndex]);\n\n        const setOnHoverTrue = useCallback(() => setHovered(true), []);\n        const setOnHoverFalse = useCallback(() => setHovered(false), []);\n\n        return (\n            <VirtualTableRowInner\n                onClick={onClick}\n                size={size}\n                cursor={onRowClick ? \"pointer\" : undefined}\n                hovered={hoverRow && hovered}\n                style={{ ...(style), width: \"fit-content\" }}\n                onMouseEnter={setOnHoverTrue}\n                onMouseMove={setOnHoverTrue}\n                onMouseLeave={setOnHoverFalse}>\n\n                {children}\n\n            </VirtualTableRowInner>\n        );\n    },\n    equal\n);\n","import React from \"react\";\n\nimport equal from \"react-fast-compare\"\n\nimport { CellRendererParams, TableColumn } from \"./VirtualTableProps\";\n\ntype VirtualTableCellProps<T extends any> = {\n    dataKey: string;\n    column: TableColumn;\n    columns: TableColumn[];\n    rowData: any;\n    cellData: any;\n    rowIndex: any;\n    columnIndex: number;\n    cellRenderer: (params: CellRendererParams<T>) => React.ReactNode;\n};\n\nexport const VirtualTableCell = React.memo<VirtualTableCellProps<any>>(\n    function VirtualTableCell<T extends any>(props: VirtualTableCellProps<T>) {\n        return props.rowData && props.cellRenderer(\n            {\n                cellData: props.cellData,\n                rowData: props.rowData,\n                rowIndex: props.rowIndex,\n                isScrolling: false,\n                column: props.column,\n                columns: props.columns,\n                columnIndex: props.columnIndex,\n                width: props.column.width\n            } as CellRendererParams<T>\n        );\n    },\n    (a, b) => {\n        return equal(a, b);\n    }\n);\n","import React, { createContext, forwardRef, RefObject, useCallback, useEffect, useRef, useState } from \"react\";\n\nimport equal from \"react-fast-compare\"\n\nimport { Box, Typography } from \"@mui/material\";\nimport AssignmentIcon from \"@mui/icons-material/Assignment\";\n\n// @ts-ignore\nimport { FixedSizeList as List } from \"react-window\";\nimport useMeasure from \"react-use-measure\";\n\nimport { CircularProgressCenter } from \"../CircularProgressCenter\";\nimport {\n    OnTableColumnResizeParams,\n    TableColumn,\n    TableFilterValues,\n    TableWhereFilterOp,\n    VirtualTableProps\n} from \"./VirtualTableProps\";\n\nimport { getRowHeight } from \"./common\";\nimport { VirtualTableContextProps } from \"./types\";\nimport { VirtualTableHeaderRow } from \"./VirtualTableHeaderRow\";\nimport { VirtualTableRow } from \"./VirtualTableRow\";\nimport { VirtualTableCell } from \"./VirtualTableCell\";\n\nconst VirtualListContext = createContext<VirtualTableContextProps<any>>({} as any);\nVirtualListContext.displayName = \"VirtualListContext\";\n\ntype InnerElementProps = { children: React.ReactNode, style: any };\n\n// eslint-disable-next-line react/display-name\nconst innerElementType = forwardRef<HTMLDivElement, InnerElementProps>(({\n                                                                            children,\n                                                                            ...rest\n                                                                        }: InnerElementProps, ref) => {\n\n        return (\n            <VirtualListContext.Consumer>\n                {(virtualTableProps) => {\n                    const customView = virtualTableProps.customView;\n                    return (\n                        <>\n                            <div\n                                id={\"virtual-table\"}\n                                style={{\n                                    position: \"relative\",\n                                    height: \"100%\"\n                                }}>\n                                <div\n                                    ref={ref}\n                                    {...rest}\n                                    style={{\n                                        ...rest?.style,\n                                        minHeight: \"100%\",\n                                        position: \"relative\"\n                                    }}>\n                                    <VirtualTableHeaderRow {...virtualTableProps}/>\n                                    {!customView && children}\n                                </div>\n                            </div>\n                            {customView && <div style={{\n                                position: \"sticky\",\n                                top: \"56px\",\n                                flexGrow: 1,\n                                height: \"calc(100% - 56px)\",\n                                marginTop: \"calc(56px - 100vh)\",\n                                left: 0\n                            }}>{customView}</div>}\n                        </>\n                    );\n                }}\n            </VirtualListContext.Consumer>\n        );\n    })\n;\n\n/**\n * This is a Table component that allows displaying arbitrary data, not\n * necessarily related to entities or properties. It is the component\n * that powers the entity collections but has a generic API, so it\n * can be reused.\n *\n * @category Components\n */\nexport const VirtualTable = React.memo<VirtualTableProps<any>>(\n    function VirtualTable<T extends Record<string, any>>({\n                                                             data,\n                                                             onResetPagination,\n                                                             onEndReached,\n                                                             size = \"m\",\n                                                             columns: columnsProp,\n                                                             onRowClick,\n                                                             onColumnResize,\n                                                             filter: filterInput,\n                                                             checkFilterCombination,\n                                                             onFilterUpdate,\n                                                             sortBy,\n                                                             error,\n                                                             emptyMessage,\n                                                             onSortByUpdate,\n                                                             loading,\n                                                             cellRenderer,\n                                                             hoverRow,\n                                                             createFilterField\n                                                         }: VirtualTableProps<T>) {\n\n        const sortByProperty: string | undefined = sortBy ? sortBy[0] : undefined;\n        const currentSort: \"asc\" | \"desc\" | undefined = sortBy ? sortBy[1] : undefined;\n\n        const [columns, setColumns] = useState(columnsProp);\n\n        const tableRef = useRef<HTMLDivElement>(null);\n        const endReachCallbackThreshold = useRef<number>(0);\n\n        useEffect(() => {\n            setColumns(columnsProp);\n        }, [columnsProp]);\n\n        const [measureRef, bounds] = useMeasure();\n\n        const onColumnResizeInternal = useCallback((params: OnTableColumnResizeParams) => {\n            setColumns(columns.map((column) => column.key === params.column.key ? params.column : column));\n        }, [columns]);\n\n        const onColumnResizeEndInternal = useCallback((params: OnTableColumnResizeParams) => {\n            setColumns(columns.map((column) => column.key === params.column.key ? params.column : column));\n            if (onColumnResize) {\n                onColumnResize(params);\n            }\n        }, [columns, onColumnResize]);\n\n        // saving the current filter as a ref as a workaround for header closure\n        const filterRef = useRef<TableFilterValues<any> | undefined>();\n\n        useEffect(() => {\n            filterRef.current = filterInput;\n        }, [filterInput]);\n\n        const scrollToTop = useCallback(() => {\n            endReachCallbackThreshold.current = 0;\n            if (tableRef.current) {\n                // scrollRef.current = [scrollRef.current[0], 0];\n                tableRef.current.scrollTo(tableRef.current?.scrollLeft, 0);\n            }\n        }, []);\n\n        const onColumnSort = useCallback((key: string) => {\n\n            const isDesc = sortByProperty === key && currentSort === \"desc\";\n            const isAsc = sortByProperty === key && currentSort === \"asc\";\n            const newSort = isAsc ? \"desc\" : (isDesc ? undefined : \"asc\");\n            const newSortProperty: string | undefined = isDesc ? undefined : key;\n\n            const filter = filterRef.current;\n\n            const newSortBy: [string, \"asc\" | \"desc\"] | undefined = newSort && newSortProperty ? [newSortProperty, newSort] : undefined;\n            if (filter) {\n                if (checkFilterCombination && !checkFilterCombination(filter, newSortBy)) {\n                    if (onFilterUpdate)\n                        onFilterUpdate(undefined);\n                }\n            }\n\n            if (onResetPagination) {\n                onResetPagination();\n            }\n\n            if (onSortByUpdate) {\n                onSortByUpdate(newSortBy);\n            }\n\n            scrollToTop();\n        }, [checkFilterCombination, currentSort, onFilterUpdate, onResetPagination, onSortByUpdate, scrollToTop, sortByProperty]);\n\n        const resetSort = useCallback(() => {\n            endReachCallbackThreshold.current = 0;\n            if (onSortByUpdate)\n                onSortByUpdate(undefined);\n        }, [onSortByUpdate]);\n\n        const maxScroll = Math.max((data?.length ?? 0) * getRowHeight(size) - bounds.height, 0);\n        const onEndReachedInternal = useCallback((scrollOffset: number) => {\n            if (onEndReached && (data?.length ?? 0) > 0 && scrollOffset > endReachCallbackThreshold.current + 500) {\n                endReachCallbackThreshold.current = scrollOffset;\n                onEndReached();\n            }\n        }, [data, onEndReached]);\n\n        const onScroll = useCallback(({\n                                          scrollOffset,\n                                          scrollUpdateWasRequested\n                                      }: {\n            scrollDirection: \"forward\" | \"backward\",\n            scrollOffset: number,\n            scrollUpdateWasRequested: boolean;\n        }) => {\n            if (!scrollUpdateWasRequested && (scrollOffset >= maxScroll - 500))\n                onEndReachedInternal(scrollOffset);\n        }, [maxScroll, onEndReachedInternal]);\n\n        const onFilterUpdateInternal = useCallback((column: TableColumn, filterForProperty?: [TableWhereFilterOp, any]) => {\n\n            endReachCallbackThreshold.current = 0;\n            const filter = filterRef.current;\n            let newFilterValue: TableFilterValues<any> = filter ? { ...filter } : {};\n\n            if (!filterForProperty) {\n                delete newFilterValue[column.key];\n            } else {\n                newFilterValue[column.key] = filterForProperty;\n            }\n            const newSortBy: [string, \"asc\" | \"desc\"] | undefined = sortByProperty && currentSort ? [sortByProperty, currentSort] : undefined;\n            const isNewFilterCombinationValid = !checkFilterCombination || checkFilterCombination(newFilterValue, newSortBy);\n            if (!isNewFilterCombinationValid) {\n                newFilterValue = filterForProperty ? { [column.key]: filterForProperty } as TableFilterValues<Extract<keyof T, string>> : {};\n            }\n\n            if (onFilterUpdate) onFilterUpdate(newFilterValue);\n\n            if (column.key !== sortByProperty) {\n                resetSort();\n            }\n        }, [checkFilterCombination, currentSort, onFilterUpdate, resetSort, sortByProperty]);\n\n        const buildErrorView = useCallback(() => (\n            <Box\n                sx={{\n                    height: \"calc(100% - 64px)\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    position: \"sticky\",\n                    left: 0\n                }}>\n\n                <Typography variant={\"h6\"}>\n                    {\"Error fetching data from the data source\"}\n                </Typography>\n\n                {error?.message && <Typography>\n                    {error?.message}\n                </Typography>}\n\n            </Box>\n        ), [error?.message]);\n\n        const buildEmptyView = useCallback(() => {\n            if (loading)\n                return <CircularProgressCenter/>;\n            return <Box sx={{\n                display: \"flex\",\n                overflow: \"auto\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                p: 2,\n                gap: 2,\n                height: \"100%\"\n            }}>\n                <AssignmentIcon/>\n                <Typography>\n                    {emptyMessage}\n                </Typography>\n            </Box>;\n        }, [emptyMessage, loading]);\n\n        const empty = !loading && (data?.length ?? 0) === 0;\n        const customView = error ? buildErrorView() : (empty ? buildEmptyView() : undefined);\n\n        return (\n            <Box\n                ref={measureRef}\n                sx={{\n                    height: \"100%\",\n                    width: \"100%\"\n                }}>\n                <VirtualListContext.Provider\n                    value={{\n                        data,\n                        size,\n                        cellRenderer,\n                        columns,\n                        currentSort,\n                        onRowClick,\n                        customView,\n                        onColumnResize: onColumnResizeInternal,\n                        onColumnResizeEnd: onColumnResizeEndInternal,\n                        filter: filterRef.current,\n                        onColumnSort,\n                        onFilterUpdate: onFilterUpdateInternal,\n                        sortByProperty,\n                        hoverRow: hoverRow ?? false,\n                        createFilterField\n                    }}>\n\n                    <MemoizedList\n                        outerRef={tableRef}\n                        key={size}\n                        width={bounds.width}\n                        height={bounds.height}\n                        itemCount={data?.length ?? 0}\n                        onScroll={onScroll}\n                        itemSize={getRowHeight(size)}/>\n\n                </VirtualListContext.Provider>\n            </Box>\n        );\n    },\n    equal\n);\n\nfunction MemoizedList({\n                          outerRef,\n                          width,\n                          height,\n                          itemCount,\n                          onScroll,\n                          itemSize\n                      }: {\n    outerRef: RefObject<HTMLDivElement>;\n    width: number;\n    height: number;\n    itemCount: number;\n    onScroll: (params: {\n        scrollDirection: \"forward\" | \"backward\",\n        scrollOffset: number,\n        scrollUpdateWasRequested: boolean;\n    }) => void;\n    itemSize: number;\n}) {\n\n    const Row = useCallback(({\n                                 index,\n                                 style\n                             }: any) => {\n        return <VirtualListContext.Consumer>\n            {({\n                  onRowClick,\n                  data,\n                  columns,\n                  size = \"m\",\n                  cellRenderer,\n                  hoverRow\n              }) => {\n                const rowData = data && data[index];\n                return (\n                    <VirtualTableRow\n                        key={`row_${index}`}\n                        rowData={rowData}\n                        rowIndex={index}\n                        onRowClick={onRowClick}\n                        columns={columns}\n                        hoverRow={hoverRow}\n                        style={{\n                            ...style,\n                            top: `calc(${style.top}px + 50px)`\n                        }}\n                        size={size}>\n                        {columns.map((column: TableColumn, columnIndex: number) => {\n                            const cellData = rowData && rowData[column.key];\n                            return <VirtualTableCell\n                                key={`cell_${column.key}`}\n                                dataKey={column.key}\n                                cellRenderer={cellRenderer}\n                                column={column}\n                                columns={columns}\n                                rowData={rowData}\n                                cellData={cellData}\n                                rowIndex={index}\n                                columnIndex={columnIndex}/>;\n                        })}\n                    </VirtualTableRow>\n                );\n\n            }}\n        </VirtualListContext.Consumer>;\n    }, []);\n\n    return <List\n        outerRef={outerRef}\n        innerElementType={innerElementType}\n        width={width}\n        height={height}\n        overscanCount={4}\n        itemCount={itemCount}\n        onScroll={onScroll}\n        itemSize={itemSize}>\n        {Row}\n    </List>;\n}\n","import { CollectionSize, Entity } from \"../../../../types\";\n\nimport React, { MouseEvent, useCallback } from \"react\";\nimport {\n    alpha,\n    Box,\n    Checkbox,\n    IconButton,\n    ListItemIcon,\n    ListItemText,\n    Menu,\n    MenuItem,\n    Skeleton,\n    Tooltip,\n    Typography,\n    useMediaQuery,\n    useTheme\n} from \"@mui/material\";\nimport { Delete, FileCopy, KeyboardTab, MoreVert } from \"@mui/icons-material\";\n\n/**\n *\n * @param entity\n * @param width\n * @param frozen\n * @param isSelected\n * @param selectionEnabled\n * @param size\n * @param toggleEntitySelection\n * @param onCopyClicked\n * @param onEditClicked\n * @param onDeleteClicked\n * @param hideId\n * @constructor\n *\n * @category Collection components\n */\nexport function EntityCollectionRowActions<M extends Record<string, any>>({\n                                                                              entity,\n                                                                              width,\n                                                                              frozen,\n                                                                              isSelected,\n                                                                              selectionEnabled,\n                                                                              size,\n                                                                              toggleEntitySelection,\n                                                                              onCopyClicked,\n                                                                              onEditClicked,\n                                                                              onDeleteClicked,\n                                                                              hideId\n                                                                          }:\n                                                                              {\n                                                                                  entity: Entity<M>,\n                                                                                  width: number,\n                                                                                  frozen?: boolean,\n                                                                                  size: CollectionSize,\n                                                                                  isSelected?: boolean,\n                                                                                  selectionEnabled?: boolean,\n                                                                                  toggleEntitySelection?: (selectedEntity: Entity<M>) => void\n                                                                                  onEditClicked?: (selectedEntity: Entity<M>) => void,\n                                                                                  onCopyClicked?: (selectedEntity: Entity<M>) => void,\n                                                                                  onDeleteClicked?: (selectedEntity: Entity<M>) => void,\n                                                                                  hideId?: boolean\n                                                                              }) {\n\n    const theme = useTheme();\n    const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n\n    const editEnabled = Boolean(onEditClicked);\n    const copyEnabled = Boolean(onCopyClicked);\n    const deleteEnabled = Boolean(onDeleteClicked);\n\n    const [anchorEl, setAnchorEl] = React.useState<any | null>(null);\n\n    const openMenu = useCallback((event: React.MouseEvent) => {\n        setAnchorEl(event.currentTarget);\n        event.stopPropagation();\n    }, [setAnchorEl]);\n\n    const closeMenu = useCallback(() => {\n        setAnchorEl(null);\n    }, [setAnchorEl]);\n\n    const onCheckboxChange = useCallback((event: React.ChangeEvent) => {\n        if (toggleEntitySelection)\n            toggleEntitySelection(entity);\n        event.preventDefault();\n        event.stopPropagation();\n    }, [entity, toggleEntitySelection]);\n\n    const onDeleteClick = useCallback((event: MouseEvent) => {\n        event.stopPropagation();\n        if (onDeleteClicked)\n            onDeleteClicked(entity);\n        setAnchorEl(null);\n    }, [entity, onDeleteClicked, setAnchorEl]);\n\n    const onCopyClick = useCallback((event: MouseEvent) => {\n        event.stopPropagation();\n        if (onCopyClicked)\n            onCopyClicked(entity);\n        setAnchorEl(null);\n    }, [entity, onCopyClicked, setAnchorEl]);\n\n    const onClick = useCallback((event: MouseEvent) => {\n        event.stopPropagation();\n        if (toggleEntitySelection)\n            toggleEntitySelection(entity);\n    }, [entity, toggleEntitySelection]);\n\n    return (\n        <Box\n            style={{\n                width\n            }}\n            onClick={onClick}\n            sx={theme => ({\n                height: \"100%\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                flexDirection: \"column\",\n                position: frozen ? \"sticky\" : \"initial\",\n                left: frozen ? 0 : \"initial\",\n                background: theme.palette.mode === \"dark\" ? alpha(theme.palette.background.default, 0.96) : alpha(theme.palette.background.default, 0.96),\n                // backdropFilter: frozen ? \"blur(8px)\" : undefined,\n                contain: \"strict\",\n                zIndex: 1\n            })}>\n\n            {(editEnabled || deleteEnabled || selectionEnabled) &&\n                <Box sx={{\n                    minWidth: 138,\n                    display: \"flex\",\n                    justifyContent: \"center\"\n                }}>\n                    {editEnabled &&\n                        <Tooltip title={`Edit ${entity.id}`}>\n                            <IconButton\n                                onClick={(event: MouseEvent) => {\n                                    event.stopPropagation();\n                                    if (onEditClicked)\n                                        onEditClicked(entity);\n                                }}\n                                size={largeLayout ? \"medium\" : \"small\"}>\n                                <KeyboardTab/>\n                            </IconButton>\n                        </Tooltip>\n                    }\n\n                    {selectionEnabled &&\n                        <Tooltip title={`Select ${entity.id}`}>\n                            <Checkbox\n                                size={largeLayout ? \"medium\" : \"small\"}\n                                checked={isSelected}\n                                onChange={onCheckboxChange}\n                            />\n                        </Tooltip>}\n\n                    {(copyEnabled || deleteEnabled) &&\n                        <IconButton onClick={openMenu}\n                                    size={largeLayout ? \"medium\" : \"small\"}>\n                            <MoreVert/>\n                        </IconButton>\n                    }\n\n                    {(copyEnabled || deleteEnabled) && <Menu\n                        anchorEl={anchorEl}\n                        open={Boolean(anchorEl)}\n                        onClose={closeMenu}\n                        elevation={3}\n                    >\n                        {deleteEnabled && <MenuItem onClick={onDeleteClick}>\n                            <ListItemIcon>\n                                <Delete/>\n                            </ListItemIcon>\n                            <ListItemText primary={\"Delete\"}/>\n                        </MenuItem>}\n\n                        {copyEnabled && <MenuItem onClick={onCopyClick}>\n                            <ListItemIcon>\n                                <FileCopy/>\n                            </ListItemIcon>\n                            <ListItemText primary=\"Copy\"/>\n                        </MenuItem>}\n\n                    </Menu>}\n\n                </Box>}\n\n            {!hideId && size !== \"xs\" && (\n                <Box sx={{\n                    width: 138,\n                    textAlign: \"center\",\n                    textOverflow: \"ellipsis\",\n                    overflow: \"hidden\"\n                }}>\n\n                    {entity\n                        ? <Typography\n                            className={\"mono\"}\n                            variant={\"caption\"}\n                            color={\"textSecondary\"}> {entity.id} </Typography>\n                        : <Skeleton variant=\"text\"/>\n                    }\n                </Box>\n            )}\n\n        </Box>\n    );\n\n}\n","import React, { useCallback, useDeferredValue, useState } from \"react\";\nimport { darken, Theme } from \"@mui/material/styles\";\nimport InputBase from \"@mui/material/InputBase\";\nimport { Box, IconButton } from \"@mui/material\";\n\nimport SearchIcon from \"@mui/icons-material/Search\";\nimport ClearIcon from \"@mui/icons-material/Clear\";\n\ninterface SearchBarProps {\n    onTextSearch: (searchString?: string) => void;\n    placeholder?: string;\n    expandable?: boolean;\n    large?: boolean;\n}\n\nexport function SearchBar({\n                              onTextSearch,\n                              placeholder = \"Search\",\n                              expandable = false,\n                              large = false\n                          }: SearchBarProps) {\n\n    const [searchText, setSearchText] = useState<string>(\"\");\n    const [active, setActive] = useState<boolean>(false);\n\n    const deferredValues = useDeferredValue(searchText);\n\n    /**\n     * Debounce on Search text update\n     */\n    React.useEffect(() => {\n        if (deferredValues) {\n            onTextSearch(deferredValues);\n        } else {\n            onTextSearch(undefined);\n        }\n    }, [deferredValues]);\n\n    const clearText = useCallback(() => {\n        setSearchText(\"\");\n        onTextSearch(undefined);\n    }, []);\n\n    return (\n        <Box sx={theme => ({\n            position: \"relative\",\n            display: \"flex\",\n            alignItems: \"center\",\n            height: large ? 56 : 40,\n            width: expandable ? undefined : \"100%\",\n            minWidth: \"200px\",\n            borderRadius: `${theme.shape.borderRadius}px`,\n            backgroundColor: theme.palette.mode === \"light\" ? darken(theme.palette.background.default, 0.05) : darken(theme.palette.background.default, 0.2),\n            \"&:hover\": {\n                backgroundColor: theme.palette.mode === \"light\" ? darken(theme.palette.background.default, 0.08) : darken(theme.palette.background.default, 0.3)\n            },\n            [theme.breakpoints.up(\"sm\")]: {\n                width: \"auto\"\n            }\n        })}>\n            <Box sx={theme => ({\n                padding: theme.spacing(0, 2),\n                height: \"100%\",\n                position: \"absolute\",\n                pointerEvents: \"none\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\"\n            })}>\n                <SearchIcon htmlColor={\"#888\"}/>\n            </Box>\n            <InputBase\n                placeholder={placeholder}\n                value={searchText}\n                onChange={(event) => {\n                    setSearchText(event.target.value);\n                }}\n                onFocus={() => setActive(true)}\n                onBlur={() => setActive(false)}\n                sx={{\n                    width: expandable ? undefined : \"100%\",\n                    color: \"inherit\",\n                    minHeight: \"inherit\"\n                }}\n                inputProps={{\n                    sx: (theme: Theme) => ({\n                        padding: theme.spacing(1, 1, 1, 0),\n                        // vertical padding + font size from searchIcon\n                        paddingLeft: `calc(1em + ${theme.spacing(4)})`,\n                        transition: theme.transitions.create(\"width\"),\n                        width: \"100%\",\n                        [theme.breakpoints.up(\"sm\")]: {\n                            width: expandable ? active ? \"20ch\" : \"12ch\" : \"100%\"\n                        }\n                    }),\n                    \"aria-label\": placeholder\n                }}\n                endAdornment={searchText\n                    ? <IconButton\n                        sx={{ mr: large ? 2 : 1 }}\n                        size={\"small\"}\n                        onClick={clearText}>\n                        <ClearIcon fontSize={\"small\"}/>\n                    </IconButton>\n                    : <div style={{ width: 26 }}/>\n                }\n            />\n        </Box>\n    );\n}\n","import { alpha, darken, styled } from \"@mui/material/styles\";\nimport Select, { SelectProps } from \"@mui/material/Select\";\nimport InputBase from \"@mui/material/InputBase\";\nimport MenuItem, { MenuItemProps } from \"@mui/material/MenuItem\";\n\nconst StyledInput = styled(InputBase)(({ theme }) => ({\n    \"label + &\": {\n        // marginTop: theme.spacing(3)\n    },\n    \"& .MuiInputBase-input\": {\n        borderRadius: 4,\n        position: \"relative\",\n        backgroundColor: theme.palette.mode === \"light\" ? alpha(theme.palette.common.black, 0.05) : darken(theme.palette.background.default, 0.2),\n        fontSize: 14,\n        fontWeight: theme.typography.fontWeightMedium,\n        padding: \"8px 26px 8px 12px\",\n        transition: theme.transitions.create([\"border-color\", \"box-shadow\"]),\n        \"&:focus\": {\n            borderRadius: 4\n        }\n    }\n}));\n\nexport function FilledSelect<T>(props: SelectProps<T>) {\n    return <Select\n        input={<StyledInput/>}\n        renderValue={(value: any) => value.toUpperCase()}\n        {...props}\n        MenuProps={{\n            MenuListProps: {\n                disablePadding: true,\n                style: {\n                    borderRadius: 4\n                }\n            },\n            elevation: 1\n        }}\n    >\n        {props.children}\n    </Select>\n}\n\nexport function FilledMenuItem(props: MenuItemProps) {\n    return <MenuItem\n        {...props}\n        sx={(theme) => ({\n            backgroundColor: theme.palette.background.default,\n            fontSize: 14,\n            fontWeight: theme.typography.fontWeightMedium,\n            paddingTop: theme.spacing(1),\n            paddingBottom: theme.spacing(1),\n            \"&:hover\": {\n                backgroundColor: darken(theme.palette.background.default, 0.1)\n            },\n            \"&:focus\": {\n                backgroundColor: darken(theme.palette.background.default, 0.2),\n                \"& .MuiListItemIcon-root, & .MuiListItemText-primary\": {\n                    color: theme.palette.text.primary\n                }\n            }\n        })}\n    >\n        {props.children}\n    </MenuItem>\n}\n","import React from \"react\";\nimport {\n    Box,\n    CircularProgress,\n    Hidden,\n    IconButton,\n    Tooltip,\n    useMediaQuery,\n    useTheme\n} from \"@mui/material\";\n\nimport { CollectionSize } from \"../../../../types\";\nimport { SearchBar } from \"./SearchBar\";\nimport FilterListOffIcon from \"@mui/icons-material/FilterListOff\";\nimport { FilledMenuItem, FilledSelect } from \"../../fields/FilledSelect\";\n\ninterface CollectionTableToolbarProps {\n    size: CollectionSize;\n    filterIsSet: boolean;\n    loading: boolean;\n    forceFilter: boolean;\n    actionsStart?: React.ReactNode;\n    actions?: React.ReactNode;\n    title?: React.ReactNode,\n    onTextSearch?: (searchString?: string) => void;\n    onSizeChanged: (size: CollectionSize) => void;\n    clearFilter: () => void;\n}\n\nexport function CollectionTableToolbar<M extends Record<string, any>>(props: CollectionTableToolbarProps) {\n\n    const theme = useTheme();\n    const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n\n    const filterView = !props.forceFilter && props.filterIsSet &&\n        <Tooltip title=\"Clear filter\">\n            <IconButton\n                sx={{ height: \"fit-content\" }}\n                aria-label=\"filter clear\"\n                onClick={props.clearFilter}\n                size=\"medium\">\n                <FilterListOffIcon/>\n            </IconButton>\n        </Tooltip>;\n\n    const sizeSelect = (\n        <FilledSelect\n            variant={\"standard\"}\n            value={props.size}\n            sx={{\n                width: 56,\n                height: 40\n            }}\n            onChange={(evt: any) => props.onSizeChanged(evt.target.value)}\n            renderValue={(value: any) => value.toUpperCase()}\n        >\n            {[\"xs\", \"s\", \"m\", \"l\", \"xl\"].map((value) => (\n                <FilledMenuItem\n                    key={`size-select-${value}`} value={value}>\n                    {value.toUpperCase()}\n                </FilledMenuItem>\n            ))}\n        </FilledSelect>\n    );\n\n    return (\n        <Box\n            sx={{\n                minHeight: 56,\n                overflowX: \"auto\",\n                [theme.breakpoints.down(\"sm\")]: {\n                    px: theme.spacing(1)\n                },\n                px: theme.spacing(2),\n                backgroundColor: theme.palette.background.default,\n                borderBottom: `1px solid ${theme.palette.divider}`,\n                display: \"flex\",\n                flexDirection: \"row\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                width: \"100%\"\n            }}\n        >\n\n            <Box display={\"flex\"}\n                 alignItems=\"center\"\n                 sx={{\n                     \"& > *\": {\n                         [theme.breakpoints.down(\"md\")]: {\n                             marginRight: `${theme.spacing(1)} !important`\n                         },\n                         marginRight: `${theme.spacing(2)} !important`\n                     }\n                 }}>\n\n                {props.title && <Hidden lgDown>\n                    {props.title}\n                </Hidden>}\n\n                {sizeSelect}\n\n                {props.actionsStart}\n\n                {filterView}\n\n            </Box>\n\n            <Box sx={{\n                display: \"flex\",\n                alignItems: \"center\",\n                \"& > *\": {\n                    [theme.breakpoints.down(\"md\")]: {\n                        marginRight: `${theme.spacing(0.5)} !important`\n                    },\n                    marginRight: `${theme.spacing(1)} !important`\n                }\n            }}>\n\n                {largeLayout && <Box width={22}>\n                    {props.loading &&\n                        <CircularProgress size={16} thickness={8}/>}\n                </Box>}\n\n                {props.onTextSearch &&\n                    <SearchBar\n                        key={\"search-bar\"}\n                        onTextSearch={props.onTextSearch}\n                        expandable={true}/>\n                }\n\n                {props.actions}\n\n            </Box>\n\n        </Box>\n    );\n}\n","import {\n    Box,\n    Button,\n    FormControl,\n    MenuItem,\n    Select as MuiSelect\n} from \"@mui/material\";\nimport React, { useMemo, useState } from \"react\";\nimport { TableWhereFilterOp } from \"../../Table\";\nimport { Entity, EntityCollection, EntityReference } from \"../../../../types\";\nimport { ReferencePreview } from \"../../../../preview\";\nimport { getReferenceFrom } from \"../../../util\";\nimport { useNavigationContext, useReferenceDialog } from \"../../../../hooks\";\n\ninterface ReferenceFilterFieldProps {\n    name: string,\n    value?: [op: TableWhereFilterOp, fieldValue: any];\n    setValue: (filterValue?: [TableWhereFilterOp, any]) => void;\n    isArray?: boolean;\n    path?: string;\n    title?: string;\n    previewProperties?: string[];\n    popupOpen: boolean;\n    setPopupOpen: (open: boolean) => void;\n}\n\nconst operationLabels = {\n    \"==\": \"==\",\n    \"!=\": \"!=\",\n    \">\": \">\",\n    \"<\": \"<\",\n    \">=\": \">=\",\n    \"<=\": \"<=\",\n    in: \"In\",\n    \"not-in\": \"Not in\",\n    \"array-contains\": \"Contains\",\n    \"array-contains-any\": \"Contains Any\"\n};\n\nconst multipleSelectOperations = [\"array-contains-any\", \"in\", \"not-in\"];\n\nexport function ReferenceFilterField({\n                                         name,\n                                         value,\n                                         setValue,\n                                         isArray,\n                                         path,\n                                         title,\n                                         previewProperties,\n                                         setPopupOpen\n                                     }: ReferenceFilterFieldProps) {\n\n    const possibleOperations: (keyof typeof operationLabels) [] = isArray\n        ? [\"array-contains\"]\n        : [\"==\", \"!=\", \">\", \"<\", \">=\", \"<=\"];\n\n    const [onHover, setOnHover] = React.useState(false);\n\n    isArray\n        ? possibleOperations.push(\"array-contains-any\")\n        : possibleOperations.push(\"in\", \"not-in\");\n\n    const [fieldOperation, fieldValue] = value || [possibleOperations[0], undefined];\n    const [operation, setOperation] = useState<TableWhereFilterOp>(fieldOperation);\n    const [internalValue, setInternalValue] = useState<EntityReference | EntityReference[] | undefined>(fieldValue);\n\n    const selectedEntityIds = internalValue\n        ? (Array.isArray(internalValue) ? internalValue.map((ref) => ref.id) : [internalValue.id])\n        : [];\n\n    function updateFilter(op: TableWhereFilterOp, val?: EntityReference | EntityReference[]) {\n\n        const prevOpIsArray = multipleSelectOperations.includes(operation);\n        const newOpIsArray = multipleSelectOperations.includes(op);\n        let newValue = val;\n        if (prevOpIsArray !== newOpIsArray) {\n            // @ts-ignore\n            newValue = newOpIsArray ? (newValue instanceof EntityReference ? [newValue] : []) : undefined\n        }\n\n        setOperation(op);\n        setInternalValue(newValue);\n\n        const hasNewValue = newValue !== null && Array.isArray(newValue)\n            ? newValue.length > 0\n            : newValue !== undefined;\n        if (op && hasNewValue) {\n            setValue(\n                [op, newValue]\n            );\n        } else {\n            setValue(\n                undefined\n            );\n        }\n    }\n\n    const navigationContext = useNavigationContext();\n    const collection: EntityCollection | undefined = useMemo(() => {\n        return path ? navigationContext.getCollection(path) : undefined;\n    }, [path]);\n\n    const onSingleEntitySelected = (entity: Entity<any>) => {\n        updateFilter(operation, getReferenceFrom(entity));\n    };\n\n    const onMultipleEntitiesSelected = (entities: Entity<any>[]) => {\n        updateFilter(operation, entities.map(e => getReferenceFrom(e)));\n    };\n\n    const multiple = multipleSelectOperations.includes(operation);\n\n    const referenceDialogController = useReferenceDialog({\n            multiselect: multiple,\n            path,\n            collection,\n            onSingleEntitySelected,\n            onMultipleEntitiesSelected,\n            selectedEntityIds,\n            onClose: () => {\n                setPopupOpen(true);\n            }\n        }\n    );\n\n    const doOpenDialog = () => {\n        setPopupOpen(false);\n        referenceDialogController.open();\n    };\n\n    const buildEntry = (reference: EntityReference) => {\n        return (\n            <Box\n                sx={{ mb: 0.5 }}\n                onMouseEnter={() => setOnHover(true)}\n                onMouseMove={() => setOnHover(true)}\n                onMouseLeave={() => setOnHover(false)}>\n                <ReferencePreview\n                    disabled={!path}\n                    previewProperties={previewProperties}\n                    size={\"regular\"}\n                    onClick={doOpenDialog}\n                    reference={reference}\n                    onHover={onHover}\n                    allowEntityNavigation={false}\n                />\n            </Box>\n        );\n    };\n\n    return (\n\n        <Box\n            display={\"flex\"}\n            width={440}\n            flexDirection={\"row\"}>\n            <Box width={120}>\n                <FormControl fullWidth>\n                    <MuiSelect value={operation}\n                               fullWidth\n                               onChange={(evt: any) => {\n                                   updateFilter(evt.target.value, internalValue);\n                               }}>\n                        {possibleOperations.map((op) =>\n                            <MenuItem\n                                key={`filter_op_${name}_${op}`}\n                                value={op}>{operationLabels[op]}</MenuItem>\n                        )}\n\n                    </MuiSelect>\n                </FormControl>\n            </Box>\n\n            <Box flexGrow={1} ml={1}>\n\n                <FormControl fullWidth\n                             sx={{ height: \"100%\" }}>\n                    {internalValue && Array.isArray(internalValue) && <Box>\n                        {internalValue.map((ref, index) => buildEntry(ref))}\n                    </Box>}\n                    {internalValue && !Array.isArray(internalValue) && <Box>\n                        {buildEntry(internalValue)}\n                    </Box>}\n                    {(!internalValue || (Array.isArray(internalValue) && internalValue.length === 0)) &&\n                        <Button onClick={doOpenDialog}\n                                sx={{ height: \"100%\" }}>\n                            {multiple ? \"Select references\" : \"Select reference\"}\n                        </Button>\n                    }\n                </FormControl>\n            </Box>\n\n        </Box>\n    );\n\n}\n","import {\n    Box,\n    FormControl,\n    IconButton,\n    MenuItem,\n    OutlinedInput,\n    Select as MuiSelect\n} from \"@mui/material\";\nimport ClearIcon from \"@mui/icons-material/Clear\";\nimport React, { useState } from \"react\";\nimport { EnumValuesChip } from \"../../../../preview\";\nimport { TableEnumValues, TableWhereFilterOp } from \"../../Table\";\n\ninterface StringNumberFilterFieldProps {\n    name: string,\n    dataType: \"string\" | \"number\";\n    value?: [op: TableWhereFilterOp, fieldValue: any];\n    setValue: (value?: [op: TableWhereFilterOp, newValue: any]) => void;\n    isArray?: boolean;\n    enumValues?: TableEnumValues;\n    title?: string;\n}\n\nconst operationLabels = {\n    \"==\": \"==\",\n    \"!=\": \"!=\",\n    \">\": \">\",\n    \"<\": \"<\",\n    \">=\": \">=\",\n    \"<=\": \"<=\",\n    in: \"In\",\n    \"not-in\": \"Not in\",\n    \"array-contains\": \"Contains\",\n    \"array-contains-any\": \"Any\"\n};\n\nconst multipleSelectOperations = [\"array-contains-any\", \"in\", \"not-in\"];\n\nexport function StringNumberFilterField({\n                                            name,\n                                            value,\n                                            setValue,\n                                            dataType,\n                                            isArray,\n                                            enumValues,\n                                            title\n                                        }: StringNumberFilterFieldProps) {\n\n    const possibleOperations: (keyof typeof operationLabels) [] = isArray\n        ? [\"array-contains\"]\n        : [\"==\", \"!=\", \">\", \"<\", \">=\", \"<=\"];\n\n    if (enumValues)\n        isArray\n            ? possibleOperations.push(\"array-contains-any\")\n            : possibleOperations.push(\"in\", \"not-in\");\n\n    const [fieldOperation, fieldValue] = value || [possibleOperations[0], undefined];\n    const [operation, setOperation] = useState<TableWhereFilterOp>(fieldOperation);\n    const [internalValue, setInternalValue] = useState<string | number | string[] | number[] | undefined>(fieldValue);\n\n    function updateFilter(op: TableWhereFilterOp, val: string | number | string[] | number[] | undefined) {\n        let newValue = val;\n        const prevOpIsArray = multipleSelectOperations.includes(operation);\n        const newOpIsArray = multipleSelectOperations.includes(op);\n        if (prevOpIsArray !== newOpIsArray) {\n            // @ts-ignore\n            newValue = newOpIsArray ? (typeof val === \"string\" || typeof val === \"number\" ? [val] : []) : \"\";\n        }\n\n        if (typeof newValue === \"number\" && isNaN(newValue))\n            newValue = undefined;\n\n        setOperation(op);\n        setInternalValue(newValue);\n\n        const hasNewValue = newValue !== null && Array.isArray(newValue)\n            ? newValue.length > 0\n            : newValue !== undefined;\n        if (op && hasNewValue) {\n            setValue(\n                [op, newValue]\n            );\n        } else {\n            setValue(\n                undefined\n            );\n        }\n    }\n\n    const multiple = multipleSelectOperations.includes(operation);\n    return (\n\n        <Box display={\"flex\"} width={440} alignItems={\"center\"}>\n            <Box width={80}>\n                <FormControl fullWidth>\n                    <MuiSelect value={operation}\n                               fullWidth\n                               onChange={(evt: any) => {\n                                   updateFilter(evt.target.value, internalValue);\n                               }}>\n                        {possibleOperations.map((op) =>\n                            <MenuItem\n                                key={`filter_op_${name}_${op}`}\n                                value={op}>{operationLabels[op]}</MenuItem>\n                        )}\n\n                    </MuiSelect>\n                </FormControl>\n            </Box>\n\n            <Box flexGrow={1} ml={1}>\n\n                <FormControl fullWidth>\n                    {!enumValues && <OutlinedInput\n                        fullWidth\n                        key={`filter_${name}`}\n                        type={dataType === \"number\" ? \"number\" : undefined}\n                        value={internalValue !== undefined ? internalValue : \"\"}\n                        onChange={(evt) => {\n                            const val = dataType === \"number\"\n                                ? parseFloat(evt.target.value)\n                                : evt.target.value;\n                            updateFilter(operation, val);\n                        }}\n                        endAdornment={internalValue && <IconButton\n                            sx={{\n                                position: \"absolute\",\n                                right: \"12px\",\n                                top: \"8px\"\n                            }}\n                            onClick={(e) => updateFilter(operation, undefined)}>\n                            <ClearIcon/>\n                        </IconButton>}\n                    />}\n\n                    {enumValues &&\n                        <MuiSelect\n                            fullWidth\n                            key={`filter-select-${multiple}-${name}`}\n                            multiple={multiple}\n                            value={internalValue !== undefined ? internalValue : isArray ? [] : \"\"}\n                            onChange={(evt: any) => updateFilter(operation, dataType === \"number\" ? parseInt(evt.target.value) : evt.target.value)}\n                            endAdornment={internalValue && <IconButton\n                                sx={{\n                                    position: \"absolute\",\n                                    right: \"12px\",\n                                    top: \"8px\"\n                                }}\n                                onClick={(e) => updateFilter(operation, undefined)}>\n                                <ClearIcon/>\n                            </IconButton>}\n                            renderValue={multiple\n                                ? (selected: any) =>\n                                    (\n                                        <div>\n                                            {selected.map((enumKey: any) => {\n                                                return <EnumValuesChip\n                                                    key={`select_value_${name}_${enumKey}`}\n                                                    enumKey={enumKey}\n                                                    enumValues={enumValues}\n                                                    small={true}/>;\n                                            })}\n                                        </div>\n                                    )\n                                : undefined}>\n                            {enumValues.map((enumConfig) => {\n                                return (\n                                    <MenuItem\n                                        key={`select_${name}_${enumConfig.id}`}\n                                        value={enumConfig.id}>\n                                        <EnumValuesChip\n                                            enumKey={enumConfig.id}\n                                            enumValues={enumValues}\n                                            small={true}/>\n                                    </MenuItem>\n                                );\n                            })}\n                        </MuiSelect>}\n                </FormControl>\n            </Box>\n\n        </Box>\n    );\n\n}\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\nimport { Checkbox, FormControlLabel, Theme } from \"@mui/material\";\nimport { TableWhereFilterOp } from \"../../Table\";\n\nconst PREFIX = \"BooleanFilterField\";\n\nconst classes = {\n    formControl: `${PREFIX}-formControl`,\n    label: `${PREFIX}-label`\n};\n\nconst Root = styled(\n    \"div\"\n)((\n    { theme }: {\n        theme: Theme\n    }\n) => ({\n    [`& .${classes.formControl}`]: {\n        width: \"200px\"\n    },\n\n    [`& .${classes.label}`]: {\n        width: \"100%\",\n        height: \"100%\"\n    }\n}));\n\ninterface BooleanFieldProps {\n    name: string,\n    value?: [op: TableWhereFilterOp, fieldValue: any];\n    setValue: (value?: [op: TableWhereFilterOp, newValue: any]) => void;\n    title?: string;\n}\n\nexport function BooleanFilterField({\n                                       name,\n                                       title,\n                                       value,\n                                       setValue\n                                   }: BooleanFieldProps) {\n\n    function updateFilter(val?: boolean) {\n        if (val !== undefined) {\n            setValue(\n                [\"==\", val]\n            );\n        } else {\n            setValue(\n                undefined\n            );\n        }\n    }\n\n    const valueSetToTrue = value && value[1];\n    const valueSet = !!value;\n\n    return (\n        <Root>\n            <FormControlLabel\n                className={classes.formControl}\n                labelPlacement={\"end\"}\n                checked={valueSet && valueSetToTrue}\n                control={\n                    <Checkbox\n                        key={`filter-${name}`}\n                        indeterminate={!valueSet}\n                        onChange={(evt) => {\n                            if (valueSetToTrue) {\n                                updateFilter(false);\n                            } else if (!valueSet) {\n                                updateFilter(true);\n                            } else {\n                                updateFilter(undefined);\n                            }\n                        }}\n                    />\n                }\n                label={!valueSet ? \"No filter\" : (valueSetToTrue ? `${title} is true` : `${title} is false`)}\n            />\n        </Root>\n    );\n}\n","import React from \"react\";\n\nimport {\n    Box,\n    IconButton,\n    TextField\n} from \"@mui/material\";\n\nimport ClearIcon from \"@mui/icons-material/Clear\";\nimport { DateTimePicker } from \"@mui/x-date-pickers/DateTimePicker\";\nimport { DatePicker } from \"@mui/x-date-pickers/DatePicker\";\n\nexport type DateTimeFieldProps = {\n    value?: Date;\n    onChange: (value: Date | null) => void;\n    mode?: \"date\" | \"date_time\";\n    clearable?: boolean;\n    small?: boolean;\n    disabled?: boolean;\n}\n\nexport function DateTimeField({\n                                  mode,\n                                  value,\n                                  onChange,\n                                  disabled,\n                                  clearable,\n                                  small\n                              }: DateTimeFieldProps) {\n\n    const PickerComponent = mode === undefined || mode === \"date_time\"\n        ? DateTimePicker\n        : DatePicker;\n\n    return <PickerComponent\n        value={value ?? null}\n        disabled={disabled}\n        renderInput={(params) =>\n            (\n                <TextField {...params}\n                           fullWidth\n                           disabled={disabled}\n                           sx={(theme) => ({\n                               height: small ? \"48px\" : \"56px\",\n                               borderRadius: `${theme.shape.borderRadius}px`\n                           })}\n                           InputProps={{\n                               ...params.InputProps,\n                               sx: theme => ({\n                                   height: small ? \"48px\" : \"56px\",\n                                   borderRadius: `${theme.shape.borderRadius}px`,\n                                   padding: small ? \"0 0px\" : undefined,\n                               }),\n                               disableUnderline: true,\n                               endAdornment: clearable\n                                   ? <Box\n                                       sx={{\n                                           pr: 2,\n                                           gap: 2\n                                       }}>\n                                       <IconButton\n                                           sx={{\n                                               position: \"absolute\",\n                                               right: \"56px\",\n                                               top: \"8px\"\n                                           }}\n                                           onClick={(e) => onChange?.(null)}>\n                                           <ClearIcon/>\n                                       </IconButton>\n                                       {params.InputProps?.endAdornment}\n                                   </Box>\n                                   : null\n                           }}\n                           variant={\"filled\"}/>\n            )}\n        onChange={onChange}\n    />;\n}\n","import React, { useState } from \"react\";\nimport { Box, FormControl, MenuItem, Select as MuiSelect } from \"@mui/material\";\nimport { TableWhereFilterOp } from \"../../Table\";\nimport { DateTimeField } from \"../../fields/DateTimeField\";\n\ninterface DateTimeFilterFieldProps {\n    name: string,\n    mode?: \"date\" | \"date_time\",\n    value?: [op: TableWhereFilterOp, fieldValue: any];\n    setValue: (value?: [op: TableWhereFilterOp, newValue: any]) => void;\n    isArray?: boolean;\n    title?: string;\n}\n\nconst operationLabels = {\n    \"==\": \"==\",\n    \"!=\": \"!=\",\n    \">\": \">\",\n    \"<\": \"<\",\n    \">=\": \">=\",\n    \"<=\": \"<=\",\n    in: \"in\",\n    \"array-contains\": \"Contains\",\n    \"array-contains-any\": \"Any\"\n};\n\nconst multipleSelectOperations = [\"array-contains-any\", \"in\"];\n\nexport function DateTimeFilterField({\n                                        name,\n                                        isArray,\n                                        mode,\n                                        value,\n                                        setValue,\n                                        title\n                                    }: DateTimeFilterFieldProps) {\n\n    const possibleOperations: (keyof typeof operationLabels) [] = isArray\n        ? [\"array-contains\"]\n        : [\"==\", \"!=\", \">\", \"<\", \">=\", \"<=\"];\n\n    const [fieldOperation, fieldValue] = value || [possibleOperations[0], undefined];\n    const [operation, setOperation] = useState<TableWhereFilterOp>(fieldOperation);\n    const [internalValue, setInternalValue] = useState<Date | undefined>(fieldValue);\n\n    function updateFilter(op: TableWhereFilterOp, val: Date | undefined) {\n        let newValue: Date | undefined = val;\n        const prevOpIsArray = multipleSelectOperations.includes(operation);\n        const newOpIsArray = multipleSelectOperations.includes(op);\n        if (prevOpIsArray !== newOpIsArray) {\n            // @ts-ignore\n            newValue = newOpIsArray ? (val ? [val] : []) : \"\";\n        }\n\n        setOperation(op);\n        setInternalValue(newValue === null ? undefined : newValue);\n\n        const hasNewValue = newValue !== null && Array.isArray(newValue)\n            ? newValue.length > 0\n            : newValue !== undefined;\n        if (op && hasNewValue) {\n            setValue(\n                [op, newValue]\n            );\n        } else {\n            setValue(\n                undefined\n            );\n        }\n    }\n\n    return (\n\n        <Box display={\"flex\"} width={440} alignItems={\"center\"}>\n            <Box width={80}>\n                <FormControl fullWidth>\n                    <MuiSelect value={operation}\n                               fullWidth\n                               onChange={(evt: any) => {\n                                   updateFilter(evt.target.value, internalValue);\n                               }}>\n                        {possibleOperations.map((op) =>\n                            <MenuItem\n                                key={`filter_op_${name}_${op}`}\n                                value={op}>{operationLabels[op]}</MenuItem>\n                        )}\n\n                    </MuiSelect>\n                </FormControl>\n            </Box>\n\n            <Box flexGrow={1} ml={1}>\n\n                <DateTimeField\n                    mode={mode}\n                    value={internalValue}\n                    onChange={(dateValue: Date | null) => {\n                        updateFilter(operation, dateValue === null ? undefined : dateValue);\n                    }}\n                    clearable={true}\n                />\n\n            </Box>\n\n        </Box>\n    );\n\n}\n","import React, { useCallback, useContext, useEffect, useMemo } from \"react\";\nimport { Box, Button, useMediaQuery, useTheme } from \"@mui/material\";\nimport equal from \"react-fast-compare\";\nimport {\n    getCellAlignment,\n    getPropertyColumnWidth,\n    getSubcollectionColumnId\n} from \"./internal/common\";\nimport {\n    AdditionalFieldDelegate,\n    CollectionSize,\n    Entity,\n    EntityCollection,\n    FilterValues,\n    FireCMSContext,\n    PropertyOrBuilder,\n    ResolvedEntityCollection,\n    ResolvedProperty,\n    SaveEntityProps,\n    User\n} from \"../../../types\";\nimport { ReferencePreview, renderSkeletonText } from \"../../../preview\";\nimport { CustomFieldValidator } from \"../../../form/validation\";\nimport { PropertyTableCell } from \"./internal/PropertyTableCell\";\nimport { ErrorBoundary } from \"../ErrorBoundary\";\nimport {\n    saveEntityWithCallbacks,\n    useDataSource,\n    useFireCMSContext,\n    useNavigationContext,\n    useSideEntityController\n} from \"../../../hooks\";\nimport { PopupFormField } from \"./internal/popup_field/PopupFormField\";\nimport { CellRendererParams, TableColumn, VirtualTable } from \"../Table\";\nimport {\n    getIconForProperty,\n    getPropertyInPath,\n    getResolvedPropertyInPath,\n    getValueInPath,\n    resolveCollection,\n    resolveEnumValues,\n    resolveProperty\n} from \"../../util\";\nimport { getRowHeight } from \"../Table/common\";\nimport {\n    EntityCollectionRowActions\n} from \"./internal/EntityCollectionRowActions\";\nimport {\n    EntityCollectionTableController,\n    OnCellValueChange,\n    SelectedCellProps,\n    UniqueFieldValidator\n} from \"./types\";\nimport KeyboardTabIcon from \"@mui/icons-material/KeyboardTab\";\nimport { setIn } from \"formik\";\nimport { CollectionTableToolbar } from \"./internal/CollectionTableToolbar\";\nimport { EntityCollectionTableProps } from \"./EntityCollectionTableProps\";\nimport { TableCell } from \"./internal/TableCell\";\nimport { FilterFormFieldProps } from \"../Table/VirtualTableHeader\";\nimport { ReferenceFilterField } from \"./filters/ReferenceFilterField\";\nimport { StringNumberFilterField } from \"./filters/StringNumberFilterField\";\nimport { BooleanFilterField } from \"./filters/BooleanFilterField\";\nimport { DateTimeFilterField } from \"./filters/DateTimeFilterField\";\n\nconst DEFAULT_STATE = {} as any;\n\nexport const EntityCollectionTableContext = React.createContext<EntityCollectionTableController<any>>(DEFAULT_STATE);\n\nexport const useEntityCollectionTableController = () => useContext<EntityCollectionTableController<any>>(EntityCollectionTableContext);\n\nconst COLLECTION_GROUP_PARENT_ID = \"collectionGroupParent\";\n\n/**\n * This component is in charge of rendering a collection table with a high\n * degree of customization. It is in charge of fetching data from\n * the {@link DataSource} and holding the state of filtering and sorting.\n *\n * This component is used internally by {@link EntityCollectionView} and\n * {@link useReferenceDialog}\n *\n * Please note that you only need to use this component if you are building\n * a custom view. If you just need to create a default view you can do it\n * exclusively with config options.\n *\n * If you want to bind a {@link EntityCollection} to a table with the default\n * options you see in collections in the top level navigation, you can\n * check {@link EntityCollectionView}\n *\n * If you need a table that is not bound to the datasource or entities and\n * properties at all, you can check {@link VirtualTable}\n *\n * @see EntityCollectionTableProps\n * @see EntityCollectionView\n * @see VirtualTable\n * @category Components\n */\nexport const EntityCollectionTable = React.memo<EntityCollectionTableProps<any>>(\n    function EntityCollectionTable<M extends Record<string, any>, AdditionalKey extends string, UserType extends User>\n    ({\n         fullPath,\n         initialFilter,\n         initialSort,\n         filterCombinations,\n         forceFilter,\n         actionsStart,\n         actions,\n         title,\n         tableRowActionsBuilder,\n         selectionController,\n         highlightedEntities,\n         onEntityClick,\n         onColumnResize,\n         onSizeChanged,\n         textSearchEnabled = false,\n         hoverRow = true,\n         inlineEditing = false,\n         tableController:\n             {\n                 data,\n                 dataLoading,\n                 noMoreToLoad,\n                 dataLoadingError,\n                 filterValues,\n                 setFilterValues,\n                 sortBy,\n                 setSortBy,\n                 searchString,\n                 setSearchString,\n                 clearFilter,\n                 itemCount,\n                 setItemCount,\n                 pageSize,\n                 paginationEnabled,\n                 checkFilterCombination\n             },\n         ...collection\n     }: EntityCollectionTableProps<M>) {\n\n        const navigation = useNavigationContext();\n\n        const theme = useTheme();\n        const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n        const disabledFilterChange = Boolean(forceFilter);\n        const selectedEntities = selectionController?.selectedEntities?.length > 0 ? selectionController?.selectedEntities : highlightedEntities;\n\n        const tableKey = React.useRef<string>(Math.random().toString(36));\n\n        const context: FireCMSContext<UserType> = useFireCMSContext();\n\n        const dataSource = useDataSource();\n        const sideEntityController = useSideEntityController();\n\n        const resolvedCollection = useMemo(() => resolveCollection<M>({\n            collection,\n            path: fullPath,\n            fields: context.fields\n        }), [collection, fullPath]);\n\n        const [size, setSize] = React.useState<CollectionSize>(resolvedCollection.defaultSize ?? \"m\");\n\n        const [selectedCell, setSelectedCell] = React.useState<SelectedCellProps<M> | undefined>(undefined);\n        const [popupCell, setPopupCell] = React.useState<SelectedCellProps<M> | undefined>(undefined);\n        const [focused, setFocused] = React.useState<boolean>(false);\n\n        const selectedEntityIds = selectedEntities?.map(e => e.id);\n\n        const filterIsSet = !!filterValues && Object.keys(filterValues).length > 0;\n\n        const additionalFields = useMemo(() => {\n            const subcollectionColumns: AdditionalFieldDelegate<M, any, any>[] = collection.subcollections?.map((subcollection) => {\n                return {\n                    id: getSubcollectionColumnId(subcollection),\n                    name: subcollection.name,\n                    width: 200,\n                    dependencies: [],\n                    Builder: ({ entity }) => (\n                        <Button color={\"primary\"}\n                                variant={\"outlined\"}\n                                startIcon={<KeyboardTabIcon\n                                    fontSize={\"small\"}/>}\n                                onClick={(event) => {\n                                    event.stopPropagation();\n                                    sideEntityController.open({\n                                        path: fullPath,\n                                        entityId: entity.id,\n                                        selectedSubPath: subcollection.alias ?? subcollection.path,\n                                        collection,\n                                        updateUrl: true\n                                    });\n                                }}>\n                            {subcollection.name}\n                        </Button>\n                    )\n                };\n            }) ?? [];\n\n            const collectionGroupParentCollections: AdditionalFieldDelegate<M, any, any>[] = collection.collectionGroup\n                ? [{\n                    id: COLLECTION_GROUP_PARENT_ID,\n                    name: \"Parent entities\",\n                    width: 260,\n                    dependencies: [],\n                    Builder: ({ entity }) => {\n                        const collectionsWithPath = navigation.getParentReferencesFromPath(entity.path);\n                        return (\n                            <>\n                                {collectionsWithPath.map((reference) => {\n                                    return (\n                                        <ReferencePreview\n                                            key={reference.path + \"/\" + reference.id}\n                                            reference={reference}\n                                            size={\"tiny\"}/>\n                                    );\n                                })}\n                            </>\n                        );\n                    }\n                }]\n                : [];\n\n            return [\n                ...(collection.additionalFields ?? collection.additionalColumns ?? []),\n                ...subcollectionColumns,\n                ...collectionGroupParentCollections\n            ];\n        }, [collection, fullPath]);\n\n        const uniqueFieldValidator: UniqueFieldValidator = useCallback(\n            ({\n                 name,\n                 value,\n                 property,\n                 entityId\n             }) => dataSource.checkUniqueField(fullPath, name, value, property, entityId),\n            [fullPath]);\n\n        const loadNextPage = () => {\n            if (!paginationEnabled || dataLoading || noMoreToLoad)\n                return;\n            if (itemCount !== undefined)\n                setItemCount(itemCount + pageSize);\n        };\n\n        const resetPagination = useCallback(() => {\n            setItemCount(pageSize);\n        }, [pageSize]);\n\n        const onRowClick = useCallback(({ rowData }: {\n            rowData: Entity<M>\n        }) => {\n            if (inlineEditing)\n                return;\n            return onEntityClick && onEntityClick(rowData);\n        }, [onEntityClick, inlineEditing]);\n\n        const updateSize = useCallback((size: CollectionSize) => {\n            if (onSizeChanged)\n                onSizeChanged(size);\n            setSize(size);\n        }, []);\n\n        const onTextSearch = useCallback((newSearchString?: string) => setSearchString(newSearchString), []);\n\n        const additionalFieldsMap: Record<string, AdditionalFieldDelegate<M, string, UserType>> = useMemo(() => {\n            return (additionalFields\n                ? additionalFields\n                    .map((aC) => ({ [aC.id]: aC }))\n                    .reduce((a, b) => ({ ...a, ...b }), {})\n                : {}) as Record<string, AdditionalFieldDelegate<M, string, UserType>>;\n        }, [additionalFields]);\n\n        // on ESC key press\n        useEffect(() => {\n            const escFunction = (event: any) => {\n                if (event.keyCode === 27) {\n                    unselect();\n                }\n            };\n            document.addEventListener(\"keydown\", escFunction, false);\n            return () => {\n                document.removeEventListener(\"keydown\", escFunction, false);\n            };\n        });\n\n        const select = useCallback((cell?: SelectedCellProps<M>) => {\n            setSelectedCell(cell);\n            setFocused(true);\n        }, []);\n\n        const unselect = useCallback(() => {\n            setSelectedCell(undefined);\n            setFocused(false);\n        }, []);\n\n        const onPopupClose = useCallback(() => {\n            setPopupCell(undefined);\n            setFocused(true);\n        }, []);\n\n        const displayedColumnIds = useColumnIds<M>(resolvedCollection, true);\n\n        const customFieldValidator: CustomFieldValidator | undefined = uniqueFieldValidator;\n\n        const propertyCellRenderer = useCallback(({\n                                                      column,\n                                                      columnIndex,\n                                                      rowData,\n                                                      rowIndex\n                                                  }: CellRendererParams<any>) => {\n\n            const entity: Entity<M> = rowData;\n\n            const propertyKey = column.key;\n\n            const propertyOrBuilder: PropertyOrBuilder<any, M> | undefined = getPropertyInPath<M>(collection.properties, propertyKey);\n            if (!propertyOrBuilder) {\n                return null;\n            }\n            const property = resolveProperty({\n                propertyKey,\n                propertyOrBuilder,\n                path: fullPath,\n                propertyValue: entity.values ? getValueInPath(entity.values, propertyKey) : undefined,\n                values: entity.values,\n                entityId: entity.id,\n                fields: context.fields\n            });\n\n            if (!property) {\n                return null;\n            }\n\n            return (\n                <ErrorBoundary>\n                    {entity\n                        ? <PropertyTableCell\n                            key={`property_table_cell_${entity.id}_${propertyKey}`}\n                            readonly={!inlineEditing}\n                            align={column.align ?? \"left\"}\n                            propertyKey={propertyKey as string}\n                            property={property}\n                            setFocused={setFocused}\n                            value={entity?.values ? getValueInPath(entity.values, propertyKey) : undefined}\n                            collection={collection}\n                            customFieldValidator={customFieldValidator}\n                            columnIndex={columnIndex}\n                            width={column.width}\n                            height={getRowHeight(size)}\n                            entity={entity}\n                            path={entity.path}/>\n                        : renderSkeletonText()\n                    }\n                </ErrorBoundary>);\n\n        }, [collection, customFieldValidator, fullPath, inlineEditing, size, selectedEntityIds]);\n\n        const additionalCellRenderer = useCallback(({\n                                                        column,\n                                                        rowData,\n                                                        width\n                                                    }: CellRendererParams<any>) => {\n\n            const entity: Entity<M> = rowData;\n\n            const additionalField = additionalFieldsMap[column.key as AdditionalKey];\n            const value = additionalField.dependencies\n                ? Object.entries(entity.values)\n                    .filter(([key, value]) => additionalField.dependencies!.includes(key as Extract<keyof M, string>))\n                    .reduce((a, b) => ({ ...a, ...b }), {})\n                : entity;\n\n            if (additionalField.builder) {\n                console.warn(\"`additionalField.builder` is deprecated. Use `additionalField.Builder` instead.\");\n            }\n\n            const Builder = additionalField.builder ?? additionalField.Builder;\n            if (!Builder) {\n                throw new Error(\"No builder provided for additional field\");\n            }\n\n            return (\n                <TableCell\n                    key={`additional_table_cell_${entity.id}_${column.key}`}\n                    width={width}\n                    size={size}\n                    focused={focused}\n                    value={value}\n                    selected={false}\n                    selectedRow={selectedEntityIds?.includes(entity.id) ?? false}\n                    disabled={true}\n                    align={\"left\"}\n                    allowScroll={false}\n                    showExpandIcon={false}\n                    disabledTooltip={\"This column can't be edited directly\"}\n                >\n                    <ErrorBoundary>\n                        <Builder entity={entity}\n                                 context={context}/>\n                    </ErrorBoundary>\n                </TableCell>\n            );\n\n        }, [additionalFieldsMap, size, selectedEntityIds]);\n\n        const allColumns: TableColumn[] = useMemo(() => {\n                const columnsResult: TableColumn[] = Object.entries<ResolvedProperty>(resolvedCollection.properties)\n                    .flatMap(([key, property]) => {\n                        if (property.dataType === \"map\" && property.spreadChildren && property.properties) {\n                            return Object.keys(property.properties).map(childKey => `${key}.${childKey}`);\n                        }\n                        return [key];\n                    })\n                    .map((key) => {\n                        const property = getResolvedPropertyInPath(resolvedCollection.properties, key);\n                        if (!property)\n                            throw Error(\"Internal error: no property found in path \" + key);\n                        const filterable = filterableProperty(property);\n                        return ({\n                            key: key as string,\n                            align: getCellAlignment(property),\n                            icon: (hoverOrOpen) => getIconForProperty(property, hoverOrOpen ? undefined : \"disabled\", \"small\"),\n                            title: property.name ?? key as string,\n                            sortable: forceFilter ? Object.keys(forceFilter).includes(key) : true,\n                            filter: !disabledFilterChange && filterable,\n                            width: getPropertyColumnWidth(property),\n                            resizable: true,\n                            custom: property\n                        });\n                    });\n\n                const additionalTableColumns: TableColumn[] = additionalFields\n                    ? additionalFields.map((additionalField) =>\n                        ({\n                            key: additionalField.id,\n                            type: \"additional\",\n                            align: \"left\",\n                            sortable: false,\n                            title: additionalField.name,\n                            width: additionalField.width ?? 200\n                        }))\n                    : [];\n                return [...columnsResult, ...additionalTableColumns];\n            },\n            [additionalFields, disabledFilterChange, forceFilter, resolvedCollection.properties]);\n\n        const idColumn: TableColumn = useMemo(() => ({\n            key: \"id_ewcfedcswdf3\",\n            width: largeLayout ? 160 : 130,\n            title: \"ID\",\n            resizable: false,\n            frozen: largeLayout,\n            headerAlign: \"center\"\n        }), [largeLayout])\n\n        const columns: TableColumn[] = useMemo(() => [\n            idColumn,\n            ...displayedColumnIds\n                .map((p) => {\n                    return allColumns.find(c => c.key === p);\n                }).filter(c => !!c) as TableColumn[]\n        ], [allColumns, displayedColumnIds, idColumn]);\n\n        const cellRenderer = useCallback((props: CellRendererParams<any>) => {\n            const column = props.column;\n            const columns = props.columns;\n            const columnKey = column.key;\n            if (props.columnIndex === 0) {\n                if (tableRowActionsBuilder)\n                    return tableRowActionsBuilder({\n                        entity: props.rowData,\n                        size,\n                        width: column.width,\n                        frozen: column.frozen\n                    });\n                else\n                    return <EntityCollectionRowActions entity={props.rowData}\n                                                       width={column.width}\n                                                       frozen={column.frozen}\n                                                       size={size}/>;\n            } else if (additionalFieldsMap[columnKey]) {\n                return additionalCellRenderer(props);\n            } else if (props.columnIndex < columns.length + 1) {\n                return propertyCellRenderer(props);\n            } else {\n                throw Error(\"Internal: columns not mapped properly\");\n            }\n        }, [additionalFieldsMap, tableRowActionsBuilder, size, additionalCellRenderer, propertyCellRenderer])\n\n        const onFilterUpdate = useCallback((updatedFilterValues?: FilterValues<any>) => {\n            setFilterValues({ ...updatedFilterValues, ...forceFilter } as FilterValues<any>);\n        }, [forceFilter]);\n\n        return (\n\n            <EntityCollectionTableContext.Provider\n                value={{\n                    setPopupCell,\n                    select,\n                    onValueChange,\n                    size,\n                    selectedCell,\n                    selectedEntityIds,\n                    focused,\n                    setFocused\n                }}\n            >\n\n                <Box sx={(theme) => ({\n                    height: \"100%\",\n                    width: \"100%\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    backgroundColor: theme.palette.background.paper\n                })}>\n\n                    <CollectionTableToolbar\n                        forceFilter={disabledFilterChange}\n                        filterIsSet={filterIsSet}\n                        onTextSearch={textSearchEnabled ? onTextSearch : undefined}\n                        clearFilter={clearFilter}\n                        size={size}\n                        onSizeChanged={updateSize}\n                        title={title}\n                        actionsStart={actionsStart}\n                        actions={actions}\n                        loading={dataLoading}/>\n\n                    <Box sx={{ flexGrow: 1 }}>\n                        <VirtualTable\n                            data={data}\n                            columns={columns}\n                            cellRenderer={cellRenderer}\n                            onRowClick={inlineEditing ? undefined : onRowClick}\n                            onEndReached={loadNextPage}\n                            onResetPagination={resetPagination}\n                            error={dataLoadingError}\n                            paginationEnabled={paginationEnabled}\n                            onColumnResize={onColumnResize}\n                            size={size}\n                            loading={dataLoading}\n                            filter={filterValues}\n                            onFilterUpdate={onFilterUpdate}\n                            sortBy={sortBy}\n                            onSortByUpdate={setSortBy as ((sortBy?: [string, \"asc\" | \"desc\"]) => void)}\n                            hoverRow={hoverRow}\n                            checkFilterCombination={checkFilterCombination}\n                            createFilterField={createFilterField}\n                        />\n                    </Box>\n\n                    <PopupFormField\n                        key={`popup_form_${popupCell?.columnIndex}_${popupCell?.entity?.id}`}\n                        open={Boolean(popupCell)}\n                        onClose={onPopupClose}\n                        cellRect={popupCell?.cellRect}\n                        columnIndex={popupCell?.columnIndex}\n                        propertyKey={popupCell?.propertyKey}\n                        collection={popupCell?.collection}\n                        entity={popupCell?.entity}\n                        tableKey={tableKey.current}\n                        customFieldValidator={customFieldValidator}\n                        path={fullPath}\n                        onCellValueChange={onValueChange}\n                    />\n\n                </Box>\n            </EntityCollectionTableContext.Provider>\n        );\n\n    },\n    equal\n);\n\nconst onValueChange: OnCellValueChange<any, any> = ({\n                                                        fullPath,\n                                                        collection,\n                                                        dataSource,\n                                                        context,\n                                                        value,\n                                                        propertyKey,\n                                                        onValueUpdated,\n                                                        setError,\n                                                        entity\n                                                    }) => {\n\n    const updatedValues = setIn({ ...entity.values }, propertyKey, value);\n\n    const saveProps: SaveEntityProps = {\n        path: fullPath,\n        entityId: entity.id,\n        values: updatedValues,\n        previousValues: entity.values,\n        collection,\n        status: \"existing\"\n    };\n\n    return saveEntityWithCallbacks({\n        ...saveProps,\n        callbacks: collection.callbacks,\n        dataSource,\n        context,\n        onSaveSuccess: () => onValueUpdated(),\n        onSaveFailure: (e: Error) => {\n            console.error(\"Save failure\");\n            console.error(e);\n            setError(e);\n        }\n    });\n\n};\n\nfunction getDefaultColumnKeys<M extends Record<string, any> = any>(collection: ResolvedEntityCollection<M>, includeSubcollections: boolean) {\n    const propertyKeys = Object.keys(collection.properties);\n\n    if (collection.additionalColumns) {\n        console.warn(\"`additionalColumns` is deprecated and will be removed in previous versions. Use `additionalFields` instead, with the same structure.\");\n    }\n\n    const additionalFields = collection.additionalFields ?? collection.additionalColumns ?? [];\n    const subCollections: EntityCollection[] = collection.subcollections ?? [];\n\n    const columnIds: string[] = [\n        ...propertyKeys,\n        ...additionalFields.map((field) => field.id)\n    ];\n\n    if (includeSubcollections) {\n        const subCollectionIds = subCollections\n            .map((collection) => getSubcollectionColumnId(collection));\n        columnIds.push(...subCollectionIds.filter((subColId) => !columnIds.includes(subColId)));\n    }\n\n    if (collection.collectionGroup) {\n        columnIds.push(COLLECTION_GROUP_PARENT_ID);\n    }\n\n    return hideAndExpandKeys(collection, columnIds);\n}\n\nfunction useColumnIds<M extends Record<string, any>>(collection: ResolvedEntityCollection<M>, includeSubcollections: boolean): string[] {\n    return useMemo(() => {\n        if (collection.propertiesOrder)\n            return hideAndExpandKeys(collection, collection.propertiesOrder);\n        return getDefaultColumnKeys(collection, includeSubcollections);\n\n    }, [collection, includeSubcollections]);\n}\n\nfunction hideAndExpandKeys<M extends Record<string, any>>(collection: ResolvedEntityCollection<M>, keys: string[]): string[] {\n\n    return keys.flatMap((key) => {\n        const property = collection.properties[key];\n        if (property) {\n            if (property.hideFromCollection)\n                return [null];\n            if (property.disabled && typeof property.disabled === \"object\" && property.disabled.hidden)\n                return [null];\n            if (property.dataType === \"map\" && property.spreadChildren && property.properties) {\n                return Object.keys(property.properties).map(childKey => `${key}.${childKey}`);\n            }\n            return [key];\n        }\n\n        const additionalField = collection.additionalFields?.find(field => field.id === key);\n        if (additionalField) {\n            return [key];\n        }\n\n        if (collection.collectionGroup && key === COLLECTION_GROUP_PARENT_ID) {\n            return [key];\n        }\n\n        return [null];\n    }).filter((key) => key !== null) as string[];\n}\n\nfunction createFilterField({\n                               id,\n                               filterValue,\n                               setFilterValue,\n                               column,\n                               popupOpen,\n                               setPopupOpen\n                           }: FilterFormFieldProps<ResolvedProperty>): React.ReactNode {\n    const property: ResolvedProperty | undefined = column.custom;\n    if (!property) {\n        return null;\n    }\n    const isArray = property?.dataType === \"array\";\n    const baseProperty: ResolvedProperty = isArray ? property.of : property;\n    if (!baseProperty) {\n        return null;\n    }\n    if (baseProperty.dataType === \"reference\") {\n        return <ReferenceFilterField value={filterValue}\n                                     setValue={setFilterValue}\n                                     name={id as string}\n                                     isArray={isArray}\n                                     path={baseProperty.path}\n                                     title={property?.name}\n                                     previewProperties={baseProperty?.previewProperties}\n                                     popupOpen={popupOpen}\n                                     setPopupOpen={setPopupOpen}/>;\n    } else if (baseProperty.dataType === \"number\" || baseProperty.dataType === \"string\") {\n        const name = baseProperty.name;\n        const enumValues = baseProperty.enumValues ? resolveEnumValues(baseProperty.enumValues) : undefined;\n        return <StringNumberFilterField value={filterValue}\n                                        setValue={setFilterValue}\n                                        name={id as string}\n                                        dataType={baseProperty.dataType}\n                                        isArray={isArray}\n                                        enumValues={enumValues}\n                                        title={name}/>;\n    } else if (baseProperty.dataType === \"boolean\") {\n        const name = baseProperty.name;\n        return <BooleanFilterField value={filterValue}\n                                   setValue={setFilterValue}\n                                   name={id as string}\n                                   title={name}/>;\n\n    } else if (baseProperty.dataType === \"date\") {\n        const title = baseProperty.name;\n        return <DateTimeFilterField value={filterValue}\n                                    setValue={setFilterValue}\n                                    name={id as string}\n                                    mode={baseProperty.mode}\n                                    isArray={isArray}\n                                    title={title}/>;\n    }\n\n    return (\n        <div>{`Currently the field ${property.dataType} is not supported`}</div>\n    );\n}\n\nfunction filterableProperty(property: ResolvedProperty, partOfArray = false): boolean {\n    if (partOfArray) {\n        return [\"string\", \"number\", \"date\", \"reference\"].includes(property.dataType);\n    }\n    if (property.dataType === \"array\") {\n        if (property.of)\n            return filterableProperty(property.of, true);\n        else\n            return false;\n    }\n    return [\"string\", \"number\", \"boolean\", \"date\", \"reference\", \"array\"].includes(property.dataType);\n}\n","import React from \"react\";\nimport { Backdrop, Modal, Paper, Slide, useTheme } from \"@mui/material\";\n\nexport interface SideDialogDrawerProps {\n\n    /**\n     * The contents of the drawer.\n     */\n    children: React.ReactNode,\n\n    /**\n     * Callback fired when the component requests to be closed.\n     */\n    onClose?: (force: boolean) => void,\n\n    /**\n     * If `true`, the drawer is open.\n     */\n    open: boolean,\n\n    /**\n     * The offset position of this view determines if it needs to be translated\n     * when nested\n     */\n    offsetPosition: number;\n\n}\n\nconst defaultTransitionDuration = {\n    enter: 225,\n    exit: 175\n};\n\n/**\n * The props of the [Modal](/api/modal/) component are available\n * when `variant=\"temporary\"` is set.\n */\nexport const SideDialogDrawer = React.forwardRef<HTMLDivElement, SideDialogDrawerProps>(function EntityDrawer(props, ref) {\n\n    const {\n        children,\n        onClose,\n        open,\n        offsetPosition\n    } = props;\n\n    const theme = useTheme();\n    return (\n        <Modal\n            BackdropProps={{\n                transitionDuration: defaultTransitionDuration,\n                sx: {\n                    backgroundColor: theme.palette.mode === \"dark\" ? \"rgba(0, 0, 0, 0.85)\" : \"rgba(0, 0, 0, 0.6)\"\n                }\n            }}\n            BackdropComponent={Backdrop}\n            open={open}\n            onClose={onClose ? () => onClose(false) : undefined}\n            ref={ref}\n            keepMounted={true}\n            disableEnforceFocus={true}\n            disableEscapeKeyDown={true}\n            sx={{\n                transition: `transform 300ms ${theme.transitions.easing.easeOut}`,\n                transform: `translateX(-${(offsetPosition) * 200}px)`\n            }}\n        >\n            <Slide\n                in={open}\n                timeout={defaultTransitionDuration}\n                direction={\"left\"}\n            >\n                <Paper\n                    variant={\"outlined\"}\n                    square\n                    sx={{\n                        height: \"100%\",\n                        WebkitOverflowScrolling: \"touch\", // Add iOS momentum scrolling.\n                        position: \"fixed\",\n                        outline: 0,\n                        left: \"auto\",\n                        right: 0,\n                        overflow: \"hidden\",\n                        borderRadius: \"16px 0 0 16px\"\n                    }}\n                >\n                    {children}\n                </Paper>\n            </Slide>\n        </Modal>\n    );\n});\n","import React, { useCallback } from \"react\";\nimport { Blocker, Transition } from \"history\";\nimport { UNSAFE_NavigationContext, useNavigate } from \"react-router-dom\";\nimport Button from \"@mui/material/Button\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogContentText from \"@mui/material/DialogContentText\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport { CustomDialogActions } from \"../components\";\n\nexport function useNavigationUnsavedChangesDialog(when: boolean, onSuccess: () => void):\n    {\n        navigationWasBlocked: boolean,\n        handleCancel: () => void,\n        handleOk: () => void\n    } {\n\n    const [nextLocation, setNextLocation] = React.useState<any | undefined>();\n    const { navigator } = React.useContext(UNSAFE_NavigationContext);\n\n    const navigate = useNavigate();\n\n    const handleCancel = () => {\n        setNextLocation(undefined);\n    };\n\n    const handleOk = () => {\n        onSuccess();\n        setNextLocation(undefined);\n        navigate(-1);\n    };\n\n    const blocker: Blocker = useCallback(({ action, location: nextLocation, retry }) => {\n        switch (action) {\n            case \"REPLACE\": {\n                retry();\n                return;\n            }\n            case \"POP\": {\n                setNextLocation(nextLocation);\n            }\n        }\n    }, []);\n\n    React.useEffect(() => {\n        if (!when) return;\n        if (nextLocation) return;\n        if (!(\"block\" in navigator)) return;\n        const unblock = (navigator as any).block((tx: Transition) => {\n            const autoUnblockingTx = {\n                ...tx,\n                retry() {\n                    unblock();\n                    tx.retry();\n                }\n            };\n            blocker(autoUnblockingTx);\n        });\n\n        return unblock;\n    }, [navigator, blocker, when, nextLocation]);\n\n    return { navigationWasBlocked: Boolean(nextLocation), handleCancel, handleOk };\n}\n\nexport interface UnsavedChangesDialogProps {\n    open: boolean;\n    body?: React.ReactNode;\n    title?: string;\n    handleOk: () => void;\n    handleCancel: () => void;\n}\n\nexport function UnsavedChangesDialog({\n                                         open,\n                                         handleOk,\n                                         handleCancel,\n                                         body,\n                                         title\n                                     }: UnsavedChangesDialogProps) {\n\n    return (\n        <Dialog\n            keepMounted={false}\n            open={open}\n            onClose={handleCancel}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n        >\n            <DialogTitle >\n                {title ?? \"Unsaved changes\"}\n            </DialogTitle>\n            <DialogContent>\n                {body && <DialogContentText>\n                    {body}\n                </DialogContentText>}\n                <DialogContentText >\n                    Are you sure you want to leave this page?\n                </DialogContentText>\n            </DialogContent>\n            <CustomDialogActions>\n                <Button onClick={handleCancel} autoFocus> Cancel </Button>\n                <Button onClick={handleOk}> Ok </Button>\n            </CustomDialogActions>\n        </Dialog>\n    );\n}\n","import React, { useContext, useEffect, useState } from \"react\";\nimport { useSideDialogsController } from \"../hooks/useSideDialogsController\";\nimport { SideDialogDrawer } from \"./internal/SideDialogDrawer\";\nimport { ErrorBoundary } from \"./components\";\nimport {\n    UnsavedChangesDialog,\n    useNavigationUnsavedChangesDialog\n} from \"./internal/useUnsavedChangesDialog\";\nimport { Box } from \"@mui/material\";\nimport { SideDialogPanelProps } from \"../types\";\nimport { CONTAINER_FULL_WIDTH } from \"./internal/common\";\n\nexport type SideDialogContextProps = {\n    blocked: boolean,\n    setBlocked: (blocked: boolean) => void,\n    setBlockedNavigationMessage: (message?: React.ReactNode) => void,\n    width?: string,\n    close: (force?: boolean) => void\n}\n\nconst SideDialogContext = React.createContext<SideDialogContextProps>({\n    width: \"\",\n    blocked: false,\n    setBlocked: (blocked: boolean) => {\n    },\n    setBlockedNavigationMessage: (message?: React.ReactNode) => {\n    },\n    close: () => {\n    }\n});\n\n/**\n * This hook is used to access the properties of a particular side dialog,\n * in contrast with {@link useSideDialogsController} which handles the\n * state of all the dialogs.\n */\nexport const useSideDialogContext = () => useContext<SideDialogContextProps>(SideDialogContext);\n\n/**\n * This is the component in charge of rendering the side dialogs used\n * for editing entities. Use the {@link useSideEntityController} to open\n * and control the dialogs.\n * This component needs a parent {@link FireCMS}\n * {@link useSideDialogsController}\n * @category Components\n */\nexport function SideDialogs() {\n\n    const sideDialogsController = useSideDialogsController();\n\n    const sidePanels = sideDialogsController.sidePanels;\n\n    const panels: (SideDialogPanelProps | undefined)[] = [...sidePanels];\n    panels.push(undefined);\n\n    return <>\n        {\n            panels.map((panel, index) =>\n                <SideDialogView\n                    key={`side_dialog_${index}`}\n                    panel={panel}\n                    offsetPosition={sidePanels.length - index - 1}/>)\n        }\n    </>;\n}\n\nfunction SideDialogView({\n                            offsetPosition,\n                            panel\n                        }: {\n    offsetPosition: number,\n    panel?: SideDialogPanelProps\n}) {\n\n    // was the closing of the dialog requested by the drawer\n    const [drawerCloseRequested, setDrawerCloseRequested] = useState<boolean>(false);\n    const [blocked, setBlocked] = useState(false);\n    const [blockedNavigationMessage, setBlockedNavigationMessage] = useState<React.ReactNode | undefined>();\n\n    const widthRef = React.useRef<string | undefined>(panel?.width);\n    const width = widthRef.current;\n\n    const sideDialogsController = useSideDialogsController();\n\n    const {\n        navigationWasBlocked,\n        handleOk: handleNavigationOk,\n        handleCancel: handleNavigationCancel\n    } = useNavigationUnsavedChangesDialog(\n        blocked && !drawerCloseRequested,\n        () => setBlocked(false)\n    );\n\n    useEffect(() => {\n        if (panel)\n            widthRef.current = panel.width;\n    }, [panel])\n\n    const handleDrawerCloseOk = () => {\n        setBlocked(false);\n        setDrawerCloseRequested(false);\n        sideDialogsController.close();\n        panel?.onClose?.();\n    };\n\n    const handleDrawerCloseCancel = () => {\n        setDrawerCloseRequested(false);\n    };\n\n    const onCloseRequest = (force?: boolean) => {\n        if (blocked && !force) {\n            setDrawerCloseRequested(true);\n        } else {\n            sideDialogsController.close();\n            panel?.onClose?.();\n        }\n    };\n\n    return (\n        <SideDialogContext.Provider\n            value={{\n                blocked,\n                setBlocked,\n                setBlockedNavigationMessage,\n                width,\n                close: onCloseRequest\n            }}>\n\n            <SideDialogDrawer\n                open={Boolean(panel)}\n                onClose={onCloseRequest}\n                offsetPosition={offsetPosition}\n            >\n                {panel &&\n                    <Box\n                        sx={(theme) => ({\n                            display: \"flex\",\n                            flexDirection: \"column\",\n                            height: \"100%\",\n                            transition: \"width 250ms ease-in-out\",\n                            width: panel.width,\n                            maxWidth: CONTAINER_FULL_WIDTH,\n                            [theme.breakpoints.up(\"lg\")]: {\n                                maxWidth: \"95vw\"\n                            }\n\n                        })}>\n                        <ErrorBoundary>\n                            {panel.component}\n                        </ErrorBoundary>\n                    </Box>}\n\n                {!panel && <div style={{ width }}/>}\n\n            </SideDialogDrawer>\n\n            <UnsavedChangesDialog\n                open={navigationWasBlocked || drawerCloseRequested}\n                handleOk={drawerCloseRequested ? handleDrawerCloseOk : handleNavigationOk}\n                handleCancel={drawerCloseRequested ? handleDrawerCloseCancel : handleNavigationCancel}\n                body={blockedNavigationMessage}/>\n\n        </SideDialogContext.Provider>\n\n    );\n}\n","import { Entity, EntityCallbacks, EntityCollection } from \"../../../../types\";\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport {\n    Button,\n    CircularProgress,\n    Dialog,\n    DialogContent,\n    DialogTitle\n} from \"@mui/material\";\nimport {\n    deleteEntityWithCallbacks,\n    useDataSource,\n    useFireCMSContext,\n    useSnackbarController\n} from \"../../../../hooks\";\nimport { CustomDialogActions } from \"../../CustomDialogActions\";\nimport { resolveCollection } from \"../../../util/resolutions\";\nimport EntityPreview from \"../../EntityPreview\";\n\nexport interface DeleteEntityDialogProps<M extends Record<string, any>> {\n    entityOrEntitiesToDelete?: Entity<M> | Entity<M>[],\n    path: string,\n    collection: EntityCollection<M>\n    open: boolean;\n    onClose: () => void;\n    callbacks?: EntityCallbacks<M>,\n\n    onEntityDelete?(path: string, entity: Entity<M>): void;\n\n    onMultipleEntitiesDelete?(path: string, entities: Entity<M>[]): void;\n}\n\nexport function DeleteEntityDialog<M extends Record<string, any>>({\n                                                                      entityOrEntitiesToDelete,\n                                                                      collection,\n                                                                      onClose,\n                                                                      open,\n                                                                      callbacks,\n                                                                      onEntityDelete,\n                                                                      onMultipleEntitiesDelete,\n                                                                      path,\n                                                                      ...other\n                                                                  }: DeleteEntityDialogProps<M>) {\n\n    const dataSource = useDataSource();\n    const snackbarController = useSnackbarController();\n    const [loading, setLoading] = useState(false);\n\n    const [entityOrEntities, setUsedEntityOrEntities] = React.useState<Entity<M> | Entity<M>[]>();\n\n    const [multipleEntities, setMultipleEntities] = React.useState<boolean>();\n    const context = useFireCMSContext();\n\n    React.useEffect(() => {\n        if (entityOrEntitiesToDelete) {\n            const revisedEntityOrEntities = Array.isArray(entityOrEntitiesToDelete) && entityOrEntitiesToDelete.length === 1\n                ? entityOrEntitiesToDelete[0]\n                : entityOrEntitiesToDelete;\n            setUsedEntityOrEntities(revisedEntityOrEntities);\n            setMultipleEntities(Array.isArray(revisedEntityOrEntities));\n        }\n    }, [entityOrEntitiesToDelete]);\n\n    const resolvedCollection = useMemo(() => resolveCollection<M>({\n        collection,\n        path,\n        fields: context.fields\n    }), [collection, path]);\n\n    const handleCancel = useCallback(() => {\n        onClose();\n    }, [onClose]);\n\n    const onDeleteSuccess = useCallback((entity: Entity<any>) => {\n        console.debug(\"Deleted\", entity);\n    }, []);\n\n    const onDeleteFailure = useCallback((entity: Entity<any>, e: Error) => {\n        snackbarController.open({\n            type: \"error\",\n            message: \"Error deleting: \" + e?.message\n        });\n\n        console.error(\"Error deleting entity\");\n        console.error(e);\n    }, [resolvedCollection.name]);\n\n    const onPreDeleteHookError = useCallback((entity: Entity<any>, e: Error) => {\n        snackbarController.open({\n            type: \"error\",\n            message: \"Error before deleting: \" + e?.message\n        });\n        console.error(e);\n    }, [resolvedCollection.name]);\n\n    const onDeleteSuccessHookError = useCallback((entity: Entity<any>, e: Error) => {\n        snackbarController.open({\n            type: \"error\",\n            message: \"Error after deleting: \" + e?.message\n        });\n        console.error(e);\n    }, [resolvedCollection.name]);\n\n    const performDelete = useCallback((entity: Entity<M>): Promise<boolean> =>\n        deleteEntityWithCallbacks({\n            dataSource,\n            entity,\n            collection: resolvedCollection,\n            callbacks,\n            onDeleteSuccess,\n            onDeleteFailure,\n            onPreDeleteHookError,\n            onDeleteSuccessHookError,\n            context\n        }), [dataSource, resolvedCollection, callbacks, onDeleteSuccess, onDeleteFailure, onPreDeleteHookError, onDeleteSuccessHookError, context]);\n\n    const handleOk = useCallback(async () => {\n        if (entityOrEntities) {\n\n            setLoading(true);\n\n            if (multipleEntities) {\n                Promise.all((entityOrEntities as Entity<M>[]).map(performDelete)).then((results) => {\n\n                    setLoading(false);\n\n                    if (onMultipleEntitiesDelete && entityOrEntities)\n                        onMultipleEntitiesDelete(path, entityOrEntities as Entity<M>[]);\n\n                    if (results.every(Boolean)) {\n                        snackbarController.open({\n                            type: \"success\",\n                            message: `${resolvedCollection.name}: multiple deleted`\n                        });\n                    } else if (results.some(Boolean)) {\n                        snackbarController.open({\n                            type: \"warning\",\n                            message: `${resolvedCollection.name}: Some of the entities have been deleted, but not all`\n                        });\n                    } else {\n                        snackbarController.open({\n                            type: \"error\",\n                            message: `${resolvedCollection.name}: Error deleting entities`\n                        });\n                    }\n                    onClose();\n                });\n\n            } else {\n                performDelete(entityOrEntities as Entity<M>).then((success) => {\n                    setLoading(false);\n                    if (success) {\n                        if (onEntityDelete && entityOrEntities)\n                            onEntityDelete(path, entityOrEntities as Entity<M>);\n                        snackbarController.open({\n                            type: \"success\",\n                            message: `${resolvedCollection.singularName ?? resolvedCollection.name} deleted`\n                        });\n                        onClose();\n                    }\n                });\n            }\n        }\n    }, [entityOrEntities, multipleEntities, performDelete, onMultipleEntitiesDelete, path, onClose, snackbarController, resolvedCollection.name, onEntityDelete]);\n\n    let content: React.ReactNode;\n    if (entityOrEntities && multipleEntities) {\n        content = <div>Multiple entities</div>;\n    } else {\n        const entity = entityOrEntities as Entity<M> | undefined;\n        content = entity\n            ? <EntityPreview\n                entity={entity}\n                collection={collection}\n                path={path}/>\n            : <></>;\n    }\n\n    const dialogTitle = multipleEntities\n        ? `${resolvedCollection.name}: Confirm multiple delete?`\n        : `Would you like to delete this ${resolvedCollection.singularName ?? resolvedCollection.name}?`;\n\n    return (\n        <Dialog\n            maxWidth=\"md\"\n            aria-labelledby=\"delete-dialog\"\n            open={open}\n            onBackdropClick={onClose}\n            {...other}\n        >\n            <DialogTitle id=\"delete-dialog-title\">\n                {dialogTitle}\n            </DialogTitle>\n\n            {!multipleEntities && <DialogContent dividers>\n                {content}\n            </DialogContent>}\n\n            <CustomDialogActions>\n\n                {loading && <CircularProgress size={16} thickness={8}/>}\n\n                <Button onClick={handleCancel}\n                        disabled={loading}\n                        color=\"primary\">\n                    Cancel\n                </Button>\n                <Button\n                    autoFocus\n                    disabled={loading}\n                    onClick={handleOk}\n                    variant=\"contained\"\n                    color=\"primary\">\n                    Ok\n                </Button>\n            </CustomDialogActions>\n\n        </Dialog>\n    );\n}\n","import {\n    Entity,\n    EntityReference,\n    ExportConfig,\n    ResolvedEntityCollection,\n    ResolvedProperties,\n    ResolvedProperty,\n    User\n} from \"../../types\";\nimport { getValueInPath } from \"./objects\";\n\ninterface Header {\n    key: string;\n    label: string;\n}\n\nexport function downloadCSV<M extends Record<string, any>>(data: Entity<M>[],\n                               additionalData: Record<string, any>[] | undefined,\n                               collection: ResolvedEntityCollection<M>,\n                               path: string,\n                               exportConfig: ExportConfig | undefined) {\n    const properties = collection.properties;\n    const headers = getExportHeaders(properties, path, exportConfig);\n    const exportableData = getExportableData(data, additionalData, properties, headers);\n    const headersData = entryToCSVRow(headers.map(h => h.label));\n    const csvData = exportableData.map(entry => entryToCSVRow(entry));\n    downloadBlob([headersData, ...csvData], `${collection.name}.csv`, \"text/csv\");\n}\n\nexport function getExportableData(data: any[],\n                                  additionalData: Record<string, any>[] | undefined,\n                                  properties: ResolvedProperties,\n                                  headers: Header[]\n) {\n\n    const mergedData: any[] = data.map(e => ({ id: e.id, ...processCSVValues(e.values, properties) }));\n    if (additionalData) {\n        additionalData.forEach((additional, index) => {\n            mergedData[index] = { ...mergedData[index], ...additional };\n        });\n    }\n    return mergedData && mergedData.map((entry) => {\n        return headers.map((header) => getValueInPath(entry, header.key));\n    });\n}\n\nfunction getExportHeaders<M extends Record<string, any>, UserType extends User>(properties: ResolvedProperties<M>,\n                                                                      path: string,\n                                                                      exportConfig?: ExportConfig<UserType>): Header[] {\n    const headers = [\n        { label: \"id\", key: \"id\" },\n        ...Object.entries(properties)\n            .map(([childKey, property]) => getHeaders(property as ResolvedProperty, childKey, \"\"))\n            .flat()\n    ];\n\n    if (exportConfig?.additionalFields) {\n        headers.push(...exportConfig.additionalFields.map((column) => ({\n            label: column.key,\n            key: column.key\n        })));\n    }\n\n    return headers;\n}\n\n/**\n * Get headers for property. There could be more than one header per property\n * @param property\n * @param propertyKey\n * @param prefix\n */\nfunction getHeaders(property: ResolvedProperty, propertyKey: string, prefix = \"\"): Header[] {\n    const currentKey = prefix ? `${prefix}.${propertyKey}` : propertyKey;\n    if (property.dataType === \"map\" && property.properties) {\n        return Object.entries(property.properties)\n            .map(([childKey, p]) => getHeaders(p, childKey, currentKey))\n            .flat();\n    } else {\n        return [{ label: currentKey, key: currentKey }];\n    }\n}\n\nfunction processCSVValue(inputValue: any,\n                         property: ResolvedProperty): any {\n\n    let value;\n    if (property.dataType === \"map\" && property.properties) {\n        value = processCSVValues(inputValue, property.properties as ResolvedProperties);\n    } else if (property.dataType === \"array\") {\n        if (property.of && Array.isArray(inputValue)) {\n            if (Array.isArray(property.of)) {\n                value = property.of.map((p, i) => processCSVValue(inputValue[i], p));\n            } else if (property.of.dataType === \"map\") {\n                value = inputValue.map((e) => JSON.stringify(e));\n            } else {\n                value = inputValue.map((e) => processCSVValue(e, property.of as ResolvedProperty));\n            }\n        } else {\n            value = inputValue;\n        }\n    } else if (property.dataType === \"reference\") {\n        const ref = inputValue ? inputValue as EntityReference : undefined;\n        value = ref ? ref.pathWithId : null;\n    } else if (property.dataType === \"date\") {\n        value = inputValue ? inputValue.getTime() : null;\n    } else {\n        value = inputValue;\n    }\n\n    return value;\n}\n\nfunction processCSVValues<M extends Record<string, any>>\n(inputValues: Record<keyof M, any>, properties: ResolvedProperties<M>): Record<keyof M, any> {\n    const updatedValues = Object.entries(properties)\n        .map(([key, property]) => {\n            const inputValue = inputValues && (inputValues)[key];\n            const updatedValue = processCSVValue(inputValue, property as ResolvedProperty);\n            if (updatedValue === undefined) return {};\n            return ({ [key]: updatedValue });\n        })\n        .reduce((a, b) => ({ ...a, ...b }), {}) as Record<keyof M, any>;\n    return { ...inputValues, ...updatedValues };\n}\n\nfunction entryToCSVRow(entry: any[]) {\n    return entry\n        .map((v: string | undefined) => {\n            if (v === null || v === undefined) return \"\";\n            const s = String(v);\n            return '\"' + s.replaceAll('\"', '\"\"') + '\"';\n        })\n        .join(\",\") + \"\\r\\n\";\n}\n\nexport function downloadBlob(content: BlobPart[], filename: string, contentType: string) {\n    const blob = new Blob(content, { type: contentType });\n    const url = URL.createObjectURL(blob);\n    const pom = document.createElement(\"a\");\n    pom.href = url;\n    pom.setAttribute(\"download\", filename);\n    pom.click();\n}\n","import React, { useCallback, useEffect, useRef } from \"react\";\nimport {\n    Alert,\n    Button,\n    CircularProgress,\n    Dialog,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    IconButton,\n    Tooltip\n} from \"@mui/material\";\n\nimport GetAppIcon from \"@mui/icons-material/GetApp\";\nimport {\n    Entity,\n    EntityCollection,\n    ExportConfig,\n    ResolvedEntityCollection,\n    User\n} from \"../../../../types\";\nimport {\n    useDataSource,\n    useFireCMSContext,\n    useNavigationContext\n} from \"../../../../hooks\";\nimport { downloadCSV } from \"../../../util/csv\";\nimport { CustomDialogActions } from \"../../CustomDialogActions\";\nimport { resolveCollection } from \"../../../util\";\n\ninterface ExportButtonProps<M extends Record<string, any>, UserType extends User> {\n    collection: EntityCollection<M>;\n    path: string;\n    exportConfig?: ExportConfig<UserType>;\n}\n\nconst INITIAL_DOCUMENTS_LIMIT = 200;\n\nexport function ExportButton<M extends Record<string, any>, UserType extends User>({\n                                                                                       collection: inputCollection,\n                                                                                       path: inputPath,\n                                                                                       exportConfig\n                                                                                   }: ExportButtonProps<M, UserType>\n) {\n\n    const context = useFireCMSContext<UserType>();\n    const dataSource = useDataSource();\n    const navigationContext = useNavigationContext();\n\n    const path = navigationContext.resolveAliasesFrom(inputPath);\n\n    const collection: ResolvedEntityCollection<M> = React.useMemo(() => resolveCollection({\n        collection: inputCollection,\n        path,\n        fields: context.fields\n    }), [inputCollection, path]);\n\n    const dataRef = useRef<Entity<M>[]>();\n    const additionalDataRef = useRef<Record<string, any>[]>();\n\n    const [dataLoading, setDataLoading] = React.useState<boolean>(false);\n    const [dataLoadingError, setDataLoadingError] = React.useState<Error | undefined>();\n\n    // If in the initial load, we get more than INITIAL_DOCUMENTS_LIMIT results\n    const [hasLargeAmountOfData, setHasLargeAmountOfData] = React.useState<boolean>(false);\n\n    // did the user agree to export a large amount of data\n    const [fetchLargeDataAccepted, setFetchLargeDataAccepted] = React.useState<boolean>(false);\n\n    const [open, setOpen] = React.useState(false);\n\n    const handleClickOpen = useCallback(() => {\n        setOpen(true);\n    }, [setOpen]);\n\n    const handleClose = useCallback(() => {\n        setOpen(false);\n    }, [setOpen]);\n\n    const doDownload = useCallback((data: Entity<M>[] | undefined,\n                                    additionalData: Record<string, any>[] | undefined,\n                                    collection: ResolvedEntityCollection<M>,\n                                    path: string,\n                                    exportConfig: ExportConfig<any> | undefined) => {\n        if (!data)\n            throw Error(\"Trying to perform export without loading data first\");\n\n        downloadCSV(data, additionalData, collection, path, exportConfig);\n    }, []);\n\n    const fetchAdditionalFields = useCallback(async (entities: Entity<M>[]) => {\n\n        if (!exportConfig?.additionalFields) {\n            return;\n        }\n\n        const additionalFields = exportConfig.additionalFields;\n\n        const resolvedColumnsValues: Record<string, any>[] = await Promise.all(entities.map(async (entity) => {\n            return (await Promise.all(additionalFields.map(async (column) => {\n                return {\n                    [column.key]: await column.builder({\n                        entity,\n                        context\n                    })\n                };\n            }))).reduce((a, b) => ({ ...a, ...b }), {});\n        }));\n        return resolvedColumnsValues;\n    }, [exportConfig?.additionalFields]);\n\n    const updateEntities = useCallback(async (entities: Entity<M>[]) => {\n        if (entities.length >= INITIAL_DOCUMENTS_LIMIT) {\n            setHasLargeAmountOfData(true);\n        }\n\n        const pendingDownload = dataRef.current && entities.length > dataRef.current.length && fetchLargeDataAccepted;\n\n        dataRef.current = entities;\n        const additionalFieldsData = await fetchAdditionalFields(entities);\n        additionalDataRef.current = additionalFieldsData;\n        setDataLoadingError(undefined);\n\n        if (pendingDownload) {\n            doDownload(entities, additionalFieldsData, collection, path, exportConfig);\n            handleClose();\n        }\n    }, [collection, doDownload, exportConfig, fetchAdditionalFields, fetchLargeDataAccepted, handleClose, path]);\n\n    useEffect(() => {\n\n        if (!open) return;\n\n        setDataLoading(true);\n        dataSource.fetchCollection<M>({\n            path,\n            collection,\n            limit: fetchLargeDataAccepted ? undefined : INITIAL_DOCUMENTS_LIMIT\n        })\n            .then(updateEntities)\n            .catch(setDataLoadingError)\n            .finally(() => setDataLoading(false));\n\n    }, [collection, dataSource, fetchLargeDataAccepted, open, path, updateEntities]);\n\n    const needsToAcceptFetchAllData = hasLargeAmountOfData && !fetchLargeDataAccepted;\n\n    const onOkClicked = useCallback(() => {\n        if (needsToAcceptFetchAllData) {\n            setFetchLargeDataAccepted(true);\n        } else {\n            doDownload(dataRef.current, additionalDataRef.current, collection, path, exportConfig);\n            handleClose();\n        }\n    }, [needsToAcceptFetchAllData, doDownload, collection, path, exportConfig, handleClose]);\n\n    return <>\n\n        <Tooltip title={\"Export\"}>\n            <IconButton color={\"primary\"} onClick={handleClickOpen}>\n                <GetAppIcon/>\n            </IconButton>\n        </Tooltip>\n\n        <Dialog\n            keepMounted={false}\n            open={open}\n            onClose={handleClose}\n        >\n            <DialogTitle>Export data</DialogTitle>\n\n            <DialogContent>\n                <DialogContentText>\n\n                    <div>Download the the content of this table as a CSV\n                    </div>\n                    <br/>\n\n                    {needsToAcceptFetchAllData &&\n                        <Alert elevation={3}\n                               variant=\"filled\"\n                               severity={\"warning\"}>\n                            <div>\n                                This collections has a large number\n                                of documents (more\n                                than {INITIAL_DOCUMENTS_LIMIT}).\n                            </div>\n                            <div>\n                                Would you like to proceed?\n                            </div>\n\n                        </Alert>}\n\n                </DialogContentText>\n            </DialogContent>\n\n            <CustomDialogActions>\n\n                {dataLoading && <CircularProgress size={16} thickness={8}/>}\n\n                <Button color=\"primary\" onClick={handleClose}>\n                    Cancel\n                </Button>\n\n                <Button color=\"primary\"\n                        variant=\"contained\"\n                        disabled={dataLoading}\n                        onClick={onOkClicked}>\n                    Download\n                </Button>\n\n            </CustomDialogActions>\n\n        </Dialog>\n\n    </>;\n}\n","import React from \"react\";\nimport {\n    Button,\n    IconButton,\n    Tooltip,\n    useMediaQuery,\n    useTheme\n} from \"@mui/material\";\n\nimport { Add, Delete } from \"@mui/icons-material\";\nimport { ExportButton } from \"../EntityCollectionTable/internal/ExportButton\";\n\nimport { canCreateEntity, canDeleteEntity } from \"../../util/permissions\";\nimport { useAuthController, useFireCMSContext } from \"../../../hooks\";\nimport {\n    CollectionActionsProps,\n    Entity,\n    EntityCollection,\n    ExportConfig,\n    SelectionController\n} from \"../../../types\";\nimport { fullPathToCollectionSegments } from \"../../util/paths\";\n\nexport type EntityCollectionViewActionsProps<M extends Record<string, any>> = {\n    collection: EntityCollection<M>;\n    path: string;\n    selectionEnabled: boolean;\n    exportable: boolean | ExportConfig;\n    onNewClick: () => void;\n    onMultipleDeleteClick: () => void;\n    selectionController: SelectionController<M>;\n    loadedEntities: Entity<M>[];\n\n}\n\nexport function EntityCollectionViewActions<M extends Record<string, any>>({\n                                                                               collection,\n                                                                               onNewClick,\n                                                                               exportable,\n                                                                               onMultipleDeleteClick,\n                                                                               selectionEnabled,\n                                                                               path,\n                                                                               selectionController,\n                                                                               loadedEntities\n                                                                           }: EntityCollectionViewActionsProps<M>) {\n\n    const context = useFireCMSContext();\n    const authController = useAuthController();\n\n    const theme = useTheme();\n    const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n\n    const selectedEntities = selectionController.selectedEntities;\n\n    const addButton = canCreateEntity(collection, authController, fullPathToCollectionSegments(path), null) &&\n        onNewClick && (largeLayout\n            ? <Button\n                id={`add_entity_${path}`}\n                onClick={onNewClick}\n                startIcon={<Add/>}\n                size=\"large\"\n                variant=\"contained\"\n                color=\"primary\">\n                Add {collection.singularName ?? collection.name}\n            </Button>\n            : <Button\n                id={`add_entity_${path}`}\n                onClick={onNewClick}\n                size=\"medium\"\n                variant=\"contained\"\n                color=\"primary\"\n            >\n                <Add/>\n            </Button>);\n\n    const multipleDeleteEnabled = canDeleteEntity(collection, authController, fullPathToCollectionSegments(path), null);\n\n    let multipleDeleteButton: React.ReactNode | undefined;\n    if (selectionEnabled) {\n        const button = largeLayout\n            ? <Button\n                disabled={!(selectedEntities?.length) || !multipleDeleteEnabled}\n                startIcon={<Delete/>}\n                onClick={onMultipleDeleteClick}\n                color={\"primary\"}\n                sx={{ minWidth: 68 }}\n            >\n                ({selectedEntities?.length})\n            </Button>\n            : <IconButton\n                color={\"primary\"}\n                disabled={!(selectedEntities?.length) || !multipleDeleteEnabled}\n                onClick={onMultipleDeleteClick}>\n                <Delete/>\n            </IconButton>;\n        multipleDeleteButton =\n            <Tooltip\n                title={multipleDeleteEnabled ? \"Delete\" : \"You have selected at least one entity you cannot delete\"}>\n                <span>{button}</span>\n            </Tooltip>\n    }\n\n    const actionProps: CollectionActionsProps = {\n        path,\n        collection,\n        selectionController,\n        context,\n        loadedEntities\n    };\n\n    const actions = collection.Actions\n        ? Array.isArray(collection.Actions)\n            ? <>\n                {collection.Actions.map((Action, i) => (\n                    <Action key={`actions_${i}`} {...actionProps} />\n                ))}\n            </>\n            : <collection.Actions {...actionProps} />\n        : undefined;\n\n    const exportButton = exportable &&\n        <ExportButton collection={collection}\n                      exportConfig={typeof collection.exportable === \"object\" ? collection.exportable : undefined}\n                      path={path}/>;\n    return (\n        <>\n            {actions}\n            {multipleDeleteButton}\n            {exportButton}\n            {addButton}\n        </>\n    );\n}\n","import { Entity } from \"../../types\";\n\nexport interface DataOrderProps<M extends Record<string, any>> {\n    data: Entity<M>[];\n    entitiesDisplayedFirst?: Entity<M>[];\n}\n\n/**\n * This hook is used to have some entities at the beginning of data.\n * @param path\n * @param entitiesDisplayedFirst\n * @category Hooks and utilities\n */\nexport function useDataOrder<M extends Record<string, any>>(\n    {\n        data,\n        entitiesDisplayedFirst\n    }: DataOrderProps<M>): Entity<M>[] {\n\n    if (!entitiesDisplayedFirst)\n        return data;\n\n    const displayedFirstId = new Set(entitiesDisplayedFirst.map((e) => e.id));\n    return [...entitiesDisplayedFirst, ...data.filter((e) => !displayedFirstId.has(e.id))];\n\n}\n","import React from \"react\";\nimport equal from \"react-fast-compare\";\n\n/**\n * Hack to prevent data updates for incomplete callbacks from Firestore\n * triggers.\n * If any deps change, the update is immediate\n * @param data\n * @param deps\n * @param timeoutMs\n */\nexport function useDebouncedData<T>(data: T[], deps: any, timeoutMs = 5000) {\n\n    const [deferredData, setDeferredData] = React.useState(data);\n    const dataLength = React.useRef(deferredData.length ?? 0);\n    const pendingUpdate = React.useRef(false);\n    const currentDeps = React.useRef(deps);\n\n    const haveDepsChanged = !equal(currentDeps.current, deps);\n    const immediateUpdate = data.length >= dataLength.current || haveDepsChanged;\n\n    React.useEffect(() => {\n\n        const performUpdate = () => {\n            if (!equal(deferredData, data)) {\n                currentDeps.current = deps;\n                dataLength.current = data.length;\n                setDeferredData(data);\n            }\n            pendingUpdate.current = false;\n        };\n\n        pendingUpdate.current = true;\n\n        let handler: any;\n        if (immediateUpdate)\n            performUpdate()\n        else\n            handler = setTimeout(performUpdate, timeoutMs);\n\n        return () => {\n            clearTimeout(handler);\n            if (pendingUpdate.current && immediateUpdate)\n                performUpdate();\n        };\n    }, [data, timeoutMs, deps, immediateUpdate]);\n\n    return immediateUpdate ? data : deferredData;\n}\n","import React, { useCallback, useMemo } from \"react\";\n\nimport { useCollectionFetch } from \"../../../hooks\";\nimport { useDataOrder } from \"../../../hooks/data/useDataOrder\";\nimport {\n    Entity,\n    EntityCollection,\n    FilterCombination,\n    FilterValues,\n    User\n} from \"../../../types\";\nimport { useDebouncedData } from \"./useDebouncedData\";\n\nconst DEFAULT_PAGE_SIZE = 50;\n\nexport type TableController<M extends Record<string, any> = any> = {\n    data: Entity<M>[];\n    dataLoading: boolean;\n    noMoreToLoad: boolean;\n    dataLoadingError?: Error;\n    filterValues?: FilterValues<Extract<keyof M, string>>;\n    setFilterValues: (filterValues: FilterValues<Extract<keyof M, string>>) => void;\n    sortBy?: [Extract<keyof M, string>, \"asc\" | \"desc\"];\n    setSortBy: (sortBy: [Extract<keyof M, string>, \"asc\" | \"desc\"]) => void;\n    searchString?: string;\n    setSearchString: (searchString?: string) => void;\n    clearFilter: () => void;\n    itemCount?: number;\n    setItemCount: (itemCount: number) => void;\n    pageSize: number;\n    paginationEnabled: boolean;\n    checkFilterCombination: (filterValues: FilterValues<any>,\n                             sortBy?: [string, \"asc\" | \"desc\"]) => boolean;\n\n}\nexport type TableControllerProps<M extends Record<string, any> = any> = {\n    fullPath: string;\n    collection: EntityCollection<M>;\n    /**\n     * List of entities that will be displayed on top, no matter the ordering.\n     * This is used for reference fields selection\n     */\n    entitiesDisplayedFirst?: Entity<M>[];\n    isFilterCombinationValid: (\n        filter: FilterValues<Extract<keyof M, string>>,\n        sort?: [string, \"asc\" | \"desc\"],\n        filterCombinations?: FilterCombination<Extract<keyof M, string>>[]) => boolean;\n    lastDeleteTimestamp?: number;\n    forceFilter?: FilterValues<string>;\n}\n\nexport function useTableController<M extends Record<string, any> = any, UserType extends User = User>(\n    {\n        fullPath,\n        collection,\n        entitiesDisplayedFirst,\n        isFilterCombinationValid,\n        lastDeleteTimestamp,\n        forceFilter: forceFilterFromProps\n    }: TableControllerProps<M>)\n    : TableController<M> {\n\n    const {\n        filterCombinations,\n        initialFilter,\n        initialSort,\n        forceFilter: forceFilterFromCollection\n    } = collection;\n\n    const forceFilter = forceFilterFromProps ?? forceFilterFromCollection;\n    const paginationEnabled = collection.pagination === undefined || Boolean(collection.pagination);\n    const pageSize = typeof collection.pagination === \"number\" ? collection.pagination : DEFAULT_PAGE_SIZE;\n\n    const [searchString, setSearchString] = React.useState<string | undefined>();\n    const [itemCount, setItemCount] = React.useState<number | undefined>(paginationEnabled ? pageSize : undefined);\n\n    const checkFilterCombination = useCallback((filterValues: FilterValues<any>,\n                                                sortBy?: [string, \"asc\" | \"desc\"]) => isFilterCombinationValid(filterValues, sortBy, filterCombinations), [filterCombinations]);\n\n    const initialSortInternal = useMemo(() => {\n        if (initialSort && forceFilter && !checkFilterCombination(forceFilter, initialSort)) {\n            console.warn(\"Initial sort is not compatible with the force filter. Ignoring initial sort\");\n            return undefined;\n        }\n        return initialSort;\n    }, [initialSort, forceFilter]);\n\n    const [filterValues, setFilterValues] = React.useState<FilterValues<Extract<keyof M, string>> | undefined>(forceFilter ?? initialFilter ?? undefined);\n    const [sortBy, setSortBy] = React.useState<[Extract<keyof M, string>, \"asc\" | \"desc\"] | undefined>(initialSortInternal);\n\n    const clearFilter = useCallback(() => setFilterValues(forceFilter ?? undefined), [forceFilter]);\n\n    const {\n        data: rawData,\n        dataLoading,\n        noMoreToLoad,\n        dataLoadingError\n    } = useCollectionFetch<M, UserType>({\n        path: fullPath,\n        collection,\n        filterValues,\n        sortBy,\n        searchString,\n        itemCount\n    });\n\n    const orderedData = useDataOrder({\n        data: rawData,\n        entitiesDisplayedFirst\n    });\n\n    // hack to fix Firestore listeners firing with incomplete data\n    const data = useDebouncedData(orderedData, {\n        filterValues,\n        sortBy,\n        searchString,\n        lastDeleteTimestamp\n    });\n\n    return {\n        data,\n        dataLoading,\n        noMoreToLoad,\n        dataLoadingError,\n        filterValues,\n        setFilterValues,\n        sortBy,\n        setSortBy,\n        searchString,\n        setSearchString,\n        clearFilter,\n        itemCount,\n        setItemCount,\n        paginationEnabled,\n        pageSize,\n        checkFilterCombination\n    }\n}\n","import { FilterCombination, FilterValues, WhereFilterOp } from \"../../../types\";\n\nexport function isFilterCombinationValidForFirestore<M>(\n    filterValues: FilterValues<Extract<keyof M, string>>,\n    sortBy?: [string, \"asc\" | \"desc\"],\n    indexes?: FilterCombination<string>[]\n): boolean {\n\n    const sortKey = sortBy ? sortBy[0] : undefined;\n    const sortDirection = sortBy ? sortBy[1] : undefined;\n\n    // Order by clause cannot contain a field with an equality filter\n    const values: [WhereFilterOp, any][] = Object.values(filterValues) as [WhereFilterOp, any][];\n    if (sortKey && values.map((v) => v[0]).includes(\"==\")) {\n        return false;\n    }\n\n    const filterKeys = Object.keys(filterValues);\n    const filtersCount = filterKeys.length;\n\n    if (filtersCount === 1 && (!sortKey || sortKey === filterKeys[0])) {\n        return true;\n    }\n\n    if (!indexes && filtersCount > 1) {\n        return false;\n    }\n\n    return !!indexes && indexes\n        .filter((compositeIndex) => !sortKey || sortKey in compositeIndex)\n        .find((compositeIndex) =>\n            Object.entries(filterValues).every(([key, value]) => compositeIndex[key] !== undefined && (!sortDirection || compositeIndex[key] === sortDirection))\n        ) !== undefined;\n}\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { Box, Popover, Typography, useTheme } from \"@mui/material\";\nimport equal from \"react-fast-compare\"\n\nimport {\n    CollectionSize,\n    Entity,\n    EntityCollection,\n    PartialEntityCollection,\n    Property,\n    SelectionController\n} from \"../../../types\";\nimport {\n    EntityCollectionTable,\n    OnColumnResizeParams\n} from \"../EntityCollectionTable\";\n\nimport {\n    EntityCollectionRowActions\n} from \"../EntityCollectionTable/internal/EntityCollectionRowActions\";\nimport {\n    DeleteEntityDialog\n} from \"../EntityCollectionTable/internal/DeleteEntityDialog\";\n\nimport {\n    canCreateEntity,\n    canDeleteEntity,\n    canEditEntity,\n    fullPathToCollectionSegments,\n    mergeDeep\n} from \"../../util\";\nimport { Markdown, renderSkeletonText } from \"../../../preview\";\nimport {\n    useAuthController,\n    useDataSource,\n    useFireCMSContext,\n    useNavigationContext,\n    useSideEntityController\n} from \"../../../hooks\";\nimport {\n    useUserConfigurationPersistence\n} from \"../../../hooks/useUserConfigurationPersistence\";\nimport { EntityCollectionViewActions } from \"./EntityCollectionViewActions\";\nimport {\n    useTableController\n} from \"../EntityCollectionTable/useTableController\";\nimport {\n    isFilterCombinationValidForFirestore\n} from \"./isFilterCombinationValidForFirestore\";\n\n/**\n * @category Components\n */\nexport type EntityCollectionViewProps<M extends Record<string, any>> = {\n    fullPath: string;\n    isSubCollection?: boolean;\n} & EntityCollection<M>;\n\n/**\n * This component is in charge of binding a datasource path with an {@link EntityCollection}\n * where it's configuration is defined. It includes an infinite scrolling table\n * and a 'Add' new entities button,\n *\n * This component is the default one used for displaying entity collections\n * and is in charge of generating all the specific actions and customization\n * of the lower level {@link EntityCollectionTable}\n *\n * Please **note** that you only need to use this component if you are building\n * a custom view. If you just need to create a default view you can do it\n * exclusively with config options.\n *\n * If you need a lower level implementation with more granular options, you\n * can use {@link EntityCollectionTable}.\n *\n * If you need a generic table that is not bound to the datasource or entities and\n * properties at all, you can check {@link VirtualTable}\n *\n * @param fullPath\n * @param collection\n * @constructor\n * @category Components\n */\nexport const EntityCollectionView = React.memo(\n    function EntityCollectionView<M extends Record<string, any>>({\n                                                                     fullPath,\n                                                                     isSubCollection,\n                                                                     ...collectionProp\n                                                                 }: EntityCollectionViewProps<M>\n    ) {\n\n        const sideEntityController = useSideEntityController();\n        const authController = useAuthController();\n        const userConfigPersistence = useUserConfigurationPersistence();\n        const context = useFireCMSContext();\n\n        const collection = useMemo(() => {\n            const userOverride = userConfigPersistence?.getCollectionConfig<M>(fullPath);\n            return userOverride ? mergeDeep(collectionProp, userOverride) : collectionProp;\n        }, [collectionProp, fullPath, userConfigPersistence?.getCollectionConfig]);\n\n        const theme = useTheme();\n\n        const [selectedNavigationEntity, setSelectedNavigationEntity] = useState<Entity<M> | undefined>(undefined);\n        const [deleteEntityClicked, setDeleteEntityClicked] = React.useState<Entity<M> | Entity<M>[] | undefined>(undefined);\n\n        const [lastDeleteTimestamp, setLastDeleteTimestamp] = React.useState<number>(0);\n\n        const unselectNavigatedEntity = useCallback(() => {\n            const currentSelection = selectedNavigationEntity;\n            setTimeout(() => {\n                if (currentSelection === selectedNavigationEntity)\n                    setSelectedNavigationEntity(undefined);\n            }, 2400);\n        }, [selectedNavigationEntity]);\n\n        const checkInlineEditing = useCallback((entity?: Entity<any>): boolean => {\n            if (!canEditEntity(collection, authController, fullPathToCollectionSegments(fullPath), entity ?? null)) {\n                return false;\n            }\n            return collection.inlineEditing === undefined || collection.inlineEditing;\n        }, [collection, authController, fullPath]);\n\n        const exportable = collection.exportable === undefined || collection.exportable;\n\n        const selectionEnabled = collection.selectionEnabled === undefined || collection.selectionEnabled;\n        const hoverRow = !checkInlineEditing();\n\n        const [anchorEl, setAnchorEl] = React.useState<HTMLElement | null>(null);\n\n        const selectionController = useSelectionController<M>();\n        const usedSelectionController = collection.selectionController ?? selectionController;\n        const {\n            selectedEntities,\n            toggleEntitySelection,\n            isEntitySelected,\n            setSelectedEntities\n        } = usedSelectionController;\n\n        useEffect(() => {\n            setDeleteEntityClicked(undefined);\n        }, [selectedEntities]);\n\n        const tableController = useTableController<M>({\n            fullPath,\n            collection,\n            entitiesDisplayedFirst: [],\n            isFilterCombinationValid: isFilterCombinationValidForFirestore,\n            lastDeleteTimestamp\n        });\n\n        const onEntityClick = useCallback((clickedEntity: Entity<M>) => {\n            setSelectedNavigationEntity(clickedEntity);\n            context.onAnalyticsEvent?.(\"edit_entity_clicked\", {\n                path: clickedEntity.path,\n                entityId: clickedEntity.id\n            });\n            return sideEntityController.open({\n                entityId: clickedEntity.id,\n                path: fullPath,\n                collection,\n                updateUrl: true,\n                onClose: unselectNavigatedEntity\n            });\n        }, [fullPath, collection, sideEntityController]);\n\n        const onNewClick = useCallback(() => {\n            context.onAnalyticsEvent?.(\"new_entity_click\", {\n                path: fullPath\n            });\n            sideEntityController.open({\n                path: fullPath,\n                collection,\n                updateUrl: true,\n                onClose: unselectNavigatedEntity\n            });\n        }, [fullPath, collection, sideEntityController]);\n\n        const onSingleDeleteClick = useCallback((selectedEntity: Entity<any>) => {\n            context.onAnalyticsEvent?.(\"single_delete_dialog_open\", {\n                path: fullPath\n            });\n            setDeleteEntityClicked(selectedEntity);\n        }, [context, fullPath]);\n\n        const onMultipleDeleteClick = useCallback(() => {\n            context.onAnalyticsEvent?.(\"multiple_delete_dialog_open\", {\n                path: fullPath\n            });\n            setDeleteEntityClicked(selectedEntities);\n        }, [context, fullPath, selectedEntities]);\n\n        const internalOnEntityDelete = useCallback((_path: string, entity: Entity<M>) => {\n            context.onAnalyticsEvent?.(\"single_entity_deleted\", {\n                path: fullPath\n            });\n            setSelectedEntities((selectedEntities) => selectedEntities.filter((e) => e.id !== entity.id));\n            setLastDeleteTimestamp(Date.now());\n        }, [context, fullPath, setSelectedEntities]);\n\n        const internalOnMultipleEntitiesDelete = useCallback((_path: string, entities: Entity<M>[]) => {\n            context.onAnalyticsEvent?.(\"multiple_entities_deleted\", {\n                path: fullPath\n            });\n            setSelectedEntities([]);\n            setDeleteEntityClicked(undefined);\n            setLastDeleteTimestamp(Date.now());\n        }, [setSelectedEntities]);\n\n        const onCollectionModifiedForUser = useCallback((path: string, partialCollection: PartialEntityCollection<M>) => {\n            if (userConfigPersistence) {\n                const currentStoredConfig = userConfigPersistence.getCollectionConfig(path);\n                const updatedConfig = mergeDeep(currentStoredConfig, partialCollection);\n                userConfigPersistence.onCollectionModified(path, updatedConfig);\n            }\n        }, [userConfigPersistence]);\n\n        const onColumnResize = useCallback(({\n                                                width,\n                                                key\n                                            }: OnColumnResizeParams) => {\n            // Only for property columns\n            if (!collection.properties[key]) return;\n            const property: Partial<Property> = { columnWidth: width };\n            const localCollection = { properties: { [key as keyof M]: property } } as PartialEntityCollection<M>;\n            onCollectionModifiedForUser(fullPath, localCollection);\n        }, [collection, onCollectionModifiedForUser, fullPath]);\n\n        const onSizeChanged = useCallback((size: CollectionSize) => {\n            if (userConfigPersistence)\n                onCollectionModifiedForUser(fullPath, { defaultSize: size })\n        }, [onCollectionModifiedForUser, fullPath, userConfigPersistence]);\n\n        const open = anchorEl != null;\n\n        const Title = useMemo(() => (\n            <Box sx={{\n                display: \"flex\",\n                flexDirection: \"row\",\n                contain: \"content\",\n                \"& > *:not(:last-child)\": {\n                    [theme.breakpoints.down(\"md\")]: {\n                        mr: theme.spacing(1)\n                    },\n                    mr: theme.spacing(2)\n                }\n            }}>\n                <Box>\n                    <Typography\n                        variant={\"h6\"}\n                        sx={{\n                            lineHeight: \"1.15\",\n                            textOverflow: \"ellipsis\",\n                            whiteSpace: \"nowrap\",\n                            overflow: \"hidden\",\n                            maxWidth: \"164px\",\n                            cursor: collection.description ? \"pointer\" : \"inherit\"\n                        }}\n                        onClick={collection.description\n                            ? (e) => {\n                                setAnchorEl(e.currentTarget);\n                                e.stopPropagation();\n                            }\n                            : undefined}\n                    >\n                        {`${collection.name}`}\n                    </Typography>\n                    <EntitiesCount fullPath={fullPath} collection={collection}/>\n\n                    {collection.description &&\n                        <Popover\n                            id={\"info-dialog\"}\n                            open={open}\n                            anchorEl={anchorEl}\n                            elevation={3}\n                            onClose={() => {\n                                setAnchorEl(null);\n                            }}\n                            anchorOrigin={{\n                                vertical: \"bottom\",\n                                horizontal: \"center\"\n                            }}\n                            transformOrigin={{\n                                vertical: \"top\",\n                                horizontal: \"center\"\n                            }}\n                        >\n\n                            <Box m={2}>\n                                <Markdown source={collection.description}/>\n                            </Box>\n\n                        </Popover>\n                    }\n\n                </Box>\n\n            </Box>\n        ), [theme, collection.description, collection.name, fullPath, open, anchorEl]);\n\n        const createEnabled = canCreateEntity(collection, authController, fullPathToCollectionSegments(fullPath), null);\n\n        const onCopyClicked = useCallback((clickedEntity: Entity<M>) => {\n            setSelectedNavigationEntity(clickedEntity);\n            context.onAnalyticsEvent?.(\"copy_entity_click\", {\n                path: clickedEntity.path,\n                entityId: clickedEntity.id\n            });\n            sideEntityController.open({\n                entityId: clickedEntity.id,\n                path: fullPath,\n                copy: true,\n                collection,\n                updateUrl: true,\n                onClose: unselectNavigatedEntity\n            });\n        }, [sideEntityController, collection, fullPath, unselectNavigatedEntity]);\n\n        const onEditClicked = useCallback((clickedEntity: Entity<M>) => {\n            setSelectedNavigationEntity(clickedEntity);\n            context.onAnalyticsEvent?.(\"entity_click\", {\n                path: clickedEntity.path,\n                entityId: clickedEntity.id\n            });\n            sideEntityController.open({\n                entityId: clickedEntity.id,\n                path: clickedEntity.path,\n                collection,\n                updateUrl: true,\n                onClose: unselectNavigatedEntity\n            });\n        }, [sideEntityController, collection, fullPath, unselectNavigatedEntity]);\n\n        const tableRowActionsBuilder = useCallback(({\n                                                        entity,\n                                                        size,\n                                                        width,\n                                                        frozen\n                                                    }: {\n            entity: Entity<any>,\n            size: CollectionSize,\n            width: number,\n            frozen?: boolean\n        }) => {\n\n            const isSelected = isEntitySelected(entity);\n\n            const deleteEnabled = canDeleteEntity(collection, authController, fullPathToCollectionSegments(fullPath), entity);\n\n            return (\n                <EntityCollectionRowActions\n                    entity={entity}\n                    width={width}\n                    frozen={frozen}\n                    isSelected={isSelected}\n                    selectionEnabled={selectionEnabled}\n                    size={size}\n                    toggleEntitySelection={toggleEntitySelection}\n                    onEditClicked={onEditClicked}\n                    onCopyClicked={createEnabled ? onCopyClicked : undefined}\n                    onDeleteClicked={deleteEnabled ? onSingleDeleteClick : undefined}\n                    hideId={collection?.hideIdFromCollection}\n                />\n            );\n\n        }, [isEntitySelected, collection, authController, fullPath, selectionEnabled, toggleEntitySelection, onEditClicked, createEnabled, onCopyClicked]);\n\n        return (\n            <Box sx={{\n                overflow: \"hidden\",\n                height: \"100%\",\n                width: \"100%\"\n            }}>\n                <EntityCollectionTable\n                    key={`collection_table_${fullPath}`}\n                    fullPath={fullPath}\n                    tableController={tableController}\n                    onSizeChanged={onSizeChanged}\n                    onEntityClick={onEntityClick}\n                    onColumnResize={onColumnResize}\n                    tableRowActionsBuilder={tableRowActionsBuilder}\n                    title={Title}\n                    selectionController={usedSelectionController}\n                    highlightedEntities={selectedNavigationEntity ? [selectedNavigationEntity] : []}\n                    {...collection}\n                    actions={<EntityCollectionViewActions\n                        collection={collection}\n                        exportable={exportable}\n                        onMultipleDeleteClick={onMultipleDeleteClick}\n                        onNewClick={onNewClick}\n                        path={fullPath}\n                        loadedEntities={tableController.data}\n                        selectionController={usedSelectionController}\n                        selectionEnabled={selectionEnabled}/>}\n                    hoverRow={hoverRow}\n                    inlineEditing={checkInlineEditing()}\n                />\n\n                {deleteEntityClicked &&\n                    <DeleteEntityDialog\n                        entityOrEntitiesToDelete={deleteEntityClicked}\n                        path={fullPath}\n                        collection={collection}\n                        callbacks={collection.callbacks}\n                        open={Boolean(deleteEntityClicked)}\n                        onEntityDelete={internalOnEntityDelete}\n                        onMultipleEntitiesDelete={internalOnMultipleEntitiesDelete}\n                        onClose={() => setDeleteEntityClicked(undefined)}/>}\n\n            </Box>\n        );\n    }, equal) as React.FunctionComponent<EntityCollectionViewProps<any>>\n\nexport function useSelectionController<M extends Record<string, any>>(): SelectionController<M> {\n\n    const [selectedEntities, setSelectedEntities] = useState<Entity<M>[]>([]);\n\n    const toggleEntitySelection = useCallback((entity: Entity<M>) => {\n        let newValue;\n        if (selectedEntities.map(e => e.id).includes(entity.id)) {\n            newValue = selectedEntities.filter((item: Entity<M>) => item.id !== entity.id);\n        } else {\n            newValue = [...selectedEntities, entity];\n        }\n        setSelectedEntities(newValue);\n    }, [selectedEntities]);\n\n    const isEntitySelected = useCallback((entity: Entity<M>) => selectedEntities.map(e => e.id).includes(entity.id), [selectedEntities]);\n\n    return {\n        selectedEntities,\n        setSelectedEntities,\n        isEntitySelected,\n        toggleEntitySelection\n    };\n}\n\nfunction EntitiesCount({ fullPath, collection }: { fullPath: string, collection:EntityCollection }) {\n\n    const dataSource = useDataSource();\n    const navigation = useNavigationContext();\n    const [count, setCount] = useState<number | undefined>(undefined);\n    const [error, setError] = useState<Error | undefined>(undefined);\n\n    useEffect(() => {\n        dataSource.countEntities({ path: navigation.resolveAliasesFrom(fullPath), collection }).then(setCount).catch(setError);\n    }, [fullPath, dataSource, navigation]);\n\n    if (error) {\n        return null;\n    }\n\n    return <Typography\n        sx={{\n            display: \"block\",\n            textOverflow: \"ellipsis\",\n            whiteSpace: \"nowrap\",\n            overflow: \"hidden\",\n            maxWidth: \"160px\",\n            textAlign: \"left\"\n        }}\n        variant={\"caption\"}\n        color={\"textSecondary\"}>\n        {count !== undefined ? `${count} entities` : renderSkeletonText()}\n    </Typography>;\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport {\n    CollectionSize,\n    Entity,\n    EntityCollection,\n    FilterValues\n} from \"../../types\";\nimport {\n    Box,\n    Button,\n    Typography,\n    useMediaQuery,\n    useTheme\n} from \"@mui/material\";\nimport { Add } from \"@mui/icons-material\";\n\nimport { EntityCollectionTable } from \"./EntityCollectionTable\";\nimport {\n    EntityCollectionRowActions\n} from \"./EntityCollectionTable/internal/EntityCollectionRowActions\";\nimport {\n    useAuthController,\n    useDataSource,\n    useFireCMSContext,\n    useNavigationContext,\n    useSideEntityController\n} from \"../../hooks\";\nimport { ErrorView } from \"./ErrorView\";\nimport { CustomDialogActions } from \"./CustomDialogActions\";\nimport { useSideDialogContext } from \"../SideDialogs\";\nimport { canCreateEntity, fullPathToCollectionSegments } from \"../util\";\nimport {\n    useSelectionController\n} from \"./EntityCollectionView/EntityCollectionView\";\nimport { useTableController } from \"./EntityCollectionTable/useTableController\";\nimport {\n    isFilterCombinationValidForFirestore\n} from \"./EntityCollectionView/isFilterCombinationValidForFirestore\";\n\n/**\n * @category Components\n */\nexport interface ReferenceSelectionInnerProps<M extends Record<string, any>> {\n\n    /**\n     * Allow multiple selection of values\n     */\n    multiselect?: boolean;\n\n    /**\n     * Entity collection config\n     */\n    collection?: EntityCollection<M>;\n\n    /**\n     * Absolute path of the collection.\n     * May be not set if this hook is being used in a component and the path is\n     * dynamic. If not set, the dialog won't open.\n     */\n    path: string;\n\n    /**\n     * If you are opening the dialog for the first time, you can select some\n     * entity ids to be displayed first.\n     */\n    selectedEntityIds?: string[];\n\n    /**\n     * If `multiselect` is set to `false`, you will get the selected entity\n     * in this callback.\n     * @param entity\n     * @callback\n        */\n    onSingleEntitySelected?(entity: Entity<any> | null): void;\n\n    /**\n     * If `multiselect` is set to `true`, you will get the selected entities\n     * in this callback.\n     * @param entities\n     * @callback\n        */\n    onMultipleEntitiesSelected?(entities: Entity<any>[]): void;\n\n    /**\n     * Allow selection of entities that pass the given filter only.\n     */\n    forceFilter?: FilterValues<string>;\n\n    /**\n     * Use this description to indicate the user what to do in this dialog.\n     */\n    description?: React.ReactNode;\n\n    /**\n     * Maximum number of entities that can be selected.\n     */\n    maxSelection?: number;\n\n}\n\n/**\n * This component allows to select entities from a given collection.\n * You probably want to open this dialog as a side view using {@link useReferenceDialog}\n * @category Components\n */\nexport function ReferenceSelectionInner<M extends Record<string, any>>(\n    {\n        onSingleEntitySelected,\n        onMultipleEntitiesSelected,\n        multiselect,\n        collection,\n        path: pathInput,\n        selectedEntityIds,\n        description,\n        forceFilter,\n        maxSelection\n    }: ReferenceSelectionInnerProps<M>) {\n\n    const sideDialogContext = useSideDialogContext();\n    const sideEntityController = useSideEntityController();\n    const navigation = useNavigationContext();\n    const context = useFireCMSContext();\n\n    const fullPath = navigation.resolveAliasesFrom(pathInput);\n\n    const dataSource = useDataSource();\n\n    const [entitiesDisplayedFirst, setEntitiesDisplayedFirst] = useState<Entity<any>[]>([]);\n\n    const selectionController = useSelectionController();\n\n    /**\n     * Fetch initially selected ids\n     */\n    useEffect(() => {\n        let unmounted = false;\n        if (selectedEntityIds && collection) {\n            Promise.all(\n                selectedEntityIds.map((entityId) =>\n                    dataSource.fetchEntity({\n                        path: fullPath,\n                        entityId,\n                        collection\n                    })))\n                .then((entities) => {\n                    if (!unmounted) {\n                        const result = entities.filter(e => e !== undefined) as Entity<any>[];\n                        selectionController.setSelectedEntities(result);\n                        setEntitiesDisplayedFirst(result);\n                    }\n                });\n        } else {\n            selectionController.setSelectedEntities([]);\n            setEntitiesDisplayedFirst([]);\n        }\n        return () => {\n            unmounted = true;\n        };\n    }, [dataSource, fullPath, selectedEntityIds, collection, selectionController.setSelectedEntities]);\n\n    const onClear = useCallback(() => {\n        context.onAnalyticsEvent?.(\"reference_selection_clear\", {\n            path: fullPath\n        });\n        selectionController.setSelectedEntities([]);\n        if (!multiselect && onSingleEntitySelected) {\n            onSingleEntitySelected(null);\n        } else if (onMultipleEntitiesSelected) {\n            onMultipleEntitiesSelected([]);\n        }\n    }, [multiselect, onMultipleEntitiesSelected, onSingleEntitySelected]);\n\n    const toggleEntitySelection = useCallback((entity: Entity<any>) => {\n        let newValue;\n        const selectedEntities = selectionController.selectedEntities;\n\n        context.onAnalyticsEvent?.(\"reference_selection_toggle\", {\n            path: fullPath,\n            entityId: entity.id\n        });\n        if (selectedEntities) {\n\n            if (selectedEntities.map((e) => e.id).indexOf(entity.id) > -1) {\n                newValue = selectedEntities.filter((item: Entity<any>) => item.id !== entity.id);\n            } else {\n                if (maxSelection && selectedEntities.length >= maxSelection)\n                    return;\n                newValue = [...selectedEntities, entity];\n            }\n            selectionController.setSelectedEntities(newValue);\n\n            if (onMultipleEntitiesSelected)\n                onMultipleEntitiesSelected(newValue);\n        }\n    }, [onMultipleEntitiesSelected, selectionController.selectedEntities]);\n\n    const onEntityClick = useCallback((entity: Entity<any>) => {\n\n        if (!multiselect && onSingleEntitySelected) {\n            context.onAnalyticsEvent?.(\"reference_selected_single\", {\n                path: fullPath,\n                entityId: entity.id\n            });\n            onSingleEntitySelected(entity);\n            sideDialogContext.close(false);\n        } else {\n            toggleEntitySelection(entity);\n        }\n    }, [sideDialogContext, multiselect, onSingleEntitySelected, toggleEntitySelection]);\n\n    // create a new entity from within the reference dialog\n    const onNewClick = useCallback(() => {\n            context.onAnalyticsEvent?.(\"reference_selection_new_entity\", {\n                path: fullPath\n            });\n            sideEntityController.open({\n                path: fullPath,\n                collection,\n                updateUrl: true,\n                onUpdate: ({ entity }) => {\n                    setEntitiesDisplayedFirst([entity, ...entitiesDisplayedFirst]);\n                    onEntityClick(entity);\n                },\n                closeOnSave: true\n            });\n        },\n        [sideEntityController, fullPath, collection, entitiesDisplayedFirst, onEntityClick]);\n\n    const tableRowActionsBuilder = useCallback(({\n                                                    entity,\n                                                    size,\n                                                    width,\n                                                    frozen\n                                                }: { entity: Entity<any>, size: CollectionSize, width: number, frozen?: boolean }) => {\n        const selectedEntities = selectionController.selectedEntities;\n        const isSelected = selectedEntities && selectedEntities.map(e => e.id).indexOf(entity.id) > -1;\n        return <EntityCollectionRowActions\n            width={width}\n            frozen={frozen}\n            entity={entity}\n            size={size}\n            isSelected={isSelected}\n            selectionEnabled={multiselect}\n            toggleEntitySelection={toggleEntitySelection}\n            hideId={collection?.hideIdFromCollection}\n        />;\n\n    }, [multiselect, selectionController.selectedEntities, toggleEntitySelection, collection?.hideIdFromCollection]);\n\n    const onDone = useCallback((event: React.SyntheticEvent) => {\n        event.stopPropagation();\n        sideDialogContext.close(false);\n    }, [sideDialogContext]);\n\n    if (!collection) {\n        return <ErrorView\n            error={\"Could not find collection with id \" + collection}/>\n    }\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const tableController = useTableController<M>({\n        fullPath,\n        collection,\n        entitiesDisplayedFirst,\n        isFilterCombinationValid: isFilterCombinationValidForFirestore,\n        forceFilter,\n    });\n\n    return (\n\n        <Box sx={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            height: \"100%\"\n        }}>\n\n            <Box sx={{ flexGrow: 1 }}>\n                {entitiesDisplayedFirst &&\n                    <EntityCollectionTable fullPath={fullPath}\n                                           onEntityClick={onEntityClick}\n                                           tableController={tableController}\n                                           tableRowActionsBuilder={tableRowActionsBuilder}\n                                           title={<Typography variant={\"h6\"}>\n                                               {collection.singularName ? `Select ${collection.singularName}` : `Select from ${collection.name}`}\n                                           </Typography>}\n                                           {...collection}\n                                           forceFilter={forceFilter}\n                                           inlineEditing={false}\n                                           selectionController={selectionController}\n                                           actions={<ReferenceDialogActions\n                                               collection={collection}\n                                               path={fullPath}\n                                               onNewClick={onNewClick}\n                                               onClear={onClear}/>\n                                           }\n                    />}\n            </Box>\n            <CustomDialogActions translucent={false}>\n                {description &&\n                    <Typography variant={\"body2\"} sx={{\n                        flexGrow: 1,\n                        textAlign: \"left\"\n                    }}>\n                        {description}\n                    </Typography>}\n                <Button\n                    onClick={onDone}\n                    color=\"primary\"\n                    variant=\"contained\">\n                    Done\n                </Button>\n            </CustomDialogActions>\n        </Box>\n\n    );\n\n}\n\nfunction ReferenceDialogActions({\n                                    collection,\n                                    path,\n                                    onClear,\n                                    onNewClick\n                                }: { collection: EntityCollection<any>, path: string, onClear: () => void, onNewClick: () => void }) {\n\n    const authController = useAuthController();\n\n    const theme = useTheme();\n    const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n\n    const addButton = canCreateEntity(collection, authController, fullPathToCollectionSegments(path), null) &&\n        onNewClick && (largeLayout\n            ? <Button\n                onClick={onNewClick}\n                startIcon={<Add/>}\n                size=\"large\"\n                variant=\"outlined\"\n                color=\"primary\">\n                Add {collection.singularName ?? collection.name}\n            </Button>\n            : <Button\n                onClick={onNewClick}\n                size=\"medium\"\n                variant=\"outlined\"\n                color=\"primary\"\n            >\n                <Add/>\n            </Button>);\n\n    return (\n        <>\n            <Button onClick={onClear}\n                    color=\"primary\">\n                Clear\n            </Button>\n            {addButton}\n        </>\n    );\n}\n","export function toArray<T>(input?: T | T[]):T[] {\n    return Array.isArray(input) ? input : (input ? [input] : []);\n}\n","import { Box, Typography } from \"@mui/material\";\nimport { PropsWithChildren } from \"react\";\nimport { ExpandablePanel } from \"../ExpandablePanel\";\nimport {\n    useUserConfigurationPersistence\n} from \"../../../hooks/useUserConfigurationPersistence\";\n\nexport function NavigationGroup({\n                                    children,\n                                    group\n                                }: PropsWithChildren<{ group: string | undefined }>) {\n    const userConfigurationPersistence = useUserConfigurationPersistence();\n    return (\n        <ExpandablePanel\n            invisible={true}\n            initiallyExpanded={!(userConfigurationPersistence?.collapsedGroups ?? []).includes(group ?? \"ungrouped\")}\n            onExpandedChange={expanded => {\n                if (userConfigurationPersistence) {\n\n                    if (!expanded) {\n                        const paths = (userConfigurationPersistence.collapsedGroups ?? []).concat(group ?? \"ungrouped\");\n                        userConfigurationPersistence.setCollapsedGroups(paths);\n                    } else {\n                        userConfigurationPersistence.setCollapsedGroups((userConfigurationPersistence.collapsedGroups ?? []).filter(g => g !== (group ?? \"ungrouped\")));\n                    } }\n            }}\n            title={<Typography color={\"textSecondary\"}\n                               className={\"weight-500\"}\n                               sx={{ ml: 1 }}>\n                {group?.toUpperCase() ?? \"Ungrouped views\".toUpperCase()}\n            </Typography>}>\n\n            <Box mb={2}>\n                {children}\n            </Box>\n        </ExpandablePanel>\n    );\n}\n","import {\n    Box,\n    CardActionArea,\n    CardActions,\n    CardContent,\n    IconButton,\n    Paper,\n    Typography\n} from \"@mui/material\";\nimport ArrowForwardIcon from \"@mui/icons-material/ArrowForward\";\nimport StarBorderIcon from \"@mui/icons-material/StarBorder\";\nimport StarIcon from \"@mui/icons-material/Star\";\n\nimport { useNavigate } from \"react-router-dom\";\n\nimport { Markdown } from \"../../../preview\";\nimport { useFireCMSContext } from \"../../../hooks\";\nimport { PluginHomePageActionsProps, TopNavigationEntry } from \"../../../types\";\nimport { getIconForView } from \"../../util\";\nimport {\n    useUserConfigurationPersistence\n} from \"../../../hooks/useUserConfigurationPersistence\";\n\n/**\n * This is the component used in the home page to render a card for each\n * collection.\n * @category Components\n * @param view\n * @param path\n * @param collection\n * @param url\n * @param name\n * @param description\n * @param onClick\n * @constructor\n */\nexport function NavigationCollectionCard({\n                                             view,\n                                             path,\n                                             collection,\n                                             url,\n                                             name,\n                                             description,\n                                             onClick\n                                         }: TopNavigationEntry & { onClick?: () => void }) {\n\n    const userConfigurationPersistence = useUserConfigurationPersistence();\n    const CollectionIcon = getIconForView(collection ?? view);\n\n    const navigate = useNavigate();\n    const context = useFireCMSContext();\n\n    const favourite = (userConfigurationPersistence?.favouritePaths ?? []).includes(path);\n\n    let actions: React.ReactNode | undefined;\n    if (context.plugins && collection) {\n        const actionProps: PluginHomePageActionsProps = {\n            path,\n            collection,\n            context\n        };\n        actions = <>\n            {context.plugins.map((plugin, i) => (\n                plugin.homePage?.CollectionActions\n                    ? <plugin.homePage.CollectionActions\n                        key={`actions_${i}`}\n                        {...actionProps}\n                        extraProps={plugin.homePage.extraProps}\n                    />\n                    : null\n            ))}\n        </>\n        ;\n    }\n\n    return (\n        <Paper elevation={0} sx={{\n            height: \"100%\"\n        }}>\n\n            <CardActionArea\n                component={\"div\"}\n                sx={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"flex-start\",\n                    minHeight: 248,\n                    height: \"100%\"\n                }}\n                onClick={() => {\n                    onClick?.();\n                    navigate(url);\n                    if (userConfigurationPersistence) {\n                        userConfigurationPersistence.setRecentlyVisitedPaths(\n                            [path, ...(userConfigurationPersistence.recentlyVisitedPaths ?? []).filter(p => p !== path)]\n                        );\n                    }\n                }}\n            >\n                <CardContent\n                    sx={{\n                        flexGrow: 1,\n                        width: \"100%\"\n                    }}>\n\n                    <Box sx={{\n                        height: 40,\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        width: \"100%\",\n                        justifyContent: \"space-between\"\n                    }}>\n\n                        <CollectionIcon color={\"disabled\"}/>\n\n                        <Box\n                            sx={{\n                                display: \"flex\",\n                                alignItems: \"center\",\n                                gap: 1\n                            }}\n                            onClick={(event: React.MouseEvent) => {\n                                event.preventDefault();\n                                event.stopPropagation();\n                            }}>\n                            {actions}\n                            {userConfigurationPersistence &&\n                                <IconButton size={\"small\"}\n                                            onClick={(e) => {\n                                                e.preventDefault();\n                                                e.stopPropagation();\n                                                if (favourite) {\n                                                    userConfigurationPersistence.setFavouritePaths(\n                                                        userConfigurationPersistence.favouritePaths.filter(p => p !== path)\n                                                    );\n                                                } else {\n                                                    userConfigurationPersistence.setFavouritePaths(\n                                                        [...userConfigurationPersistence.favouritePaths, path]\n                                                    );\n                                                }\n                                            }}>\n                                    {favourite\n                                        ? <StarIcon color={\"secondary\"}/>\n                                        : <StarBorderIcon color={\"disabled\"}/>}\n                                </IconButton>}\n                        </Box>\n\n                    </Box>\n\n                    <Typography gutterBottom variant=\"h5\"\n                                component=\"h2\">\n                        {name}\n                    </Typography>\n\n                    {description && <Typography variant=\"body2\"\n                                                color=\"textSecondary\"\n                                                component=\"div\">\n                        <Markdown source={description}/>\n                    </Typography>}\n                </CardContent>\n\n                <CardActions style={{ alignSelf: \"flex-end\" }}>\n\n                    <Box p={1}>\n                        <ArrowForwardIcon color=\"primary\"/>\n                    </Box>\n                </CardActions>\n\n            </CardActionArea>\n\n        </Paper>)\n        ;\n}\n","import { useNavigate } from \"react-router-dom\";\nimport { Box, Chip, Collapse, Grid } from \"@mui/material\";\nimport { useFireCMSContext, useNavigationContext } from \"../../../hooks\";\nimport {\n    useUserConfigurationPersistence\n} from \"../../../hooks/useUserConfigurationPersistence\";\nimport { TopNavigationEntry } from \"../../../types\";\nimport StarBorderIcon from \"@mui/icons-material/StarBorder\";\nimport StarIcon from \"@mui/icons-material/Star\";\nimport { NavigationGroup } from \"./NavigationGroup\";\nimport { NavigationCollectionCard } from \"./NavigationCollectionCard\";\n\nfunction NavigationChip({ entry }: { entry: TopNavigationEntry }) {\n\n    const navigate = useNavigate();\n    const userConfigurationPersistence = useUserConfigurationPersistence();\n\n    if (!userConfigurationPersistence)\n        return null;\n\n    const favourite = userConfigurationPersistence.favouritePaths.includes(entry.path);\n    return <Chip\n        key={entry.path}\n        label={entry.name}\n        onClick={() => navigate(entry.url)}\n        onDelete={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (favourite) {\n                userConfigurationPersistence.setFavouritePaths(\n                    userConfigurationPersistence.favouritePaths.filter(p => p !== entry.path)\n                );\n            } else {\n                userConfigurationPersistence.setFavouritePaths(\n                    [...userConfigurationPersistence.favouritePaths, entry.path]\n                );\n            }\n        }}\n        deleteIcon={favourite\n            ? <StarIcon color={\"secondary\"}/>\n            : <StarBorderIcon color={\"disabled\"}/>}\n    />;\n}\n\nexport function FavouritesView({ hidden }: { hidden: boolean }) {\n\n    const context = useFireCMSContext();\n    const navigationContext = useNavigationContext();\n    const userConfigurationPersistence = useUserConfigurationPersistence();\n\n    if (!userConfigurationPersistence)\n        return null;\n\n    const favouriteCollections = (userConfigurationPersistence?.favouritePaths ?? [])\n        .map((path) => navigationContext.topLevelNavigation?.navigationEntries.find((entry) => entry.path === path))\n        .filter(Boolean) as TopNavigationEntry[];\n\n    const recentCollections = ((userConfigurationPersistence?.recentlyVisitedPaths ?? [])\n        .map((path) => navigationContext.topLevelNavigation?.navigationEntries.find((entry) => entry.path === path))\n        .filter(Boolean) as TopNavigationEntry[])\n        .slice(0, 5);\n\n    const favouritesGroup = <Collapse\n        in={!hidden && favouriteCollections.length > 0}>\n        <NavigationGroup group={\"Favourites\"}>\n            <Grid container spacing={2}>\n                {favouriteCollections\n                    .map((entry) =>\n                        <Grid item\n                              xs={12}\n                              sm={6}\n                              lg={4}\n                              key={`nav_${entry.group}_${entry.name}`}>\n                            <NavigationCollectionCard {...entry}\n                                                      onClick={() => {\n                                                          const event = entry.type === \"collection\" ? \"home_favorite_navigate_to_collection\" : (entry.type === \"view\" ? \"home_favorite_navigate_to_view\" : \"unmapped_event\");\n                                                          context.onAnalyticsEvent?.(event, { path: entry.path });\n                                                      }}/>\n                        </Grid>)\n                }\n\n            </Grid>\n        </NavigationGroup>\n    </Collapse>;\n\n    return <Box>\n        <Box sx={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            flexWrap: \"wrap\",\n            gap: 1,\n            pb: 2\n        }}>\n            {recentCollections.map((entry) => <NavigationChip key={entry.path}\n                                                              entry={entry}/>)}\n        </Box>\n        {favouritesGroup}\n    </Box>;\n}\n","import React, { useCallback, useEffect } from \"react\";\nimport { useLocation } from \"react-router-dom\";\n\nexport function useRestoreScroll() {\n\n    const scrollsMap = React.useRef<Record<string, number>>({});\n\n    const location = useLocation();\n\n    const containerRef = React.createRef<HTMLDivElement>();\n    const [scroll, setScroll] = React.useState(0);\n    const [direction, setDirection] = React.useState<\"up\" | \"down\">(\"down\");\n\n    const handleScroll = useCallback(() => {\n        if (!containerRef.current || !location.key) return;\n        scrollsMap.current[location.key] = containerRef.current.scrollTop;\n        setScroll(containerRef.current.scrollTop);\n        setDirection(containerRef.current.scrollTop > scroll ? \"down\" : \"up\");\n    }, [containerRef, location.key, scroll]);\n\n    useEffect(() => {\n        const container = containerRef.current;\n        if (!container) return;\n        container.addEventListener(\"scroll\", handleScroll, { passive: true });\n\n        return () => {\n            if (container)\n                container.removeEventListener(\"scroll\", handleScroll);\n        };\n    }, [containerRef, handleScroll, location]);\n\n    useEffect(() => {\n        if (!containerRef.current || !scrollsMap.current || !scrollsMap.current[location.key]) return;\n        containerRef.current.scrollTo(\n            {\n                top: scrollsMap.current[location.key],\n                behavior: \"auto\"\n            });\n    }, [location]);\n\n    return {\n        containerRef,\n        scroll,\n        direction\n    };\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\n\nimport { Box, Container, Grid } from \"@mui/material\";\n\nimport { useFireCMSContext, useNavigationContext } from \"../../../hooks\";\nimport { PluginGenericProps, PluginHomePageAdditionalCardsProps } from \"../../../types\";\n\nimport { toArray } from \"../../util/arrays\";\nimport { NavigationGroup } from \"./NavigationGroup\";\nimport { NavigationCollectionCard } from \"./NavigationCollectionCard\";\n\n// @ts-ignore\nimport * as JsSearch from \"js-search\";\n\nimport { SearchBar } from \"../EntityCollectionTable/internal/SearchBar\";\nimport { FavouritesView } from \"./FavouritesView\";\nimport { useRestoreScroll } from \"../../internal/useRestoreScroll\";\n\nconst search = new JsSearch.Search(\"home\");\nsearch.addIndex(\"name\");\nsearch.addIndex(\"description\");\nsearch.addIndex(\"group\");\nsearch.addIndex(\"path\");\n\n/**\n * Default entry view for the CMS. This component renders navigation cards\n * for each collection defined in the navigation.\n * @constructor\n * @category Components\n */\nexport function FireCMSHomePage({ additionalChildrenStart, additionalChildrenEnd }: { additionalChildrenStart?: React.ReactNode, additionalChildrenEnd?: React.ReactNode }) {\n\n    const context = useFireCMSContext();\n    const navigationContext = useNavigationContext();\n\n    if (!navigationContext.topLevelNavigation)\n        throw Error(\"Navigation not ready in FireCMSHomePage\");\n\n    const {\n        containerRef,\n        scroll,\n        direction\n    } = useRestoreScroll();\n\n    const {\n        navigationEntries,\n        groups\n    } = navigationContext.topLevelNavigation;\n\n    const [filteredUrls, setFilteredUrls] = useState<string[] | null>(null);\n\n    const filteredNavigationEntries = filteredUrls\n        ? navigationEntries.filter((entry) => filteredUrls.includes(entry.url))\n        : navigationEntries;\n\n    useEffect(() => {\n        search.addDocuments(filteredNavigationEntries);\n    }, [navigationEntries]);\n\n    const updateSearchResults = useCallback(\n        (value?: string) => {\n            if (!value || value === \"\") {\n                setFilteredUrls(null);\n            } else {\n                setFilteredUrls(search.search(value).map((e: any) => e.url));\n            }\n        }, []);\n\n    const allGroups: Array<string | undefined> = [...groups];\n    if (filteredNavigationEntries.filter(e => !e.group).length > 0 || filteredNavigationEntries.length === 0) {\n        allGroups.push(undefined);\n    }\n\n    let additionalSections: React.ReactNode | undefined;\n    if (context.plugins) {\n        const sectionProps: PluginGenericProps = {\n            context\n        };\n        additionalSections = <>\n            {context.plugins.filter(plugin => plugin.homePage?.includeSection)\n                .map((plugin, i) => {\n                    const section = plugin.homePage!.includeSection!(sectionProps)\n                    return (\n                        <NavigationGroup\n                            group={section.title}\n                            key={`plugin_section_${plugin.name}`}>\n                            {section.children}\n                        </NavigationGroup>\n                    );\n                })}\n        </>\n        ;\n    }\n\n    return (\n        <Box ref={containerRef}\n             sx={{\n                 py: 2,\n                 overflow: \"auto\",\n                 height: \"100%\",\n                 width: \"100%\"\n             }}>\n            <Container>\n\n                <Box sx={{\n                    position: \"sticky\",\n                    py: 2,\n                    transition: \"top 0.4s ease-in-out\",\n                    top: 0,\n                    // top: direction === \"down\" ? -84 : 0,\n                    zIndex: 10\n                }}>\n                    <SearchBar onTextSearch={updateSearchResults}\n                               placeholder={\"Search collections\"}\n                               large={false}/>\n                </Box>\n\n                <FavouritesView hidden={Boolean(filteredUrls)}/>\n\n                {additionalChildrenStart}\n\n                {allGroups.map((group, index) => {\n\n                    const AdditionalCards: React.ComponentType<PluginHomePageAdditionalCardsProps>[] = [];\n                    const actionProps: PluginHomePageAdditionalCardsProps = {\n                        group,\n                        context\n                    };\n\n                    if (context.plugins) {\n                        context.plugins.forEach(plugin => {\n                            if (plugin.homePage?.AdditionalCards) {\n                                AdditionalCards.push(...toArray(plugin.homePage?.AdditionalCards));\n                            }\n                        });\n                    }\n\n                    const thisGroupCollections = filteredNavigationEntries\n                        .filter((entry) => entry.group === group || (!entry.group && group === undefined));\n                    if (thisGroupCollections.length === 0 && AdditionalCards.length === 0)\n                        return null;\n                    return (\n                        <NavigationGroup\n                            group={group}\n                            key={`plugin_section_${group}`}>\n                            <Grid container spacing={2}>\n                                {thisGroupCollections // so we don't miss empty groups\n                                    .map((entry) =>\n                                        <Grid item\n                                              xs={12}\n                                              sm={6}\n                                              lg={4}\n                                              key={`nav_${entry.group}_${entry.name}`}>\n                                            <NavigationCollectionCard {...entry}\n                                                                      onClick={() => {\n                                                                          const event = entry.type === \"collection\" ? \"home_navigate_to_collection\" : (entry.type === \"view\" ? \"home_navigate_to_view\" : \"unmapped_event\");\n                                                                          context.onAnalyticsEvent?.(event, { path: entry.path });\n                                                                      }}/>\n                                        </Grid>)\n                                }\n                                {AdditionalCards && AdditionalCards.map((AdditionalCard, i) => (\n                                    <Grid item\n                                          xs={12}\n                                          sm={6}\n                                          lg={4}\n                                          key={`nav_${group}_\"add_${i}`}>\n                                        <AdditionalCard {...actionProps}/>\n                                    </Grid>\n                                ))}\n\n                            </Grid>\n                        </NavigationGroup>\n                    );\n                })}\n\n                {additionalSections}\n\n                {additionalChildrenEnd}\n\n            </Container>\n        </Box>\n    );\n}\n","import React, { PropsWithChildren } from \"react\";\nimport { useBreadcrumbsContext } from \"../../hooks\";\n\nexport interface BreadcrumbUpdaterProps {\n    title: string;\n    path: string;\n}\n\n/**\n * This component updates the breadcrumb in the app bar when rendered\n * @param children\n * @param title\n * @param path\n * @constructor\n * @category Components\n */\nexport function BreadcrumbUpdater({\n                                      children,\n                                      title,\n                                      path\n                                  }\n                                      : PropsWithChildren<BreadcrumbUpdaterProps>) {\n\n    const breadcrumbsContext = useBreadcrumbsContext();\n    React.useEffect(() => {\n        breadcrumbsContext.set({\n            breadcrumbs: [{\n                title: title,\n                url: path\n            }]\n        });\n    }, [path, title]);\n\n    return <>{children}</>;\n}\n","import React from \"react\";\nimport { Box, Button, Typography } from \"@mui/material\";\nimport { Link as ReactLink } from \"react-router-dom\";\n\nexport function NotFoundPage() {\n\n    return (\n        <Box\n            display=\"flex\"\n            width={\"100%\"}\n            height={\"100%\"}>\n            <Box m=\"auto\"\n                 display=\"flex\"\n                 alignItems={\"center\"}\n                 flexDirection={\"column\"}>\n                <Typography variant={\"h4\"} align={\"center\"} gutterBottom={true}>\n                    Page not found\n                </Typography>\n                <Typography align={\"center\"} gutterBottom={true}>\n                    This page does not exist or you may not have access to it\n                </Typography>\n                <Button\n                    component={ReactLink}\n                    to={\"/\"}>Back to home</Button>\n            </Box>\n        </Box>\n    );\n}\n","import React from \"react\";\nimport {\n    Button,\n    Dialog,\n    DialogContent,\n    DialogContentText,\n    DialogTitle\n} from \"@mui/material\";\n\nimport { CustomDialogActions } from \"./CustomDialogActions\";\nimport { LoadingButton } from \"@mui/lab\";\n\nexport function DeleteConfirmationDialog({\n                                             open,\n                                             onAccept,\n                                             onCancel,\n                                             title,\n                                             loading,\n                                             body\n                                         }: {\n    open: boolean,\n    onAccept: () => void,\n    onCancel: () => void,\n    loading?: boolean,\n    title: React.ReactNode,\n    body?: React.ReactNode,\n}) {\n    return (\n        <Dialog\n            open={open}\n            onClose={onCancel}\n        >\n            <DialogTitle>\n                {title}\n            </DialogTitle>\n            {body && <DialogContent>\n                <DialogContentText>\n                    {body}\n                </DialogContentText>\n            </DialogContent>}\n            <CustomDialogActions>\n                <Button\n                    onClick={onCancel}\n                    autoFocus>Cancel</Button>\n\n                <LoadingButton\n                    variant=\"contained\"\n                    color=\"primary\"\n                    type=\"submit\"\n                    loading={loading}\n                    onClick={onAccept}\n                >\n                    Ok\n                </LoadingButton>\n            </CustomDialogActions>\n        </Dialog>\n    );\n}\n","import React from \"react\";\n\nexport function FireCMSLogo({\n                                width,\n                                height,\n                                style\n                            }: { width?: string, height?: string, style?: React.CSSProperties }) {\n    return (\n        <svg\n            width={width ?? \"100%\"} height={height ?? \"100%\"}\n            viewBox=\"0 0 599 599\" version=\"1.1\"\n            style={style}\n            xmlns=\"http://www.w3.org/2000/svg\">\n            <defs>\n                <radialGradient cx=\"28.6213569%\" cy=\"43.1133328%\"\n                                fx=\"28.6213569%\"\n                                fy=\"43.1133328%\" r=\"71.5003456%\"\n                                gradientTransform=\"translate(0.286214,0.431133),rotate(3.343450),scale(1.000000,0.996175),translate(-0.286214,-0.431133)\"\n                                id=\"radialGradient-1\">\n                    <stop stopColor=\"#FF5B79\" offset=\"0%\"/>\n                    <stop stopColor=\"#FA5574\" offset=\"28.0930803%\"/>\n                    <stop stopColor=\"#EC4C51\" offset=\"44.7242531%\"/>\n                    <stop stopColor=\"#9543C1\" offset=\"71.4578165%\"/>\n                    <stop stopColor=\"#3857B3\" offset=\"100%\"/>\n                </radialGradient>\n                <radialGradient cx=\"53.6205516%\" cy=\"47.2473036%\"\n                                fx=\"53.6205516%\"\n                                fy=\"47.2473036%\" r=\"50.8229649%\"\n                                gradientTransform=\"translate(0.536206,0.472473),rotate(90.000000),scale(1.000000,1.206631),translate(-0.536206,-0.472473)\"\n                                id=\"radialGradient-2\">\n                    <stop stopColor=\"#68294F\" stopOpacity=\"0\" offset=\"0%\"/>\n                    <stop stopColor=\"#5E2548\" stopOpacity=\"0.04641108\"\n                          offset=\"75.3503173%\"/>\n                    <stop stopColor=\"#0D060B\" stopOpacity=\"0.437431709\"\n                          offset=\"100%\"/>\n                </radialGradient>\n                <radialGradient cx=\"53.8605015%\" cy=\"48.1990423%\"\n                                fx=\"53.8605015%\"\n                                fy=\"48.1990423%\" r=\"59.9151549%\"\n                                gradientTransform=\"translate(0.538605,0.481990),rotate(180.000000),scale(1.000000,0.925027),translate(-0.538605,-0.481990)\"\n                                id=\"radialGradient-3\">\n                    <stop stopColor=\"#68294F\" stopOpacity=\"0\" offset=\"0%\"/>\n                    <stop stopColor=\"#5E2548\" stopOpacity=\"0.04641108\"\n                          offset=\"84.0867343%\"/>\n                    <stop stopColor=\"#FF0000\" stopOpacity=\"0.567324765\"\n                          offset=\"100%\"/>\n                </radialGradient>\n            </defs>\n            <g id=\"Page-1\" stroke=\"none\" strokeWidth=\"1\" fill=\"none\"\n               fillRule=\"evenodd\">\n                <g id=\"firecms_logo\">\n                    <circle fill=\"url(#radialGradient-1)\" cx=\"299.5\"\n                            cy=\"299.5\"\n                            r=\"299.5\"/>\n                    <circle fill=\"url(#radialGradient-2)\" cx=\"299.5\"\n                            cy=\"299.5\"\n                            r=\"299.5\"/>\n                    <circle fill=\"url(#radialGradient-3)\" cx=\"299.5\"\n                            cy=\"299.5\"\n                            r=\"299.5\"/>\n                </g>\n            </g>\n        </svg>\n    );\n\n}\n","import React from \"react\";\n\nimport { Box, Fade } from \"@mui/material\";\n\nexport function CenteredView({\n                                 children,\n                                 maxWidth,\n                                 fullScreen = false,\n                                 fadeTimeout = 800\n                             }: {\n    children: React.ReactNode;\n    maxWidth?: number | string | object;\n    fullScreen?: boolean,\n    fadeTimeout?: number\n}) {\n\n    return (\n        <Fade\n            in={true}\n            appear={true}\n            timeout={fadeTimeout}\n            mountOnEnter\n            unmountOnExit>\n            <Box\n                sx={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    height: fullScreen ? \"100vh\" : \"100%\",\n                    \"@supports (height: 100dvh)\": {\n                        height: fullScreen ? \"100dvh\" : \"100%\"\n                    },\n                    justifyContent: !maxWidth ? \"center\" : undefined,\n                    maxHeight: \"100%\",\n                    gap: 2,\n                    p: 2\n                }}>\n                {maxWidth && <Box sx={{\n                    width: \"100%\",\n                    margin: \"auto\",\n                    maxWidth\n                }}>\n                    {children}\n                </Box>}\n\n                {!maxWidth && children}\n            </Box>\n        </Fade>\n    );\n\n}\n","import { Box, useTheme } from \"@mui/material\";\n\nexport function InfoLabel({\n                              children,\n                              mode = \"info\"\n                          }: { children: React.ReactNode, mode?: \"info\" | \"warn\" }) {\n\n    const theme = useTheme();\n    const background = mode === \"info\"\n        ? (theme.palette.mode === \"dark\" ? \"#193c47\" : \"#b9f4fe\")\n        : (theme.palette.mode === \"dark\" ? \"#4d3800\" : \"#f9e3b9\");\n\n    return (\n        <Box\n            sx={(theme) => ({\n                my: 3,\n                py: 1,\n                px: 2,\n                borderRadius: 1,\n                background\n            })}>\n            {children}\n        </Box>\n    )\n}\n","import React, { useCallback } from \"react\";\n\nimport { NavLink } from \"react-router-dom\";\nimport {\n    Box,\n    darken,\n    lighten,\n    List,\n    ListItem,\n    SvgIconTypeMap,\n    Tooltip,\n    Typography,\n    useTheme\n} from \"@mui/material\";\nimport { useFireCMSContext, useNavigationContext } from \"../hooks\";\nimport {\n    CMSAnalyticsEvent,\n    TopNavigationEntry,\n    TopNavigationResult\n} from \"../types\";\nimport { getIconForView } from \"./util\";\nimport { grey } from \"@mui/material/colors\";\n\n/**\n * Props used in case you need to override the default drawer\n * @category Core\n */\nexport type DrawerProps<T = {}> = T & {\n    hovered: boolean,\n    drawerOpen: boolean,\n    closeDrawer: () => any,\n}\n\n/**\n * Default drawer used in the CMS\n * @category Core\n */\nexport function Drawer({\n                           hovered,\n                           drawerOpen,\n                           closeDrawer\n                       }: DrawerProps) {\n\n    const context = useFireCMSContext();\n    const navigation = useNavigationContext();\n\n    const tooltipsOpen = hovered && !drawerOpen;\n\n    if (!navigation.topLevelNavigation)\n        throw Error(\"Navigation not ready in Drawer\");\n\n    const {\n        navigationEntries,\n        groups\n    }: TopNavigationResult = navigation.topLevelNavigation;\n\n    const ungroupedNavigationViews = Object.values(navigationEntries).filter(e => !e.group);\n\n    const buildGroupHeader = useCallback((group?: string) => {\n        if (!drawerOpen) return <Box sx={{ height: 16 }}/>;\n        return <Box pt={2} pl={2} pr={2} pb={0.5} sx={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            alignItems: \"center\"\n        }}>\n            <Typography variant={\"caption\"}\n                        color={\"textSecondary\"}\n                        className={\"weight-500\"}\n                        sx={{ flexGrow: 1 }}>\n                {group ? group.toUpperCase() : \"Ungrouped views\".toUpperCase()}\n            </Typography>\n\n        </Box>;\n    }, [drawerOpen]);\n\n    const onClick = (view: TopNavigationEntry) => {\n        const eventName: CMSAnalyticsEvent = view.type === \"collection\"\n            ? \"drawer_navigate_to_collection\"\n            : (view.type === \"view\" ? \"drawer_navigate_to_view\" : \"unmapped_event\");\n        context.onAnalyticsEvent?.(eventName, { url: view.url });\n    };\n\n    return (\n        <List>\n\n            {groups.map((group) => (\n                <React.Fragment\n                    key={`drawer_group_${group}`}>\n                    {buildGroupHeader(group)}\n                    {Object.values(navigationEntries)\n                        .filter(e => e.group === group)\n                        .map((view, index) =>\n                            <DrawerNavigationItem\n                                key={`navigation_${index}`}\n                                Icon={getIconForView(view.collection ?? view.view)}\n                                tooltipsOpen={tooltipsOpen}\n                                drawerOpen={drawerOpen}\n                                onClick={() => onClick(view)}\n                                url={view.url}\n                                name={view.name}/>)}\n                </React.Fragment>\n            ))}\n\n            {ungroupedNavigationViews.length > 0 && buildGroupHeader()}\n\n            {ungroupedNavigationViews.map((view, index) => {\n\n                return <DrawerNavigationItem\n                    key={`navigation_${index}`}\n                    Icon={getIconForView(view.collection ?? view.view)}\n                    tooltipsOpen={tooltipsOpen}\n                    onClick={() => onClick(view)}\n                    drawerOpen={drawerOpen}\n                    url={view.url}\n                    name={view.name}/>;\n            })}\n\n        </List>\n    );\n}\n\nexport function DrawerNavigationItem({\n                                         name,\n                                         Icon,\n                                         drawerOpen,\n                                         tooltipsOpen,\n                                         url,\n                                         onClick\n                                     }: {\n    Icon: React.ComponentType<SvgIconTypeMap[\"props\"]>,\n    name: string,\n    tooltipsOpen: boolean,\n    drawerOpen: boolean,\n    url: string,\n    onClick?: () => void,\n}) {\n\n    const theme = useTheme();\n    const icon = <Icon fontSize={\"medium\"}\n                       sx={theme => ({ color: theme.palette.mode === \"dark\" ? grey[500] : grey[700] })}/>;\n    const listItem = <ListItem\n        // @ts-ignore\n        button\n        component={NavLink}\n        onClick={onClick}\n        // @ts-ignore\n        style={({ isActive }) => ({\n            fontWeight: isActive ? \"600\" : \"500\",\n            background: isActive\n                ? (theme.palette.mode === \"light\"\n                    ? darken(theme.palette.background.default, 0.1)\n                    : lighten(theme.palette.background.default, 0.08))\n                : \"inherit\",\n            minHeight: \"48px\",\n            borderRadius: \"0 16px 16px 0\"\n        })}\n        sx={theme => ({\n            pl: 3,\n            alignItems: \"center\"\n        })}\n        to={url}\n    >\n\n        {icon}\n\n        <Typography\n            variant={\"subtitle2\"}\n            sx={{\n                opacity: drawerOpen ? 1.0 : 0.0,\n                fontWeight: \"inherit\",\n                ml: 3,\n                p: 0.5\n            }}>\n            {name.toUpperCase()}\n        </Typography>\n    </ListItem>;\n\n    if (drawerOpen)\n        return listItem;\n    else\n        return <Tooltip\n            open={tooltipsOpen}\n            placement=\"right\"\n            title={name}>\n            {listItem}\n        </Tooltip>;\n}\n","import React, { PropsWithChildren, useCallback } from \"react\";\nimport equal from \"react-fast-compare\"\n\nimport {\n    alpha,\n    Box,\n    Drawer as MuiDrawer,\n    DrawerProps as MuiDrawerProps,\n    Link,\n    Toolbar,\n    Tooltip,\n    useMediaQuery,\n    useTheme\n} from \"@mui/material\";\nimport { Drawer as FireCMSDrawer, DrawerProps } from \"./Drawer\";\nimport { NavLink } from \"react-router-dom\";\nimport { useFireCMSContext, useNavigationContext } from \"../hooks\";\nimport {\n    CircularProgressCenter,\n    ErrorBoundary,\n    FireCMSAppBar,\n    FireCMSAppBarProps,\n    FireCMSLogo\n} from \"./components\";\nimport { CSSObject, styled, Theme } from \"@mui/material/styles\";\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\nimport MenuIcon from \"@mui/icons-material/Menu\";\nimport IconButton from \"@mui/material/IconButton\";\nimport ChevronLeftIcon from \"@mui/icons-material/ChevronLeft\";\nimport ChevronRightIcon from \"@mui/icons-material/ChevronRight\";\nimport { useRestoreScroll } from \"./internal/useRestoreScroll\";\n\nexport const DRAWER_WIDTH = 280;\n\n/**\n * @category Core\n */\nexport interface ScaffoldProps<ExtraDrawerProps = {}> {\n\n    /**\n     * Name of the app, displayed as the main title and in the tab title\n     */\n    name: string;\n\n    /**\n     * Logo to be displayed in the drawer of the CMS\n     */\n    logo?: string;\n\n    /**\n     * A component that gets rendered on the upper side of the main toolbar\n     */\n    toolbarExtraWidget?: React.ReactNode;\n\n    /**\n     * In case you need to override the view that gets rendered as a drawer\n     * @see FireCMSDrawer\n     */\n    Drawer?: React.ComponentType<DrawerProps<ExtraDrawerProps>>;\n\n    /**\n     * Additional props passed to the custom Drawer\n     */\n    drawerProps?: ExtraDrawerProps;\n\n    /**\n     * Open the drawer on hover\n     */\n    autoOpenDrawer?: boolean;\n\n    /**\n     * A component that gets rendered on the upper side of the main toolbar.\n     * `toolbarExtraWidget` has no effect if this is set.\n     */\n    FireCMSAppBarComponent?: React.ComponentType<FireCMSAppBarProps>;\n\n}\n\n/**\n * This view acts as a scaffold for FireCMS.\n *\n * It is in charge of displaying the navigation drawer, top bar and main\n * collection views.\n * This component needs a parent {@link FireCMS}\n *\n * @param props\n * @constructor\n * @category Core\n */\n\nexport const Scaffold = React.memo<PropsWithChildren<ScaffoldProps>>(\n    function Scaffold(props: PropsWithChildren<ScaffoldProps>) {\n\n        const {\n            children,\n            name,\n            logo,\n            toolbarExtraWidget,\n            Drawer,\n            autoOpenDrawer,\n            FireCMSAppBarComponent = FireCMSAppBar,\n        } = props;\n\n        const theme = useTheme();\n        const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n\n        const navigation = useNavigationContext();\n        const { containerRef } = useRestoreScroll();\n\n        const [drawerOpen, setDrawerOpen] = React.useState(false);\n        const [onHover, setOnHover] = React.useState(false);\n\n        const setOnHoverTrue = useCallback(() => setOnHover(true), []);\n        const setOnHoverFalse = useCallback(() => setOnHover(false), []);\n\n        const UsedDrawer = Drawer || FireCMSDrawer;\n\n        const handleDrawerClose = useCallback(() => {\n            setDrawerOpen(false);\n        }, []);\n\n        const computedDrawerOpen: boolean = drawerOpen || Boolean(largeLayout && autoOpenDrawer && onHover);\n        return (\n            <Box\n                sx={{\n                    display: \"flex\",\n                    height: \"100vh\",\n                    \"@supports (height: 100dvh)\": {\n                        height: \"100dvh\"\n                    },\n                    width: \"100vw\",\n                    pt: \"env(safe-area-inset-top)\",\n                    pl: \"env(safe-area-inset-left)\",\n                    pr: \"env(safe-area-inset-right)\",\n                    pb: \"env(safe-area-inset-bottom)\"\n                }}>\n\n                <FireCMSAppBarComponent title={name}\n                                        drawerOpen={computedDrawerOpen}\n                                        toolbarExtraWidget={toolbarExtraWidget}/>\n\n                <StyledDrawer\n                    onMouseEnter={setOnHoverTrue}\n                    onMouseMove={setOnHoverTrue}\n                    onMouseLeave={setOnHoverFalse}\n                    open={computedDrawerOpen}\n                    logo={logo}\n                    hovered={autoOpenDrawer ? onHover : false}\n                    setDrawerOpen={setDrawerOpen}>\n                    <nav>\n                        {navigation.loading\n                            ? <CircularProgressCenter/>\n                            : <UsedDrawer\n                                hovered={onHover}\n                                drawerOpen={computedDrawerOpen}\n                                closeDrawer={handleDrawerClose}/>}\n                    </nav>\n                </StyledDrawer>\n\n                <Box component={\"main\"}\n                     sx={{\n                         display: \"flex\",\n                         flexDirection: \"column\",\n                         flexGrow: 1,\n                         width: \"100%\",\n                         height: \"100%\",\n                         overflow: \"auto\"\n                     }}>\n                    <DrawerHeader/>\n                    <Box\n                        ref={containerRef}\n                        sx={{\n                            flexGrow: 1,\n                            m: largeLayout ? 2 : 0,\n                            mt: largeLayout ? 0 : 1,\n                            borderRadius: largeLayout ? \"12px\" : undefined,\n                            border: largeLayout ? `1px solid ${theme.palette.divider}` : undefined,\n                            height: \"100%\",\n                            overflow: \"auto\"\n                        }}>\n\n                        <ErrorBoundary>\n                            {children}\n                        </ErrorBoundary>\n\n                    </Box>\n                </Box>\n            </Box>\n        );\n    },\n    equal\n)\n\nconst DrawerHeader = styled(\"div\")(({ theme }) => ({\n    display: \"flex\",\n    flexDirection: \"column\",\n    // alignItems: \"center\",\n    // justifyContent: \"flex-end\",\n    // padding: theme.spacing(4, 12, 1, 3),\n    // necessary for content to be below app bar\n    ...theme.mixins.toolbar\n}));\n\nfunction StyledDrawer(props: MuiDrawerProps & {\n    logo?: string,\n    hovered: boolean,\n    setDrawerOpen: (open: boolean) => void,\n}) {\n    const context = useFireCMSContext();\n    const theme = useTheme();\n    const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n\n    const {\n        open,\n        logo,\n        setDrawerOpen,\n        hovered,\n        ...drawerProps\n    } = props;\n\n    let logoComponent;\n    if (logo) {\n        logoComponent = <img\n            style={{\n                maxWidth: \"100%\",\n                maxHeight: \"100%\"\n            }}\n            src={logo}\n            alt={\"Logo\"}/>;\n    } else {\n        logoComponent = <FireCMSLogo/>;\n    }\n\n    const menuIconButton = <IconButton\n        color=\"inherit\"\n        aria-label=\"Open drawer\"\n        edge=\"start\"\n        onClick={() => setDrawerOpen(true)}\n        size=\"large\"\n        sx={{\n            position: \"absolute\",\n            top: 8,\n            left: 24\n        }}>\n        <MenuIcon/>\n    </IconButton>;\n\n    return <>\n\n        {!largeLayout && menuIconButton}\n\n        <MuiDrawer\n            {...drawerProps}\n            variant={largeLayout ? \"permanent\" : \"temporary\"}\n            open={open}\n            onClose={!largeLayout\n                ? () => {\n                    setDrawerOpen(false);\n                }\n                : undefined}\n            sx={{\n                width: DRAWER_WIDTH,\n                flexShrink: 0,\n                height: \"100%\",\n                whiteSpace: \"nowrap\",\n                boxSizing: \"border-box\",\n                border: \"none\",\n                ...(open && {\n                    ...openedMixin(theme),\n                    \"& .MuiDrawer-paper\": openedMixin(theme)\n                }),\n                ...(!open && {\n                    ...closedMixin(theme, largeLayout),\n                    \"& .MuiDrawer-paper\": closedMixin(theme, largeLayout)\n                })\n            }}\n        >\n\n            <IconButton onClick={() => setDrawerOpen(false)}\n                        sx={{\n                            position: \"absolute\",\n                            right: 16,\n                            top: 16,\n                            opacity: open ? 1.0 : 0.0,\n                            transition: theme.transitions.create(\"opacity\", {\n                                easing: theme.transitions.easing.sharp,\n                                duration: theme.transitions.duration.enteringScreen\n                            })\n                        }}>\n                {theme.direction === \"rtl\"\n                    ? <ChevronRightIcon/>\n                    : <ChevronLeftIcon/>}\n            </IconButton>\n\n            <Toolbar sx={{\n                position: \"absolute\",\n                left: open ? \"-100%\" : 0,\n                right: open ? undefined : 0,\n                opacity: open ? 0.0 : 1.0,\n                backgroundColor: theme.palette.background.default,\n                transition: theme.transitions.create([\"left\", \"opacity\"], {\n                    easing: theme.transitions.easing.sharp,\n                    duration: theme.transitions.duration.enteringScreen\n                })\n            }}>\n                {!open\n                    ? <Tooltip title={\"Open menu\"}\n                               placement={\"right\"}>\n                        {menuIconButton}\n                    </Tooltip>\n                    : menuIconButton}\n            </Toolbar>\n\n            <Box sx={{ height: \"100%\", width: \"100%\", overflow: \"auto\" }}>\n                <Link\n                    key={\"breadcrumb-home\"}\n                    color=\"inherit\"\n                    component={NavLink}\n                    to={\".\"}\n                    sx={theme => ({\n                        display: \"block\",\n                        transition: theme.transitions.create([\"padding\"], {\n                            easing: theme.transitions.easing.sharp,\n                            duration: theme.transitions.duration.enteringScreen\n                        }),\n                        p: theme.spacing(\n                            open ? 4 : 9,\n                            open ? 12 : 2,\n                            0,\n                            open ? 3 : 2)\n                    })}>\n                    <Tooltip title={\"Home\"} placement={\"right\"}>\n                        <div onClick={() => {\n                            context.onAnalyticsEvent?.(\"drawer_navigate_to_home\");\n                        }}>\n                            {logoComponent}\n                        </div>\n                    </Tooltip>\n\n                </Link>\n                {props.children}\n            </Box>\n\n            <Link sx={(theme) => ({\n                width: DRAWER_WIDTH,\n                position: \"fixed\",\n                bottom: 0,\n                left: open ? 0 : \"-100%\",\n                opacity: open ? 1.0 : 0.0,\n                transition: theme.transitions.create([\"left\", \"opacity\"], {\n                    easing: theme.transitions.easing.sharp,\n                    duration: theme.transitions.duration.enteringScreen\n                }),\n                px: \"24px\",\n                py: 1,\n                display: \"flex\",\n                alignItems: \"center\",\n                fontWeight: theme.typography.fontWeightMedium,\n                background: theme.palette.mode === \"light\" ? \"rgba(255,255,255,0.6)\" : alpha(theme.palette.background.paper, 0.1),\n                backdropFilter: \"blur(8px)\"\n                // borderTop: `1px solid ${theme.palette.divider}`\n            })}\n                  href={\"https://firecms.co?utm_source=drawer\"}\n                  onMouseDown={(e: React.MouseEvent) => {\n                      e.preventDefault();\n                  }}\n                  target=\"_blank\">\n                <OpenInNewIcon style={{ marginRight: \"24px\" }}\n                               fontSize={\"small\"}/>\n                firecms.co\n            </Link>\n\n        </MuiDrawer>\n    </>;\n}\n\nconst openedMixin = (theme: Theme): CSSObject => ({\n    willChange: \"width\",\n    pb: \"32px\",\n    width: DRAWER_WIDTH,\n    border: \"none\",\n    transition: theme.transitions.create(\"width\", {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.enteringScreen\n    }),\n    backgroundColor: theme.palette.background.default,\n    overflowX: \"hidden\"\n});\n\nconst closedMixin = (theme: Theme, large: boolean): CSSObject => ({\n    willChange: \"width\",\n    transition: theme.transitions.create(\"width\", {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen\n    }),\n    border: \"none\",\n    overflowX: \"hidden\",\n    backgroundColor: theme.palette.background.default,\n    width: large ? `calc(${theme.spacing(9)})` : \"0px\"\n});\n","import React from \"react\";\nimport {\n    Avatar,\n    Box,\n    Breadcrumbs,\n    Button,\n    Chip,\n    Hidden,\n    IconButton,\n    Link,\n    Slide,\n    Toolbar,\n    Typography,\n    useMediaQuery,\n    useTheme\n} from \"@mui/material\";\nimport LightModeOutlinedIcon from \"@mui/icons-material/LightModeOutlined\";\nimport DarkModeOutlinedIcon from \"@mui/icons-material/DarkModeOutlined\";\nimport NavigateNextIcon from \"@mui/icons-material/NavigateNext\";\nimport { Link as ReactLink } from \"react-router-dom\";\nimport { ErrorBoundary } from \"../components\";\nimport {\n    useAuthController,\n    useBreadcrumbsContext,\n    useModeController\n} from \"../../hooks\";\nimport { DRAWER_WIDTH } from \"../Scaffold\";\n\nexport interface FireCMSAppBarProps {\n    title: string;\n    /**\n     * A component that gets rendered on the upper side of the main toolbar\n     */\n    toolbarExtraWidget?: React.ReactNode;\n\n    drawerOpen: boolean;\n}\n\n/**\n * This component renders the main app bar of FireCMS.\n * You will likely not need to use this component directly.\n *\n * @param title\n * @param toolbarExtraWidget\n * @param drawerOpen\n * @constructor\n */\nexport const FireCMSAppBar = function FireCMSAppBar({\n                                                        title,\n                                                        toolbarExtraWidget,\n                                                        drawerOpen\n                                                    }: FireCMSAppBarProps) {\n\n    const breadcrumbsContext = useBreadcrumbsContext();\n    const { breadcrumbs } = breadcrumbsContext;\n\n    const authController = useAuthController();\n    const { mode, toggleMode } = useModeController();\n\n    const theme = useTheme();\n    const largeLayout = useMediaQuery(theme.breakpoints.up(\"md\"));\n\n    const initial = authController.user?.displayName\n        ? authController.user.displayName[0].toUpperCase()\n        : (authController.user?.email ? authController.user.email[0].toUpperCase() : \"A\");\n\n    return (\n        <Box\n            sx={{\n                position: \"fixed\",\n                marginLeft: theme.spacing(8),\n                width: `calc(100% - ${theme.spacing(8)})`,\n                zIndex: largeLayout ? theme.zIndex.drawer + 1 : undefined,\n                transition: theme.transitions.create([\"width\", \"margin\"], {\n                    easing: theme.transitions.easing.sharp,\n                    duration: theme.transitions.duration.leavingScreen\n                }),\n                ...(drawerOpen && largeLayout && {\n                    marginLeft: `calc(${DRAWER_WIDTH}px - 8px)`,\n                    width: `calc(100% - ${DRAWER_WIDTH}px)`,\n                    transition: theme.transitions.create([\"width\", \"margin\"], {\n                        easing: theme.transitions.easing.sharp,\n                        duration: theme.transitions.duration.enteringScreen\n                    })\n                })\n            }}>\n\n            <Slide\n                direction=\"down\" in={true} mountOnEnter unmountOnExit>\n                <Toolbar sx={{ gap: 1 }}>\n\n                    <Hidden lgDown>\n                        <Box mr={2}>\n                            <Link\n                                underline={\"none\"}\n                                key={\"breadcrumb-home\"}\n                                color=\"inherit\"\n                                component={ReactLink}\n                                to={\".\"}>\n                                <Typography variant=\"h6\"\n                                            noWrap\n                                            className={\"weight-500\"}>\n                                    {title}\n                                </Typography>\n                            </Link>\n                        </Box>\n                    </Hidden>\n\n                    {largeLayout && <Box>\n                        <Breadcrumbs\n                            separator={<NavigateNextIcon\n                                htmlColor={\"rgb(0,0,0,0.87)\"}\n                                fontSize=\"small\"/>}\n                            aria-label=\"breadcrumb\">\n                            {breadcrumbs.map((entry, index) => (\n                                <Link\n                                    underline={\"none\"}\n                                    key={`breadcrumb-${index}`}\n                                    color=\"inherit\"\n                                    component={ReactLink}\n                                    to={entry.url}>\n                                    <Chip\n                                        sx={theme => ({\n                                            backgroundColor: theme.palette.grey[200],\n                                            height: theme.spacing(3),\n                                            color: theme.palette.grey[800],\n                                            fontWeight: theme.typography.fontWeightMedium,\n                                            \"&:hover, &:focus\": {\n                                                cursor: \"pointer\",\n                                                backgroundColor: theme.palette.grey[300]\n                                            },\n                                            \"&:active\": {\n                                                boxShadow: theme.shadows[1],\n                                                backgroundColor: theme.palette.grey[400]\n                                            }\n                                        })}\n                                        label={entry.title}\n                                    />\n                                </Link>)\n                            )\n                            }\n                        </Breadcrumbs>\n                    </Box>}\n\n                    <Box flexGrow={1}/>\n\n                    {toolbarExtraWidget &&\n                        <ErrorBoundary>\n                            {\n                                toolbarExtraWidget\n                            }\n                        </ErrorBoundary>}\n\n                    <Box p={1}>\n                        <IconButton\n                            color=\"inherit\"\n                            aria-label=\"Open drawer\"\n                            edge=\"start\"\n                            onClick={() => toggleMode()}\n                            size=\"large\">\n                            {mode === \"dark\"\n                                ? <DarkModeOutlinedIcon/>\n                                : <LightModeOutlinedIcon/>}\n                        </IconButton>\n                    </Box>\n\n                    <Box p={1}>\n                        {authController.user && authController.user.photoURL\n                            ? <Avatar\n                                src={authController.user.photoURL}/>\n                            : <Avatar>{initial}</Avatar>\n                        }\n                    </Box>\n\n                    <Button variant=\"text\"\n                            color=\"inherit\"\n                            onClick={authController.signOut}>\n                        Log Out\n                    </Button>\n\n                </Toolbar>\n            </Slide>\n        </Box>\n    );\n}\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\n\nimport { Box, Button, IconButton, ListItemIcon, ListItemText, Menu, MenuItem, Tooltip } from \"@mui/material\";\n\nimport AddIcon from \"@mui/icons-material/Add\";\nimport RemoveIcon from \"@mui/icons-material/Remove\";\nimport CopyIcon from \"@mui/icons-material/ContentCopy\";\nimport DragHandleIcon from \"@mui/icons-material/DragHandle\";\n\nimport { DragDropContext, Draggable, DraggableProvided, Droppable } from \"@hello-pangea/dnd\";\n\nimport { getHashValue } from \"../util\";\nimport useMeasure from \"react-use-measure\";\nimport { MoreVert } from \"@mui/icons-material\";\nimport { fieldBackgroundSubtleHover } from \"../util/field_colors\";\n\ninterface ArrayContainerProps<T> {\n    droppableId: string;\n    value: T[];\n    addLabel: string;\n    buildEntry: (index: number, internalId: number) => React.ReactNode;\n    disabled?: boolean;\n    small?: boolean;\n    onInternalIdAdded?: (id: number) => void;\n    includeAddButton?: boolean;\n    newDefaultEntry: T;\n    onValueChange: (value: T[]) => void\n}\n\nconst buildIdsMap = (value: any[]) =>\n    value && Array.isArray(value) && value.length > 0\n        ? value.map((v, index) => {\n            if (!v) return {};\n            return ({\n                [getHashValue(v) + index]: getRandomId()\n            });\n        }).reduce((a, b) => ({ ...a, ...b }), {})\n        : {}\n\n/**\n * @category Form custom fields\n */\nexport function ArrayContainer<T>({\n                                      droppableId,\n                                      addLabel,\n                                      value,\n                                      disabled = false,\n                                      buildEntry,\n                                      small,\n                                      onInternalIdAdded,\n                                      includeAddButton,\n                                      newDefaultEntry,\n                                      onValueChange\n                                  }: ArrayContainerProps<T>) {\n\n    const hasValue = value && Array.isArray(value) && value.length > 0;\n\n    // Used to track the ids that have displayed the initial show animation\n    const internalIdsRef = useRef<Record<string, number>>(buildIdsMap(value));\n\n    const [internalIds, setInternalIds] = useState<number[]>(\n        hasValue\n            ? Object.values(internalIdsRef.current)\n            : []);\n\n    useEffect(() => {\n        if (hasValue && value && value.length !== internalIds.length) {\n            const newInternalIds = value.map((v, index) => {\n                const hashValue = getHashValue(v) + index;\n                if (hashValue in internalIdsRef.current) {\n                    return internalIdsRef.current[hashValue];\n                } else {\n                    const newInternalId = getRandomId();\n                    internalIdsRef.current[hashValue] = newInternalId;\n                    return newInternalId;\n                }\n            });\n            setInternalIds(newInternalIds);\n        }\n    }, [hasValue, internalIds.length, value]);\n\n    const insertInEnd = () => {\n        if (disabled) return;\n        const id = getRandomId();\n        const newIds: number[] = [...internalIds, id];\n        if (onInternalIdAdded)\n            onInternalIdAdded(id);\n        setInternalIds(newIds);\n        onValueChange([...(value ?? []), newDefaultEntry]);\n    };\n\n    const remove = (index: number) => {\n        const newIds = [...internalIds];\n        newIds.splice(index, 1);\n        setInternalIds(newIds);\n        onValueChange(value.filter((_, i) => i !== index));\n    };\n\n    const copy = (index: number) => {\n        const id = getRandomId();\n        const copyingItem = value[index];\n        const newIds: number[] = [\n            ...internalIds.splice(0, index + 1),\n            id,\n            ...internalIds.splice(index + 1, internalIds.length - index - 1)];\n        if (onInternalIdAdded)\n            onInternalIdAdded(id);\n        setInternalIds(newIds);\n        // insert value in index + 1\n        onValueChange([...value.slice(0, index + 1), copyingItem, ...value.slice(index + 1)]);\n    };\n\n    const onDragEnd = (result: any) => {\n        // dropped outside the list\n        if (!result.destination) {\n            return;\n        }\n        const sourceIndex = result.source.index;\n        const destinationIndex = result.destination.index;\n\n        const newIds = [...internalIds];\n        const temp = newIds[sourceIndex];\n        newIds[sourceIndex] = newIds[destinationIndex];\n        newIds[destinationIndex] = temp;\n        setInternalIds(newIds);\n\n        onValueChange(arrayMove(value, sourceIndex, destinationIndex));\n    };\n\n    return (\n        <DragDropContext onDragEnd={onDragEnd}>\n            <Droppable droppableId={droppableId}\n                       renderClone={(provided, snapshot, rubric) => {\n                           const index = rubric.source.index;\n                           const internalId = internalIds[index];\n                           return (\n                               <ArrayContainerItem\n                                   provided={provided}\n                                   internalId={internalId}\n                                   index={index}\n                                   small={small}\n                                   disabled={disabled}\n                                   buildEntry={buildEntry}\n                                   remove={remove}\n                                   copy={copy}\n                                   isDragging={snapshot.isDragging}\n                               />\n                           );\n                       }}\n            >\n                {(droppableProvided, droppableSnapshot) => (\n                    <div\n                        {...droppableProvided.droppableProps}\n                        ref={droppableProvided.innerRef}>\n                        {hasValue && internalIds.map((internalId: number, index: number) => {\n                            return (\n                                <Draggable\n                                    key={`array_field_${internalId}`}\n                                    draggableId={`array_field_${internalId}`}\n                                    isDragDisabled={disabled}\n                                    index={index}>\n                                    {(provided, snapshot) => (\n                                        <ArrayContainerItem\n                                            provided={provided}\n                                            internalId={internalId}\n                                            index={index}\n                                            small={small}\n                                            disabled={disabled}\n                                            buildEntry={buildEntry}\n                                            remove={remove}\n                                            copy={copy}\n                                            isDragging={snapshot.isDragging}\n                                        />\n                                    )}\n                                </Draggable>\n                            );\n                        })}\n\n                        {droppableProvided.placeholder}\n\n                        {includeAddButton && <Box p={1}\n                                                  justifyContent=\"center\"\n                                                  textAlign={\"left\"}>\n                            <Button\n                                variant={small ? \"text\" : \"outlined\"}\n                                size={small ? \"small\" : \"large\"}\n                                color=\"primary\"\n                                disabled={disabled}\n                                startIcon={<AddIcon/>}\n                                onClick={insertInEnd}>\n                                {addLabel ?? \"Add\"}\n                            </Button>\n                        </Box>}\n                    </div>\n                )}\n            </Droppable>\n        </DragDropContext>\n    );\n}\n\ntype ArrayContainerItemProps = {\n    provided: DraggableProvided,\n    index: number,\n    internalId: number,\n    small?: boolean,\n    disabled: boolean,\n    buildEntry: (index: number, internalId: number) => React.ReactNode,\n    remove: (index: number) => void,\n    copy: (index: number) => void,\n    isDragging: boolean,\n};\n\nexport function ArrayContainerItem({\n                                       provided,\n                                       index,\n                                       internalId,\n                                       small,\n                                       disabled,\n                                       buildEntry,\n                                       remove,\n                                       copy,\n                                       isDragging\n                                   }: ArrayContainerItemProps) {\n\n    const [measureRef, bounds] = useMeasure();\n    const menuOverflow = !small && bounds.height > 0 && bounds.height < 100;\n\n    const [onHover, setOnHover] = React.useState(false);\n    const setOnHoverTrue = useCallback(() => setOnHover(true), []);\n    const setOnHoverFalse = useCallback(() => setOnHover(false), []);\n\n    return <Box\n        onMouseEnter={setOnHoverTrue}\n        onMouseMove={setOnHoverTrue}\n        onMouseLeave={setOnHoverFalse}\n        ref={provided.innerRef}\n        {...provided.draggableProps}\n        style={provided.draggableProps.style}\n        sx={theme => ({\n            backgroundColor: isDragging || onHover\n                ? fieldBackgroundSubtleHover(theme)\n                : undefined,\n            marginBottom: 1,\n            borderRadius: `${theme.shape.borderRadius}px`,\n            opacity: 1\n        })}\n    >\n        <Box\n            display=\"flex\"\n            alignItems={\"start\"}>\n            <Box ref={measureRef}\n                 flexGrow={1}\n                 width={\"calc(100% - 48px)\"}\n            >\n                {buildEntry(index, internalId)}\n            </Box>\n            <ArrayItemOptions direction={small ? \"row\" : \"column\"}\n                              disabled={disabled}\n                              remove={remove}\n                              index={index}\n                              provided={provided}\n                              contentOverflow={menuOverflow}\n                              copy={copy}/>\n        </Box>\n    </Box>;\n}\n\nexport function ArrayItemOptions({\n                                     direction,\n                                     disabled,\n                                     remove,\n                                     index,\n                                     provided,\n                                     copy,\n                                     contentOverflow\n                                 }: {\n    direction?: \"row\" | \"column\",\n    contentOverflow: boolean,\n    disabled: boolean,\n    remove: (index: number) => void,\n    index: number,\n    provided: any,\n    copy: (index: number) => void\n}) {\n\n    const [anchorEl, setAnchorEl] = React.useState<any | null>(null);\n\n    const openMenu = (event: React.MouseEvent) => {\n        setAnchorEl(event.currentTarget);\n        event.stopPropagation();\n    };\n\n    const closeMenu = () => {\n        setAnchorEl(null);\n    };\n\n    return <Box display=\"flex\"\n                flexDirection={direction === \"row\" ? \"row-reverse\" : \"column\"}\n                sx={{\n                    pl: 1,\n                    pt: 1\n                }}\n                alignItems=\"center\">\n        <div\n            {...provided.dragHandleProps}>\n            <Tooltip\n                placement={direction === \"column\" ? \"left\" : undefined}\n                title=\"Move\">\n                <IconButton\n                    size=\"small\"\n                    disabled={disabled}\n                    sx={{ cursor: disabled ? \"inherit\" : \"move\" }}>\n                    <DragHandleIcon\n                        fontSize={\"small\"}\n                        color={disabled ? \"disabled\" : \"inherit\"}/>\n                </IconButton>\n            </Tooltip>\n        </div>\n\n        {!contentOverflow && <>\n            <Tooltip\n                title=\"Remove\"\n                placement={direction === \"column\" ? \"left\" : undefined}>\n                <IconButton\n                    size=\"small\"\n                    aria-label=\"remove\"\n                    disabled={disabled}\n                    onClick={() => remove(index)}>\n                    <RemoveIcon\n                        fontSize={\"small\"}/>\n                </IconButton>\n            </Tooltip>\n\n            <Tooltip\n                placement={direction === \"column\" ? \"left\" : undefined}\n                title=\"Copy in this position\">\n                <IconButton\n                    size=\"small\"\n                    aria-label=\"copy\"\n                    disabled={disabled}\n                    onClick={() => copy(index)}>\n                    <CopyIcon\n                        fontSize={\"small\"}/>\n                </IconButton>\n            </Tooltip>\n        </>}\n\n        {contentOverflow && <>\n            <IconButton onClick={openMenu}\n                        size={\"small\"}>\n                <MoreVert/>\n            </IconButton>\n            <Menu\n                anchorEl={anchorEl}\n                open={Boolean(anchorEl)}\n                onClose={closeMenu}\n                elevation={3}\n            >\n\n                <MenuItem dense onClick={() => remove(index)}>\n                    <ListItemIcon>\n                        <RemoveIcon/>\n                    </ListItemIcon>\n                    <ListItemText primary=\"Remove\"/>\n                </MenuItem>\n                <MenuItem dense onClick={() => copy(index)}>\n                    <ListItemIcon>\n                        <CopyIcon/>\n                    </ListItemIcon>\n                    <ListItemText primary={\"Copy\"}/>\n                </MenuItem>\n\n            </Menu></>}\n    </Box>;\n}\n\nfunction arrayMove(value: any[], sourceIndex: number, destinationIndex: number) {\n    const result = Array.from(value);\n    const [removed] = result.splice(sourceIndex, 1);\n    result.splice(destinationIndex, 0, removed);\n    return result;\n}\n\nexport function getRandomId() {\n    return Math.floor(Math.random() * Math.floor(Number.MAX_SAFE_INTEGER));\n}\n","import { useMediaQuery, useTheme } from \"@mui/material\";\n\nexport function useLargeSideLayout() {\n    const theme = useTheme();\n    return useMediaQuery(theme.breakpoints.up(\"xl\"));\n}\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Box, CircularProgress, Divider, IconButton, Tab, Tabs, Typography, useTheme } from \"@mui/material\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport { Entity, EntityCollection, EntityStatus, EntityValues, FireCMSPlugin, FormContext, User } from \"../../types\";\nimport { CircularProgressCenter, EntityCollectionView, EntityPreview, ErrorBoundary } from \"../components\";\nimport {\n    canEditEntity,\n    fullPathToCollectionSegments,\n    removeInitialAndTrailingSlashes,\n    resolveDefaultSelectedView,\n    useDebounce\n} from \"../util\";\n\nimport { ADDITIONAL_TAB_WIDTH, CONTAINER_FULL_WIDTH, FORM_CONTAINER_WIDTH } from \"./common\";\nimport {\n    saveEntityWithCallbacks,\n    useAuthController,\n    useDataSource,\n    useEntityFetch,\n    useFireCMSContext,\n    useSideEntityController,\n    useSnackbarController\n} from \"../../hooks\";\nimport { EntityForm } from \"../../form\";\nimport { useSideDialogContext } from \"../SideDialogs\";\nimport { useLargeSideLayout } from \"./useLargeSideLayout\";\nimport { EntityFormSaveParams } from \"../../form/EntityForm\";\n\nexport interface EntityViewProps<M extends Record<string, any>> {\n    path: string;\n    collection: EntityCollection<M>;\n    entityId?: string;\n    copy?: boolean;\n    selectedSubPath?: string;\n    formWidth?: number | string;\n    onValuesAreModified: (modified: boolean) => void;\n    onUpdate?: (params: { entity: Entity<any> }) => void;\n    onClose?: () => void;\n}\n\n/**\n * This is the default view that is used as the content of a side panel when\n * an entity is opened.\n * You probably don't want to use this view directly since it is bound to the\n * side panel. Instead, you might want to use {@link EntityForm} or {@link EntityCollectionView}\n */\nexport function EntityView<M extends Record<string, any>, UserType extends User>({\n                                                                                     path,\n                                                                                     entityId,\n                                                                                     selectedSubPath,\n                                                                                     copy,\n                                                                                     collection,\n                                                                                     onValuesAreModified,\n                                                                                     formWidth,\n                                                                                     onUpdate,\n                                                                                     onClose\n                                                                                 }: EntityViewProps<M>) {\n\n    if (collection.customId && collection.formAutoSave) {\n        console.warn(`The collection ${collection.path} has customId and formAutoSave enabled. This is not supported and formAutoSave will be ignored`);\n    }\n\n    const [saving, setSaving] = useState(false);\n    /**\n     * These are the values that are being saved. They are debounced.\n     * We use this only when autoSave is enabled.\n     */\n    const [valuesToBeSaved, setValuesToBeSaved] = useState<EntityValues<M> | undefined>(undefined);\n    useDebounce(valuesToBeSaved, () => {\n        if (valuesToBeSaved)\n            saveEntity({\n                entityId: usedEntity?.id,\n                collection,\n                path,\n                values: valuesToBeSaved,\n                closeAfterSave: false\n            });\n    }, false, 2000);\n\n    const theme = useTheme();\n    const largeLayout = useLargeSideLayout();\n    const largeLayoutTabSelected = useRef(!largeLayout);\n\n    const resolvedFormWidth: string = typeof formWidth === \"number\" ? `${formWidth}px` : formWidth ?? FORM_CONTAINER_WIDTH;\n\n    const dataSource = useDataSource();\n    const sideDialogContext = useSideDialogContext();\n    const sideEntityController = useSideEntityController();\n    const snackbarController = useSnackbarController();\n    const context = useFireCMSContext();\n    const authController = useAuthController<UserType>();\n\n    const [formContext, setFormContext] = useState<FormContext<M> | undefined>(undefined);\n\n    const [status, setStatus] = useState<EntityStatus>(copy ? \"copy\" : (entityId ? \"existing\" : \"new\"));\n\n    const modifiedValuesRef = useRef<EntityValues<M> | undefined>(undefined);\n    const modifiedValues = modifiedValuesRef.current;\n\n    const subcollections = (collection.subcollections ?? []).filter(c => !c.hideFromNavigation);\n    const subcollectionsCount = subcollections?.length ?? 0;\n    const customViews = collection.views;\n    const customViewsCount = customViews?.length ?? 0;\n    const autoSave = collection.formAutoSave && !collection.customId;\n\n    const getTabPositionFromPath = (subPath: string): number => {\n        if (customViews) {\n            const index = customViews\n                .map((c) => c.path)\n                .findIndex((p) => p === subPath);\n            if (index !== -1)\n                return index;\n        }\n\n        if (subcollections) {\n            const index = subcollections\n                .map((c) => c.path)\n                .findIndex((p) => p === subPath);\n            if (index !== -1)\n                return index + customViewsCount;\n        }\n        return -1;\n    };\n\n    const hasAdditionalViews = customViewsCount > 0 || subcollectionsCount > 0;\n\n    const defaultSelectedView = selectedSubPath ?? resolveDefaultSelectedView(\n        collection ? collection.defaultSelectedView : undefined,\n        {\n            status,\n            entityId\n        }\n    );\n\n    const tabsPositionRef = useRef<number>(defaultSelectedView ? getTabPositionFromPath(defaultSelectedView) : -1);\n\n    const mainViewVisible = tabsPositionRef.current === -1 || largeLayout;\n\n    const {\n        entity,\n        dataLoading,\n        // eslint-disable-next-line no-unused-vars\n        dataLoadingError\n    } = useEntityFetch<M, UserType>({\n        path,\n        entityId,\n        collection,\n        useCache: false\n    });\n\n    const [usedEntity, setUsedEntity] = useState<Entity<M> | undefined>(entity);\n    const [readOnly, setReadOnly] = useState<boolean | undefined>(undefined);\n\n    useEffect(() => {\n        if (entity)\n            setUsedEntity(entity);\n    }, [entity]);\n\n    useEffect(() => {\n        if (status === \"new\") {\n            setReadOnly(false);\n        } else {\n            const editEnabled = usedEntity ? canEditEntity(collection, authController, fullPathToCollectionSegments(path), usedEntity ?? null) : false;\n            if (usedEntity)\n                setReadOnly(!editEnabled);\n        }\n    }, [authController, usedEntity, status]);\n\n    useEffect(() => {\n        if (largeLayoutTabSelected.current === largeLayout)\n            return;\n        // open first tab by default in large layouts\n        if (selectedSubPath !== defaultSelectedView) {\n            sideEntityController.replace({\n                path,\n                entityId,\n                selectedSubPath: defaultSelectedView,\n                updateUrl: true,\n                collection\n            });\n        }\n        largeLayoutTabSelected.current = largeLayout;\n    }, [defaultSelectedView, largeLayout, selectedSubPath]);\n\n    const onPreSaveHookError = useCallback((e: Error) => {\n        setSaving(false);\n        snackbarController.open({\n            type: \"error\",\n            message: \"Error before saving: \" + e?.message\n        });\n        console.error(e);\n    }, [snackbarController]);\n\n    const onSaveSuccessHookError = useCallback((e: Error) => {\n        setSaving(false);\n        snackbarController.open({\n            type: \"error\",\n            message: \"Error after saving (entity is saved): \" + e?.message\n        });\n        console.error(e);\n    }, [snackbarController]);\n\n    const getSelectedSubPath = (value: number) => {\n        if (value === -1) return undefined;\n\n        if (customViews && value < customViewsCount) {\n            return customViews[value].path;\n        }\n\n        if (subcollections) {\n            return subcollections[value - customViewsCount].path;\n        }\n\n        throw Error(\"Something is wrong in getSelectedSubPath\");\n    };\n\n    const onSaveSuccess = (updatedEntity: Entity<M>, closeAfterSave: boolean) => {\n\n        setSaving(false);\n        if (!autoSave)\n            snackbarController.open({\n                type: \"success\",\n                message: `${collection.singularName ?? collection.name}: Saved correctly`\n            });\n\n        setUsedEntity(updatedEntity);\n        setStatus(\"existing\");\n\n        onValuesAreModified(false);\n\n        if (onUpdate)\n            onUpdate({ entity: updatedEntity });\n\n        if (closeAfterSave) {\n            sideDialogContext.setBlocked(false);\n            sideDialogContext.close(true);\n            onClose?.();\n        } else if (status !== \"existing\") {\n            sideEntityController.replace({\n                path,\n                entityId: updatedEntity.id,\n                selectedSubPath: getSelectedSubPath(tabsPositionRef.current),\n                updateUrl: true,\n                collection\n            });\n        }\n\n    };\n\n    const onSaveFailure = useCallback((e: Error) => {\n\n        setSaving(false);\n        snackbarController.open({\n            type: \"error\",\n            message: \"Error saving: \" + e?.message\n        });\n\n        console.error(\"Error saving entity\", path, entityId);\n        console.error(e);\n    }, [entityId, path, snackbarController]);\n\n    const saveEntity = ({ values, previousValues, closeAfterSave, entityId, collection, path }: {\n        collection: EntityCollection<M>,\n        path: string,\n        entityId: string | undefined,\n        values: M,\n        previousValues?: M,\n        closeAfterSave: boolean,\n    }) => {\n        setSaving(true);\n        saveEntityWithCallbacks({\n            path,\n            entityId,\n            values,\n            previousValues,\n            collection,\n            status,\n            dataSource,\n            context,\n            onSaveSuccess: (updatedEntity: Entity<M>) => onSaveSuccess(updatedEntity, closeAfterSave),\n            onSaveFailure,\n            onPreSaveHookError,\n            onSaveSuccessHookError\n        }).then();\n    };\n\n    const onSaveEntityRequest = async ({\n                                           collection,\n                                           path,\n                                           entityId,\n                                           values,\n                                           previousValues,\n                                           closeAfterSave,\n                                           autoSave\n                                       }: EntityFormSaveParams<M>): Promise<void> => {\n        if (!status)\n            return;\n\n        if (autoSave) {\n            setValuesToBeSaved(values);\n        } else {\n            saveEntity({\n                collection,\n                path,\n                entityId,\n                values,\n                previousValues,\n                closeAfterSave\n            });\n        }\n    };\n\n    const customViewsView: React.ReactNode[] | undefined = customViews && customViews.map(\n        (customView, colIndex) => {\n            if (tabsPositionRef.current !== colIndex)\n                return null;\n            if (customView.builder) {\n                console.warn(\"customView.builder is deprecated, use customView.Builder instead\", customView);\n            }\n            const Builder = customView.Builder ?? customView.builder;\n            if (!Builder) {\n                console.error(\"customView.Builder is not defined\");\n                return null;\n            }\n            return <Box\n                sx={{\n                    width: ADDITIONAL_TAB_WIDTH,\n                    height: \"100%\",\n                    overflow: \"auto\",\n                    borderLeft: `1px solid ${theme.palette.divider}`,\n                    [theme.breakpoints.down(\"lg\")]: {\n                        borderLeft: \"inherit\",\n                        width: CONTAINER_FULL_WIDTH\n                    }\n                }}\n                key={`custom_view_${customView.path}`}\n                role=\"tabpanel\"\n                flexGrow={1}>\n                <ErrorBoundary>\n                    {formContext && <Builder\n                        collection={collection}\n                        entity={usedEntity}\n                        modifiedValues={modifiedValues ?? usedEntity?.values}\n                        formContext={formContext}\n                    />}\n                </ErrorBoundary>\n            </Box>;\n        }\n    ).filter(Boolean);\n\n    const globalLoading = (dataLoading && !usedEntity) ||\n        ((!usedEntity || readOnly === undefined) && (status === \"existing\" || status === \"copy\"));\n\n    const loading = globalLoading || saving;\n\n    const subCollectionsViews = subcollections && subcollections.map(\n        (subcollection, colIndex) => {\n            const fullPath = usedEntity ? `${path}/${usedEntity?.id}/${removeInitialAndTrailingSlashes(subcollection.alias ?? subcollection.path)}` : undefined;\n            if (tabsPositionRef.current !== colIndex + customViewsCount)\n                return null;\n            return (\n                <Box\n                    sx={{\n                        width: ADDITIONAL_TAB_WIDTH,\n                        height: \"100%\",\n                        overflow: \"auto\",\n                        borderLeft: `1px solid ${theme.palette.divider}`,\n                        [theme.breakpoints.down(\"lg\")]: {\n                            borderLeft: \"inherit\",\n                            width: CONTAINER_FULL_WIDTH\n                        }\n                    }}\n                    key={`subcol_${subcollection.alias ?? subcollection.path}`}\n                    role=\"tabpanel\"\n                    flexGrow={1}>\n\n                    {loading && <CircularProgressCenter/>}\n\n                    {!globalLoading &&\n                        (usedEntity && fullPath\n                            ? <EntityCollectionView\n                                fullPath={fullPath}\n                                isSubCollection={true}\n                                {...subcollection}/>\n                            : <Box\n                                sx={{\n                                    width: \"100%\",\n                                    height: \"100%\",\n                                    p: 3\n                                }}\n                                display={\"flex\"}\n                                alignItems={\"center\"}\n                                justifyContent={\"center\"}>\n                                <Typography variant={\"label\"}>\n                                    You need to save your entity before\n                                    adding additional collections\n                                </Typography>\n                            </Box>)\n                    }\n\n                </Box>\n            );\n        }\n    ).filter(Boolean);\n\n    const onDiscard = useCallback(() => {\n        onValuesAreModified(false);\n    }, []);\n\n    const onSideTabClick = (value: number) => {\n        tabsPositionRef.current = value;\n        sideEntityController.replace({\n            path,\n            entityId,\n            selectedSubPath: getSelectedSubPath(value),\n            updateUrl: true,\n            collection\n        });\n    };\n\n    const onValuesChanged = useCallback((values?: EntityValues<M>) => {\n        modifiedValuesRef.current = values;\n    }, []);\n\n    // eslint-disable-next-line n/handle-callback-err\n    const onIdUpdateError = useCallback((error: any) => {\n        snackbarController.open({\n            type: \"error\",\n            message: \"Error updating id, check the console\"\n        });\n    }, []);\n\n    const onIdChange = useCallback((id: string) => {\n        setUsedEntity((prevEntity) => prevEntity\n            ? {\n                ...prevEntity,\n                id\n            }\n            : undefined);\n    }, []);\n\n    const onModified = (dirty: boolean) => {\n        if (!autoSave)\n            onValuesAreModified(dirty);\n    }\n\n    function buildForm() {\n        const plugins = context.plugins;\n        let form = <EntityForm\n            status={status}\n            path={path}\n            collection={collection}\n            onEntitySaveRequested={onSaveEntityRequest}\n            onDiscard={onDiscard}\n            onValuesChanged={onValuesChanged}\n            onModified={onModified}\n            entity={usedEntity}\n            onIdChange={onIdChange}\n            onFormContextChange={setFormContext}\n            hideId={collection.hideIdFromForm}\n            autoSave={autoSave}\n            onIdUpdateError={onIdUpdateError}\n        />;\n        if (plugins) {\n            plugins.forEach((plugin: FireCMSPlugin) => {\n                if (plugin.form?.provider) {\n                    form = (\n                        <plugin.form.provider.Component\n                            status={status}\n                            path={path}\n                            collection={collection}\n                            onDiscard={onDiscard}\n                            onValuesChanged={onValuesChanged}\n                            onModified={onModified}\n                            entity={usedEntity}\n                            context={context}\n                            formContext={formContext}\n                            {...plugin.form.provider.props}>\n                            {form}\n                        </plugin.form.provider.Component>\n                    );\n                }\n            });\n        }\n        return <ErrorBoundary>{form}</ErrorBoundary>;\n    }\n\n    const form = (readOnly === undefined)\n        ? <></>\n        : (!readOnly\n            ? buildForm()\n            : (\n                <EntityPreview\n                    entity={usedEntity as Entity<M>}\n                    path={path}\n                    collection={collection}/>\n            ));\n\n    const subcollectionTabs = subcollections && subcollections.map(\n        (subcollection) =>\n            <Tab\n                sx={{\n                    fontSize: \"0.875rem\",\n                    minWidth: \"140px\"\n                }}\n                wrapped={true}\n                key={`entity_detail_collection_tab_${subcollection.name}`}\n                label={subcollection.name}/>\n    );\n\n    const customViewTabs = customViews && customViews.map(\n        (view) =>\n            <Tab\n                sx={{\n                    fontSize: \"0.875rem\",\n                    minWidth: \"140px\"\n                }}\n                wrapped={true}\n                key={`entity_detail_custom_tab_${view.name}`}\n                label={view.name}/>\n    );\n\n    const header = (\n        <Box sx={{\n            paddingLeft: 2,\n            paddingRight: 2,\n            paddingTop: 1,\n            display: \"flex\",\n            alignItems: \"end\",\n            backgroundColor: theme.palette.mode === \"light\" ? theme.palette.background.default : theme.palette.background.paper\n        }}>\n\n            <Box\n                sx={{\n                    pb: 1,\n                    alignSelf: \"center\"\n                }}>\n                <IconButton onClick={() => {\n                    onClose?.();\n                    return sideDialogContext.close(false);\n                }}\n                            size=\"large\">\n                    <CloseIcon/>\n                </IconButton>\n            </Box>\n\n            <Box flexGrow={1}/>\n\n            {globalLoading && <Box\n                sx={{\n                    alignSelf: \"center\"\n                }}>\n                <CircularProgress size={16} thickness={8}/>\n            </Box>}\n\n            <Tabs\n                value={tabsPositionRef.current + 1}\n                indicatorColor=\"secondary\"\n                textColor=\"inherit\"\n                onChange={(ev, value) => {\n                    onSideTabClick(value - 1);\n                }}\n                sx={{\n                    paddingLeft: theme.spacing(1),\n                    paddingRight: theme.spacing(1),\n                    paddingTop: theme.spacing(0)\n                }}\n                variant=\"scrollable\"\n                scrollButtons=\"auto\"\n            >\n                <Tab\n                    label={collection.singularName ?? collection.name}\n                    disabled={!hasAdditionalViews}\n                    onClick={() => {\n                        onSideTabClick(-1);\n                    }}\n                    sx={{\n                        display: !hasAdditionalViews ? \"none\" : undefined,\n                        fontSize: \"0.875rem\",\n                        minWidth: \"140px\"\n                    }}\n                    wrapped={true}\n                />\n                {customViewTabs}\n                {subcollectionTabs}\n\n            </Tabs>\n        </Box>\n\n    );\n\n    return (\n        <Box\n            sx={{\n                display: \"flex\",\n                flexDirection: \"column\",\n                height: \"100%\",\n                width: \"100%\",\n                transition: \"width 250ms ease-in-out\"\n            }}>\n            {\n                <>\n\n                    {header}\n\n                    <Divider/>\n\n                    <Box sx={{\n                        flexGrow: 1,\n                        height: \"100%\",\n                        width: `calc(${ADDITIONAL_TAB_WIDTH} + ${resolvedFormWidth})`,\n                        maxWidth: \"100%\",\n                        [`@media (max-width: ${resolvedFormWidth})`]: {\n                            width: resolvedFormWidth\n                        },\n                        display: \"flex\",\n                        overflow: \"auto\",\n                        flexDirection: \"row\"\n                    }}>\n\n                        <Box sx={{\n                            position: \"relative\",\n                            maxWidth: \"100%\"\n                        }}>\n                            <Box\n                                role=\"tabpanel\"\n                                hidden={!mainViewVisible}\n                                id={`form_${path}`}\n                                sx={{\n                                    width: resolvedFormWidth,\n                                    maxWidth: \"100%\",\n                                    height: \"100%\",\n                                    overflow: \"auto\",\n                                    [theme.breakpoints.down(\"sm\")]: {\n                                        maxWidth: CONTAINER_FULL_WIDTH,\n                                        width: CONTAINER_FULL_WIDTH\n                                    }\n                                }}>\n\n                                {globalLoading\n                                    ? <CircularProgressCenter/>\n                                    : form}\n\n                            </Box>\n                        </Box>\n\n                        {customViewsView}\n\n                        {subCollectionsViews}\n\n                    </Box>\n\n                </>\n            }\n\n        </Box>\n    );\n}\n","import React, { useCallback, useEffect, useMemo } from \"react\";\n\nimport { EntitySidePanelProps } from \"../types\";\nimport { FORM_CONTAINER_WIDTH } from \"./internal/common\";\nimport { useNavigationContext, useSideEntityController } from \"../hooks\";\n\nimport { ErrorBoundary } from \"./components\";\nimport { EntityView } from \"./internal/EntityView\";\nimport { useSideDialogContext } from \"./SideDialogs\";\n\n/**\n * This is the component in charge of rendering the side dialog used\n * for editing entities. Use the {@link useSideEntityController} to open\n * and control the dialogs.\n * This component needs a parent {@link FireCMS}\n * {@link useSideEntityController}\n * @category Components\n */\nexport function EntitySidePanel(props: EntitySidePanelProps) {\n\n    const {\n        blocked,\n        setBlocked,\n        setBlockedNavigationMessage\n    } = useSideDialogContext();\n\n    const navigationContext = useNavigationContext();\n\n    const collection = useMemo(() => {\n        if (!props) return undefined;\n        let usedCollection = props.collection;\n\n        if (!usedCollection) {\n            usedCollection = navigationContext.getCollection(props.path, props.entityId);\n            if (!usedCollection) {\n                console.error(\"ERROR: No collection found in path `\", props.path, \"`. Entity id: \", props.entityId);\n                throw Error(\"ERROR: No collection found in path `\" + props.path + \"`. Make sure you have defined a collection for this path in the root navigation.\");\n            }\n        }\n        return usedCollection;\n    }, [navigationContext, props]);\n\n    useEffect(() => {\n        function beforeunload(e: any) {\n            if (blocked && collection) {\n                e.preventDefault();\n                e.returnValue = `You have unsaved changes in this ${collection.name}. Are you sure you want to leave this page?`;\n            }\n        }\n\n        if (typeof window !== \"undefined\")\n            window.addEventListener(\"beforeunload\", beforeunload);\n\n        return () => {\n            if (typeof window !== \"undefined\")\n                window.removeEventListener(\"beforeunload\", beforeunload);\n        };\n\n    }, [blocked, collection]);\n\n    const onValuesAreModified = useCallback((modified: boolean) => {\n        setBlocked(modified);\n        setBlockedNavigationMessage(modified\n            ? <> You have unsaved changes in this <b>{collection?.name}</b>.</>\n            : undefined)\n    }, [collection?.name, setBlocked, setBlockedNavigationMessage]);\n\n    if (!props || !collection) {\n        return <div style={{ width: FORM_CONTAINER_WIDTH }}/>;\n    }\n\n    return (\n        <>\n\n            <ErrorBoundary>\n                <EntityView\n                    {...props}\n                    formWidth={props.width}\n                    collection={collection}\n                    onValuesAreModified={onValuesAreModified}\n                />\n            </ErrorBoundary>\n\n        </>\n    );\n}\n","import { useCallback, useEffect, useRef } from \"react\";\nimport { useMediaQuery, useTheme } from \"@mui/material\";\nimport {\n    EntityCollection,\n    EntitySidePanelProps,\n    NavigationContext,\n    SideDialogPanelProps,\n    SideDialogsController,\n    SideEntityController\n} from \"../../types\";\nimport {\n    getNavigationEntriesFromPathInternal,\n    NavigationViewInternal\n} from \"../util/navigation_from_path\";\nimport { useLocation } from \"react-router-dom\";\nimport { EntitySidePanel } from \"../EntitySidePanel\";\nimport {\n    removeInitialAndTrailingSlashes,\n    resolveDefaultSelectedView\n} from \"../util\";\nimport {\n    ADDITIONAL_TAB_WIDTH,\n    CONTAINER_FULL_WIDTH,\n    FORM_CONTAINER_WIDTH\n} from \"./common\";\n\nconst NEW_URL_HASH = \"new\";\n\nexport function getEntityViewWidth(props: EntitySidePanelProps<any>, small: boolean): string {\n    if (small) return CONTAINER_FULL_WIDTH;\n    const mainViewSelected = !props.selectedSubPath;\n    const resolvedWidth: string | undefined = typeof props.width === \"number\" ? `${props.width}px` : props.width;\n    return !mainViewSelected ? `calc(${ADDITIONAL_TAB_WIDTH} + ${resolvedWidth ?? FORM_CONTAINER_WIDTH})` : resolvedWidth ?? FORM_CONTAINER_WIDTH\n}\n\nexport const useBuildSideEntityController = (navigation: NavigationContext,\n                                             sideDialogsController: SideDialogsController): SideEntityController => {\n\n    const location = useLocation();\n    const initialised = useRef<boolean>(false);\n\n    const theme = useTheme();\n    const smallLayout: boolean = useMediaQuery(theme.breakpoints.down(\"sm\"));\n\n    // only on initialisation, create panels from URL\n    useEffect(() => {\n        if (!navigation.loading && !initialised.current) {\n            if (navigation.isUrlCollectionPath(location.pathname)) {\n                const newFlag = location.hash === `#${NEW_URL_HASH}`;\n                const entityOrCollectionPath = navigation.urlPathToDataPath(location.pathname);\n                const panelsFromUrl = buildSidePanelsFromUrl(entityOrCollectionPath, navigation.collections, newFlag);\n                sideDialogsController.replace(panelsFromUrl.map((props) => propsToSidePanel(props, navigation, smallLayout)));\n            }\n            initialised.current = true;\n        }\n    }, [location, navigation, sideDialogsController, smallLayout]);\n\n    const close = useCallback(() => {\n        sideDialogsController.close();\n    }, [sideDialogsController]);\n\n    const open = useCallback((props: EntitySidePanelProps<any>) => {\n\n        if (props.copy && !props.entityId) {\n            throw Error(\"If you want to copy an entity you need to provide an entityId\");\n        }\n        const defaultSelectedView = resolveDefaultSelectedView(\n            props.collection ? props.collection.defaultSelectedView : undefined,\n            {\n                status: props.copy ? \"copy\" : (props.entityId ? \"existing\" : \"new\"),\n                entityId: props.entityId\n            }\n        );\n\n        sideDialogsController.open(propsToSidePanel({ selectedSubPath: defaultSelectedView, ...props }, navigation, smallLayout));\n\n    }, [sideDialogsController, navigation, smallLayout]);\n\n    const replace = useCallback((props: EntitySidePanelProps<any>) => {\n\n        if (props.copy && !props.entityId) {\n            throw Error(\"If you want to copy an entity you need to provide an entityId\");\n        }\n\n        sideDialogsController.replace(propsToSidePanel(props, navigation, smallLayout));\n\n    }, [navigation, sideDialogsController, smallLayout]);\n\n    return {\n        close,\n        open,\n        replace\n    };\n};\n\nexport function buildSidePanelsFromUrl(path: string, collections: EntityCollection[], newFlag: boolean): EntitySidePanelProps<any>[] {\n\n    const navigationViewsForPath: NavigationViewInternal<any>[] = getNavigationEntriesFromPathInternal({\n        path,\n        collections\n    });\n\n    const sidePanels: EntitySidePanelProps<any>[] = [];\n    let lastCollectionPath = \"\";\n    for (let i = 0; i < navigationViewsForPath.length; i++) {\n        const navigationEntry = navigationViewsForPath[i];\n\n        if (navigationEntry.type === \"collection\") {\n            lastCollectionPath = navigationEntry.path;\n        }\n\n        if (i > 0) { // the first collection is handled by the main navigation\n            const previousEntry = navigationViewsForPath[i - 1];\n            if (navigationEntry.type === \"entity\") {\n                sidePanels.push({\n                        path: navigationEntry.path,\n                        entityId: navigationEntry.entityId,\n                        copy: false\n                    }\n                );\n            } else if (navigationEntry.type === \"custom_view\") {\n                if (previousEntry.type === \"entity\") {\n                    const lastSidePanel: EntitySidePanelProps<any> = sidePanels[sidePanels.length - 1];\n                    if (lastSidePanel)\n                        lastSidePanel.selectedSubPath = navigationEntry.view.path;\n                }\n            } else if (navigationEntry.type === \"collection\") {\n                if (previousEntry.type === \"entity\") {\n                    const lastSidePanel: EntitySidePanelProps<any> = sidePanels[sidePanels.length - 1];\n                    if (lastSidePanel)\n                        lastSidePanel.selectedSubPath = navigationEntry.collection.alias ?? navigationEntry.collection.path;\n                }\n            }\n        }\n\n    }\n\n    if (newFlag) {\n        sidePanels.push({\n            path: lastCollectionPath,\n            copy: false\n        });\n    }\n\n    return sidePanels;\n}\n\nconst propsToSidePanel = (props: EntitySidePanelProps<any>, navigation: NavigationContext, smallLayout: boolean): SideDialogPanelProps => {\n\n    const collectionPath = removeInitialAndTrailingSlashes(props.path);\n    const newPath = props.entityId\n        ? navigation.buildUrlCollectionPath(`${collectionPath}/${props.entityId}/${props.selectedSubPath || \"\"}`)\n        : navigation.buildUrlCollectionPath(`${collectionPath}#${NEW_URL_HASH}`);\n\n    return ({\n        key: `${props.path}/${props.entityId}`,\n        component: <EntitySidePanel {...props}/>,\n        urlPath: newPath,\n        parentUrlPath: navigation.buildUrlCollectionPath(collectionPath),\n        width: getEntityViewWidth(props, smallLayout),\n        onClose: props.onClose\n    });\n};\n","import { EntityCollection, EntityReference } from \"../../types\";\nimport {\n    getCollectionPathsCombinations,\n    removeInitialAndTrailingSlashes\n} from \"./navigation_utils\";\n\nexport function getParentReferencesFromPath(props: {\n    path: string,\n    collections: EntityCollection[] | undefined,\n    currentFullPath?: string,\n}): EntityReference [] {\n\n    const {\n        path,\n        collections = [],\n        currentFullPath,\n    } = props;\n\n    const subpaths = removeInitialAndTrailingSlashes(path).split(\"/\");\n    const subpathCombinations = getCollectionPathsCombinations(subpaths);\n\n    const result: EntityReference[] = [];\n    for (let i = 0; i < subpathCombinations.length; i++) {\n        const subpathCombination = subpathCombinations[i];\n\n        const collection: EntityCollection<any> | undefined = collections && collections.find((entry) => entry.alias === subpathCombination || entry.path === subpathCombination);\n\n        if (collection) {\n            const pathOrAlias = collection.alias ?? collection.path;\n            const collectionPath = currentFullPath && currentFullPath.length > 0\n                ? (currentFullPath + \"/\" + pathOrAlias)\n                : pathOrAlias;\n\n            const restOfThePath = removeInitialAndTrailingSlashes(removeInitialAndTrailingSlashes(path).replace(subpathCombination, \"\"));\n            const nextSegments = restOfThePath.length > 0 ? restOfThePath.split(\"/\") : [];\n            if (nextSegments.length > 0) {\n                const entityId = nextSegments[0];\n                const fullPath = collectionPath + \"/\" + entityId;\n                result.push(new EntityReference(entityId, collectionPath));\n                if (nextSegments.length > 1) {\n                    const newPath = nextSegments.slice(1).join(\"/\");\n                    if (!collection) {\n                        throw Error(\"collection not found resolving path: \" + collection);\n                    }\n                    if (collection.subcollections) {\n                        result.push(...getParentReferencesFromPath({\n                            path: newPath,\n                            collections: collection.subcollections,\n                            currentFullPath: fullPath\n                        }));\n                    }\n                }\n            }\n            break;\n        }\n\n    }\n    return result;\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router-dom\";\n\nimport {\n    AuthController,\n    CMSView,\n    CMSViewsBuilder,\n    CollectionOverrideHandler,\n    DataSource,\n    EntityCollection,\n    EntityCollectionsBuilder,\n    EntityReference,\n    FireCMSPlugin,\n    NavigationContext,\n    TopNavigationEntry,\n    TopNavigationResult,\n    User,\n    UserConfigurationPersistence\n} from \"../../types\";\nimport {\n    getCollectionByPathOrAlias,\n    mergeDeep,\n    removeInitialAndTrailingSlashes,\n    resolveCollectionPathAliases,\n    resolvePermissions\n} from \"../util\";\nimport { getParentReferencesFromPath } from \"../util/parent_references_from_path\";\n\ntype BuildNavigationContextProps<UserType extends User> = {\n    basePath: string,\n    baseCollectionPath: string,\n    authController: AuthController<UserType>;\n    collections?: EntityCollection[] | EntityCollectionsBuilder;\n    views?: CMSView[] | CMSViewsBuilder;\n    collectionOverrideHandler: CollectionOverrideHandler | undefined;\n    userConfigPersistence?: UserConfigurationPersistence;\n    plugins?: FireCMSPlugin[];\n    dataSource: DataSource;\n};\n\nexport function useBuildNavigationContext<UserType extends User>({\n                                                                     basePath,\n                                                                     baseCollectionPath,\n                                                                     authController,\n                                                                     collections: baseCollections,\n                                                                     views: baseViews,\n                                                                     collectionOverrideHandler,\n                                                                     userConfigPersistence,\n                                                                     plugins,\n                                                                     dataSource\n                                                                 }: BuildNavigationContextProps<UserType>): NavigationContext {\n\n    const location = useLocation();\n\n    const [collections, setCollections] = useState<EntityCollection[] | undefined>();\n    const [views, setViews] = useState<CMSView[] | undefined>();\n    const [initialised, setInitialised] = useState<boolean>(false);\n\n    const [topLevelNavigation, setTopLevelNavigation] = useState<TopNavigationResult | undefined>(undefined);\n    const [navigationLoading, setNavigationLoading] = useState<boolean>(true);\n    const [navigationLoadingError, setNavigationLoadingError] = useState<Error | undefined>(undefined);\n\n    const cleanBasePath = removeInitialAndTrailingSlashes(basePath);\n    const cleanBaseCollectionPath = removeInitialAndTrailingSlashes(baseCollectionPath);\n\n    const homeUrl = cleanBasePath ? `/${cleanBasePath}` : \"/\";\n\n    const fullCollectionPath = cleanBasePath ? `/${cleanBasePath}/${cleanBaseCollectionPath}` : `/${cleanBaseCollectionPath}`;\n\n    const buildCMSUrlPath = useCallback((path: string): string => cleanBasePath ? `/${cleanBasePath}/${encodePath(path)}` : `/${encodePath(path)}`,\n        [cleanBasePath]);\n\n    const buildUrlCollectionPath = useCallback((path: string): string => `${removeInitialAndTrailingSlashes(baseCollectionPath)}/${encodePath(path)}`,\n        [baseCollectionPath]);\n\n    const computeTopNavigation = useCallback((collections: EntityCollection[], views: CMSView[]): TopNavigationResult => {\n        // return (collection.editable && resolvePermissions(collection, authController, paths).editCollection) ?? DEFAULT_PERMISSIONS.editCollection;\n        const navigationEntries: TopNavigationEntry[] = [\n            ...(collections ?? []).map(collection => (!collection.hideFromNavigation\n                ? {\n                    url: buildUrlCollectionPath(collection.alias ?? collection.path),\n                    type: \"collection\",\n                    name: collection.name.trim(),\n                    path: collection.alias ?? collection.path,\n                    collection,\n                    description: collection.description?.trim(),\n                    group: collection.group?.trim()\n                }\n                : undefined))\n                .filter(Boolean) as TopNavigationEntry[],\n            ...(views ?? []).map(view =>\n                !view.hideFromNavigation\n                    ? ({\n                        url: buildCMSUrlPath(Array.isArray(view.path) ? view.path[0] : view.path),\n                        name: view.name.trim(),\n                        type: \"view\",\n                        view,\n                        description: view.description?.trim(),\n                        group: view.group?.trim()\n                    })\n                    : undefined)\n                .filter(Boolean) as TopNavigationEntry[]\n        ];\n\n        const groups: string[] = Object.values(navigationEntries)\n            .map(e => e.group)\n            .filter(Boolean)\n            .filter((value, index, array) => array.indexOf(value) === index) as string[];\n        return { navigationEntries, groups };\n    }, [buildCMSUrlPath, buildUrlCollectionPath]);\n\n    const refreshNavigation = useCallback(async () => {\n\n        if (authController.initialLoading)\n            return;\n\n        try {\n            const [resolvedCollections = [], resolvedViews = []] = await Promise.all([\n                    resolveCollections(baseCollections, authController, dataSource, plugins),\n                    resolveCMSViews(baseViews, authController, dataSource)\n                ]\n            );\n\n            setCollections(resolvedCollections);\n            setViews(resolvedViews);\n            setTopLevelNavigation(computeTopNavigation(resolvedCollections ?? [], resolvedViews));\n        } catch (e) {\n            console.error(e);\n            setNavigationLoadingError(e as any);\n        }\n\n        setNavigationLoading(false);\n        setInitialised(true);\n    }, [baseCollections, authController.user, authController.initialLoading, dataSource, plugins, baseViews, computeTopNavigation]);\n\n    useEffect(() => {\n        refreshNavigation();\n    }, [refreshNavigation]);\n\n    const getCollection = useCallback(<EC extends EntityCollection>(\n        pathOrAlias: string,\n        entityId?: string,\n        includeUserOverride = false\n    ): EC | undefined => {\n\n        if (!collections)\n            return undefined;\n\n        const baseCollection = getCollectionByPathOrAlias(removeInitialAndTrailingSlashes(pathOrAlias), collections);\n\n        const userOverride = includeUserOverride ? userConfigPersistence?.getCollectionConfig(pathOrAlias) : undefined;\n\n        const overriddenCollection = baseCollection ? mergeDeep(baseCollection, userOverride) : undefined;\n\n        let result: Partial<EntityCollection> | undefined = overriddenCollection;\n\n        const resolvedProps: Partial<EntityCollection> | undefined = collectionOverrideHandler && collectionOverrideHandler({\n            entityId,\n            path: removeInitialAndTrailingSlashes(pathOrAlias)\n        });\n\n        if (resolvedProps)\n            result = resolvedProps;\n\n        if (overriddenCollection) {\n            const subcollections = overriddenCollection.subcollections;\n            const callbacks = overriddenCollection.callbacks;\n            const permissions = overriddenCollection.permissions;\n            result = {\n                ...result,\n                subcollections: result?.subcollections ?? subcollections,\n                callbacks: result?.callbacks ?? callbacks,\n                permissions: result?.permissions ?? permissions\n            };\n        }\n\n        if (!result) return undefined;\n\n        return { ...overriddenCollection, ...result } as EC;\n\n    }, [\n        basePath,\n        baseCollectionPath,\n        collections,\n        collectionOverrideHandler\n    ]);\n\n    const isUrlCollectionPath = useCallback(\n        (path: string): boolean => removeInitialAndTrailingSlashes(path + \"/\").startsWith(removeInitialAndTrailingSlashes(fullCollectionPath) + \"/\"),\n        [fullCollectionPath]);\n\n    const urlPathToDataPath = useCallback((path: string): string => {\n        if (path.startsWith(fullCollectionPath))\n            return path.replace(fullCollectionPath, \"\");\n        throw Error(\"Expected path starting with \" + fullCollectionPath);\n    }, [fullCollectionPath]);\n\n    const buildUrlEditCollectionPath = useCallback(({\n                                                        path\n                                                    }: {\n            path: string\n        }): string => {\n            return `s/edit/${encodePath(path)}`;\n        },\n        []);\n\n    const resolveAliasesFrom = useCallback((path: string): string => {\n        if (!collections)\n            throw Error(\"Collections have not been initialised yet\");\n        return resolveCollectionPathAliases(path, collections);\n    }, [collections]);\n\n    const state = location.state as any;\n    /**\n     * The location can be overridden if `base_location` is set in the\n     * state field of the current location. This can happen if you open\n     * a side entity, like `products`, from a different one, like `users`\n     */\n    const baseLocation = state && state.base_location ? state.base_location : location;\n\n    const getAllParentCollectionsForPath = useCallback((path: string): EntityReference[] => {\n        return getParentReferencesFromPath({\n            path,\n            collections\n        });\n    }, [collections]);\n\n    return {\n        collections: collections ?? [],\n        views: views ?? [],\n        loading: !initialised || navigationLoading,\n        navigationLoadingError,\n        homeUrl,\n        basePath,\n        baseCollectionPath,\n        initialised,\n        getCollection,\n        isUrlCollectionPath,\n        urlPathToDataPath,\n        buildUrlCollectionPath,\n        buildUrlEditCollectionPath,\n        buildCMSUrlPath,\n        resolveAliasesFrom,\n        topLevelNavigation,\n        baseLocation,\n        refreshNavigation,\n        getParentReferencesFromPath: getAllParentCollectionsForPath\n    };\n}\n\nexport function getSidePanelKey(path: string, entityId?: string) {\n    if (entityId)\n        return `${removeInitialAndTrailingSlashes(path)}/${removeInitialAndTrailingSlashes(entityId)}`;\n    else\n        return removeInitialAndTrailingSlashes(path);\n}\n\nfunction encodePath(input: string) {\n    return encodeURIComponent(removeInitialAndTrailingSlashes(input))\n        .replaceAll(\"%2F\", \"/\")\n        .replaceAll(\"%23\", \"#\");\n}\n\nfunction filterOutNotAllowedCollections(resolvedCollections: EntityCollection[], authController: AuthController<User>): EntityCollection[] {\n    return resolvedCollections\n        .filter((c) => {\n            if (!c.permissions) return true;\n            const resolvedPermissions = resolvePermissions(c, authController, [c.path], null,)\n            return resolvedPermissions.read !== false;\n        })\n        .map((c) => {\n            if (!c.subcollections) return c;\n            return {\n                ...c,\n                subcollections: filterOutNotAllowedCollections(c.subcollections, authController)\n            }\n        });\n}\n\nasync function resolveCollections(collections: undefined | EntityCollection[] | EntityCollectionsBuilder, authController: AuthController, dataSource: DataSource, plugins?: FireCMSPlugin[]) {\n    let resolvedCollections: EntityCollection[] = [];\n    if (typeof collections === \"function\") {\n        resolvedCollections = await collections({\n            user: authController.user,\n            authController,\n            dataSource\n        });\n    } else if (Array.isArray(collections)) {\n        resolvedCollections = collections;\n    }\n\n    resolvedCollections = filterOutNotAllowedCollections(resolvedCollections, authController);\n\n    if (plugins) {\n        plugins.forEach((plugin: FireCMSPlugin) => {\n            if (plugin.collections?.injectCollections) {\n                resolvedCollections = plugin.collections?.injectCollections(resolvedCollections ?? []);\n            }\n        });\n    }\n    return resolvedCollections;\n}\n\nasync function resolveCMSViews(baseViews: CMSView[] | CMSViewsBuilder | undefined, authController: AuthController, dataSource: DataSource) {\n    let resolvedViews: CMSView[] = [];\n    if (typeof baseViews === \"function\") {\n        resolvedViews = await baseViews({\n            user: authController.user,\n            authController,\n            dataSource\n        });\n    } else if (Array.isArray(baseViews)) {\n        resolvedViews = baseViews;\n    }\n    return resolvedViews;\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { SideDialogPanelProps, SideDialogsController } from \"../../types\";\nimport equal from \"react-fast-compare\"\n\nexport function useBuildSideDialogsController(): SideDialogsController {\n\n    const location = useLocation();\n    const navigate = useNavigate();\n\n    const [sidePanels, setSidePanels] = useState<SideDialogPanelProps[]>([]);\n    const sidePanelsRef = useRef<SideDialogPanelProps[]>(sidePanels);\n\n    const routesStore = useRef<Record<string, SideDialogPanelProps>>({});\n    const routesCount = useRef<number>(0);\n\n    const updateSidePanels = (newPanels: SideDialogPanelProps[]) => {\n        sidePanelsRef.current = newPanels;\n        setSidePanels(newPanels);\n    };\n\n    useEffect(() => {\n        const state = location.state as any;\n        const panelKeys: string[] = state?.panels ?? [];\n        const newPanels = panelKeys\n            .map(key => routesStore.current[key])\n            .filter(p => Boolean(p)) as SideDialogPanelProps[];\n        if (!equal(sidePanelsRef.current.map(p => p.key), newPanels.map(p => p.key)))\n            updateSidePanels(newPanels);\n    }, [location]);\n\n    const close = useCallback(() => {\n\n        if (sidePanels.length === 0)\n            return;\n\n        const lastSidePanel = sidePanels[sidePanels.length - 1];\n        const updatedPanels = [...sidePanels.slice(0, -1)];\n        updateSidePanels(updatedPanels);\n\n        if (routesCount.current > 0) {\n            if (lastSidePanel.urlPath)\n                navigate(-1);\n            routesCount.current--;\n        } else if (lastSidePanel.parentUrlPath) {\n            const baseLocation = (location.state as any)?.base_location ?? location;\n            navigate(\n                lastSidePanel.parentUrlPath,\n                {\n                    replace: true,\n                    state: {\n                        base_location: baseLocation,\n                        panels: updatedPanels.map(p => p.key)\n                    }\n                }\n            );\n        }\n    }, [sidePanels, navigate, location]);\n\n    const open = useCallback((panelProps: SideDialogPanelProps | SideDialogPanelProps[]) => {\n\n        const newPanels: SideDialogPanelProps[] = Array.isArray(panelProps) ? panelProps : [panelProps];\n\n        newPanels.forEach((panel) => {\n            routesStore.current[panel.key] = panel;\n        });\n        routesCount.current = routesCount.current + newPanels.length;\n\n        const baseLocation = (location.state as any)?.base_location ?? location;\n\n        const updatedPanels = [...sidePanels, ...newPanels];\n        updateSidePanels(updatedPanels);\n\n        newPanels.forEach((panel) => {\n            if (panel.urlPath) {\n                navigate(\n                    panel.urlPath,\n                    {\n                        state: {\n                            base_location: baseLocation,\n                            panels: updatedPanels.map(p => p.key)\n                        }\n                    }\n                );\n            }\n        });\n\n    }, [location, navigate, sidePanels]);\n\n    const replace = useCallback((panelProps: SideDialogPanelProps | SideDialogPanelProps[]) => {\n\n        const newPanels: SideDialogPanelProps[] = Array.isArray(panelProps) ? panelProps : [panelProps];\n        newPanels.forEach((panel) => {\n            routesStore.current[panel.key] = panel;\n        });\n\n        const baseLocation = (location.state as any)?.base_location ?? location;\n\n        const updatedPanels = [...sidePanels.slice(0, -newPanels.length), ...newPanels];\n        updateSidePanels(updatedPanels);\n\n        newPanels.forEach((panel) => {\n            if (panel.urlPath) {\n                navigate(\n                    panel.urlPath,\n                    {\n                        replace: true,\n                        state: {\n                            base_location: baseLocation,\n                            panels: updatedPanels.map(p => p.key)\n                        }\n                    }\n                );\n            }\n        });\n\n    }, [location, navigate, sidePanels]);\n\n    return {\n        sidePanels,\n        close,\n        open,\n        replace\n    };\n}\n","import React from \"react\";\n\nimport { AdapterDateFns } from \"@mui/x-date-pickers/AdapterDateFns\";\nimport { LocalizationProvider } from \"@mui/x-date-pickers/LocalizationProvider\";\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport * as locales from \"date-fns/locale\";\n\nimport { FireCMSContext, FireCMSPlugin, FireCMSProps, User } from \"../types\";\nimport { BreadcrumbsProvider } from \"./contexts/BreacrumbsContext\";\nimport { ModeControllerContext } from \"./contexts/ModeController\";\nimport {\n    useBuildSideEntityController\n} from \"./internal/useBuildSideEntityController\";\nimport {\n    useBuildNavigationContext\n} from \"./internal/useBuildNavigationContext\";\nimport {\n    useBuildSideDialogsController\n} from \"./internal/useBuildSideDialogsController\";\nimport {\n    FireCMSContextInstance,\n    useFireCMSContext,\n    useModeController\n} from \"../hooks\";\nimport { CenteredView, ErrorView } from \"./components\";\nimport { StorageSourceContext } from \"./contexts/StorageSourceContext\";\nimport {\n    UserConfigurationPersistenceContext\n} from \"./contexts/UserConfigurationPersistenceContext\";\nimport { DataSourceContext } from \"./contexts/DataSourceContext\";\nimport {\n    SideEntityControllerContext\n} from \"./contexts/SideEntityControllerContext\";\nimport { NavigationContextInstance } from \"./contexts/NavigationContext\";\nimport { AuthControllerContext } from \"./contexts/AuthControllerContext\";\nimport {\n    SideDialogsControllerContext\n} from \"./contexts/SideDialogsControllerContext\";\n\nconst DEFAULT_COLLECTION_PATH = \"/c\";\n\n/**\n * If you are using independent components of the CMS\n * you need to wrap them with this main component, so the internal hooks work.\n *\n * This is the main component of FireCMS. It acts as the provider of all the\n * internal contexts and hooks.\n *\n * You only need to use this component if you are building a custom app.\n * In most cases you can just use the {@link FirebaseCMSApp} component.\n *\n * @constructor\n * @category Core\n */\nexport function FireCMS<UserType extends User>(props: FireCMSProps<UserType>) {\n\n    const modeController = useModeController();\n    const {\n        children,\n        collections,\n        views,\n        entityLinkBuilder,\n        userConfigPersistence,\n        dateTimeFormat,\n        locale,\n        authController,\n        collectionOverrideHandler,\n        storageSource,\n        dataSource,\n        basePath,\n        baseCollectionPath,\n        plugins,\n        onAnalyticsEvent,\n        fields\n    } = props;\n\n    const usedBasePath = basePath ?? \"/\";\n    const usedBasedCollectionPath = baseCollectionPath ?? DEFAULT_COLLECTION_PATH;\n\n    // @ts-ignore\n    const dateUtilsLocale = locale ? locales[locale] : undefined;\n\n    const navigation = useBuildNavigationContext({\n        basePath: usedBasePath,\n        baseCollectionPath: usedBasedCollectionPath,\n        authController,\n        collections,\n        views,\n        collectionOverrideHandler,\n        userConfigPersistence,\n        dataSource,\n        plugins\n    });\n\n    const sideDialogsController = useBuildSideDialogsController();\n    const sideEntityController = useBuildSideEntityController(navigation, sideDialogsController);\n\n    const loading = authController.initialLoading || navigation.loading || (plugins?.some(p => p.loading) ?? false);\n\n    if (navigation.navigationLoadingError) {\n        return (\n            <CenteredView maxWidth={300} fullScreen={true}>\n                <ErrorView\n                    title={\"Error loading navigation\"}\n                    error={navigation.navigationLoadingError}/>\n            </CenteredView>\n        );\n    }\n\n    if (authController.authError) {\n        return (\n            <CenteredView maxWidth={300} fullScreen={true}>\n                <ErrorView\n                    title={\"Error loading auth\"}\n                    error={authController.authError}/>\n            </CenteredView>\n        );\n    }\n\n    const context: Partial<FireCMSContext> = {\n        entityLinkBuilder,\n        dateTimeFormat,\n        locale,\n        plugins,\n        onAnalyticsEvent,\n        fields: fields ?? {}\n    };\n\n    return (\n        <ModeControllerContext.Provider value={modeController}>\n            <FireCMSContextInstance.Provider value={context}>\n                <UserConfigurationPersistenceContext.Provider\n                    value={userConfigPersistence}>\n                    <StorageSourceContext.Provider\n                        value={storageSource}>\n                        <DataSourceContext.Provider\n                            value={dataSource}>\n                            <AuthControllerContext.Provider\n                                value={authController}>\n                                <SideDialogsControllerContext.Provider\n                                    value={sideDialogsController}>\n                                    <SideEntityControllerContext.Provider\n                                        value={sideEntityController}>\n                                        <NavigationContextInstance.Provider\n                                            value={navigation}>\n                                            <BreadcrumbsProvider>\n                                                <LocalizationProvider\n                                                    dateAdapter={AdapterDateFns}\n                                                    utils={DateFnsUtils}\n                                                    locale={dateUtilsLocale}>\n                                                    <FireCMSInternal\n                                                        loading={loading}>\n                                                        {children}\n                                                    </FireCMSInternal>\n                                                </LocalizationProvider>\n                                            </BreadcrumbsProvider>\n                                        </NavigationContextInstance.Provider>\n                                    </SideEntityControllerContext.Provider>\n                                </SideDialogsControllerContext.Provider>\n                            </AuthControllerContext.Provider>\n                        </DataSourceContext.Provider>\n                    </StorageSourceContext.Provider>\n                </UserConfigurationPersistenceContext.Provider>\n            </FireCMSContextInstance.Provider>\n        </ModeControllerContext.Provider>\n    );\n}\n\nfunction FireCMSInternal({\n                             loading,\n                             children\n                         }: {\n    loading: boolean;\n    children: (props: {\n        context: FireCMSContext;\n        loading: boolean;\n    }) => React.ReactNode;\n}) {\n\n    const context = useFireCMSContext();\n    let childrenResult = children({\n        context,\n        loading\n    });\n\n    const plugins = context.plugins;\n    if (!loading && plugins) {\n        plugins.forEach((plugin: FireCMSPlugin) => {\n            if (plugin.provider) {\n                childrenResult = (\n                    <plugin.provider.Component {...plugin.provider.props}\n                                               context={context}>\n                        {childrenResult}\n                    </plugin.provider.Component>\n                );\n            }\n        });\n    }\n\n    return <>{childrenResult}</>;\n}\n","import { pink, red } from \"@mui/material/colors\";\nimport { createTheme, Theme } from \"@mui/material\";\nimport type {} from \"@mui/lab/themeAugmentation\";\n\ndeclare module \"@mui/material/styles\" {\n    interface TypographyVariants {\n        label: React.CSSProperties;\n    }\n\n    interface TypographyVariantsOptions {\n        label?: React.CSSProperties;\n    }\n}\n\ndeclare module \"@mui/material/Typography\" {\n    interface TypographyPropsVariantOverrides {\n        label: true;\n    }\n}\n\n/**\n * Use this function to build the default FireCMS MUI5 theme,\n * with some overrides.\n * @category Hooks and utilities\n */\nexport const createCMSDefaultTheme = (\n    { mode, primaryColor, secondaryColor, fontFamily, headersFontFamily }: {\n        mode: \"light\" | \"dark\";\n        primaryColor?: string;\n        secondaryColor?: string;\n        fontFamily?: string;\n        headersFontFamily?: string;\n    }): Theme => {\n\n    const radius = 6;\n\n    const { palette } = createTheme();\n    const { augmentColor } = palette;\n    const createColor = (mainColor: string) => augmentColor({ color: { main: mainColor } });\n\n    const original = createTheme({\n        palette: {\n            mode,\n            background: {\n                default: mode === \"dark\" ? \"#202024\" : \"#f8f8fa\",\n                paper: mode === \"dark\" ? \"#121215\" : \"#ffffff\"\n            },\n            primary: {\n                main: primaryColor || \"#0070f4\"\n            },\n            secondary: {\n                main: secondaryColor || pink[\"400\"]\n            },\n            error: {\n                main: red.A400\n            }\n        },\n        shape: {\n            borderRadius: radius\n        },\n        typography: {\n            fontFamily: fontFamily || \"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif\",\n            fontWeightMedium: 500,\n            h6: {\n                fontFamily: fontFamily || \"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif\",\n                fontSize: \"1.15rem\",\n                fontWeight: 500\n            },\n            h5: {\n                fontFamily: fontFamily || \"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif\",\n                fontSize: \"1.55rem\"\n            },\n            h4: {\n                fontFamily: fontFamily || \"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif\",\n                fontSize: \"2rem\",\n                fontWeight: 500\n            },\n            h3: {\n                fontFamily: fontFamily || \"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif\",\n                fontWeight: 600\n            },\n            h2: {\n                fontFamily: headersFontFamily || \"'IBM Plex Mono', 'Space Mono', 'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif\",\n                fontWeight: 600\n            },\n            h1: {\n                fontFamily: headersFontFamily || \"'IBM Plex Mono', 'Space Mono', 'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif\",\n                fontWeight: 600\n            },\n            label: {\n                display: \"block\",\n                color: \"#838383\",\n                fontWeight: 500,\n                fontSize: \"0.875rem\",\n                lineHeight: 1.43\n            }\n        },\n        components: {\n            MuiSkeleton: {\n                styleOverrides: {\n                    root: {\n                        borderRadius: radius\n                    }\n                }\n            },\n            MuiButton: {\n                styleOverrides: {\n                    root: {\n                        borderRadius: radius\n                    }\n                }\n            },\n            MuiLoadingButton: {\n                styleOverrides: {\n                    root: {\n                        borderRadius: radius\n                    }\n                }\n            },\n            MuiTableRow: {\n                styleOverrides: {\n                    root: {\n                        \"&:last-child td\": {\n                            borderBottom: 0\n                        }\n                    }\n                }\n            },\n            MuiTypography: {\n                styleOverrides: {\n                    root: {\n                        \"&.mono\": {\n                            fontFamily: \"'IBM Plex Mono', 'Space Mono', monospace, 'Lucida Console'\"\n                        },\n                        \"&.weight-500\": {\n                            fontWeight: 500\n                        }\n                    }\n                }\n            },\n            MuiInputBase: {\n                styleOverrides: {\n                    root: {\n                        \"&.mono\": {\n                            fontFamily: \"'IBM Plex Mono', 'Space Mono', 'Lucida Console', monospace\"\n                        },\n                        \"& input::-webkit-outer-spin-button, & input::-webkit-inner-spin-button\": {\n                            display: \"none\"\n                        },\n                        \"& input[type=number]\": {\n                            MozAppearance: \"textfield\"\n                        }\n                    }\n                }\n            },\n            MuiDialog: {\n                styleOverrides: {\n                    paper: {\n                        backgroundImage: \"inherit\",\n                    }\n                }\n            },\n            // MuiPaper: {\n            //     styleOverrides: {\n            //         outlined: {\n            //             border: \"none\",\n            //         }\n            //     }\n            // },\n            MuiCardActionArea: {\n                styleOverrides: {\n                    root: {\n                        borderRadius: radius\n                    }\n                }\n            }\n        }\n    });\n\n    return {\n        ...original,\n        // @ts-ignore\n        shadows: original.shadows.map((shadow, index) => {\n            if (index === 3) {\n                return \"0px 0px 0px 0px rgba(0,0,0,0.18), 0px 0px 10px 0px rgba(0,0,0,0.12), 0px 0px 14px 2px rgba(0,0,0,0.10)\"\n            }\n            return shadow;\n        })\n    };\n};\n","import React, { PropsWithChildren } from \"react\";\n\nimport { Route, Routes, useLocation } from \"react-router-dom\";\nimport { CMSView } from \"../types\";\nimport {\n    EntityCollectionView,\n    FireCMSHomePage,\n    NotFoundPage\n} from \"./components\";\nimport {\n    useBreadcrumbsContext,\n    useFireCMSContext,\n    useNavigationContext\n} from \"../hooks\";\nimport { toArray } from \"./util/arrays\";\nimport equal from \"react-fast-compare\"\n\n/**\n * @category Components\n */\nexport type NavigationRoutesProps = {\n    /**\n     * In case you need to override the home page\n     */\n    HomePage?: React.ComponentType;\n\n    customRoutes?: React.ReactNode[]\n\n};\n\n/**\n * This component is in charge of rendering\n * all the related routes (entity collection root views, custom views\n * or the home route) related to a {@link NavigationContext}.\n * This component needs a parent {@link FireCMS}\n *\n * @constructor\n * @category Components\n */\n\nexport const NavigationRoutes = React.memo<NavigationRoutesProps>(\n    function NavigationRoutes({\n                                  HomePage = FireCMSHomePage,\n                                  customRoutes\n                              }: NavigationRoutesProps) {\n\n        const location = useLocation();\n        const navigation = useNavigationContext();\n\n        const context = useFireCMSContext();\n        const plugins = context.plugins ?? [];\n\n        if (!navigation)\n            return <></>;\n\n        const state = location.state as any;\n\n        /**\n         * The location can be overridden if `base_location` is set in the\n         * state field of the current location. This can happen if you open\n         * a side entity, like `products`, from a different one, like `users`\n         */\n        const baseLocation = state && state.base_location ? state.base_location : location;\n\n        const cmsViews: React.ReactNode[] = [];\n        if (navigation.views) {\n            navigation.views.forEach((cmsView) => {\n                if (Array.isArray(cmsView.path))\n                    cmsViews.push(...cmsView.path.map(path => buildCMSViewRoute(path, cmsView)));\n                else\n                    cmsViews.push(buildCMSViewRoute(cmsView.path, cmsView));\n            });\n        }\n\n        // we reorder collections so that nested paths are included first\n        const sortedCollections = [...(navigation.collections ?? [])]\n            .sort((a, b) => b.path.length - a.path.length);\n\n        const collectionRoutes = sortedCollections\n            .map((collection) => {\n                    const urlPath = navigation.buildUrlCollectionPath(collection.alias ?? collection.path);\n                    const allActions:React.ComponentType<any>[] = [];\n                    if (plugins) {\n                        plugins.forEach(plugin => {\n                            if (plugin.collections?.CollectionActions) {\n                                allActions.push(...toArray(plugin.collections?.CollectionActions));\n                            }\n                        });\n                    }\n                    allActions.push(...toArray(collection.Actions));\n                    return <Route path={urlPath + \"/*\"}\n                                  key={`navigation_${collection.alias ?? collection.path}`}\n                                  element={\n                                      <RouteWrapper\n                                          path={urlPath}\n                                          title={collection.name}\n                                          type={\"collection\"}>\n                                          <EntityCollectionView\n                                              key={`collection_view_${collection.alias ?? collection.path}`}\n                                              isSubCollection={false}\n                                              fullPath={collection.alias ?? collection.path}\n                                              {...collection}\n                                              Actions={allActions}/>\n                                      </RouteWrapper>\n                                  }/>;\n                }\n            );\n\n        const homeRoute = (\n            <Route path={\"/\"}\n                   element={\n                       <RouteWrapper\n                           path={navigation.homeUrl}\n                           key={\"navigation_home\"}\n                           title={\"Home\"}\n                           type={\"home\"}>\n                           <HomePage/>\n                       </RouteWrapper>\n                   }/>\n        );\n\n        const notFoundRoute = <Route path={\"*\"}\n                                     element={\n                                         <NotFoundPage/>\n                                     }/>;\n\n        return (\n            <Routes location={baseLocation}>\n\n                {collectionRoutes}\n\n                {cmsViews}\n\n                {homeRoute}\n\n                {notFoundRoute}\n\n                {customRoutes}\n\n            </Routes>\n        );\n    });\n\nconst buildCMSViewRoute = (path: string, cmsView: CMSView) => {\n    return <Route\n        key={\"navigation_view_\" + path}\n        path={path}\n        element={\n            <RouteWrapper\n                path={path}\n                key={`navigation_${path}`}\n                title={cmsView.name}\n                type={\"view\"}>\n                {cmsView.view}\n            </RouteWrapper>}\n    />;\n};\n\ninterface RouteWrapperProps {\n    title: string;\n    path: string;\n    type: \"collection\" | \"view\" | \"home\";\n}\n\n/**\n * This component updates the breadcrumb in the app bar when rendered\n * @param children\n * @param title\n * @param path\n * @param type\n * @constructor\n * @category Components\n */\n\nexport const RouteWrapper = React.memo<PropsWithChildren<RouteWrapperProps>>(\n    function RouteWrapper({\n                              children,\n                              title,\n                              path,\n                              type\n                          }\n                              : PropsWithChildren<RouteWrapperProps>) {\n\n        const breadcrumbsContext = useBreadcrumbsContext();\n\n        React.useEffect(() => {\n            breadcrumbsContext.set({\n                breadcrumbs: [{\n                    title,\n                    url: path\n                }]\n            });\n        }, [path, title]);\n\n        return <>{children}</>;\n    }, equal);\n","import {\n    AdditionalFieldDelegate,\n    ArrayProperty,\n    BooleanProperty,\n    CMSType,\n    DateProperty,\n    EntityCallbacks,\n    EntityCollection,\n    EnumValueConfig,\n    EnumValues,\n    FieldConfig,\n    GeopointProperty,\n    MapProperty,\n    NumberProperty,\n    PropertiesOrBuilders,\n    PropertyBuilder,\n    PropertyOrBuilder,\n    ReferenceProperty,\n    StringProperty,\n    User\n} from \"../types\";\n\n/**\n * Identity function we use to defeat the type system of Typescript and build\n * collection views with all its properties\n * @param collection\n * @category Builder\n */\nexport function buildCollection<M extends Record<string, any> = any,\n    AdditionalKey extends string = string,\n    UserType extends User = User>(\n    collection: EntityCollection<M, AdditionalKey, UserType>\n): EntityCollection<M, AdditionalKey, UserType> {\n    return collection;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and preserve\n * the property keys.\n * @param property\n * @category Builder\n */\nexport function buildProperty<T extends CMSType = CMSType, P extends PropertyOrBuilder<T> = PropertyOrBuilder<T>, M extends Record<string, any> = Record<string, any>>(\n    property: P\n):\n    P extends StringProperty ? StringProperty :\n        P extends NumberProperty ? NumberProperty :\n            P extends BooleanProperty ? BooleanProperty :\n                P extends DateProperty ? DateProperty :\n                    P extends GeopointProperty ? GeopointProperty :\n                        P extends ReferenceProperty ? ReferenceProperty :\n                            P extends ArrayProperty ? ArrayProperty :\n                                P extends MapProperty ? MapProperty :\n                                    P extends PropertyBuilder<T, M> ? PropertyBuilder<T, M> : never {\n    return property as any;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and preserve\n * the properties keys.\n * @param properties\n * @category Builder\n */\nexport function buildProperties<M extends Record<string, any>>(\n    properties: PropertiesOrBuilders<M>\n): PropertiesOrBuilders<M> {\n    return properties;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and preserve\n * the properties keys.\n * @param propertiesOrBuilder\n * @category Builder\n */\nexport function buildPropertiesOrBuilder<M extends Record<string, any>>(\n    propertiesOrBuilder: PropertiesOrBuilders<M>\n): PropertiesOrBuilders<M> {\n    return propertiesOrBuilder;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and preserve\n * the properties keys.\n * @param enumValues\n * @category Builder\n */\nexport function buildEnumValues(\n    enumValues: EnumValues\n): EnumValues {\n    return enumValues;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and preserve\n * the properties keys.\n * @param enumValueConfig\n * @category Builder\n */\nexport function buildEnumValueConfig(\n    enumValueConfig: EnumValueConfig\n): EnumValueConfig {\n    return enumValueConfig;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and preserve\n * the properties keys.\n * @param callbacks\n * @category Builder\n */\nexport function buildEntityCallbacks<M extends Record<string, any> = any>(\n    callbacks: EntityCallbacks<M>\n): EntityCallbacks<M> {\n    return callbacks;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and build\n * additional field delegates views with all its properties\n * @param additionalFieldDelegate\n * @category Builder\n */\nexport function buildAdditionalFieldDelegate<M extends Record<string, any>, AdditionalKey extends string = string, UserType extends User = User>(\n    additionalFieldDelegate: AdditionalFieldDelegate<M, AdditionalKey, UserType>\n): AdditionalFieldDelegate<M, AdditionalKey, UserType> {\n    return additionalFieldDelegate;\n}\n\n/**\n * Identity function we use to defeat the type system of Typescript and build\n * additional field delegates views with all its properties\n * @param fieldConfig\n * @category Builder\n */\nexport function buildFieldConfig<T extends CMSType = CMSType>(\n    fieldConfig: FieldConfig<T>\n): FieldConfig<T> {\n    return fieldConfig;\n}\n","import { useMediaQuery } from \"@mui/material\";\nimport React, { useCallback, useEffect, useState } from \"react\";\n\nimport { ModeController } from \"../hooks/useModeController\";\n\n/**\n * Use this hook to build a color mode controller that determines\n * the theme of the CMS\n */\nexport function useBuildModeController(): ModeController {\n\n    const prefersDarkModeQuery = useMediaQuery(\"(prefers-color-scheme: dark)\");\n    const prefersDarkModeStorage: boolean | null = localStorage.getItem(\"prefers-dark-mode\") != null ? localStorage.getItem(\"prefers-dark-mode\") === \"true\" : null;\n    const prefersDarkMode = prefersDarkModeStorage ?? prefersDarkModeQuery;\n    const [mode, setMode] = useState<\"light\" | \"dark\">(prefersDarkMode ? \"dark\" : \"light\");\n\n    useEffect(() => {\n        setMode(prefersDarkMode ? \"dark\" : \"light\");\n        setDocumentMode(prefersDarkMode ? \"dark\" : \"light\");\n    }, [prefersDarkMode]);\n\n    // color-scheme: dark;\n    const setDarkMode = useCallback(() => {\n        setMode(\"dark\");\n        setDocumentMode(\"dark\");\n    }, [prefersDarkModeQuery]);\n\n    const setLightMode = useCallback(() => {\n        setMode(\"light\");\n        setDocumentMode(\"light\");\n    }, []);\n\n    const setDocumentMode = useCallback((mode: \"light\" | \"dark\") => {\n        document.body.style.setProperty(\"color-scheme\", mode);\n    }, [document]);\n\n    const toggleMode = useCallback(() => {\n\n        if (mode === \"light\") {\n            if (!prefersDarkModeQuery)\n                localStorage.setItem(\"prefers-dark-mode\", \"true\");\n            else\n                localStorage.removeItem(\"prefers-dark-mode\");\n            setDarkMode();\n        } else {\n            if (prefersDarkModeQuery)\n                localStorage.setItem(\"prefers-dark-mode\", \"false\");\n            else\n                localStorage.removeItem(\"prefers-dark-mode\");\n            setLightMode();\n        }\n    }, [mode, prefersDarkModeQuery]);\n\n    return {\n        mode,\n        setMode,\n        toggleMode\n    };\n}\n","import { useCallback, useEffect, useState } from \"react\";\nimport {\n    PartialEntityCollection,\n    UserConfigurationPersistence\n} from \"../types\";\nimport { mergeDeep, stripCollectionPath } from \"./util\";\n\nexport function useBuildLocalConfigurationPersistence(): UserConfigurationPersistence {\n\n    const [configCache, setConfigCache] = useState<Record<string, PartialEntityCollection>>({});\n\n    const getCollectionFromStorage = useCallback((storageKey: string) => {\n        const item = localStorage.getItem(storageKey);\n        return item ? JSON.parse(item) : {};\n    }, []);\n\n    const getCollectionConfig = useCallback(<M extends Record<string, any>>(path: string): PartialEntityCollection<M> => {\n        const storageKey = `collection_config::${stripCollectionPath(path)}`;\n        if (configCache[storageKey]) {\n            return configCache[storageKey] as PartialEntityCollection<M>;\n        }\n        return getCollectionFromStorage(storageKey);\n    }, [configCache, getCollectionFromStorage]);\n\n    const onCollectionModified = useCallback(<M extends Record<string, any>>(path: string, data: PartialEntityCollection<M>) => {\n        const storageKey = `collection_config::${stripCollectionPath(path)}`;\n        localStorage.setItem(storageKey, JSON.stringify(data));\n        setConfigCache((currentCache) => {\n            const cachedConfig = currentCache[storageKey];\n            const newConfig = mergeDeep(cachedConfig ?? getCollectionFromStorage(path), data);\n            return (mergeDeep(currentCache, newConfig));\n        });\n    }, [getCollectionFromStorage]);\n\n    const [recentlyVisitedPaths, _setRecentlyVisitedPaths] = useState<string[]>([]);\n    const [favouritePaths, _setFavouritePaths] = useState<string[]>([]);\n    const [collapsedGroups, _setCollapsedGroups] = useState<string[]>([]);\n\n    useEffect(() => {\n        _setRecentlyVisitedPaths(localStorage.getItem(\"recently_visited_paths\") ? JSON.parse(localStorage.getItem(\"recently_visited_paths\")!) : []);\n        _setFavouritePaths(localStorage.getItem(\"favourite_paths\") ? JSON.parse(localStorage.getItem(\"favourite_paths\")!) : []);\n        _setCollapsedGroups(localStorage.getItem(\"collapsed_groups\") ? JSON.parse(localStorage.getItem(\"collapsed_groups\")!) : []);\n    }, []);\n\n    const setRecentlyVisitedPaths = useCallback((paths: string[]) => {\n        localStorage.setItem(\"recently_visited_paths\", JSON.stringify(paths));\n        _setRecentlyVisitedPaths(paths);\n    }, []);\n\n    const setFavouritePaths = useCallback((paths: string[]) => {\n        localStorage.setItem(\"favourite_paths\", JSON.stringify(paths));\n        _setFavouritePaths(paths);\n    }, []);\n\n    const setCollapsedGroups = useCallback((paths: string[]) => {\n        localStorage.setItem(\"collapsed_groups\", JSON.stringify(paths));\n        _setCollapsedGroups(paths);\n    }, []);\n\n    return {\n        onCollectionModified,\n        getCollectionConfig,\n        recentlyVisitedPaths,\n        setRecentlyVisitedPaths,\n        favouritePaths,\n        setFavouritePaths,\n        collapsedGroups,\n        setCollapsedGroups\n    }\n}\n","import React, { PropsWithChildren } from \"react\";\nimport { SnackbarProvider as NotistackSnackbarProvider } from \"notistack\";\n\nexport const SnackbarProvider: React.FC<PropsWithChildren<{}>> = ({ children }) => {\n\n    return (\n        <NotistackSnackbarProvider maxSnack={3}\n                                   autoHideDuration={3500}>\n            {children}\n        </NotistackSnackbarProvider>\n    );\n};\n","import { useCallback, useEffect, useState } from \"react\";\n\nimport {\n    ApplicationVerifier,\n    Auth,\n    ConfirmationResult,\n    createUserWithEmailAndPassword as createUserWithEmailAndPasswordFirebase,\n    FacebookAuthProvider,\n    fetchSignInMethodsForEmail as fetchSignInMethodsForEmailFirebase,\n    getAuth,\n    GithubAuthProvider,\n    GoogleAuthProvider,\n    OAuthProvider,\n    onAuthStateChanged,\n    signInAnonymously,\n    signInWithEmailAndPassword,\n    signInWithPhoneNumber,\n    signInWithPopup,\n    signOut,\n    TwitterAuthProvider,\n    User as FirebaseUser\n} from \"firebase/auth\";\nimport { FirebaseApp } from \"firebase/app\";\nimport { AuthController } from \"../../types\";\nimport {\n    FirebaseAuthController,\n    FirebaseSignInOption,\n    FirebaseSignInProvider\n} from \"../types/auth\";\n\ninterface FirebaseAuthHandlerProps {\n    firebaseApp?: FirebaseApp;\n    signInOptions: Array<FirebaseSignInProvider | FirebaseSignInOption>;\n}\n\n/**\n * Use this hook to build an {@link AuthController} based on Firebase Auth\n * @category Firebase\n */\nexport const useFirebaseAuthController = (\n    {\n        firebaseApp,\n        signInOptions\n    }: FirebaseAuthHandlerProps): FirebaseAuthController => {\n\n    const [loggedUser, setLoggedUser] = useState<FirebaseUser | null | undefined>(undefined); // logged user, anonymous or logged out\n    const [authError, setAuthError] = useState<any>();\n    const [authProviderError, setAuthProviderError] = useState<any>();\n    const [initialLoading, setInitialLoading] = useState(true);\n    const [authLoading, setAuthLoading] = useState(true);\n    const [loginSkipped, setLoginSkipped] = useState<boolean>(false);\n    const [confirmationResult, setConfirmationResult] = useState<undefined | ConfirmationResult>();\n\n    const [extra, setExtra] = useState<any>();\n\n    useEffect(() => {\n        if (!firebaseApp) return;\n        try {\n            const auth = getAuth(firebaseApp);\n            setAuthError(undefined);\n            setLoggedUser(auth.currentUser)\n            return onAuthStateChanged(\n                auth,\n                updateFirebaseUser,\n                error => setAuthProviderError(error)\n            );\n        } catch (e) {\n            setAuthError(e);\n            return () => {\n            };\n        }\n    }, [firebaseApp]);\n\n    const skipLogin = useCallback(() => {\n        setLoginSkipped(true);\n        setLoggedUser(null);\n    }, []);\n\n    const updateFirebaseUser = useCallback(async (firebaseUser: FirebaseUser | null) => {\n        setLoggedUser(firebaseUser);\n        setInitialLoading(false);\n        setAuthLoading(false);\n    }, []);\n\n    const onSignOut = useCallback(() => {\n        const auth = getAuth(firebaseApp);\n        signOut(auth)\n            .then(_ => {\n                setLoggedUser(null);\n                setAuthProviderError(null);\n            });\n        setLoginSkipped(false);\n    }, [firebaseApp]);\n\n    const getProviderOptions = useCallback((providerId: FirebaseSignInProvider): FirebaseSignInOption | undefined => {\n        return signInOptions.find((option) => {\n            if (option === null) throw Error(\"useFirebaseAuthController\");\n            if (typeof option === \"object\" && option.provider === providerId)\n                return option as FirebaseSignInOption;\n            return undefined;\n        }) as FirebaseSignInOption | undefined;\n    }, [signInOptions]);\n\n    const googleLogin = useCallback(() => {\n        const provider = new GoogleAuthProvider();\n        const options = getProviderOptions(\"google.com\");\n        if (options?.scopes)\n            options.scopes.forEach((scope) => provider.addScope(scope));\n        if (options?.customParameters)\n            provider.setCustomParameters(options.customParameters);\n        const auth = getAuth();\n        signInWithPopup(auth, provider).catch(setAuthProviderError);\n    }, [getProviderOptions]);\n\n    const doOauthLogin = useCallback((auth: Auth, provider: OAuthProvider | FacebookAuthProvider | GithubAuthProvider | TwitterAuthProvider) => {\n        setAuthLoading(true);\n        signInWithPopup(auth, provider)\n            .catch(setAuthProviderError).then(() => setAuthLoading(false));\n    }, []);\n\n    const anonymousLogin = useCallback(() => {\n        const auth = getAuth();\n        setAuthLoading(true);\n        signInAnonymously(auth)\n            .catch(setAuthProviderError)\n            .then(() => setAuthLoading(false));\n    }, []);\n\n    const phoneLogin = useCallback((phone: string, applicationVerifier: ApplicationVerifier) => {\n        const auth = getAuth();\n        setAuthLoading(true);\n        return signInWithPhoneNumber(auth, phone, applicationVerifier)\n            .catch(setAuthProviderError)\n            .then((res) => {\n                setAuthLoading(false);\n                setConfirmationResult(res ?? undefined);\n            });\n    }, []);\n\n    const appleLogin = useCallback(() => {\n        const provider = new OAuthProvider(\"apple.com\");\n        const options = getProviderOptions(\"apple.com\");\n        if (options?.scopes)\n            options.scopes.forEach((scope) => provider.addScope(scope));\n        if (options?.customParameters)\n            provider.setCustomParameters(options.customParameters);\n        const auth = getAuth();\n        doOauthLogin(auth, provider);\n    }, [doOauthLogin, getProviderOptions]);\n\n    const facebookLogin = useCallback(() => {\n        const provider = new FacebookAuthProvider();\n        const options = getProviderOptions(\"facebook.com\");\n        if (options?.scopes)\n            options.scopes.forEach((scope) => provider.addScope(scope));\n        if (options?.customParameters)\n            provider.setCustomParameters(options.customParameters);\n        const auth = getAuth();\n        doOauthLogin(auth, provider);\n    }, [doOauthLogin, getProviderOptions]);\n\n    const githubLogin = useCallback(() => {\n        const provider = new GithubAuthProvider();\n        const options = getProviderOptions(\"github.com\");\n        if (options?.scopes)\n            options.scopes.forEach((scope) => provider.addScope(scope));\n        if (options?.customParameters)\n            provider.setCustomParameters(options.customParameters);\n        const auth = getAuth();\n        doOauthLogin(auth, provider);\n    }, [doOauthLogin, getProviderOptions]);\n\n    const microsoftLogin = useCallback(() => {\n        const provider = new OAuthProvider(\"microsoft.com\");\n        const options = getProviderOptions(\"microsoft.com\");\n        if (options?.scopes)\n            options.scopes.forEach((scope) => provider.addScope(scope));\n        if (options?.customParameters)\n            provider.setCustomParameters(options.customParameters);\n        const auth = getAuth();\n        doOauthLogin(auth, provider);\n    }, [doOauthLogin, getProviderOptions]);\n\n    const twitterLogin = useCallback(() => {\n        const provider = new TwitterAuthProvider();\n        const options = getProviderOptions(\"twitter.com\");\n        if (options?.customParameters)\n            provider.setCustomParameters(options.customParameters);\n        const auth = getAuth();\n        doOauthLogin(auth, provider);\n    }, [doOauthLogin, getProviderOptions]);\n\n    const emailPasswordLogin = useCallback((email: string, password: string) => {\n        const auth = getAuth();\n        setAuthLoading(true);\n        signInWithEmailAndPassword(auth, email, password)\n            .catch(setAuthProviderError)\n            .then(() => setAuthLoading(false));\n    }, []);\n\n    const createUserWithEmailAndPassword = useCallback((email: string, password: string) => {\n        const auth = getAuth();\n        setAuthLoading(true);\n        createUserWithEmailAndPasswordFirebase(auth, email, password)\n            .catch(setAuthProviderError)\n            .then(() => setAuthLoading(false));\n    }, []);\n\n    const fetchSignInMethodsForEmail = useCallback((email: string): Promise<string[]> => {\n        const auth = getAuth();\n        setAuthLoading(true);\n        return fetchSignInMethodsForEmailFirebase(auth, email)\n            .then((res) => {\n                setAuthLoading(false);\n                return res;\n            });\n    }, []);\n\n    const getAuthToken = useCallback(async (): Promise<string> => {\n        if (!loggedUser)\n            throw Error(\"User is not logged in\");\n        return loggedUser.getIdToken();\n    }, [loggedUser]);\n\n    return {\n        user: loggedUser ?? null,\n        authError,\n        authProviderError,\n        authLoading,\n        initialLoading,\n        getAuthToken,\n        confirmationResult,\n        signOut: onSignOut,\n        loginSkipped,\n        skipLogin,\n        googleLogin,\n        anonymousLogin,\n        appleLogin,\n        facebookLogin,\n        githubLogin,\n        microsoftLogin,\n        twitterLogin,\n        emailPasswordLogin,\n        phoneLogin,\n        fetchSignInMethodsForEmail,\n        createUserWithEmailAndPassword,\n        extra,\n        setExtra\n    };\n};\n","import { Timestamp } from \"firebase/firestore\";\n\nexport function setDateToMidnight(input?: Timestamp): Timestamp | undefined {\n    if (!input) return input;\n    const date = input.toDate();\n    date.setHours(0, 0, 0, 0);\n    return Timestamp.fromDate(date);\n}\n","import {\n    DataSource,\n    DeleteEntityProps,\n    Entity,\n    EntityCollection,\n    EntityReference,\n    EntityValues,\n    FetchCollectionProps,\n    FetchEntityProps,\n    FieldConfig,\n    FilterValues,\n    GeoPoint,\n    ListenCollectionProps,\n    ListenEntityProps,\n    ResolvedEntityCollection,\n    ResolvedProperties,\n    ResolvedProperty,\n    SaveEntityProps,\n    WhereFilterOp\n} from \"../../types\";\nimport { resolveCollection, sanitizeData, updateDateAutoValues } from \"../../core\";\nimport {\n    collection as collectionClause,\n    collectionGroup as collectionGroupClause,\n    CollectionReference,\n    deleteDoc,\n    deleteField,\n    doc,\n    DocumentReference,\n    DocumentSnapshot,\n    Firestore,\n    GeoPoint as FirestoreGeoPoint,\n    getCountFromServer,\n    getDoc,\n    getDocs,\n    getFirestore,\n    limit as limitClause,\n    onSnapshot,\n    orderBy as orderByClause,\n    Query,\n    query,\n    QueryConstraint,\n    serverTimestamp,\n    setDoc,\n    startAfter as startAfterClause,\n    Timestamp,\n    where as whereClause\n} from \"firebase/firestore\";\nimport { FirebaseApp } from \"firebase/app\";\nimport { FirestoreTextSearchController } from \"../types/text_search\";\nimport { useCallback } from \"react\";\nimport { setDateToMidnight } from \"../util/dates\";\n\n/**\n * @category Firebase\n */\nexport interface FirestoreDataSourceProps {\n    firebaseApp?: FirebaseApp,\n    textSearchController?: FirestoreTextSearchController,\n    fields?: Record<string, FieldConfig>;\n}\n\n/**\n * Use this hook to build a {@link DataSource} based on Firestore\n * @param firebaseApp\n * @param textSearchController\n * @param collectionRegistry\n * @category Firebase\n */\nexport function useFirestoreDataSource({\n                                           firebaseApp,\n                                           textSearchController,\n                                           fields = {}\n                                       }: FirestoreDataSourceProps): DataSource {\n\n    const createEntityFromCollection = useCallback(<M extends Record<string, any>>(\n        docSnap: DocumentSnapshot,\n        path: string,\n        resolvedCollection: ResolvedEntityCollection<M>\n    ): Entity<M> => {\n\n        const values = firestoreToCMSModel(docSnap.data());\n        const data = docSnap.data()\n            ? resolvedCollection.properties\n                ? sanitizeData(values as EntityValues<M>, resolvedCollection.properties)\n                : docSnap.data()\n            : undefined;\n        return {\n            id: docSnap.id,\n            path: getCMSPathFromFirestorePath(docSnap.ref.path),\n            values: data\n        };\n    }, []);\n\n    const buildQuery = useCallback(<M>(path: string,\n                                       filter: FilterValues<Extract<keyof M, string>> | undefined,\n                                       orderBy: string | undefined,\n                                       order: \"desc\" | \"asc\" | undefined,\n                                       startAfter: any[] | undefined,\n                                       limit: number | undefined,\n                                       collectionGroup = false) => {\n\n        if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n\n        const firestore = getFirestore(firebaseApp);\n        const collectionReference: Query = collectionGroup ? collectionGroupClause(firestore, path) : collectionClause(firestore, path);\n\n        const queryParams: QueryConstraint[] = [];\n        if (filter) {\n            Object.entries(filter)\n                .filter(([_, entry]) => !!entry)\n                .forEach(([key, filterParameter]) => {\n                    const [op, value] = filterParameter as [WhereFilterOp, any];\n                    queryParams.push(whereClause(key, op, cmsToFirestoreModel(value, firestore)));\n                });\n        }\n\n        if (orderBy && order) {\n            queryParams.push(orderByClause(orderBy, order));\n        }\n\n        if (startAfter) {\n            queryParams.push(startAfterClause(startAfter));\n        }\n\n        if (limit) {\n            queryParams.push(limitClause(limit));\n        }\n\n        return query(collectionReference, ...queryParams);\n    }, [firebaseApp]);\n\n    const getAndBuildEntity = useCallback(<M extends Record<string, any>>(path: string,\n                                                                          entityId: string,\n                                                                          collection: EntityCollection<M> | ResolvedEntityCollection<M>): Promise<Entity<M> | undefined> => {\n        if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n\n        const firestore = getFirestore(firebaseApp);\n\n        return getDoc(doc(firestore, path, entityId))\n            .then((docSnapshot) => {\n                if (!docSnapshot.exists()) {\n                    return undefined;\n                }\n                const resolvedCollection = resolveCollection<M>({\n                    collection,\n                    path,\n                    entityId: docSnapshot.id,\n                    values: firestoreToCMSModel(docSnapshot.data()),\n                    fields\n                });\n                return createEntityFromCollection(docSnapshot, path, resolvedCollection);\n            });\n    }, [firebaseApp]);\n\n    const performTextSearch = useCallback(async <M extends Record<string, any>>(path: string,\n                                                                                searchString: string,\n                                                                                collection: EntityCollection<M> | ResolvedEntityCollection<M>): Promise<Entity<M>[]> => {\n        if (!textSearchController)\n            throw Error(\"Trying to make text search without specifying a FirestoreTextSearchController\");\n        const ids = await textSearchController({\n            path,\n            searchString\n        });\n        if (ids === undefined)\n            throw Error(\"The current path is not supported by the specified FirestoreTextSearchController\");\n        const promises: Promise<Entity<M> | undefined>[] = ids\n            .map(async (entityId) => {\n                    try {\n                        return await getAndBuildEntity(path, entityId, collection);\n                    } catch (e) {\n                        console.error(e);\n                        return undefined;\n                    }\n                }\n            );\n        return Promise.all(promises)\n            .then((res) => res.filter((e) => e !== undefined && e.values) as Entity<M>[]);\n    }, [getAndBuildEntity, textSearchController]);\n\n    return {\n\n        /**\n         * Fetch entities in a Firestore path\n         * @param path\n         * @param collection\n         * @param filter\n         * @param limit\n         * @param startAfter\n         * @param searchString\n         * @param orderBy\n         * @param order\n         * @return Function to cancel subscription\n         * @see useCollectionFetch if you need this functionality implemented as a hook\n         * @category Firestore\n         */\n        fetchCollection: useCallback(<M extends Record<string, any>>({\n                                                                         path,\n                                                                         collection,\n                                                                         filter,\n                                                                         limit,\n                                                                         startAfter,\n                                                                         searchString,\n                                                                         orderBy,\n                                                                         order\n                                                                     }: FetchCollectionProps<M>\n        ): Promise<Entity<M>[]> => {\n\n            if (searchString) {\n                return performTextSearch(path, searchString, collection);\n            }\n\n            const collectionGroup = collection.collectionGroup ?? false;\n\n            console.debug(\"Fetching collection\", {\n                path,\n                limit,\n                filter,\n                startAfter,\n                orderBy,\n                order,\n                collectionGroup\n            });\n            const query = buildQuery(path, filter, orderBy, order, startAfter, limit, collectionGroup);\n\n            return getDocs(query)\n                .then((snapshot) =>\n                    snapshot.docs.map((doc) => {\n                        const resolvedCollection = resolveCollection<M>({\n                            collection,\n                            path,\n                            values: firestoreToCMSModel(doc.data()),\n                            fields\n                        });\n                        return createEntityFromCollection(doc, path, resolvedCollection);\n                    }));\n        }, [buildQuery, performTextSearch]),\n\n        /**\n         * Listen to a entities in a given path\n         * @param path\n         * @param collection\n         * @param onError\n         * @param filter\n         * @param limit\n         * @param startAfter\n         * @param searchString\n         * @param orderBy\n         * @param order\n         * @param onUpdate\n         * @return Function to cancel subscription\n         * @see useCollectionFetch if you need this functionality implemented as a hook\n         * @category Firestore\n         */\n        listenCollection: useCallback(<M extends Record<string, any>>(\n            {\n                path,\n                collection,\n                filter,\n                limit,\n                startAfter,\n                searchString,\n                orderBy,\n                order,\n                onUpdate,\n                onError,\n            }: ListenCollectionProps<M>\n        ): () => void => {\n\n            const collectionGroup = collection.collectionGroup ?? false;\n\n            console.debug(\"Listening collection\", {\n                path,\n                collectionGroup,\n                limit,\n                filter,\n                startAfter,\n                orderBy,\n                order\n            });\n\n            const query = buildQuery(path, filter, orderBy, order, startAfter, limit, collectionGroup);\n\n            if (searchString) {\n                performTextSearch<M>(path, searchString, collection)\n                    .then(onUpdate)\n                    .catch((e) => {\n                        if (onError) onError(e);\n                    });\n                // eslint-disable-next-line @typescript-eslint/no-empty-function\n                return () => {\n                };\n            }\n\n            const resolvedCollection = resolveCollection<M>({\n                collection,\n                path,\n                fields\n            });\n\n            return onSnapshot(query,\n                {\n                    next: (snapshot) => {\n                        onUpdate(snapshot.docs.map((doc) => createEntityFromCollection(doc, path, resolvedCollection)));\n                    },\n                    error: onError\n                }\n            );\n        }, [buildQuery, performTextSearch]),\n\n        /**\n         * Retrieve an entity given a path and a collection\n         * @param path\n         * @param entityId\n         * @param collection\n         * @category Firestore\n         */\n        fetchEntity: useCallback(<M extends Record<string, any>>({\n                                                                     path,\n                                                                     entityId,\n                                                                     collection\n                                                                 }: FetchEntityProps<M>\n        ): Promise<Entity<M> | undefined> => getAndBuildEntity(path, entityId, collection), [getAndBuildEntity]),\n\n        /**\n         *\n         * @param path\n         * @param entityId\n         * @param collection\n         * @param onUpdate\n         * @param onError\n         * @return Function to cancel subscription\n         * @category Firestore\n         */\n        listenEntity: useCallback(<M extends Record<string, any>>(\n            {\n                path,\n                entityId,\n                collection,\n                onUpdate,\n                onError\n            }: ListenEntityProps<M>): () => void => {\n            if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n\n            const firestore = getFirestore(firebaseApp);\n\n            return onSnapshot(\n                doc(firestore, path, entityId),\n                {\n                    next: (docSnapshot) => {\n                        const resolvedCollection = resolveCollection<M>({\n                            collection,\n                            path,\n                            entityId: docSnapshot.id,\n                            fields\n                        });\n                        onUpdate(createEntityFromCollection(docSnapshot, path, resolvedCollection));\n                    },\n                    error: onError\n                }\n            );\n        }, [firebaseApp]),\n\n        /**\n         * Save entity to the specified path. Note that Firestore does not allow\n         * undefined values.\n         * @param path\n         * @param entityId\n         * @param values\n         * @param schemaId\n         * @param collection\n         * @param status\n         * @category Firestore\n         */\n        saveEntity: useCallback(<M extends Record<string, any>>(\n            {\n                path,\n                entityId,\n                values,\n                collection,\n                status\n            }: SaveEntityProps<M>): Promise<Entity<M>> => {\n\n            if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n\n            const firestore = getFirestore(firebaseApp);\n\n            const resolvedCollection = resolveCollection<M>({\n                collection,\n                path,\n                entityId,\n                fields\n            });\n\n            const properties: ResolvedProperties<M> = resolvedCollection.properties;\n            const collectionReference: CollectionReference = collectionClause(firestore, path);\n\n            const firestoreValues = cmsToFirestoreModel(values, firestore);\n            const updatedFirestoreValues: EntityValues<M> = updateDateAutoValues(\n                {\n                    inputValues: firestoreValues,\n                    properties,\n                    status,\n                    timestampNowValue: serverTimestamp(),\n                    setDateToMidnight\n                });\n\n            console.debug(\"Saving entity\", path, entityId, updatedFirestoreValues);\n\n            let documentReference: DocumentReference;\n            if (entityId)\n                documentReference = doc(collectionReference, entityId);\n            else\n                documentReference = doc(collectionReference);\n\n            return setDoc(documentReference, updatedFirestoreValues, { merge: true })\n                .then(() => ({\n                    id: documentReference.id,\n                    path,\n                    values: firestoreToCMSModel(updatedFirestoreValues)\n                }));\n        }, [firebaseApp]),\n\n        /**\n         * Delete an entity\n         * @param entity\n         * @param collection\n         * @category Firestore\n         */\n        deleteEntity: useCallback(<M extends Record<string, any>>(\n            {\n                entity\n            }: DeleteEntityProps<M>\n        ): Promise<void> => {\n            if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n\n            const firestore = getFirestore(firebaseApp);\n\n            return deleteDoc(doc(firestore, entity.path, entity.id));\n        }, [firebaseApp]),\n\n        /**\n         * Check if the given property is unique in the given collection\n         * @param path Collection path\n         * @param name of the property\n         * @param value\n         * @param property\n         * @param entityId\n         * @return `true` if there are no other fields besides the given entity\n         * @category Firestore\n         */\n        checkUniqueField: useCallback((\n            path: string,\n            name: string,\n            value: any,\n            property: ResolvedProperty,\n            entityId?: string\n        ): Promise<boolean> => {\n\n            if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n\n            const firestore = getFirestore(firebaseApp);\n\n            console.debug(\"Check unique field entity\", path, name, value, entityId);\n\n            if (property.dataType === \"array\") {\n                console.error(\"checkUniqueField received an array\");\n            }\n\n            if (value === undefined || value === null) {\n                return Promise.resolve(true);\n            }\n            const q = query(collectionClause(firestore, path), whereClause(name, \"==\", cmsToFirestoreModel(value, firestore)));\n            return getDocs(q)\n                .then((snapshots) =>\n                    snapshots.docs.filter(doc => doc.id !== entityId).length === 0\n                );\n\n        }, [firebaseApp]),\n\n        generateEntityId: useCallback((path: string): string => {\n            if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n            const firestore = getFirestore(firebaseApp);\n            return doc(collectionClause(firestore, path)).id;\n        }, [firebaseApp]),\n\n        countEntities: useCallback(async (props: {\n            path: string,\n            collection: EntityCollection<any>\n            onCountUpdate?: (count: number) => void\n        }): Promise<number> => {\n            if (!firebaseApp) throw Error(\"useFirestoreDataSource Firebase not initialised\");\n            const firestore = getFirestore(firebaseApp);\n            const coll = props.collection.collectionGroup ? collectionGroupClause(firestore, props.path) : collectionClause(firestore, props.path);\n            const snapshot = await getCountFromServer(coll);\n            return snapshot.data().count;\n        }, [firebaseApp])\n\n    };\n\n}\n\n/**\n * Recursive function that converts Firestore data types into CMS or plain\n * JS types.\n * FireCMS uses Javascript dates internally instead of Firestore timestamps.\n * This makes it easier to interact with the rest of the libraries and\n * bindings.\n * Also, Firestore references are replaced with {@link EntityReference}\n * @param data\n * @category Firestore\n */\nexport function firestoreToCMSModel(data: any): any {\n    if (data === null || data === undefined) return null;\n    if (deleteField().isEqual(data)) {\n        return undefined;\n    }\n    if (serverTimestamp().isEqual(data)) {\n        return null;\n    }\n    if (data instanceof Timestamp || (typeof data.toDate === \"function\" && data.toDate() instanceof Date)) {\n        return data.toDate();\n    }\n    if (data instanceof Date) {\n        return data;\n    }\n    if (data instanceof FirestoreGeoPoint) {\n        return new GeoPoint(data.latitude, data.longitude);\n    }\n    if (data instanceof DocumentReference) {\n        return new EntityReference(data.id, getCMSPathFromFirestorePath(data.path));\n    }\n    if (Array.isArray(data)) {\n        return data.map(firestoreToCMSModel).filter(v => v !== undefined);\n    }\n    if (typeof data === \"object\") {\n        const result: Record<string, any> = {};\n        for (const key of Object.keys(data)) {\n            const childValue = firestoreToCMSModel(data[key]);\n            if (childValue !== undefined)\n                result[key] = childValue;\n        }\n        return result;\n    }\n    return data;\n}\n\nexport function cmsToFirestoreModel(data: any, firestore: Firestore): any {\n    if (data === undefined) {\n        return deleteField();\n    } else if (Array.isArray(data)) {\n        return data.map(v => cmsToFirestoreModel(v, firestore));\n    } else if (data instanceof EntityReference) {\n        return doc(firestore, data.path, data.id);\n    } else if (data instanceof GeoPoint) {\n        return new FirestoreGeoPoint(data.latitude, data.longitude);\n    } else if (data instanceof Date) {\n        return Timestamp.fromDate(data);\n    } else if (data && typeof data === \"object\") {\n        return Object.entries(data)\n            .map(([key, v]) => ({ [key]: cmsToFirestoreModel(v, firestore) }))\n            .reduce((a, b) => ({ ...a, ...b }), {});\n    }\n    return data;\n}\n\n/**\n * Remove id from Firestore path\n * @param fsPath\n */\nfunction getCMSPathFromFirestorePath(fsPath: string): string {\n    let to = fsPath.lastIndexOf(\"/\");\n    to = to === -1 ? fsPath.length : to;\n    return fsPath.substring(0, to);\n}\n","import { FirebaseApp } from \"firebase/app\";\nimport { FirebaseStorage, getDownloadURL, getMetadata, getStorage, ref, uploadBytes } from \"firebase/storage\";\nimport { DownloadConfig, DownloadMetadata, StorageSource, UploadFileProps } from \"../../types\";\nimport { useEffect, useState } from \"react\";\n\n/**\n * @category Firebase\n */\nexport interface FirebaseStorageSourceProps {\n    firebaseApp?: FirebaseApp\n}\n\n/**\n * Use this hook to build an {@link StorageSource} based on Firebase storage\n * @category Firebase\n */\nexport function useFirebaseStorageSource({ firebaseApp }: FirebaseStorageSourceProps): StorageSource {\n\n    const [storage, setStorage] = useState<FirebaseStorage>();\n\n    useEffect(() => {\n        if (!firebaseApp) return;\n        setStorage(getStorage(firebaseApp));\n    }, [firebaseApp]);\n\n    const urlsCache: Record<string, DownloadConfig> = {};\n\n    return {\n        uploadFile({ file, fileName, path, metadata }: UploadFileProps)\n            : Promise<any> {\n            if (!storage) throw Error(\"useFirebaseStorageSource Firebase not initialised\");\n            const usedFilename = fileName ?? file.name;\n            console.debug(\"Uploading file\", usedFilename, file, path, metadata);\n            return uploadBytes(ref(storage, `${path}/${usedFilename}`), file, metadata).then(snapshot => ({\n                path: snapshot.ref.fullPath\n            }));\n        },\n\n        async getFile(path: string): Promise<File | null> {\n            try {\n\n                if (!storage)\n                    throw Error(\"useFirebaseStorageSource Firebase not initialised\");\n                const fileRef = ref(storage, path);\n                const url = await getDownloadURL(fileRef);\n                const response = await fetch(url);\n                const blob = await response.blob();\n                return new File([blob], path);\n            } catch (e: any) {\n                if (e?.code === \"storage/object-not-found\") return null;\n                throw e;\n            }\n        },\n\n        async getDownloadURL(storagePathOrUrl: string): Promise<DownloadConfig> {\n            if (!storage) throw Error(\"useFirebaseStorageSource Firebase not initialised\");\n            if (urlsCache[storagePathOrUrl])\n                return urlsCache[storagePathOrUrl];\n            const fileRef = ref(storage, storagePathOrUrl);\n            const [url, metadata] = await Promise.all([getDownloadURL(fileRef), getMetadata(fileRef)]);\n            const result: DownloadConfig = {\n                url, metadata: metadata as DownloadMetadata\n            }\n            urlsCache[storagePathOrUrl] = result;\n            return result;\n        }\n    };\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\nimport equal from \"react-fast-compare\";\n\nimport { User as FirebaseUser } from \"firebase/auth\";\n\nimport { AppCheckTokenResult, DataSource, StorageSource } from \"../../types\";\nimport { Authenticator, FirebaseAuthController } from \"../types/auth\";\n\n/**\n * This hook is used internally for validating an authenticator.\n * You may want to use it if you are not using {@link FirebaseCMSApp}, but\n * building your own custom {@link FireCMS} instance.\n * @param authController\n * @param authentication\n * @param getAppCheckToken\n * @param appCheckForceRefresh\n * @param storageSource\n * @param dataSource\n */\nexport function useValidateAuthenticator({\n                                             authController,\n                                             authentication,\n                                             getAppCheckToken,\n                                             appCheckForceRefresh = false,\n                                             storageSource,\n                                             dataSource\n                                         }:\n                                             {\n                                                 authController: FirebaseAuthController,\n                                                 authentication?: boolean | Authenticator<FirebaseUser>,\n                                                 getAppCheckToken?: (forceRefresh: boolean) => Promise<AppCheckTokenResult> | undefined,\n                                                 appCheckForceRefresh?: boolean,\n                                                 dataSource: DataSource;\n                                                 storageSource: StorageSource;\n                                             }): {\n    canAccessMainView: boolean,\n    authLoading: boolean,\n    notAllowedError: any,\n    authVerified: boolean,\n} {\n\n    const authenticationEnabled = Boolean(authentication);\n\n    const [authLoading, setAuthLoading] = useState<boolean>(authenticationEnabled);\n    const [notAllowedError, setNotAllowedError] = useState<any>(false);\n    const [authVerified, setAuthVerified] = useState<boolean>(!authenticationEnabled || Boolean(authController.loginSkipped));\n\n    const canAccessMainView = (authVerified) &&\n        (!authenticationEnabled || Boolean(authController.user) || Boolean(authController.loginSkipped)) &&\n        !notAllowedError;\n\n    useEffect(() => {\n        if (authController.loginSkipped)\n            setAuthVerified(true);\n    }, [authController.loginSkipped]);\n\n    /**\n     * We use this ref to check the authentication only if the user has\n     * changed\n     */\n    const checkedUserRef = useRef<FirebaseUser | undefined>();\n\n    const checkAuthentication = useCallback(async () => {\n\n        if (authController.initialLoading) {\n            return;\n        }\n\n        if (!authController.user && !authController.loginSkipped) {\n            checkedUserRef.current = undefined;\n            setAuthLoading(false);\n            setAuthVerified(false);\n            return;\n        }\n\n        const delegateUser = authController.user;\n\n        if (getAppCheckToken) {\n            try {\n                if (!await getAppCheckToken(appCheckForceRefresh)) {\n                    setNotAllowedError(\"App Check failed.\");\n                    authController.signOut();\n                } else {\n                    console.debug(\"App Check success.\");\n                }\n            } catch (e: any) {\n                setNotAllowedError(e.message);\n                authController.signOut();\n            }\n        }\n\n        if (authentication instanceof Function && delegateUser && !equal(checkedUserRef.current, delegateUser)) {\n            setAuthLoading(true);\n            try {\n                const allowed = await authentication({\n                    user: delegateUser,\n                    authController,\n                    dataSource,\n                    storageSource\n                });\n                if (!allowed) {\n                    authController.signOut();\n                    setNotAllowedError(true);\n                }\n            } catch (e) {\n                setNotAllowedError(e);\n                authController.signOut();\n            }\n            setAuthLoading(false);\n            setAuthVerified(true);\n            checkedUserRef.current = delegateUser;\n        } else {\n            setAuthLoading(false);\n        }\n\n        if (!authController.initialLoading && !delegateUser) {\n            setAuthVerified(true);\n        }\n\n    }, [authController, authentication, getAppCheckToken, appCheckForceRefresh, dataSource, storageSource]);\n\n    useEffect(() => {\n        checkAuthentication();\n    }, [checkAuthentication]);\n\n    return {\n        canAccessMainView,\n        authLoading: authenticationEnabled && authLoading,\n        notAllowedError,\n        authVerified\n    }\n}\n","import React, { useCallback, useEffect } from \"react\";\n\nimport { FirebaseApp, initializeApp } from \"firebase/app\";\nimport { config } from \"react-transition-group\";\n\n/**\n * @category Firebase\n */\nexport interface InitialiseFirebaseResult {\n    firebaseConfigLoading: boolean,\n    firebaseApp?: FirebaseApp;\n    configError?: string,\n    firebaseConfigError?: Error\n}\n\nconst hostingError = \"It seems like the provided Firebase config is not correct. If you \\n\" +\n    \"are using the credentials provided automatically by Firebase \\n\" +\n    \"Hosting, make sure you link your Firebase app to Firebase Hosting. \\n\";\n\n/**\n * Function used to initialise Firebase, either by using the provided config,\n * or by fetching it by Firebase Hosting, if not specified.\n *\n * It works as a hook that gives you the loading state and the used\n * configuration.\n *\n * You most likely only need to use this if you are developing a custom app\n * that is not using {@link FirebaseCMSApp}. You can also not use this component\n * and initialise Firebase yourself.\n *\n * @param onFirebaseInit\n * @param firebaseConfig\n * @param name\n * @param authDomain\n * @category Firebase\n */\nexport function useInitialiseFirebase({\n                                          firebaseConfig,\n                                          onFirebaseInit,\n                                          name,\n                                          authDomain\n                                      }: {\n    onFirebaseInit?: ((config: object, firebaseApp: FirebaseApp) => void) | undefined,\n    firebaseConfig: Record<string, unknown> | undefined,\n    name?: string;\n    authDomain?: string;\n}): InitialiseFirebaseResult {\n\n    const [firebaseApp, setFirebaseApp] = React.useState<FirebaseApp | undefined>();\n    const [firebaseConfigLoading, setFirebaseConfigLoading] = React.useState<boolean>(false);\n    const [configError, setConfigError] = React.useState<string>();\n\n    const initFirebase = useCallback((config: Record<string, unknown>) => {\n        try {\n            const initialisedFirebaseApp = initializeApp(config, name ?? \"[DEFAULT]\");\n            setConfigError(undefined);\n            setFirebaseConfigLoading(false);\n            setFirebaseApp(initialisedFirebaseApp);\n        } catch (e: any) {\n            console.error(\"Error initialising Firebase\", e);\n            setConfigError(hostingError + \"\\n\" + (e.message ?? JSON.stringify(e)));\n        }\n    }, [name]);\n\n    useEffect(() => {\n        if (onFirebaseInit && firebaseConfig && firebaseApp) {\n            onFirebaseInit(firebaseConfig, firebaseApp);\n        }\n    }, [firebaseApp]);\n\n    useEffect(() => {\n\n        setFirebaseConfigLoading(true);\n\n        if (firebaseConfig) {\n            initFirebase(firebaseConfig);\n        } else if (process.env.NODE_ENV === \"production\") {\n            fetch(\"/__/firebase/init.json\")\n                .then(async response => {\n                    console.debug(\"Firebase init response\", response.status);\n                    if (response && response.status < 300) {\n                        const config = await response.json();\n                        if (authDomain) config.authDomain = authDomain;\n                        initFirebase(config);\n                    }\n                })\n                .catch(e => {\n                        setFirebaseConfigLoading(false);\n                        setConfigError(\n                            \"Could not load Firebase configuration from Firebase hosting. \" +\n                            \"If the app is not deployed in Firebase hosting, you need to specify the configuration manually\" +\n                            e.toString()\n                        );\n                    }\n                );\n        } else {\n            setFirebaseConfigLoading(false);\n            setConfigError(\n                \"You need to deploy the app to Firebase hosting or specify a Firebase configuration object\"\n            );\n        }\n    }, [firebaseConfig, initFirebase]);\n\n    return {\n        firebaseApp,\n        firebaseConfigLoading,\n        configError\n    };\n}\n","import React, { useCallback, useEffect } from \"react\";\n\nimport {\n    AppCheck as FirebaseAppCheck,\n    getToken,\n    initializeAppCheck,\n    ReCaptchaEnterpriseProvider,\n    ReCaptchaV3Provider\n} from \"firebase/app-check\";\nimport { AppCheck, AppCheckOptions, AppCheckTokenResult } from \"../../types\";\nimport { FirebaseApp } from \"firebase/app\";\n\n/**\n * @category Firebase\n */\nexport interface InitializeAppCheckProps {\n    firebaseApp?: FirebaseApp;\n    options?: AppCheckOptions;\n}\n\nexport interface InitializeAppCheckResult {\n    appCheckLoading: boolean;\n    getAppCheckToken?: (forceRefresh: boolean) => Promise<AppCheckTokenResult> | undefined;\n}\n\n/**\n * Function used to initialise Firebase App Check.\n *\n * It works as a hook that gives you back an object holding the Firebase App.\n *\n * You most likely only need to use this if you are developing a custom app\n * that is not using {@link FirebaseCMSApp}. You can also not use this component\n * and initialise App Check yourself.\n *\n * @param firebaseApp\n * @category Firebase\n */\nexport function useInitializeAppCheck({\n                                          firebaseApp,\n                                          options\n                                      }: InitializeAppCheckProps): InitializeAppCheckResult {\n    if (options?.debugToken) {\n        Object.assign(window, {\n            FIREBASE_APPCHECK_DEBUG_TOKEN: options?.debugToken\n        });\n    }\n\n    const [appCheckLoading, setAppCheckLoading] = React.useState<boolean>(false);\n    const [appCheck, setAppCheck] = React.useState<AppCheck | undefined>();\n\n    const getAppCheckToken = useCallback((forceRefresh: boolean) => {\n        if (!appCheck || !options) return;\n        return getToken(appCheck as FirebaseAppCheck, forceRefresh);\n    }, [appCheck, options]);\n\n    useEffect(() => {\n        if (!options) return;\n        if (!firebaseApp) return;\n\n        setAppCheckLoading(true);\n\n        const {\n            providerKey,\n            useEnterpriseRecaptcha,\n            isTokenAutoRefreshEnabled\n        } = options;\n        const appCheck_ = initializeAppCheck(firebaseApp, {\n            provider: useEnterpriseRecaptcha ? new ReCaptchaEnterpriseProvider(providerKey) : new ReCaptchaV3Provider(providerKey),\n            isTokenAutoRefreshEnabled\n        });\n        setAppCheck(appCheck_ as AppCheck);\n\n        setAppCheckLoading(false);\n    }, [firebaseApp, options]);\n\n    return {\n        appCheckLoading,\n        getAppCheckToken: options ? getAppCheckToken : undefined\n    };\n}\n","export const googleIcon = (mode: \"light\" | \"dark\") => <>\n    <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 64 64\"\n        width={32}\n        height={32}\n    >\n        <linearGradient\n            id=\"95yY7w43Oj6n2vH63j6HJb\"\n            x1=\"29.401\"\n            x2=\"29.401\"\n            y1=\"4.064\"\n            y2=\"106.734\"\n            gradientTransform=\"matrix(1 0 0 -1 0 66)\"\n            gradientUnits=\"userSpaceOnUse\"\n        >\n            <stop offset=\"0\" stopColor=\"#ff5840\"/>\n            <stop offset=\".007\" stopColor=\"#ff5840\"/>\n            <stop offset=\".989\" stopColor=\"#fa528c\"/>\n            <stop offset=\"1\" stopColor=\"#fa528c\"/>\n        </linearGradient>\n        <path\n            fill=\"url(#95yY7w43Oj6n2vH63j6HJb)\"\n            d=\"M47.46,15.5l-1.37,1.48c-1.34,1.44-3.5,1.67-5.15,0.6c-2.71-1.75-6.43-3.13-11-2.37 c-4.94,0.83-9.17,3.85-11.64, 7.97l-8.03-6.08C14.99,9.82,23.2,5,32.5,5c5,0,9.94,1.56,14.27,4.46 C48.81,10.83,49.13,13.71,47.46,15.5z\"\n        />\n        <linearGradient\n            id=\"95yY7w43Oj6n2vH63j6HJc\"\n            x1=\"12.148\"\n            x2=\"12.148\"\n            y1=\".872\"\n            y2=\"47.812\"\n            gradientTransform=\"matrix(1 0 0 -1 0 66)\"\n            gradientUnits=\"userSpaceOnUse\"\n        >\n            <stop offset=\"0\" stopColor=\"#feaa53\"/>\n            <stop offset=\".612\" stopColor=\"#ffcd49\"/>\n            <stop offset=\"1\" stopColor=\"#ffde44\"/>\n        </linearGradient>\n        <path\n            fill=\"url(#95yY7w43Oj6n2vH63j6HJc)\"\n            d=\"M16.01,30.91c-0.09,2.47,0.37,4.83,1.27,6.96l-8.21,6.05c-1.35-2.51-2.3-5.28-2.75-8.22 c-1.06-6.88,0.54-13.38, 3.95-18.6l8.03,6.08C16.93,25.47,16.1,28.11,16.01,30.91z\"\n        />\n        <linearGradient\n            id=\"95yY7w43Oj6n2vH63j6HJd\"\n            x1=\"29.76\"\n            x2=\"29.76\"\n            y1=\"32.149\"\n            y2=\"-6.939\"\n            gradientTransform=\"matrix(1 0 0 -1 0 66)\"\n            gradientUnits=\"userSpaceOnUse\"\n        >\n            <stop offset=\"0\" stopColor=\"#42d778\"/>\n            <stop offset=\".428\" stopColor=\"#3dca76\"/>\n            <stop offset=\"1\" stopColor=\"#34b171\"/>\n        </linearGradient>\n        <path\n            fill=\"url(#95yY7w43Oj6n2vH63j6HJd)\"\n            d=\"M50.45,51.28c-4.55,4.07-10.61,6.57-17.36,6.71C22.91,58.2,13.66,52.53,9.07,43.92l8.21-6.05 C19.78,43.81, 25.67,48,32.5,48c3.94,0,7.52-1.28,10.33-3.44L50.45,51.28z\"\n        />\n        <linearGradient\n            id=\"95yY7w43Oj6n2vH63j6HJe\"\n            x1=\"46\"\n            x2=\"46\"\n            y1=\"3.638\"\n            y2=\"35.593\"\n            gradientTransform=\"matrix(1 0 0 -1 0 66)\"\n            gradientUnits=\"userSpaceOnUse\"\n        >\n            <stop offset=\"0\" stopColor=\"#155cde\"/>\n            <stop offset=\".278\" stopColor=\"#1f7fe5\"/>\n            <stop offset=\".569\" stopColor=\"#279ceb\"/>\n            <stop offset=\".82\" stopColor=\"#2cafef\"/>\n            <stop offset=\"1\" stopColor=\"#2eb5f0\"/>\n        </linearGradient>\n        <path\n            fill=\"url(#95yY7w43Oj6n2vH63j6HJe)\"\n            d=\"M59,31.97c0.01,7.73-3.26,14.58-8.55,19.31l-7.62-6.72c2.1-1.61,3.77-3.71,4.84-6.15\n        c0.29-0.66-0.2-1.41-0.92-1.41H37c-2.21,0-4-1.79-4-4v-2c0-2.21,1.79-4,4-4h17C56.75,27,59,29.22,59,31.97z\"\n        />\n    </svg>\n</>;\n\nexport const appleIcon = (mode: \"light\" | \"dark\") => <svg width={32} height={32}\n                                                          viewBox=\"0 0 56 56\"\n                                                          style={{ transform: \"scale(2.8)\" }}\n                                                          version=\"1.1\"\n                                                          xmlns=\"http://www.w3.org/2000/svg\">\n    <g stroke={mode === \"light\" ? \"#424245\" : \"white\"} strokeWidth=\"0.5\"\n       fillRule=\"evenodd\">\n        <path\n            d=\"M28.2226562,20.3846154 C29.0546875,20.3846154 30.0976562,19.8048315 30.71875,19.0317864 C31.28125,18.3312142 31.6914062,17.352829 31.6914062,16.3744437 C31.6914062,16.2415766 31.6796875,16.1087095 31.65625,16 C30.7304687,16.0362365 29.6171875,16.640178 28.9492187,17.4494596 C28.421875,18.06548 27.9414062,19.0317864 27.9414062,20.0222505 C27.9414062,20.1671964 27.9648438,20.3121424 27.9765625,20.3604577 C28.0351562,20.3725366 28.1289062,20.3846154 28.2226562,20.3846154 Z M25.2929688,35 C26.4296875,35 26.9335938,34.214876 28.3515625,34.214876 C29.7929688,34.214876 30.109375,34.9758423 31.375,34.9758423 C32.6171875,34.9758423 33.4492188,33.792117 34.234375,32.6325493 C35.1132812,31.3038779 35.4765625,29.9993643 35.5,29.9389701 C35.4179688,29.9148125 33.0390625,28.9122695 33.0390625,26.0979021 C33.0390625,23.6579784 34.9140625,22.5588048 35.0195312,22.474253 C33.7773438,20.6382708 31.890625,20.5899555 31.375,20.5899555 C29.9804688,20.5899555 28.84375,21.4596313 28.1289062,21.4596313 C27.3554688,21.4596313 26.3359375,20.6382708 25.1289062,20.6382708 C22.8320312,20.6382708 20.5,22.5950413 20.5,26.2911634 C20.5,28.5861411 21.3671875,31.013986 22.4335938,32.5842339 C23.3476562,33.9129053 24.1445312,35 25.2929688,35 Z\"\n            fill={mode === \"light\" ? \"#424245\" : \"white\"} fillRule=\"nonzero\"/>\n    </g>\n</svg>;\n\nexport const githubIcon = (mode: \"light\" | \"dark\") => <svg\n    fill={mode === \"light\" ? \"#1c1e21\" : \"white\"}\n    role=\"img\"\n    viewBox=\"0 0 24 24\"\n    width={28}\n    height={28}\n    xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n        d=\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"/>\n</svg>;\n\n\nexport const facebookIcon = (mode: \"light\" | \"dark\") => <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width={28} height={28}\n    viewBox=\"0 0 90 90\">\n    <g>\n        <path\n            d=\"M90,15.001C90,7.119,82.884,0,75,0H15C7.116,0,0,7.119,0,15.001v59.998   C0,82.881,7.116,90,15.001,90H45V56H34V41h11v-5.844C45,25.077,52.568,16,61.875,16H74v15H61.875C60.548,31,59,32.611,59,35.024V41   h15v15H59v34h16c7.884,0,15-7.119,15-15.001V15.001z\"\n            fill={mode === \"light\" ? \"#39569c\" : \"white\"}/>\n    </g>\n</svg>;\n\nexport const microsoftIcon = (mode: \"light\" | \"dark\") => <svg\n    xmlns=\"http://www.w3.org/2000/svg\" width={28} height={28}\n    viewBox=\"0 0 480 480\">\n    <g>\n        <path\n            d=\"M0.176,224L0.001,67.963l192-26.072V224H0.176z M224.001,37.241L479.937,0v224H224.001V37.241z M479.999,256l-0.062,224   l-255.936-36.008V256H479.999z M192.001,439.918L0.157,413.621L0.147,256h191.854V439.918z\"\n            fill={mode === \"light\" ? \"#00a2ed\" : \"white\"}/>\n    </g>\n</svg>;\n\nexport const twitterIcon = (mode: \"light\" | \"dark\") => <svg\n    xmlns=\"http://www.w3.org/2000/svg\" width={28} height={28}\n    viewBox=\"0 0 24 24\">\n    <path fill={mode === \"light\" ? \"#00acee\" : \"white\"}\n          d=\"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z\"/>\n</svg>;\n\n","import { useEffect } from \"react\";\nimport { getAuth, RecaptchaVerifier } from \"firebase/auth\";\n\ndeclare global {\n    interface Window {\n        recaptchaVerifier: RecaptchaVerifier;\n    }\n}\n\nexport const RECAPTCHA_CONTAINER_ID = \"recaptcha-container\" as const;\n\nexport function useRecaptcha() {\n    useEffect(() => {\n        if (!window || window?.recaptchaVerifier) return;\n\n        const auth = getAuth();\n\n        window.recaptchaVerifier = new RecaptchaVerifier(\n            RECAPTCHA_CONTAINER_ID,\n            {\n                size: \"invisible\"\n            },\n            auth\n        );\n    }, []);\n\n    return null;\n}\n","import React, {\n    ReactNode,\n    useCallback,\n    useEffect,\n    useRef,\n    useState\n} from \"react\";\n\nimport {\n    Box,\n    Button,\n    CircularProgress,\n    Fade,\n    Grid,\n    IconButton,\n    Slide,\n    TextField,\n    Typography\n} from \"@mui/material\";\n\nimport { FirebaseApp, FirebaseError } from \"firebase/app\";\nimport { ErrorView, FireCMSLogo } from \"../../core\";\nimport { useModeController } from \"../../hooks\";\nimport {\n    FirebaseAuthController,\n    FirebaseSignInOption,\n    FirebaseSignInProvider\n} from \"../types/auth\";\nimport {\n    appleIcon,\n    facebookIcon,\n    githubIcon,\n    googleIcon,\n    microsoftIcon,\n    twitterIcon\n} from \"./social_icons\";\nimport EmailIcon from \"@mui/icons-material/Email\";\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\nimport PersonOutlineIcon from \"@mui/icons-material/PersonOutline\";\nimport { Phone } from \"@mui/icons-material\";\nimport { RECAPTCHA_CONTAINER_ID, useRecaptcha } from \"../hooks/useRecaptcha\";\nimport {\n    getAuth,\n    getMultiFactorResolver,\n    PhoneAuthProvider,\n    PhoneMultiFactorGenerator,\n    RecaptchaVerifier\n} from \"firebase/auth\";\n\n/**\n * @category Firebase\n */\nexport interface FirebaseLoginViewProps {\n\n    /**\n     * Firebase app this login view is accessing\n     */\n    firebaseApp: FirebaseApp;\n\n    /**\n     * Delegate holding the auth state\n     */\n    authController: FirebaseAuthController;\n\n    /**\n     * Path to the logo displayed in the login screen\n     */\n    logo?: string;\n\n    /**\n     * Enable the skip login button\n     */\n    allowSkipLogin?: boolean;\n\n    /**\n     * Each of the sign in options that get a custom button\n     */\n    signInOptions: Array<FirebaseSignInProvider | FirebaseSignInOption>;\n\n    /**\n     * Disable the login buttons\n     */\n    disabled?: boolean;\n\n    /**\n     * Prevent users from creating new users in when the `signInOptions` value\n     * is `password`. This does not apply to the rest of login providers.\n     */\n    disableSignupScreen?: boolean;\n\n    /**\n     * Display this component when no user is found a user tries to log in\n     * when the `signInOptions` value is `password`.\n     */\n    noUserComponent?: ReactNode;\n\n    /**\n     * Display this component bellow the sign-in buttons.\n     * Useful for adding checkboxes for privacy and terms and conditions.\n     * You may want to use it in conjunction with the `disabled` prop.\n     */\n    additionalComponent?: ReactNode;\n\n    notAllowedError?: any;\n\n}\n\n/**\n * Use this component to render a login view, that updates\n * the state of the {@link FirebaseAuthController} based on the result\n * @constructor\n * @category Firebase\n */\nexport function FirebaseLoginView({\n                                      allowSkipLogin,\n                                      logo,\n                                      signInOptions,\n                                      firebaseApp,\n                                      authController,\n                                      noUserComponent,\n                                      disableSignupScreen = false,\n                                      disabled = false,\n                                      additionalComponent,\n                                      notAllowedError\n                                  }: FirebaseLoginViewProps) {\n\n    const modeState = useModeController();\n\n    const [passwordLoginSelected, setPasswordLoginSelected] = useState(false);\n\n    const [phoneLoginSelected, setPhoneLoginSelected] = useState(false);\n\n    const resolvedSignInOptions: FirebaseSignInProvider[] = signInOptions.map((o) => {\n        if (typeof o === \"object\") {\n            return o.provider;\n        } else return o as FirebaseSignInProvider;\n    })\n\n    const sendMFASms = useCallback(() => {\n        const auth = getAuth();\n        const recaptchaVerifier = new RecaptchaVerifier(\"recaptcha\", { size: \"invisible\" }, auth);\n\n        const resolver = getMultiFactorResolver(auth, authController.authProviderError);\n\n        if (resolver.hints[0].factorId === PhoneMultiFactorGenerator.FACTOR_ID) {\n\n            const phoneInfoOptions = {\n                multiFactorHint: resolver.hints[0],\n                session: resolver.session\n            };\n            const phoneAuthProvider = new PhoneAuthProvider(auth);\n            // Send SMS verification code\n            phoneAuthProvider.verifyPhoneNumber(phoneInfoOptions, recaptchaVerifier)\n                .then(function (verificationId) {\n\n                    // Ask user for the SMS verification code. Then:\n                    const verificationCode = String(window.prompt(\"Please enter the verification \" + \"code that was sent to your mobile device.\"));\n                    const cred = PhoneAuthProvider.credential(verificationId, verificationCode);\n                    const multiFactorAssertion = PhoneMultiFactorGenerator.assertion(cred);\n                    // // Complete sign-in.\n                    return resolver.resolveSignIn(multiFactorAssertion);\n\n                })\n\n        } else {\n            // Unsupported second factor.\n            console.warn(\"Unsupported second factor.\");\n        }\n\n    }, [authController.authProviderError]);\n\n    function buildErrorView() {\n        let errorView: any;\n        if (authController.user != null) return errorView; // if the user is logged in via MFA\n        const ignoredCodes = [\"auth/popup-closed-by-user\", \"auth/cancelled-popup-request\"];\n        if (authController.authProviderError) {\n            if (authController.authProviderError.code === \"auth/operation-not-allowed\" ||\n                authController.authProviderError.code === \"auth/configuration-not-found\") {\n                errorView =\n                    <div>\n                        <Box p={1}>\n                            <ErrorView\n                                error={\"You need to enable Firebase auth and the corresponding login provider in your Firebase project\"}/>\n                        </Box>\n                        {firebaseApp &&\n                            <Box p={1}>\n                                <a href={`https://console.firebase.google.com/project/${firebaseApp.options.projectId}/authentication/providers`}\n                                   rel=\"noopener noreferrer\"\n                                   target=\"_blank\">\n                                    <Button variant=\"text\"\n                                            color=\"primary\">\n                                        Open Firebase configuration\n                                    </Button>\n                                </a>\n                            </Box>}\n                    </div>;\n            } else if (authController.authProviderError.code === \"auth/invalid-api-key\") {\n                errorView =\n                    <div>\n                        <Box p={1}>\n                            <ErrorView\n                                title={\"Invalid API key\"}\n                                error={\"auth/invalid-api-key: Check that your Firebase config is set correctly in your `firebase-config.ts` file\"}/>\n                        </Box>\n                    </div>;\n            } else if (!ignoredCodes.includes(authController.authProviderError.code)) {\n                if (authController.authProviderError.code === \"auth/multi-factor-auth-required\") {\n                    sendMFASms();\n                }\n                errorView =\n                    <Box p={1}>\n                        <ErrorView error={authController.authProviderError}/>\n                    </Box>;\n            }\n        }\n        return errorView;\n    }\n\n    let logoComponent;\n    if (logo) {\n        logoComponent = <img src={logo}\n                             style={{\n                                 height: \"100%\",\n                                 width: \"100%\",\n                                 objectFit: \"cover\"\n                             }}\n                             alt={\"Logo\"}/>;\n    } else {\n        logoComponent = <FireCMSLogo/>;\n    }\n\n    let notAllowedMessage: string | undefined;\n    if (notAllowedError) {\n        if (typeof notAllowedError === \"string\") {\n            notAllowedMessage = notAllowedError;\n        } else if (notAllowedError instanceof Error) {\n            notAllowedMessage = notAllowedError.message;\n        } else {\n            notAllowedMessage = \"It looks like you don't have access to the CMS, based on the specified Authenticator configuration\";\n        }\n    }\n\n    return (\n\n        <Fade\n            in={true}\n            timeout={800}\n            mountOnEnter\n            unmountOnExit>\n\n            <Box sx={{\n                display: \"flex\",\n                flexDirection: \"column\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                minHeight: \"100vh\",\n                \"@supports (minHeight: 100dvh)\": {\n                    minHeight: \"100dvh\"\n                },\n                minWidth: \"100vw\",\n                p: 2\n            }}>\n                <div id=\"recaptcha\"></div>\n                <Box sx={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    width: \"100%\",\n                    maxWidth: 480\n                }}>\n\n                    <Box m={1} sx={{\n                        padding: 1,\n                        width: 260,\n                        height: 260\n                    }}>\n                        {logoComponent}\n                    </Box>\n\n                    {notAllowedMessage &&\n                        <Box p={2}>\n                            <ErrorView error={notAllowedMessage}/>\n                        </Box>}\n\n                    {buildErrorView()}\n\n                    {(!passwordLoginSelected && !phoneLoginSelected) && <>\n\n                        {buildOauthLoginButtons(authController, resolvedSignInOptions, modeState.mode, disabled)}\n\n                        {resolvedSignInOptions.includes(\"password\") &&\n                            <LoginButton\n                                disabled={disabled}\n                                text={\"Email/password\"}\n                                icon={<EmailIcon fontSize={\"large\"}/>}\n                                onClick={() => setPasswordLoginSelected(true)}/>}\n\n                        {resolvedSignInOptions.includes(\"phone\") &&\n                            <LoginButton\n                                disabled={disabled}\n                                text={\"Phone number\"}\n                                icon={<Phone fontSize={\"large\"}/>}\n                                onClick={() => setPhoneLoginSelected(true)}/>}\n\n                        {resolvedSignInOptions.includes(\"anonymous\") &&\n                            <LoginButton\n                                disabled={disabled}\n                                text={\"Log in anonymously\"}\n                                icon={<PersonOutlineIcon\n                                    fontSize={\"large\"}/>}\n                                onClick={authController.anonymousLogin}/>}\n\n                        {allowSkipLogin &&\n                            <Box m={1}>\n                                <Button\n                                    disabled={disabled}\n                                    onClick={authController.skipLogin}>\n                                    Skip login\n                                </Button>\n                            </Box>\n                        }\n\n                    </>}\n\n                    {passwordLoginSelected && <LoginForm\n                        authController={authController}\n                        onClose={() => setPasswordLoginSelected(false)}\n                        mode={modeState.mode}\n                        noUserComponent={noUserComponent}\n                        disableSignupScreen={disableSignupScreen}\n                    />}\n\n                    {phoneLoginSelected && <PhoneLoginForm\n                        authController={authController}\n                        onClose={() => setPhoneLoginSelected(false)}\n                    />}\n\n                    {!passwordLoginSelected && !phoneLoginSelected && additionalComponent}\n\n                </Box>\n            </Box>\n        </Fade>\n    );\n}\n\nexport function LoginButton({\n                                icon,\n                                onClick,\n                                text,\n                                disabled\n                            }: { icon: React.ReactNode, onClick: () => void, text: string, disabled?: boolean }) {\n    return (\n        <Box m={0.5} width={\"100%\"}>\n            <Button fullWidth\n                    variant=\"outlined\"\n                    disabled={disabled}\n                    onClick={onClick}>\n                <Box sx={{\n                    p: \"1\",\n                    display: \"flex\",\n                    width: \"240px\",\n                    height: \"32px\",\n                    alignItems: \"center\",\n                    justifyItems: \"center\"\n                }}>\n                    <Box sx={{\n                        display: \"flex\",\n                        flexDirection: \"column\",\n                        width: \"32px\",\n                        alignItems: \"center\",\n                        justifyItems: \"center\"\n                    }}>\n                        {icon}\n                    </Box>\n                    <Box sx={{\n                        flexGrow: 1,\n                        pl: 2,\n                        textAlign: \"center\"\n                    }}>{text}</Box>\n                </Box>\n            </Button>\n        </Box>\n    )\n}\n\nfunction PhoneLoginForm({\n                            onClose,\n                            authController\n                        }: {\n    onClose: () => void,\n    authController: FirebaseAuthController,\n}) {\n    useRecaptcha();\n\n    const [phone, setPhone] = useState<string>();\n    const [code, setCode] = useState<string>();\n    const [isInvalidCode, setIsInvalidCode] = useState(false);\n\n    const handleSubmit = async (event: any) => {\n        event.preventDefault();\n\n        if (code && authController.confirmationResult) {\n            setIsInvalidCode(false);\n\n            authController.confirmationResult.confirm(code).catch((e: FirebaseError) => {\n                if (e.code === \"auth/invalid-verification-code\") {\n                    setIsInvalidCode(true)\n                }\n            });\n        } else {\n            if (phone) {\n                authController.phoneLogin(phone, window.recaptchaVerifier);\n            }\n        }\n    }\n\n    return (\n        <form onSubmit={handleSubmit}>\n            {isInvalidCode &&\n                <Box p={2}>\n                    <ErrorView error={\"Invalid confirmation code\"}/>\n                </Box>}\n\n            <div id={RECAPTCHA_CONTAINER_ID}/>\n\n            <Grid container spacing={1}>\n                <Grid item xs={12}>\n                    <IconButton\n                        onClick={onClose}>\n                        <ArrowBackIcon sx={{\n                            width: 20,\n                            height: 20\n                        }}/>\n                    </IconButton>\n                </Grid>\n                <Grid item xs={12} sx={{\n                    p: 1,\n                    display: \"flex\"\n                }}>\n                    <Typography align={\"center\"}\n                                variant={\"subtitle2\"}>{\"Please enter your phone number\"}</Typography>\n                </Grid>\n                <Grid item xs={12}>\n                    <TextField placeholder=\"\" fullWidth\n                               value={phone}\n                               disabled={Boolean(phone && (authController.authLoading || authController.confirmationResult))}\n                               type=\"phone\"\n                               required\n                               onChange={(event) => setPhone(event.target.value)}/>\n                </Grid>\n                {Boolean(phone && authController.confirmationResult) &&\n                    <>\n                        <Grid item xs={12} sx={{\n                            mt: 2,\n                            p: 1,\n                            display: \"flex\"\n                        }}>\n                            <Typography align={\"center\"}\n                                        variant={\"subtitle2\"}>{\"Please enter the confirmation code\"}</Typography>\n                        </Grid>\n                        <Grid item xs={12}>\n                            <TextField placeholder=\"\" fullWidth\n                                       value={code}\n                                       type=\"text\"\n                                       required\n                                       onChange={(event) => setCode(event.target.value)}/>\n                        </Grid>\n                    </>\n                }\n\n                <Grid item xs={12}>\n                    <Box sx={{\n                        display: \"flex\",\n                        justifyContent: \"end\",\n                        alignItems: \"center\",\n                        width: \"100%\"\n                    }}>\n\n                        {authController.authLoading &&\n                            <CircularProgress sx={{ p: 1 }} size={16}\n                                              thickness={8}/>\n                        }\n\n                        <Button type=\"submit\">\n                            {\"Ok\"}\n                        </Button>\n                    </Box>\n                </Grid>\n\n            </Grid>\n        </form>\n    );\n}\n\nfunction LoginForm({\n                       onClose,\n                       authController,\n                       mode,\n                       noUserComponent,\n                       disableSignupScreen\n                   }: {\n    onClose: () => void,\n    authController: FirebaseAuthController,\n    mode: \"light\" | \"dark\",\n    noUserComponent?: ReactNode,\n    disableSignupScreen: boolean\n}) {\n\n    const passwordRef = useRef<HTMLInputElement | null>(null);\n\n    const [email, setEmail] = useState<string>();\n    const [availableProviders, setAvailableProviders] = useState<string[] | undefined>();\n    const [password, setPassword] = useState<string>();\n\n    const shouldShowEmail = availableProviders === undefined;\n    const loginMode = availableProviders && availableProviders.includes(\"password\");\n    const otherProvidersMode = availableProviders && !availableProviders.includes(\"password\") && availableProviders.length > 0;\n    const registrationMode = availableProviders && !availableProviders.includes(\"password\");\n\n    useEffect(() => {\n        if ((loginMode || registrationMode) && passwordRef.current) {\n            passwordRef.current.focus()\n        }\n    }, [loginMode, registrationMode]);\n\n    useEffect(() => {\n        if (!document) return;\n        const escFunction = (event: any) => {\n            if (event.keyCode === 27) {\n                onClose();\n            }\n        };\n        document.addEventListener(\"keydown\", escFunction, false);\n        return () => {\n            document.removeEventListener(\"keydown\", escFunction, false);\n        };\n    }, [onClose]);\n\n    function handleEnterEmail() {\n        if (email) {\n            authController.fetchSignInMethodsForEmail(email).then((availableProviders) => {\n                setAvailableProviders(availableProviders)\n            });\n        }\n    }\n\n    function handleEnterPassword() {\n        if (email && password) {\n            authController.emailPasswordLogin(email, password);\n        }\n    }\n\n    function handleRegistration() {\n        if (email && password) {\n            authController.createUserWithEmailAndPassword(email, password);\n        }\n    }\n\n    const onBackPressed = () => {\n        if (shouldShowEmail) {\n            onClose();\n        } else {\n            setAvailableProviders(undefined);\n        }\n    }\n\n    const handleSubmit = (event: any) => {\n        event.preventDefault();\n        if (shouldShowEmail) {\n            handleEnterEmail();\n        } else if (loginMode) {\n            handleEnterPassword();\n        } else if (registrationMode) {\n            handleRegistration();\n        }\n    }\n\n    const label = registrationMode\n        ? \"No user found with that email. Pick a password to create a new account\"\n        : (loginMode ? \"Please enter your password\" : \"Please enter your email\");\n    const button = registrationMode ? \"Create account\" : (loginMode ? \"Login\" : \"Ok\");\n\n    if (otherProvidersMode) {\n        return (\n            <Grid container spacing={1}>\n                <Grid item xs={12}>\n                    <IconButton\n                        onClick={onBackPressed}>\n                        <ArrowBackIcon sx={{\n                            width: 20,\n                            height: 20\n                        }}/>\n                    </IconButton>\n                </Grid>\n\n                <Grid item xs={12} sx={{ p: 1 }}>\n                    <Typography align={\"center\"} variant={\"subtitle2\"}>\n                        You already have an account\n                    </Typography>\n                    <Typography align={\"center\"} variant={\"body2\"}>\n                        You can use one of these\n                        methods to login with {email}\n                    </Typography>\n                </Grid>\n\n                <Grid item xs={12}>\n                    {availableProviders && buildOauthLoginButtons(authController, availableProviders, mode, false)}\n                </Grid>\n            </Grid>\n        );\n    }\n\n    return (\n        <Slide\n            direction=\"up\"\n            in={true}\n            mountOnEnter\n            unmountOnExit>\n            <form onSubmit={handleSubmit}>\n                <Grid container spacing={1}>\n                    <Grid item xs={12}>\n                        <IconButton\n                            onClick={onBackPressed}>\n                            <ArrowBackIcon sx={{\n                                width: 20,\n                                height: 20\n                            }}/>\n                        </IconButton>\n                    </Grid>\n\n                    <Grid item xs={12} sx={{\n                        p: 1,\n                        display: (registrationMode && disableSignupScreen) ? \"none\" : \"flex\"\n                    }}>\n                        <Typography align={\"center\"}\n                                    variant={\"subtitle2\"}>{label}</Typography>\n                    </Grid>\n\n                    <Grid item xs={12}\n                          sx={{ display: shouldShowEmail ? \"inherit\" : \"none\" }}>\n                        <TextField placeholder=\"Email\" fullWidth autoFocus\n                                   value={email ?? \"\"}\n                                   disabled={authController.authLoading}\n                                   type=\"email\"\n                                   onChange={(event) => setEmail(event.target.value)}/>\n                    </Grid>\n\n                    <Grid item xs={12}>\n                        {registrationMode && noUserComponent}\n                    </Grid>\n\n                    <Grid item xs={12}\n                          sx={{ display: loginMode || (registrationMode && !disableSignupScreen) ? \"inherit\" : \"none\" }}>\n                        <TextField placeholder=\"Password\" fullWidth\n                                   value={password ?? \"\"}\n                                   disabled={authController.authLoading}\n                                   inputRef={passwordRef}\n                                   type=\"password\"\n                                   onChange={(event) => setPassword(event.target.value)}/>\n                    </Grid>\n\n                    <Grid item xs={12}>\n                        <Box sx={{\n                            display: (registrationMode && disableSignupScreen) ? \"none\" : \"flex\",\n                            justifyContent: \"end\",\n                            alignItems: \"center\",\n                            width: \"100%\"\n                        }}>\n\n                            {authController.authLoading &&\n                                <CircularProgress sx={{ p: 1 }} size={16}\n                                                  thickness={8}/>\n                            }\n\n                            <Button type=\"submit\">\n                                {button}\n                            </Button>\n                        </Box>\n                    </Grid>\n                </Grid>\n            </form>\n        </Slide>\n    );\n\n}\n\nfunction buildOauthLoginButtons(authController: FirebaseAuthController, providers: string[], mode: \"light\" | \"dark\", disabled: boolean) {\n    return <>\n        {providers.includes(\"google.com\") && <LoginButton\n            disabled={disabled}\n            text={\"Sign in with Google\"}\n            icon={googleIcon(mode)}\n            onClick={authController.googleLogin}/>}\n\n        {providers.includes(\"microsoft.com\") && <LoginButton\n            disabled={disabled}\n            text={\"Sign in with Microsoft\"}\n            icon={microsoftIcon(mode)}\n            onClick={authController.microsoftLogin}/>}\n\n        {providers.includes(\"apple.com\") && <LoginButton\n            disabled={disabled}\n            text={\"Sign in with Apple\"}\n            icon={appleIcon(mode)}\n            onClick={authController.appleLogin}/>}\n\n        {providers.includes(\"github.com\") && <LoginButton\n            disabled={disabled}\n            text={\"Sign in with Github\"}\n            icon={githubIcon(mode)}\n            onClick={authController.githubLogin}/>}\n\n        {providers.includes(\"facebook.com\") && <LoginButton\n            disabled={disabled}\n            text={\"Sign in with Facebook\"}\n            icon={facebookIcon(mode)}\n            onClick={authController.facebookLogin}/>}\n\n        {providers.includes(\"twitter.com\") && <LoginButton\n            disabled={disabled}\n            text={\"Sign in with Twitter\"}\n            icon={twitterIcon(mode)}\n            onClick={authController.twitterLogin}/>}\n    </>\n}\n","import React, { useMemo } from \"react\";\nimport { GoogleAuthProvider } from \"firebase/auth\";\nimport { CssBaseline, ThemeProvider } from \"@mui/material\";\nimport { BrowserRouter } from \"react-router-dom\";\nimport { useInitialiseFirebase } from \"./hooks/useInitialiseFirebase\";\n\nimport {\n    CenteredView,\n    CircularProgressCenter,\n    createCMSDefaultTheme,\n    FireCMS,\n    ModeControllerProvider,\n    NavigationRoutes,\n    Scaffold,\n    SideDialogs,\n    SnackbarProvider,\n    useBuildLocalConfigurationPersistence,\n    useBuildModeController\n} from \"../core\";\n\nimport { FirebaseCMSAppProps } from \"./FirebaseCMSAppProps\";\nimport { useFirebaseAuthController } from \"./hooks/useFirebaseAuthController\";\nimport { useFirestoreDataSource } from \"./hooks/useFirestoreDataSource\";\nimport { useFirebaseStorageSource } from \"./hooks/useFirebaseStorageSource\";\nimport { useInitializeAppCheck } from \"./hooks/useInitializeAppCheck\";\nimport { FirebaseLoginView } from \"./components/FirebaseLoginView\";\nimport { FirebaseAuthController } from \"./types/auth\";\nimport { useValidateAuthenticator } from \"./hooks/useValidateAuthenticator\";\nimport { useBrowserTitleAndIcon } from \"../hooks\";\n\nconst DEFAULT_SIGN_IN_OPTIONS = [\n    GoogleAuthProvider.PROVIDER_ID\n];\n\n/**\n * This is the default implementation of a FireCMS app using the Firebase services\n * as a backend.\n * You can use this component as a full app, by specifying collections and\n * entity collections.\n *\n * This component is in charge of initialising Firebase, with the given\n * configuration object.\n *\n * If you are building a larger app and need finer control, you can use\n * {@link FireCMS}, {@link Scaffold}, {@link SideDialogs}\n * and {@link NavigationRoutes} instead.\n *\n * @param props\n * @constructor\n * @category Firebase\n */\nexport function FirebaseCMSApp({\n                                   name,\n                                   logo,\n                                   logoDark,\n                                   toolbarExtraWidget,\n                                   authentication,\n                                   collectionOverrideHandler,\n                                   collections,\n                                   views,\n                                   textSearchController,\n                                   allowSkipLogin,\n                                   signInOptions = DEFAULT_SIGN_IN_OPTIONS,\n                                   firebaseConfig,\n                                   onFirebaseInit,\n                                   appCheckOptions,\n                                   primaryColor,\n                                   secondaryColor,\n                                   fontFamily,\n                                   dateTimeFormat,\n                                   locale,\n                                   HomePage,\n                                   basePath,\n                                   baseCollectionPath,\n                                   LoginView,\n                                   onAnalyticsEvent,\n                                   fields = {},\n                                   plugins,\n                                   autoOpenDrawer\n                               }: FirebaseCMSAppProps) {\n\n    /**\n     * Update the browser title and icon\n     */\n    useBrowserTitleAndIcon(name, logo);\n\n    const {\n        firebaseApp,\n        firebaseConfigLoading,\n        configError\n    } = useInitialiseFirebase({\n        onFirebaseInit,\n        firebaseConfig\n    });\n\n    const {\n        appCheckLoading,\n        getAppCheckToken\n    } = useInitializeAppCheck({\n        firebaseApp,\n        options: appCheckOptions\n    });\n\n    /**\n     * Controller for managing authentication\n     */\n    const authController: FirebaseAuthController = useFirebaseAuthController({\n        firebaseApp,\n        signInOptions\n    });\n\n    /**\n     * Controller for saving some user preferences locally.\n     */\n    const userConfigPersistence = useBuildLocalConfigurationPersistence();\n\n    /**\n     * Controller in charge of fetching and persisting data\n     */\n    const dataSource = useFirestoreDataSource({\n        firebaseApp,\n        textSearchController,\n        fields\n    });\n\n    /**\n     * Controller used for saving and fetching files in storage\n     */\n    const storageSource = useFirebaseStorageSource({\n        firebaseApp\n    });\n\n    /**\n     * Validate authenticator\n     */\n    const {\n        authLoading,\n        canAccessMainView,\n        notAllowedError\n    } = useValidateAuthenticator({\n        authController,\n        authentication,\n        getAppCheckToken,\n        appCheckForceRefresh: (appCheckOptions && appCheckOptions.forceRefresh) ? appCheckOptions.forceRefresh! : false,\n        dataSource,\n        storageSource\n    });\n\n    /**\n     * Controller used to manage the dark or light color mode\n     */\n    const modeController = useBuildModeController();\n\n    /**\n     * It is important to memoize the theme, otherwise the app will re-render\n     * whenever there is a state change in the CMS.\n     */\n    const theme = useMemo(() => createCMSDefaultTheme({\n        mode: modeController.mode,\n        primaryColor,\n        secondaryColor,\n        fontFamily\n    }), [fontFamily, modeController.mode, primaryColor, secondaryColor]);\n\n    if (configError) {\n        return <CenteredView fullScreen={true}>{configError}</CenteredView>;\n    }\n\n    if (firebaseConfigLoading || !firebaseApp || appCheckLoading) {\n        return <>\n            <CssBaseline/>\n            <CircularProgressCenter/>\n        </>;\n    }\n\n    return (\n        <BrowserRouter basename={basePath}>\n            <SnackbarProvider>\n                <ModeControllerProvider\n                    value={modeController}>\n                    <FireCMS\n                        collections={collections}\n                        views={views}\n                        authController={authController}\n                        userConfigPersistence={userConfigPersistence}\n                        collectionOverrideHandler={collectionOverrideHandler}\n                        dateTimeFormat={dateTimeFormat}\n                        dataSource={dataSource}\n                        storageSource={storageSource}\n                        entityLinkBuilder={({ entity }) => `https://console.firebase.google.com/project/${firebaseApp.options.projectId}/firestore/data/${entity.path}/${entity.id}`}\n                        locale={locale}\n                        basePath={basePath}\n                        baseCollectionPath={baseCollectionPath}\n                        onAnalyticsEvent={onAnalyticsEvent}\n                        plugins={plugins}\n                        fields={fields}>\n                        {({\n                              context,\n                              loading\n                          }) => {\n\n                            let component;\n                            if (loading || authLoading) {\n                                component = <CircularProgressCenter/>;\n                            } else {\n                                const usedLogo = modeController.mode === \"dark\" && logoDark ? logoDark : logo;\n                                if (!canAccessMainView) {\n                                    const LoginViewUsed = LoginView ?? FirebaseLoginView;\n                                    component = (\n                                        <LoginViewUsed\n                                            logo={usedLogo}\n                                            allowSkipLogin={allowSkipLogin}\n                                            signInOptions={signInOptions ?? DEFAULT_SIGN_IN_OPTIONS}\n                                            firebaseApp={firebaseApp}\n                                            authController={authController}\n                                            notAllowedError={notAllowedError}/>\n                                    );\n                                } else {\n                                    component = (\n                                        <Scaffold\n                                            name={name}\n                                            logo={usedLogo}\n                                            toolbarExtraWidget={toolbarExtraWidget}\n                                            autoOpenDrawer={autoOpenDrawer}>\n                                            <NavigationRoutes\n                                                HomePage={HomePage}/>\n                                            <SideDialogs/>\n                                        </Scaffold>\n                                    );\n                                }\n                            }\n\n                            return (\n                                <ThemeProvider theme={theme}>\n                                    <CssBaseline enableColorScheme/>\n                                    {component}\n                                </ThemeProvider>\n                            );\n                        }}\n                    </FireCMS>\n                </ModeControllerProvider>\n            </SnackbarProvider>\n        </BrowserRouter>\n    );\n}\n","import { SearchIndex } from \"algoliasearch\";\n\n/**\n * Use this controller to return a list of ids from a search index, given a\n * `path` and a `searchString`.\n * Firestore does not support text search directly so we need to rely on an external\n * index, such as Algolia.\n * Note that you will get text search requests for collections that have the\n * `textSearchEnabled` flag set to `true`.\n * @see performAlgoliaTextSearch\n * @category Firebase\n */\nexport type FirestoreTextSearchController = (props: { path: string, searchString: string }) => Promise<readonly string[]> | undefined;\n\n/**\n * Utility function to perform a text search in an algolia index,\n * returning the ids of the entities.\n * @param index\n * @param query\n * @category Firebase\n */\nexport function performAlgoliaTextSearch(index: SearchIndex, query: string): Promise<readonly string[]> {\n\n    console.debug(\"Performing Algolia query\", index, query);\n    return index\n        .search(query)\n        .then(({ hits }: any) => {\n            return hits.map((hit: any) => hit.objectID as string);\n        })\n        .catch((err: any) => {\n            console.error(err);\n            return [];\n        });\n}\n"],"names":["DEFAULT_BREADCRUMBS_CONTROLLER","props","BreadcrumbContext","React","BreadcrumbsProvider","children","breadcrumbs","setBreadcrumbs","useState","set","jsx","DEFAULT_MODE_STATE","mode","ModeControllerContext","ModeControllerProvider","removeInitialAndTrailingSlashes","s","removeInitialSlash","removeTrailingSlash","addInitialSlash","getLastSegment","path","cleanPath","segments","resolveCollectionPathAliases","allCollections","subpaths","aliasedCollection","col","resolvedAliased","segmentCollection","getCollectionByPathOrAlias","restOfThePath","pathOrAlias","collections","subpathCombinations","getCollectionPathsCombinations","result","i","subpathCombination","navigationEntry","a","b","entry","newPath","entries","length","getNavigationEntriesFromPathInternal","currentFullPath","collection","collectionPath","nextSegments","entityId","fullPath","customViews","customView","CONTAINER_FULL_WIDTH","ADDITIONAL_TAB_WIDTH","FORM_CONTAINER_WIDTH","DataSourceContext","useDataSource","useContext","NavigationContextInstance","useNavigationContext","AuthControllerContext","useAuthController","SideDialogsControllerContext","useSideDialogsController","SideEntityControllerContext","useSideEntityController","StorageSourceContext","useStorageSource","useSnackbarController","enqueueSnackbar","closeSnackbar","useSnackbar","useCallback","type","message","autoHideDuration","UserConfigurationPersistenceContext","useUserConfigurationPersistence","FireCMSContextInstance","createContext","useFireCMSContext","partialContext","authController","sideDialogsController","sideEntityController","navigation","dataSource","storageSource","snackbarController","userConfigPersistence","useCollectionFetch","inputPath","filterValues","sortBy","itemCount","searchString","sortByProperty","currentSort","context","data","setData","dataLoading","setDataLoading","dataLoadingError","setDataLoadingError","noMoreToLoad","setNoMoreToLoad","useEffect","onEntitiesUpdate","entities","entity","e","onError","error","CACHE","useEntityFetch","useCache","setEntity","onEntityUpdate","updatedEntity","saveEntityWithCallbacks","values","previousValues","status","onSaveSuccess","onSaveFailure","onPreSaveHookError","onSaveSuccessHookError","updatedValues","resolvedPath","callbacks","resolvedCollection","resolveCollection","deleteEntityWithCallbacks","onDeleteSuccess","onDeleteFailure","onPreDeleteHookError","onDeleteSuccessHookError","entityDeleteProps","useClearRestoreValue","property","value","setValue","clearedValueRef","useRef","resolveNavigationFrom","resultPromises","v","useResolvedNavigationFrom","res","useModeController","useClipboard","options","onSuccess","disableClipboardAPI","copiedDuration","ref","isCoppied","setIsCoppied","clipboard","setClipbaord","isSupported","handleError","handleSuccess","text","copyToClipboard","err","clearClipboard","copy","action","cut","operation","element","isInput","input","useBreadcrumbsContext","useReferenceDialog","referenceDialogProps","open","usedCollection","ReferenceSelectionInner","close","fireCMSLogo","useBrowserTitleAndIcon","name","logo","link","ErrorTooltip","styled","className","Tooltip","theme","tooltipClasses","ErrorView","title","tooltip","component","body","jsxs","Box","ErrorIcon","Typography","EntityReference","id","GeoPoint","latitude","longitude","EmptyValue","TINY_THUMBNAIL","SMALL_THUMBNAIL","REGULAR_THUMBNAIL","getThumbnailMeasure","size","getPreviewSizeFrom","ImagePreview","url","onHover","setOnHover","imageSize","useMemo","useTheme","imageStyle","Fragment","IconButton","ContentCopyIcon","OpenInNewIcon","UrlComponentPreview","previewType","hint","CardMedia","DescriptionOutlinedIcon","Link","SkeletonPropertyComponent","content","stringProperty","renderUrlComponent","renderSkeletonImageThumbnail","renderSkeletonText","arrayProperty","p","renderGenericArrayCell","renderArrayOfMaps","renderArrayEnumTableCell","renderArrayOfStrings","renderMap","renderReference","mapPropertyKeys","key","index","Table","TableBody","TableRow","TableCell","properties","previewProperties","tableProperties","Grid","Skeleton","renderSkeletonIcon","renderUrlFile","renderSkeletonCaptionText","StorageThumbnail","StorageThumbnailInternal","areEqual","prevProps","nextProps","URL_CACHE","storeUrl","storagePathOrDownloadUrl","storage","downloadConfig","setDownloadConfig","unmounted","filetype","getFiletype","md","MarkdownIt","Markdown","source","html","hashString","str","hash","chr","CHIP_COLORS","getColorSchemeForSeed","seed","colorKeys","enumToObjectEntries","enumValues","getLabelOrConfigFrom","getColorScheme","labelOrConfig","isEnumValueDisabled","buildEnumLabel","EnumValuesChip","enumKey","small","enumValuesConfig","enumValue","label","colorScheme","ColorChip","outlined","usedColorScheme","Chip","StringPropertyPreview","propertyKey","resolvedProperty","resolvePropertyEnum","ErrorBoundary","lines","ArrayOfMapsPreview","inputProperty","fireCMSContext","resolveArrayProperty","mapProperty","mapProperties","PropertyPreview","ArrayPropertyPreview","childSize","of","Divider","fieldBackground","fieldBackgroundHover","fieldBackgroundDisabled","fieldBackgroundSubtleHover","ReferencePreview","ReferencePreviewInternal","disabled","reference","onClick","allowEntityNavigation","navigationContext","referencesCache","usedEntity","listProperties","getReferencePreviewKeys","childProperty","getValueInPath","KeyboardTabIcon","ReferencePreviewWrap","clickableStyles","event","ArrayOfReferencesPreview","ofProperty","PREFIX","classes","Root","ArrayOfStorageComponentsPreview","ArrayEnumPreview","ArrayPropertyEnumPreview","ArrayOfStringsPreview","DEFAULT_ONE_OF_TYPE","DEFAULT_ONE_OF_VALUE","ArrayOneOfPreview","typeField","valueField","MapPropertyPreview","KeyValuePreview","childValue","defaultDateFormat","DatePreview","date","appConfig","dateUtilsLocale","locales","dateFormat","formattedDate","format","BooleanPreview","CheckBox","CheckBoxOutlineBlank","NumberPropertyPreview","resolveEnumValues","height","width","resolveProperty","createElement","buildWrongValueType","dataType","AsyncPreviewComponent","builder","loading","setLoading","setResult","pick","obj","args","isObject","item","mergeDeep","target","targetIsObject","output","o","pathSegments","removeInPath","currentObject","parts","last","part","removeFunctions","_","getHashValue","removeUndefined","isEmptyObject","childRes","isReadOnly","isHidden","isPropertyBuilder","propertyOrBuilder","getDefaultValuesFor","getDefaultValueFor","defaultValuesFor","getDefaultValueForDataType","updateDateAutoValues","inputValues","timestampNowValue","setDateToMidnight","traverseValuesProperties","inputValue","resultDate","sanitizeData","getReferenceFrom","updatedValue","traverseValueProperty","mergeCollections","subcollectionsMerged","targetSubcollection","modifiedCollection","sourceSubcollection","mergedCollection","sortProperties","joinCollectionLists","fetchedCollections","baseCollections","resolvedFetchedCollections","c","updatedCollections","navigationCollection","storedCollection","storedCollections","propertiesOrder","propertiesKeys","resolveDefaultSelectedView","defaultSelectedView","params","kebabCaseRegex","toKebabCase","regExpMatchArray","x","snakeCaseRegex","toSnakeCase","randomString","strLength","randomColor","COLLECTION_PATH_SEPARATOR","stripCollectionPath","segmentsToStrippedPath","fullPathToCollectionSegments","paths","serializeRegExp","hydrateRegExp","fragments","isValidRegExp","useDebounce","callback","immediate","timeoutMs","pendingUpdate","performUpdate","handlerRef","useDebounceValue","delay","debouncedValue","setDebouncedValue","handler","FormikArrayContainer","addLabel","buildEntry","onInternalIdAdded","includeAddButton","newDefaultEntry","setFieldValue","ArrayContainer","FieldDescription","disabledTooltip","FormHelperText","InfoIcon","LabelWithIcon","icon","sx","required","DebouncedTextField","previousEventRef","internalValue","setInternalValue","deferredValue","useDeferredValue","internalOnChange","TextField","SwitchControl","field","form","formControlLabel","FormControlLabel","Switch","checked","errorInfo","ReadOnlyFieldBinding","showError","isSubmitting","touched","tableMode","includeDescription","FormControl","getIconForProperty","Paper","PropertyFieldBinding","PropertyFieldBindingInternal","aIsBuilder","bIsBuilder","equal","shouldPropertyReRender","underlyingValueHasChanged","partOfArray","autoFocus","FieldComponent","Field","FastField","fieldProps","Component","fieldConfig","getFieldConfig","FieldInternal","plugins","customFieldProps","initialValue","getIn","UsedComponent","useWrappedComponent","shouldValidate","otherPropertyKey","plugin","defAProperty","rerenderThisProperty","Wrapper","fieldId","getFieldId","enabled","ArrayCustomShapedFieldBinding","expanded","ExpandablePanel","SelectFieldBinding","handleClearClick","InputLabel","MuiSelect","ClearIcon","evt","eventValue","newValue","enumConfig","MenuItem","ArrayEnumSelectBinding","validValue","selected","Checkbox","ListItemText","ArrayOfReferencesFieldBinding","selectedEntityIds","onMultipleEntitiesSelected","referenceDialogController","onEntryClick","internalId","entryValue","Button","resolveFilenameString","file","replacePlaceholders","resolveStoragePathString","ext","useStorageUploadController","entityValues","onChange","multipleFilesSupported","metadata","compression","internalInitialValue","getRandomId","setInitialValue","fileNameBuilder","fileName","storagePathBuilder","onFileUploadComplete","uploadedPath","uploadPathOrDownloadUrl","removeDuplicates","fieldValue","onFilesAdded","acceptedFiles","newInternalValue","compressionFormat","resizeAndCompressImage","items","supportedTypes","defaultQuality","resolve","inputQuality","quality","Resizer","StorageUploadProgress","storagePath","simple","setError","mounted","uploading","upload","StorageItemPreview","onRemove","RemoveIcon","StyledBox","StorageUploadFieldBinding","StorageUpload","FileDropComponent","isDraggingOver","droppableProvided","onClear","helpText","snackbarContext","getRootProps","getInputProps","isDragActive","isDragAccept","isDragReject","useDropzone","fileRejections","fileRejection","clsx","child","Draggable","provided","snapshot","moveItem","fromIndex","toIndex","onDragEnd","clearedStoragePathOrDownloadUrl","renderProperty","DragDropContext","Droppable","rubric","getStyleValue","styles","isEmpty","TextareaAutosize","onScroll","onResize","maxRows","minRows","style","onFocus","onBlur","sizeRef","other","isControlled","inputRef","handleRef","useForkRef","shadowRef","renders","state","setState","getUpdatedState","computedStyle","ownerWindow","sizeReferenceElement","inputShallow","boxSizing","padding","border","innerHeight","singleRowHeight","outerHeight","outerHeightStyle","overflow","updateState","prevState","newState","syncHeight","syncHeightWithFlushSync","ReactDOM","handleResize","debounce","resizeObserver","containerWindow","useEnhancedEffect","handleChange","DisabledTextField","TextInput","inputType","multiline","endAdornment","placeholder","focused","setFocused","hasValue","numberInputOnWheelPreventChange","StyledTextArea","StyledInput","TextFieldBinding","allowInfinity","numberValue","isMultiline","Collapse","BooleanSwitch","position","focus","setFocus","SwitchFieldBinding","DateTimeFieldBinding","PickerComponent","DateTimePicker","DatePicker","MuiTextField","dateValue","ReferenceWidget","forceFilter","onSingleEntitySelected","handleClickOpen","clearValue","seeEntityDetails","missingEntity","LinkIcon","ReferenceFieldBinding","ReferenceFieldBindingInternal","MapFieldBinding","pickOnlySomeKeys","mapFormView","entryKey","buildPickKeysSelect","keys","handleAddProperty","Select","KeyValueFieldBinding","MapEditView","MapKeyValueRow","rowId","fieldKey","onFieldKeyChange","onDeleteClick","updateDataType","menuAnchorEl","setMenuAnchorEl","menuOpen","openTypeSelectMenu","handleMenuClose","buildInput","DateTimeField","ArrayKeyValueRow","newArrayValue","doUpdateDataType","ArrowDropDownIcon","Menu","selectedDataType","setSelectedDataType","getDataType","fieldName","internalState","setInternalState","currentKeys","newKeys","keysToAdd","keysToRemove","newRowIds","k","originalValue","row","currentRowId","newKey","AddIcon","invisible","initiallyExpanded","highlightOnHover","dark","onExpandedChange","setOnHoverTrue","setOnHoverFalse","expandedInternal","setExpandedInternal","Accordion","AccordionSummary","ExpandMoreIcon","AccordionDetails","RepeatFieldBinding","lastAddedId","setLastAddedId","arrayContainer","BlockFieldBinding","BlockEntry","firstOneOfKey","typeInternal","setTypeInternal","formikContext","useFormikContext","updateType","enumValuesConfigs","typeFieldName","valueFieldName","newType","newSelectedProperty","enumValueConfig","mdParser","MdEditor","Plugins","MarkdownFieldBinding","valueRef","deferred","StyledFormControl","darken","lighten","yup","mapper","getYupEntitySchema","customFieldValidator","objectSchema","mapPropertyToYup","propertyContext","getYupStringSchema","getYupNumberSchema","getYupBooleanSchema","getYupMapObjectSchema","getYupArraySchema","getYupDateSchema","getYupGeoPointSchema","getYupReferenceSchema","childName","parentProperty","validation","regExp","hasUniqueInArrayModifier","arraySchema","yupProperties","object","arrayUniqueFields","ErrorFocus","containerRef","isValidating","errors","errorElement","scrollableParent","getScrollableParent","top","isScrollable","ele","hasScrollableContent","overflowYStyle","isOverflowHidden","fields","collectionOverride","storedProperties","defaultValues","usedValues","usedPreviousValues","resolvedProperties","propertyValue","cleanedProperties","fromBuilder","resolveProperties","cmsFields","customField","customFieldProperty","CustomIdField","customId","idSetAutomatically","inputProps","InputAdornment","ErrorMessage","EntityForm","EntityFormInternal","inputCollection","onEntitySaveRequested","onDiscard","onModified","onValuesChanged","onIdChange","onFormContextChange","hideId","autoSave","onIdUpdateError","initialResolvedCollection","mustSetCustomId","initialEntityId","closeAfterSaveRef","baseDataSourceValues","setEntityId","entityIdError","setEntityIdError","savingError","setSavingError","initialValuesRef","initialValues","internalValues","setInternalValues","doOnValuesChanges","save","onIdUpdate","updatedId","underlyingChanges","latestValue","eventName","saveFormValues","formikActions","uniqueFieldValidator","validationSchema","Formik","pluginActions","formContext","actionProps","alpha","InnerForm","handleSubmit","dirty","modified","formValue","formFields","cmsFormFieldProps","formRef","Form","CustomDialogActions","DEFAULT_FIELD_CONFIGS","ShortTextIcon","SubjectIcon","FormatQuoteIcon","HttpIcon","EmailIcon","ListIcon","ListAltIcon","NumbersIcon","FormatListNumberedIcon","UploadFileIcon","DriveFolderUploadIcon","AddLinkIcon","FlagIcon","ScheduleIcon","BallotOutlinedIcon","RepeatIcon","ViewStreamIcon","oneOf","isReferenceProperty","getIdIcon","color","fontSize","AdjustIcon","getIconForWidget","widget","Icon","Crop75Icon","FunctionsIcon","getBadgeForWidget","getColorForProperty","getPropertyInPath","getResolvedPropertyInPath","getBracketNotation","DEFAULT_PERMISSIONS","resolvePermissions","permission","canEditEntity","canCreateEntity","canDeleteEntity","getIcon","iconKey","mui","getIconForView","collectionOrView","iconsCount","collectionIconKeys","plural","word","amount","plurals","irregular","w","pattern","replace","reg","singular","singulars","targetCollection","limit","allProperties","StyledTableContainer","TableContainer","EntityPreview","getCellAlignment","getPropertyColumnWidth","getSubcollectionColumnId","TableInput","updateValue","prevValue","focusedState","doUpdate","TableSelect","multiple","valueType","setOpen","handleOpen","handleClose","renderValue","chip","NumberTableInput","align","propStringValue","regexp","Input","TableSwitch","TableDateField","TableReferenceField","multiselect","hoverTrue","hoverFalse","valueNotSet","buildSingleReferenceField","buildMultipleReferenceField","dropZoneMixin","activeDropMixin","acceptDropMixin","rejectDropMixin","TableStorageUpload","previewSize","previewSizeInput","rootProps","TableStorageItemPreview","EditIcon","getRowHeight","getBackgroundColor","selectedRow","saved","isSelected","TableCellRoot","justifyContent","alignItems","backgroundColor","TableCellInner","scrollable","faded","fullHeight","allowScroll","openPopup","removePadding","onSelect","showExpandIcon","measureRef","bounds","useMeasure","isOverflowing","setIsOverflowing","maxHeight","internalSaved","setInternalSaved","iconRef","doOpenPopup","cellRect","onSelectCallback","newOverflowingValue","RemoveCircleIcon","ErrorOutlineIcon","isStorageProperty","PropertyTableCell","columnIndex","readonly","onValueChange","selectedCell","select","setPopupCell","useEntityCollectionTableController","internalValueRef","setSaved","onValueUpdated","customPreview","readOnlyProperty","saveValues","innerComponent","numberProperty","useDraggable","innerRef","y","onMove","relX","relY","listeningRef","onMouseDown","onMouseMove","onMouseUp","onMouseDownInner","update","current","innerCurrent","useWindowSize","setSize","useLayoutEffect","updateSize","ElementResizeListener","rafRef","objectRef","onResizeRef","_onResize","onLoad","maxWidth","translucent","Container","PopupFormField","PopupFormFieldInternal","tableKey","onClose","onCellValueChange","popupLocation","setPopupLocation","windowSize","initialPositionSet","getInitialLocation","normalizePosition","draggableBoundingRect","updatePopupLocation","newPosition","adaptResize","saveValue","actions","setFieldTouched","internalForm","draggable","Portal","CircularProgressCenter","CircularProgress","VirtualTableHeader","resizeHandleRef","isResizingIndex","sort","onColumnSort","onFilterUpdate","filter","column","onClickResizeColumn","createFilterField","openFilter","setOpenFilter","handleSettingsClick","filterForProperty","newOpenFilterState","thisColumnIsResizing","hovered","Badge","ArrowUpwardIcon","ArrowDownwardIcon","ArrowDropDownCircleIcon","FilterForm","popupOpen","setPopupOpen","anchorEl","filterInternal","setFilterInternal","submit","reset","filterIsSet","filterField","Popover","VirtualTableHeaderRow","columns","onColumnResize","onColumnResizeEnd","columnRefs","createRef","isResizing","setIsResizing","adjustWidthColumn","end","minWidth","newWidth","getEventNewWidth","left","setCursorDocument","handleOnMouseMove","handleOnMouseUp","removeResizingListeners","attachResizeListeners","filterForThisProperty","VirtualTableRowInner","cursor","VirtualTableRow","rowData","rowIndex","onRowClick","hoverRow","setHovered","VirtualTableCell","VirtualListContext","innerElementType","forwardRef","rest","virtualTableProps","VirtualTable","onResetPagination","onEndReached","columnsProp","filterInput","checkFilterCombination","emptyMessage","onSortByUpdate","cellRenderer","setColumns","tableRef","endReachCallbackThreshold","onColumnResizeInternal","onColumnResizeEndInternal","filterRef","scrollToTop","isDesc","newSort","newSortProperty","newSortBy","resetSort","maxScroll","onEndReachedInternal","scrollOffset","scrollUpdateWasRequested","onFilterUpdateInternal","newFilterValue","buildErrorView","buildEmptyView","AssignmentIcon","empty","MemoizedList","outerRef","itemSize","Row","cellData","List","EntityCollectionRowActions","frozen","selectionEnabled","toggleEntitySelection","onCopyClicked","onEditClicked","onDeleteClicked","largeLayout","useMediaQuery","editEnabled","copyEnabled","deleteEnabled","setAnchorEl","openMenu","closeMenu","onCheckboxChange","onCopyClick","KeyboardTab","MoreVert","ListItemIcon","Delete","FileCopy","SearchBar","onTextSearch","expandable","large","searchText","setSearchText","active","setActive","deferredValues","clearText","SearchIcon","InputBase","FilledSelect","FilledMenuItem","CollectionTableToolbar","filterView","FilterListOffIcon","sizeSelect","Hidden","operationLabels","multipleSelectOperations","ReferenceFilterField","isArray","possibleOperations","fieldOperation","setOperation","updateFilter","op","val","prevOpIsArray","newOpIsArray","hasNewValue","doOpenDialog","StringNumberFilterField","OutlinedInput","BooleanFilterField","valueSetToTrue","valueSet","clearable","DateTimeFilterField","DEFAULT_STATE","EntityCollectionTableContext","COLLECTION_GROUP_PARENT_ID","EntityCollectionTable","initialFilter","initialSort","filterCombinations","actionsStart","tableRowActionsBuilder","selectionController","highlightedEntities","onEntityClick","onSizeChanged","textSearchEnabled","inlineEditing","setFilterValues","setSortBy","setSearchString","clearFilter","setItemCount","pageSize","paginationEnabled","disabledFilterChange","selectedEntities","setSelectedCell","popupCell","additionalFields","subcollectionColumns","subcollection","collectionGroupParentCollections","collectionsWithPath","loadNextPage","resetPagination","newSearchString","additionalFieldsMap","aC","escFunction","unselect","cell","onPopupClose","displayedColumnIds","useColumnIds","propertyCellRenderer","additionalCellRenderer","additionalField","Builder","allColumns","columnsResult","childKey","filterable","filterableProperty","hoverOrOpen","additionalTableColumns","idColumn","columnKey","updatedFilterValues","setIn","saveProps","getDefaultColumnKeys","includeSubcollections","propertyKeys","subCollections","columnIds","subCollectionIds","subColId","hideAndExpandKeys","filterValue","setFilterValue","baseProperty","defaultTransitionDuration","SideDialogDrawer","offsetPosition","Modal","Backdrop","Slide","useNavigationUnsavedChangesDialog","when","nextLocation","setNextLocation","navigator","UNSAFE_NavigationContext","navigate","useNavigate","handleCancel","handleOk","blocker","retry","unblock","tx","autoUnblockingTx","UnsavedChangesDialog","Dialog","DialogTitle","DialogContent","DialogContentText","SideDialogContext","blocked","useSideDialogContext","SideDialogs","sidePanels","panels","panel","SideDialogView","drawerCloseRequested","setDrawerCloseRequested","setBlocked","blockedNavigationMessage","setBlockedNavigationMessage","widthRef","navigationWasBlocked","handleNavigationOk","handleNavigationCancel","handleDrawerCloseOk","handleDrawerCloseCancel","onCloseRequest","force","DeleteEntityDialog","entityOrEntitiesToDelete","onEntityDelete","onMultipleEntitiesDelete","entityOrEntities","setUsedEntityOrEntities","multipleEntities","setMultipleEntities","revisedEntityOrEntities","performDelete","results","success","dialogTitle","downloadCSV","additionalData","exportConfig","headers","getExportHeaders","exportableData","getExportableData","headersData","entryToCSVRow","h","csvData","downloadBlob","mergedData","processCSVValues","additional","header","getHeaders","prefix","currentKey","processCSVValue","filename","contentType","blob","pom","INITIAL_DOCUMENTS_LIMIT","ExportButton","dataRef","additionalDataRef","hasLargeAmountOfData","setHasLargeAmountOfData","fetchLargeDataAccepted","setFetchLargeDataAccepted","doDownload","fetchAdditionalFields","updateEntities","pendingDownload","additionalFieldsData","needsToAcceptFetchAllData","onOkClicked","GetAppIcon","Alert","EntityCollectionViewActions","onNewClick","exportable","onMultipleDeleteClick","loadedEntities","addButton","Add","multipleDeleteEnabled","multipleDeleteButton","button","Action","exportButton","useDataOrder","entitiesDisplayedFirst","displayedFirstId","useDebouncedData","deps","deferredData","setDeferredData","dataLength","currentDeps","haveDepsChanged","immediateUpdate","DEFAULT_PAGE_SIZE","useTableController","isFilterCombinationValid","lastDeleteTimestamp","forceFilterFromProps","forceFilterFromCollection","initialSortInternal","rawData","orderedData","isFilterCombinationValidForFirestore","indexes","sortKey","sortDirection","filterKeys","filtersCount","compositeIndex","EntityCollectionView","isSubCollection","collectionProp","userOverride","selectedNavigationEntity","setSelectedNavigationEntity","deleteEntityClicked","setDeleteEntityClicked","setLastDeleteTimestamp","unselectNavigatedEntity","currentSelection","checkInlineEditing","useSelectionController","usedSelectionController","isEntitySelected","setSelectedEntities","tableController","clickedEntity","onSingleDeleteClick","selectedEntity","internalOnEntityDelete","_path","internalOnMultipleEntitiesDelete","onCollectionModifiedForUser","partialCollection","currentStoredConfig","updatedConfig","localCollection","Title","EntitiesCount","createEnabled","count","setCount","pathInput","description","maxSelection","sideDialogContext","setEntitiesDisplayedFirst","onDone","ReferenceDialogActions","toArray","NavigationGroup","group","userConfigurationPersistence","g","NavigationCollectionCard","view","CollectionIcon","favourite","CardActionArea","CardContent","StarIcon","StarBorderIcon","CardActions","ArrowForwardIcon","NavigationChip","FavouritesView","hidden","favouriteCollections","recentCollections","favouritesGroup","useRestoreScroll","scrollsMap","location","useLocation","scroll","setScroll","direction","setDirection","handleScroll","container","search","JsSearch","FireCMSHomePage","additionalChildrenStart","additionalChildrenEnd","navigationEntries","groups","filteredUrls","setFilteredUrls","filteredNavigationEntries","updateSearchResults","allGroups","additionalSections","sectionProps","section","AdditionalCards","thisGroupCollections","AdditionalCard","BreadcrumbUpdater","breadcrumbsContext","NotFoundPage","ReactLink","DeleteConfirmationDialog","onAccept","onCancel","LoadingButton","FireCMSLogo","CenteredView","fullScreen","fadeTimeout","Fade","InfoLabel","background","Drawer","drawerOpen","closeDrawer","tooltipsOpen","ungroupedNavigationViews","buildGroupHeader","DrawerNavigationItem","listItem","ListItem","NavLink","isActive","grey","DRAWER_WIDTH","Scaffold","toolbarExtraWidget","autoOpenDrawer","FireCMSAppBarComponent","FireCMSAppBar","setDrawerOpen","UsedDrawer","FireCMSDrawer","handleDrawerClose","computedDrawerOpen","StyledDrawer","DrawerHeader","drawerProps","logoComponent","menuIconButton","MenuIcon","MuiDrawer","openedMixin","closedMixin","ChevronRightIcon","ChevronLeftIcon","Toolbar","toggleMode","initial","Breadcrumbs","NavigateNextIcon","DarkModeOutlinedIcon","LightModeOutlinedIcon","Avatar","buildIdsMap","droppableId","internalIdsRef","internalIds","setInternalIds","newInternalIds","hashValue","newInternalId","insertInEnd","newIds","remove","copyingItem","sourceIndex","destinationIndex","temp","arrayMove","ArrayContainerItem","droppableSnapshot","isDragging","menuOverflow","ArrayItemOptions","contentOverflow","DragHandleIcon","CopyIcon","removed","useLargeSideLayout","EntityView","selectedSubPath","onValuesAreModified","formWidth","onUpdate","saving","setSaving","valuesToBeSaved","setValuesToBeSaved","saveEntity","largeLayoutTabSelected","resolvedFormWidth","setFormContext","setStatus","modifiedValuesRef","modifiedValues","subcollections","subcollectionsCount","customViewsCount","getTabPositionFromPath","subPath","hasAdditionalViews","tabsPositionRef","mainViewVisible","setUsedEntity","readOnly","setReadOnly","getSelectedSubPath","closeAfterSave","onSaveEntityRequest","customViewsView","colIndex","globalLoading","subCollectionsViews","onSideTabClick","prevEntity","buildForm","subcollectionTabs","Tab","customViewTabs","CloseIcon","Tabs","ev","EntitySidePanel","beforeunload","NEW_URL_HASH","getEntityViewWidth","mainViewSelected","resolvedWidth","useBuildSideEntityController","initialised","smallLayout","newFlag","entityOrCollectionPath","panelsFromUrl","buildSidePanelsFromUrl","propsToSidePanel","navigationViewsForPath","lastCollectionPath","previousEntry","lastSidePanel","getParentReferencesFromPath","useBuildNavigationContext","basePath","baseCollectionPath","baseViews","collectionOverrideHandler","setCollections","views","setViews","setInitialised","topLevelNavigation","setTopLevelNavigation","navigationLoading","setNavigationLoading","navigationLoadingError","setNavigationLoadingError","cleanBasePath","cleanBaseCollectionPath","homeUrl","fullCollectionPath","buildCMSUrlPath","encodePath","buildUrlCollectionPath","computeTopNavigation","array","refreshNavigation","resolvedCollections","resolvedViews","resolveCollections","resolveCMSViews","getCollection","includeUserOverride","baseCollection","overriddenCollection","resolvedProps","permissions","isUrlCollectionPath","urlPathToDataPath","buildUrlEditCollectionPath","resolveAliasesFrom","baseLocation","getAllParentCollectionsForPath","filterOutNotAllowedCollections","useBuildSideDialogsController","setSidePanels","sidePanelsRef","routesStore","routesCount","updateSidePanels","newPanels","updatedPanels","panelProps","DEFAULT_COLLECTION_PATH","FireCMS","modeController","entityLinkBuilder","dateTimeFormat","locale","onAnalyticsEvent","usedBasePath","usedBasedCollectionPath","LocalizationProvider","AdapterDateFns","DateFnsUtils","FireCMSInternal","childrenResult","createCMSDefaultTheme","primaryColor","secondaryColor","fontFamily","headersFontFamily","createTheme","original","pink","red","shadow","NavigationRoutes","HomePage","customRoutes","cmsViews","cmsView","buildCMSViewRoute","collectionRoutes","urlPath","allActions","Route","RouteWrapper","homeRoute","Routes","buildCollection","buildProperty","buildProperties","buildPropertiesOrBuilder","propertiesOrBuilder","buildEnumValues","buildEnumValueConfig","buildEntityCallbacks","buildAdditionalFieldDelegate","additionalFieldDelegate","buildFieldConfig","useBuildModeController","prefersDarkModeQuery","prefersDarkMode","setMode","setDocumentMode","setDarkMode","setLightMode","useBuildLocalConfigurationPersistence","configCache","setConfigCache","getCollectionFromStorage","storageKey","getCollectionConfig","onCollectionModified","currentCache","cachedConfig","newConfig","recentlyVisitedPaths","_setRecentlyVisitedPaths","favouritePaths","_setFavouritePaths","collapsedGroups","_setCollapsedGroups","setRecentlyVisitedPaths","setFavouritePaths","setCollapsedGroups","SnackbarProvider","NotistackSnackbarProvider","useFirebaseAuthController","firebaseApp","signInOptions","loggedUser","setLoggedUser","authError","setAuthError","authProviderError","setAuthProviderError","initialLoading","setInitialLoading","authLoading","setAuthLoading","loginSkipped","setLoginSkipped","confirmationResult","setConfirmationResult","extra","setExtra","auth","getAuth","onAuthStateChanged","updateFirebaseUser","skipLogin","firebaseUser","onSignOut","signOut","getProviderOptions","providerId","option","googleLogin","provider","GoogleAuthProvider","scope","signInWithPopup","doOauthLogin","anonymousLogin","signInAnonymously","phoneLogin","phone","applicationVerifier","signInWithPhoneNumber","appleLogin","OAuthProvider","facebookLogin","FacebookAuthProvider","githubLogin","GithubAuthProvider","microsoftLogin","twitterLogin","TwitterAuthProvider","emailPasswordLogin","email","password","signInWithEmailAndPassword","createUserWithEmailAndPassword","createUserWithEmailAndPasswordFirebase","fetchSignInMethodsForEmail","fetchSignInMethodsForEmailFirebase","getAuthToken","Timestamp","useFirestoreDataSource","textSearchController","createEntityFromCollection","docSnap","firestoreToCMSModel","getCMSPathFromFirestorePath","buildQuery","orderBy","order","startAfter","collectionGroup","firestore","getFirestore","collectionReference","collectionGroupClause","collectionClause","queryParams","filterParameter","whereClause","cmsToFirestoreModel","orderByClause","startAfterClause","limitClause","query","getAndBuildEntity","getDoc","doc","docSnapshot","performTextSearch","ids","promises","getDocs","onSnapshot","firestoreValues","updatedFirestoreValues","serverTimestamp","documentReference","setDoc","deleteDoc","q","snapshots","coll","getCountFromServer","deleteField","FirestoreGeoPoint","DocumentReference","fsPath","to","useFirebaseStorageSource","setStorage","getStorage","urlsCache","usedFilename","uploadBytes","fileRef","getDownloadURL","storagePathOrUrl","getMetadata","useValidateAuthenticator","authentication","getAppCheckToken","appCheckForceRefresh","authenticationEnabled","notAllowedError","setNotAllowedError","authVerified","setAuthVerified","canAccessMainView","checkedUserRef","checkAuthentication","delegateUser","hostingError","useInitialiseFirebase","firebaseConfig","onFirebaseInit","authDomain","setFirebaseApp","firebaseConfigLoading","setFirebaseConfigLoading","configError","setConfigError","initFirebase","config","initialisedFirebaseApp","initializeApp","response","useInitializeAppCheck","appCheckLoading","setAppCheckLoading","appCheck","setAppCheck","forceRefresh","getToken","providerKey","useEnterpriseRecaptcha","isTokenAutoRefreshEnabled","appCheck_","initializeAppCheck","ReCaptchaEnterpriseProvider","ReCaptchaV3Provider","googleIcon","appleIcon","githubIcon","facebookIcon","microsoftIcon","twitterIcon","RECAPTCHA_CONTAINER_ID","useRecaptcha","RecaptchaVerifier","FirebaseLoginView","allowSkipLogin","noUserComponent","disableSignupScreen","additionalComponent","modeState","passwordLoginSelected","setPasswordLoginSelected","phoneLoginSelected","setPhoneLoginSelected","resolvedSignInOptions","sendMFASms","recaptchaVerifier","resolver","getMultiFactorResolver","PhoneMultiFactorGenerator","phoneInfoOptions","PhoneAuthProvider","verificationId","verificationCode","cred","multiFactorAssertion","errorView","ignoredCodes","notAllowedMessage","buildOauthLoginButtons","LoginButton","Phone","PersonOutlineIcon","LoginForm","PhoneLoginForm","setPhone","code","setCode","isInvalidCode","setIsInvalidCode","ArrowBackIcon","passwordRef","setEmail","availableProviders","setAvailableProviders","setPassword","shouldShowEmail","loginMode","otherProvidersMode","registrationMode","handleEnterEmail","handleEnterPassword","handleRegistration","onBackPressed","providers","DEFAULT_SIGN_IN_OPTIONS","FirebaseCMSApp","logoDark","appCheckOptions","LoginView","CssBaseline","BrowserRouter","usedLogo","ThemeProvider","performAlgoliaTextSearch","hits","hit"],"mappings":"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"}